import{s as Ut,l as V,b as s,m as Ye,e as w,i as Ft,f as c,c as l,n as Z,d as e,t as v,h as T,w as Pe,T as Ht,p as Ct,q as ns,r as D,x as Me,F as K,y as oe,z as ve,k as Ee,A as os,g as Gt,v as It,o as Jt,B as as,j as Tt,C as is,D as cs,u as rs,E as Xt}from"./index-gQaYO5ct.js";import{u as At,a as Zt,c as us,b as ds,d as vs,H as hs}from"./fillProfile-BtIfjwhZ.js";import{_ as Re,c as Qt,I as A,a as vt,i as Pt,b as St,l as ps,p as Mt,r as ms,g as Bt,d as Ot,e as _t,f as Lt,s as fs,G as gs,u as ys,h as zt,j as xs,k as ks,m as bs,n as _s}from"./GameLayout-B-di3ld6.js";import{usePointerStore as $s}from"./pointer-D6QFUiDV.js";import{s as Oe,a as $t}from"./safeStoreRefs-BFQqCsTa.js";const ws={key:0,class:"splash-damage-content"},Cs={class:"damage-icon"},Ss={class:"damage-amount"},Ms={key:0,class:"damage-source"},Ts={key:1,class:"splash-heal-content"},As={class:"heal-icon"},Ps={class:"heal-amount"},Es={key:2,class:"splash-effect-content"},Rs={class:"effect-text"},Ds={key:3,class:"splash-notification-content"},Vs={class:"notification-text"},js={key:4,class:"splash-image-content"},Ys={key:1,class:"image-title"},qs={class:"image-container"},Xs=["src","alt"],Bs={key:2,class:"image-caption"},Os={key:0,class:"note-title"},Ls={class:"note-text"},zs={__name:"SplashOverlay",setup(k){const ee=At(),{currentSplash:C}=Ut(ee),x=()=>{var O;((O=C.value)==null?void 0:O.dismissible)!==!1&&ee.dismissSplash()},_=V(()=>{if(!C.value)return"";const O=C.value.splashType,d="splash-overlay";switch(O){case"damage":return`${d} splash-damage`;case"heal":return`${d} splash-heal`;case"effect":return`${d} splash-effect`;case"notification":return`${d} splash-notification`;case"image":return`${d} splash-image`;case"note":return`${d} splash-note`;default:return d}}),u=["ðŸ’¥","âš”ï¸","ðŸ”¥","âš¡","ðŸ’€"],n=["âœ¨","ðŸ’š","ðŸŒ¿","ðŸ’«"],b=V(()=>u[Math.floor(Math.random()*u.length)]),$=V(()=>n[Math.floor(Math.random()*n.length)]);return(O,d)=>(s(),Ye(Ct,{to:"body"},[w(Ht,{name:"splash"},{default:Ft(()=>{var N,W,U,R,H,Q,te,P,Y,p;return[c(C)?(s(),l("div",{key:0,class:Z(_.value),onClick:x},[c(C).splashType==="damage"?(s(),l("div",ws,[e("div",Cs,v(b.value),1),e("div",Ss,"-"+v(((N=c(C).content)==null?void 0:N.amount)||"?"),1),(W=c(C).content)!=null&&W.source?(s(),l("div",Ms,v(c(C).content.source),1)):T("",!0)])):c(C).splashType==="heal"?(s(),l("div",Ts,[e("div",As,v($.value),1),e("div",Ps,"+"+v(((U=c(C).content)==null?void 0:U.amount)||"?"),1)])):c(C).splashType==="effect"?(s(),l("div",Es,[e("div",Rs,v(c(C).content),1)])):c(C).splashType==="notification"?(s(),l("div",Ds,[e("div",Vs,v(c(C).content),1)])):c(C).splashType==="image"?(s(),l("div",js,[c(C).dismissible!==!1?(s(),l("button",{key:0,class:"image-close-btn",onClick:Pe(x,["stop"])}," âœ• ")):T("",!0),(R=c(C).content)!=null&&R.title?(s(),l("h2",Ys,v(c(C).content.title),1)):T("",!0),e("div",qs,[e("img",{src:(H=c(C).content)==null?void 0:H.url,alt:((Q=c(C).content)==null?void 0:Q.caption)||"",class:"splash-img"},null,8,Xs)]),(te=c(C).content)!=null&&te.caption?(s(),l("p",Bs,v(c(C).content.caption),1)):T("",!0)])):c(C).splashType==="note"?(s(),l("div",{key:5,class:Z(["splash-note-content",`note-style-${((P=c(C).content)==null?void 0:P.style)||"parchment"}`])},[e("button",{class:"note-close-btn",onClick:Pe(x,["stop"])}," âœ• "),(Y=c(C).content)!=null&&Y.title?(s(),l("h2",Os,v(c(C).content.title),1)):T("",!0),e("div",Ls,v((p=c(C).content)==null?void 0:p.text),1)],2)):T("",!0)],2)):T("",!0)]}),_:1})]))}},Ns=Re(zs,[["__scopeId","data-v-a18f08cc"]]),Kt={1:{name:"ÐšÐ°Ð¼ÐµÐ½Ð½Ñ‹Ð¹ Ð²ÐµÐº"},2:{name:"Ð–ÐµÐ»ÐµÐ·Ð½Ñ‹Ð¹ Ð²ÐµÐº"},3:{name:"Ð¢Ñ‘Ð¼Ð½Ñ‹Ðµ Ð²ÐµÐºÐ°"},4:{name:"ÐÐ½Ñ‚Ð¸Ñ‡Ð½Ð¾ÑÑ‚ÑŒ"},5:{name:"Ð Ð°Ð½Ð½ÐµÐµ ÑÑ€ÐµÐ´Ð½ÐµÐ²ÐµÐºÐ¾Ð²ÑŒÐµ"},6:{name:"Ð¡Ñ€ÐµÐ´Ð½Ð¸Ðµ Ð²ÐµÐºÐ°"},7:{name:"Ð ÐµÐ½ÐµÑÑÐ°Ð½Ñ"},8:{name:"Ð’ÐµÐº Ð¿Ð°Ñ€Ð°"},9:{name:"Ð’ÐµÐº Ð´Ð¸Ð·ÐµÐ»Ñ"},10:{name:"Ð¡Ð¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾ÑÑ‚ÑŒ"},11:{name:"ÐšÐ¸Ð±ÐµÑ€ Ð²ÐµÐº"}},Ws=ns("characterCreation",{state:()=>({step:1,constraints:{allowedRaces:[],allowedSubraces:[],allowedClasses:[],maxWealth:10,maxEpoch:10},formData:{name:"",portrait:null,gender:null,race:null,subrace:null,class:null,stats:{war:0,knowledge:0,community:0,shadow:0,mysticism:0,nature:0},skills:{fromClass:null,fromAspect1:null,fromAspect2:null},equipment:{armor:"clothes",weapons:[],wealth:5,epoch:10}}}),persist:{key:"trip-character-creation-v3",paths:["step","formData","constraints"]},getters:{isComplete:k=>k.step===7&&k.formData.gender&&k.formData.race&&k.formData.class,isRaceAllowed:k=>ee=>!k.constraints.allowedRaces||k.constraints.allowedRaces.length===0?!0:k.constraints.allowedRaces.includes(ee),isSubraceAllowed:k=>ee=>!k.constraints.allowedSubraces||k.constraints.allowedSubraces.length===0?!0:k.constraints.allowedSubraces.includes(ee),isClassAllowed:k=>ee=>!k.constraints.allowedClasses||k.constraints.allowedClasses.length===0?!0:k.constraints.allowedClasses.includes(ee),maxWealth:k=>k.constraints.maxWealth??10,maxEpoch:k=>k.constraints.maxEpoch??10,hasConstraints:k=>{var C,x,_;const ee=k.constraints;return((C=ee.allowedRaces)==null?void 0:C.length)>0||((x=ee.allowedSubraces)==null?void 0:x.length)>0||((_=ee.allowedClasses)==null?void 0:_.length)>0||ee.maxWealth<10||ee.maxEpoch<10}},actions:{setStep(k){this.step=k},setConstraints(k){this.constraints={allowedRaces:k.allowedRaces||[],allowedSubraces:k.allowedSubraces||[],allowedClasses:k.allowedClasses||[],maxWealth:k.maxWealth??10,maxEpoch:k.maxEpoch??10}},setName(k){this.formData.name=k},setPortrait(k){this.formData.portrait=k},setGender(k){this.formData.gender=k},setRace(k){this.formData.race=k},setSubrace(k){this.formData.subrace=k},setClass(k){this.formData.class=k},setStats(k){this.formData.stats={...this.formData.stats,...k}},setSkills(k){this.formData.skills=k},setEquipment(k){this.formData.equipment=k},reset(){this.step=1,this.constraints={allowedRaces:[],allowedSubraces:[],allowedClasses:[],maxWealth:10,maxEpoch:10},this.formData={name:"",portrait:null,gender:null,race:null,subrace:null,class:null,stats:{war:0,knowledge:0,community:0,shadow:0,mysticism:0,nature:0},skills:{fromClass:null,fromAspect1:null,fromAspect2:null},equipment:{armor:"clothes",weapons:[],wealth:5,epoch:10}}}}}),Us={class:"space-y-6"},Fs={key:0},Hs={class:"flex items-center justify-between mb-3"},Gs={class:"space-y-2"},Is={class:"flex items-center gap-3 flex-1"},Js={class:"flex-1"},Zs={class:"text-sm font-medium text-slate-200"},Qs={class:"text-xs text-slate-400"},Ks={class:"flex items-center gap-3"},el={class:"text-right"},tl={class:"flex items-center gap-3 flex-1"},sl={class:"flex-1"},ll={class:"text-sm font-medium text-slate-300"},nl={class:"text-xs text-slate-500"},ol={class:"flex items-center gap-3"},al={class:"flex items-center gap-2 px-2.5 py-1.5 rounded-lg border border-slate-700/40 bg-slate-800/40"},il={class:"text-right"},cl={class:"text-[10px] uppercase font-medium tracking-wide text-slate-500"},rl={class:"text-sm font-bold text-slate-400"},ul={class:"text-xl font-semibold text-slate-400 px-3 py-1"},dl={class:"flex items-center gap-3 flex-1"},vl={class:"flex-1"},hl={class:"text-sm font-medium text-slate-500"},pl={class:"text-xs text-slate-600"},ml={class:"flex items-center gap-3"},fl={class:"flex items-center gap-2 px-2.5 py-1.5 rounded-lg border border-slate-800/50 bg-slate-900/40"},gl={class:"text-right"},yl={class:"text-[10px] uppercase font-medium tracking-wide text-slate-600"},xl={class:"text-sm font-bold text-slate-600"},kl={key:1},bl={class:"space-y-3"},_l={class:"text-xs font-medium text-slate-400 mb-2 flex items-center gap-2"},$l={class:"grid grid-cols-1 gap-2"},wl=["onClick"],Cl={class:"flex items-start justify-between gap-2"},Sl={class:"flex-1 min-w-0"},Ml={class:"text-sm font-medium text-slate-200 mb-1"},Tl={class:"text-xs text-slate-500 leading-relaxed"},Al={key:0,class:"border-t border-slate-700/30"},Pl=["onClick"],El={key:0,class:"px-3 pb-3 space-y-2 bg-slate-900/30"},Rl={class:"text-xs font-medium text-slate-300 mb-1"},Dl={class:"text-xs text-slate-400"},Vl={class:"grid grid-cols-1 gap-2"},jl=["onClick"],Yl={class:"flex items-start justify-between gap-2"},ql={class:"flex-1 min-w-0"},Xl={class:"text-sm font-medium text-slate-200 mb-1"},Bl={class:"text-xs text-slate-500 leading-relaxed"},Ol={key:0,class:"border-t border-slate-700/30"},Ll=["onClick"],zl={key:0,class:"px-3 pb-3 space-y-2 bg-slate-900/30"},Nl={class:"text-xs font-medium text-slate-300 mb-1"},Wl={class:"text-xs text-slate-400"},Ul={class:"grid grid-cols-1 gap-2"},Fl=["onClick"],Hl={class:"flex items-start justify-between gap-2"},Gl={class:"flex-1 min-w-0"},Il={class:"text-sm font-medium text-slate-200 mb-1"},Jl={class:"text-xs text-slate-500 leading-relaxed"},Zl={key:0,class:"border-t border-slate-700/30"},Ql=["onClick"],Kl={key:0,class:"px-3 pb-3 space-y-2 bg-slate-900/30"},en={class:"text-xs font-medium text-slate-300 mb-1"},tn={class:"text-xs text-slate-400"},sn={__name:"ClassStatsAndSkills",props:{classId:{type:String,required:!0},modelValue:{type:Object,required:!0},showStats:{type:Boolean,default:!0},showSkills:{type:Boolean,default:!0}},emits:["update:modelValue"],setup(k,{expose:ee,emit:C}){const x=k,_=C,u=vt.aspects,n=Qt.classes,b=D({...x.modelValue.stats}),$=D({...x.modelValue.skills}),O=D(!1),d=D(new Set);Me(()=>x.modelValue,E=>{if(!O.value){const y=JSON.stringify(b.value)!==JSON.stringify(E.stats),S=JSON.stringify($.value)!==JSON.stringify(E.skills);y&&(b.value={...E.stats}),S&&($.value={...E.skills})}},{deep:!0,flush:"post"}),Me([b,$],()=>{O.value||_("update:modelValue",{stats:{...b.value},skills:{...$.value}})},{deep:!0,flush:"post"});const N=V(()=>n.find(E=>E.id===x.classId)),W=V(()=>N.value?N.value.aspects:[]),U=V(()=>{if(W.value.length!==2)return!1;const E=P(W.value[0]);return P(W.value[1]),(E==null?void 0:E.opposite)===W.value[1]}),R=V(()=>{var S,L;if(!N.value)return[];const E=u.map(J=>J.id),y=W.value;if(U.value)return E.filter(J=>!y.includes(J));{const J=(S=P(y[0]))==null?void 0:S.opposite,ie=(L=P(y[1]))==null?void 0:L.opposite,f=[J,ie].filter(Boolean);return E.filter(m=>!y.includes(m)&&!f.includes(m))}}),H=V(()=>{var L,J;if(U.value)return[];if(!N.value)return[];const E=W.value,y=(L=P(E[0]))==null?void 0:L.opposite,S=(J=P(E[1]))==null?void 0:J.opposite;return[y,S].filter(Boolean)}),Q=V(()=>{var E;return((E=N.value)==null?void 0:E.traits)||[]}),te=V(()=>{if(!N.value)return[[],[]];const E=u.find(J=>J.id===W.value[0]),y=u.find(J=>J.id===W.value[1]),S=(E==null?void 0:E.traits)||[],L=(y==null?void 0:y.traits)||[];return[S,L]});function P(E){return u.find(y=>y.id===E)}function Y(E){var y;return((y=P(E))==null?void 0:y.color)||"#64748b"}const p=V(()=>{const E={};return u.forEach(S=>{var ce;const L=b.value[S.id]||0,J=S.neighbors||[],ie=S.opposite,f=b.value[J[0]]||0,m=b.value[J[1]]||0,a=Math.floor(L+f/2+m/2+0),F=b.value[ie]||0,se=Math.floor(F/2),ue=Math.max(a,se);E[S.id]={bonus:ue,checkName:((ce=S.check)==null?void 0:ce.name)||"",checkIcon:S.checkIcon}}),E});Me(()=>x.classId,E=>{if(!E)return;O.value=!0;const y={war:0,knowledge:0,community:0,shadow:0,mysticism:0,nature:0},S=W.value,L=R.value,J=H.value;S.length===2&&(U.value?(y[S[0]]=6,y[S[1]]=4,L.forEach(ie=>{y[ie]=1})):(y[S[0]]=6,y[S[1]]=4,L.forEach(ie=>{y[ie]=2}),J.forEach(ie=>{y[ie]=0}))),b.value=y,setTimeout(()=>{O.value=!1,_("update:modelValue",{stats:{...b.value},skills:{...$.value}})},0)},{immediate:!0});function g(){const E=b.value[W.value[0]];b.value[W.value[0]]=b.value[W.value[1]],b.value[W.value[1]]=E}function h(E,y){$.value[E]=y}function X(E){d.value.has(E)?d.value.delete(E):d.value.add(E)}const q=V(()=>$.value.fromClass&&$.value.fromAspect1&&$.value.fromAspect2);return ee({allSkillsSelected:q,swapStats:g}),(E,y)=>{var S,L,J,ie,f,m;return s(),l("div",Us,[k.showStats?(s(),l("div",Fs,[e("div",Hs,[y[1]||(y[1]=e("h4",{class:"text-xs font-semibold text-slate-400 uppercase tracking-wider"},"Ð¥Ð°Ñ€Ð°ÐºÑ‚ÐµÑ€Ð¸ÑÑ‚Ð¸ÐºÐ¸",-1)),W.value.length===2?(s(),l("button",{key:0,onClick:g,class:"flex items-center gap-1.5 px-3 py-1.5 text-xs rounded bg-slate-700/50 hover:bg-slate-700 border border-slate-600/50 text-slate-300 transition"},[w(c(A),{icon:"mdi:swap-horizontal",class:"w-4 h-4"}),y[0]||(y[0]=e("span",null,"ÐŸÐ¾Ð¼ÐµÐ½ÑÑ‚ÑŒ Ð¼ÐµÑÑ‚Ð°Ð¼Ð¸",-1))])):T("",!0)]),e("div",Gs,[(s(!0),l(K,null,oe(W.value,(a,F)=>{var se,ue,ce,de,xe,pe;return s(),l("div",{key:a,class:"flex items-center justify-between p-3 rounded-lg border transition-colors",style:ve({backgroundColor:Y(a)+"15",borderColor:Y(a)+"40"})},[e("div",Is,[w(c(A),{icon:((se=P(a))==null?void 0:se.characteristicIcon)||"mdi:star",class:"w-6 h-6",style:ve({color:Y(a)})},null,8,["icon","style"]),e("div",Js,[e("div",Zs,v((ue=P(a))==null?void 0:ue.characteristic.name),1),e("div",Qs,v((ce=P(a))==null?void 0:ce.name),1)])]),e("div",Ks,[e("div",{class:"flex items-center gap-2 px-2.5 py-1.5 rounded-lg border",style:ve({backgroundColor:Y(a)+"15",borderColor:Y(a)+"30"})},[w(c(A),{icon:(de=p.value[a])==null?void 0:de.checkIcon,class:"w-4 h-4",style:ve({color:Y(a)+"aa"})},null,8,["icon","style"]),e("div",el,[e("div",{class:"text-[10px] uppercase font-medium tracking-wide",style:ve({color:Y(a)+"cc"})},v((xe=p.value[a])==null?void 0:xe.checkName),5),e("div",{class:"text-sm font-bold",style:ve({color:Y(a)})}," +"+v((pe=p.value[a])==null?void 0:pe.bonus),5)])],4),e("div",{class:"text-2xl font-bold px-3 py-1 rounded",style:ve({color:Y(a),backgroundColor:Y(a)+"20"})},v(b.value[a]),5)])],4)}),128)),(s(!0),l(K,null,oe(R.value,a=>{var F,se,ue,ce,de,xe;return s(),l("div",{key:a,class:"flex items-center justify-between p-3 rounded-lg bg-slate-800/30 border border-slate-700/30"},[e("div",tl,[w(c(A),{icon:((F=P(a))==null?void 0:F.characteristicIcon)||"mdi:star",class:"w-6 h-6 text-slate-400"},null,8,["icon"]),e("div",sl,[e("div",ll,v((se=P(a))==null?void 0:se.characteristic.name),1),e("div",nl,v((ue=P(a))==null?void 0:ue.name),1)])]),e("div",ol,[e("div",al,[w(c(A),{icon:(ce=p.value[a])==null?void 0:ce.checkIcon,class:"w-4 h-4 text-slate-500"},null,8,["icon"]),e("div",il,[e("div",cl,v((de=p.value[a])==null?void 0:de.checkName),1),e("div",rl," +"+v((xe=p.value[a])==null?void 0:xe.bonus),1)])]),e("div",ul,v(b.value[a]),1)])])}),128)),(s(!0),l(K,null,oe(H.value,a=>{var F,se,ue,ce,de,xe;return s(),l("div",{key:a,class:"flex items-center justify-between p-3 rounded-lg bg-slate-900/50 border border-slate-800/50 opacity-60"},[e("div",dl,[w(c(A),{icon:((F=P(a))==null?void 0:F.characteristicIcon)||"mdi:star",class:"w-6 h-6 text-slate-600"},null,8,["icon"]),e("div",vl,[e("div",hl,v((se=P(a))==null?void 0:se.characteristic.name),1),e("div",pl,v((ue=P(a))==null?void 0:ue.name),1)])]),e("div",ml,[e("div",fl,[w(c(A),{icon:(ce=p.value[a])==null?void 0:ce.checkIcon,class:"w-4 h-4 text-slate-600"},null,8,["icon"]),e("div",gl,[e("div",yl,v((de=p.value[a])==null?void 0:de.checkName),1),e("div",xl," +"+v((xe=p.value[a])==null?void 0:xe.bonus),1)])]),y[2]||(y[2]=e("div",{class:"text-xl font-semibold text-slate-600 px-3 py-1"}," 0 ",-1))])])}),128))])])):T("",!0),k.showSkills?(s(),l("div",kl,[y[3]||(y[3]=e("h4",{class:"text-sm font-semibold text-slate-300 mb-3"},"Ð’Ñ‹Ð±Ð¾Ñ€ Ð½Ð°Ð²Ñ‹ÐºÐ¾Ð² (3 Ð¸Ð· 9)",-1)),e("div",bl,[e("div",null,[e("div",_l,[w(c(A),{icon:"game-icons:skills",class:"w-4 h-4"}),Ee(" ÐÐ°Ð²Ñ‹Ðº ÐºÐ»Ð°ÑÑÐ° (1 Ð¸Ð· "+v(Q.value.length)+") ",1)]),e("div",$l,[(s(!0),l(K,null,oe(Q.value,a=>(s(),l("div",{key:a.id,class:Z(["rounded-lg border transition-all overflow-hidden",$.value.fromClass===a.id?"bg-slate-700/40 border-slate-500/60 ring-2 ring-slate-500/30":"bg-slate-800/30 border-slate-700/30 hover:bg-slate-800/40 hover:border-slate-700/40"])},[e("button",{onClick:F=>h("fromClass",a.id),class:"w-full text-left p-3 transition"},[e("div",Cl,[e("div",Sl,[e("div",Ml,v(a.name),1),e("div",Tl,v(a.levels[0].text),1)]),$.value.fromClass===a.id?(s(),Ye(c(A),{key:0,icon:"mdi:check-circle",class:"w-5 h-5 text-slate-300 flex-shrink-0"})):T("",!0)])],8,wl),a.levels.length>1?(s(),l("div",Al,[e("button",{onClick:F=>X(a.id),class:"w-full px-3 py-2 text-xs text-slate-400 hover:text-slate-300 hover:bg-white/5 transition flex items-center gap-1.5"},[w(c(A),{icon:d.value.has(a.id)?"mdi:chevron-up":"mdi:chevron-down",class:"w-4 h-4"},null,8,["icon"]),e("span",null,v(d.value.has(a.id)?"Ð¡ÐºÑ€Ñ‹Ñ‚ÑŒ":"ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ")+" ÑƒÑ€Ð¾Ð²Ð½Ð¸ 2-3",1)],8,Pl),d.value.has(a.id)?(s(),l("div",El,[(s(!0),l(K,null,oe(a.levels.slice(1),(F,se)=>(s(),l("div",{key:se,class:"p-2 rounded bg-slate-800/50 border border-slate-700/50"},[e("div",Rl,"Ð£Ñ€Ð¾Ð²ÐµÐ½ÑŒ "+v(se+2),1),e("div",Dl,v(F.text),1)]))),128))])):T("",!0)])):T("",!0)],2))),128))])]),e("div",null,[e("div",{class:"text-xs font-medium mb-2 flex items-center gap-2",style:ve({color:Y(W.value[0])})},[w(c(A),{icon:(S=P(W.value[0]))==null?void 0:S.icon,class:"w-4 h-4"},null,8,["icon"]),Ee(" ÐÐ°Ð²Ñ‹Ðº Ð°ÑÐ¿ÐµÐºÑ‚Ð° "+v((L=P(W.value[0]))==null?void 0:L.name)+" (1 Ð¸Ð· "+v(((J=te.value[0])==null?void 0:J.length)||0)+") ",1)],4),e("div",Vl,[(s(!0),l(K,null,oe(te.value[0],a=>(s(),l("div",{key:a.id,class:Z(["rounded-lg border transition-all overflow-hidden",$.value.fromAspect1===a.id?"bg-slate-700/40 border-slate-500/60 ring-2 ring-slate-500/30":"bg-slate-800/30 border-slate-700/30 hover:bg-slate-800/40 hover:border-slate-700/40"])},[e("button",{onClick:F=>h("fromAspect1",a.id),class:"w-full text-left p-3 transition"},[e("div",Yl,[e("div",ql,[e("div",Xl,v(a.name),1),e("div",Bl,v(a.levels[0].text),1)]),$.value.fromAspect1===a.id?(s(),Ye(c(A),{key:0,icon:"mdi:check-circle",class:"w-5 h-5 text-slate-300 flex-shrink-0"})):T("",!0)])],8,jl),a.levels.length>1?(s(),l("div",Ol,[e("button",{onClick:F=>X(a.id),class:"w-full px-3 py-2 text-xs text-slate-400 hover:text-slate-300 hover:bg-white/5 transition flex items-center gap-1.5"},[w(c(A),{icon:d.value.has(a.id)?"mdi:chevron-up":"mdi:chevron-down",class:"w-4 h-4"},null,8,["icon"]),e("span",null,v(d.value.has(a.id)?"Ð¡ÐºÑ€Ñ‹Ñ‚ÑŒ":"ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ")+" ÑƒÑ€Ð¾Ð²Ð½Ð¸ 2-3",1)],8,Ll),d.value.has(a.id)?(s(),l("div",zl,[(s(!0),l(K,null,oe(a.levels.slice(1),(F,se)=>(s(),l("div",{key:se,class:"p-2 rounded border bg-slate-800/50 border-slate-700/50"},[e("div",Nl,"Ð£Ñ€Ð¾Ð²ÐµÐ½ÑŒ "+v(se+2),1),e("div",Wl,v(F.text),1)]))),128))])):T("",!0)])):T("",!0)],2))),128))])]),e("div",null,[e("div",{class:"text-xs font-medium mb-2 flex items-center gap-2",style:ve({color:Y(W.value[1])})},[w(c(A),{icon:(ie=P(W.value[1]))==null?void 0:ie.icon,class:"w-4 h-4"},null,8,["icon"]),Ee(" ÐÐ°Ð²Ñ‹Ðº Ð°ÑÐ¿ÐµÐºÑ‚Ð° "+v((f=P(W.value[1]))==null?void 0:f.name)+" (1 Ð¸Ð· "+v(((m=te.value[1])==null?void 0:m.length)||0)+") ",1)],4),e("div",Ul,[(s(!0),l(K,null,oe(te.value[1],a=>(s(),l("div",{key:a.id,class:Z(["rounded-lg border transition-all overflow-hidden",$.value.fromAspect2===a.id?"bg-slate-700/40 border-slate-500/60 ring-2 ring-slate-500/30":"bg-slate-800/30 border-slate-700/30 hover:bg-slate-800/40 hover:border-slate-700/40"])},[e("button",{onClick:F=>h("fromAspect2",a.id),class:"w-full text-left p-3 transition"},[e("div",Hl,[e("div",Gl,[e("div",Il,v(a.name),1),e("div",Jl,v(a.levels[0].text),1)]),$.value.fromAspect2===a.id?(s(),Ye(c(A),{key:0,icon:"mdi:check-circle",class:"w-5 h-5 text-slate-300 flex-shrink-0"})):T("",!0)])],8,Fl),a.levels.length>1?(s(),l("div",Zl,[e("button",{onClick:F=>X(a.id),class:"w-full px-3 py-2 text-xs text-slate-400 hover:text-slate-300 hover:bg-white/5 transition flex items-center gap-1.5"},[w(c(A),{icon:d.value.has(a.id)?"mdi:chevron-up":"mdi:chevron-down",class:"w-4 h-4"},null,8,["icon"]),e("span",null,v(d.value.has(a.id)?"Ð¡ÐºÑ€Ñ‹Ñ‚ÑŒ":"ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ")+" ÑƒÑ€Ð¾Ð²Ð½Ð¸ 2-3",1)],8,Ql),d.value.has(a.id)?(s(),l("div",Kl,[(s(!0),l(K,null,oe(a.levels.slice(1),(F,se)=>(s(),l("div",{key:se,class:"p-2 rounded border bg-slate-800/50 border-slate-700/50"},[e("div",en,"Ð£Ñ€Ð¾Ð²ÐµÐ½ÑŒ "+v(se+2),1),e("div",tn,v(F.text),1)]))),128))])):T("",!0)])):T("",!0)],2))),128))])])])])):T("",!0)])}}},ln={class:"flex flex-col items-center gap-4"},nn={class:"flex items-center gap-2 bg-slate-800/50 rounded-lg p-1 border border-slate-700/50"},on=["width","height","viewBox"],an={key:0},cn=["points","stroke","stroke-width"],rn={key:1},un=["cx","cy","r","stroke","stroke-width"],dn=["x1","y1","x2","y2"],vn=["points"],hn=["points"],pn=["cx","cy","fill","stroke"],mn=["cx","cy","fill","stroke"],fn=["x","y"],gn={class:"w-full h-full flex items-center justify-center",xmlns:"http://www.w3.org/1999/xhtml"},yn=["title"],xn=["x","y"],kn={class:"flex items-center justify-center",xmlns:"http://www.w3.org/1999/xhtml"},bn=["x","y"],_n={class:"flex items-center justify-center",xmlns:"http://www.w3.org/1999/xhtml"},$n={__name:"AspectChart",props:{stats:{type:Object,required:!0},size:{type:Number,default:340}},emits:["swap-stats"],setup(k,{emit:ee}){const C=k,{stats:x}=os(C),_=vt.aspects,u=D("stats"),n=V(()=>C.size/2),b=V(()=>C.size/2*.6),$=V(()=>{const P={};return _.forEach(Y=>{P[Y.id]=Y.color}),P}),O=V(()=>{const P={};return _.forEach(p=>{var ie;const g=x.value[p.id]||0,h=p.neighbors||[],X=p.opposite,q=x.value[h[0]]||0,E=x.value[h[1]]||0,y=Math.floor(g+q/2+E/2+0),S=x.value[X]||0,L=Math.floor(S/2),J=Math.max(y,L);P[p.id]={bonus:J,checkName:((ie=p.check)==null?void 0:ie.name)||"",checkIcon:p.checkIcon}}),P});function d(P,Y){const g=(P*60-120)*(Math.PI/180),h=b.value*Y/10;return{x:n.value+h*Math.cos(g),y:n.value+h*Math.sin(g)}}function N(P,Y){const p=(P*60-120)*(Math.PI/180),g=W(Y);return{x:n.value+g*Math.cos(p),y:n.value+g*Math.sin(p)}}function W(P){return b.value*P/12}function U(P){const Y=(P*60-120)*(Math.PI/180),p=b.value;return{x:n.value+p*Math.cos(Y),y:n.value+p*Math.sin(Y)}}function R(P){const Y=[];for(let p=0;p<6;p++){const g=d(p,P);Y.push(`${g.x},${g.y}`)}return Y.join(" ")}function H(){const P=[];return _.forEach((Y,p)=>{const g=x.value[Y.id]||0,h=d(p,g);P.push(`${h.x},${h.y}`)}),P.join(" ")}function Q(){const P=[];return _.forEach((Y,p)=>{var X;const g=((X=O.value[Y.id])==null?void 0:X.bonus)||0,h=N(p,g);P.push(`${h.x},${h.y}`)}),P.join(" ")}function te(P){const Y=(P*60-120)*(Math.PI/180),p=b.value*1.25;return{x:n.value+p*Math.cos(Y),y:n.value+p*Math.sin(Y)}}return(P,Y)=>(s(),l("div",ln,[e("div",nn,[e("button",{onClick:Y[0]||(Y[0]=p=>u.value="stats"),class:Z(["px-4 py-2 rounded-md text-sm font-medium transition-all",u.value==="stats"?"bg-sky-500/20 text-sky-200 border border-sky-400/40":"text-slate-400 hover:text-slate-300"])},[w(c(A),{icon:"game-icons:embrassed-energy",class:"w-4 h-4 inline mr-1.5"}),Y[2]||(Y[2]=Ee(" Ð¥Ð°Ñ€Ð°ÐºÑ‚ÐµÑ€Ð¸ÑÑ‚Ð¸ÐºÐ¸ ",-1))],2),e("button",{onClick:Y[1]||(Y[1]=p=>u.value="checks"),class:Z(["px-4 py-2 rounded-md text-sm font-medium transition-all",u.value==="checks"?"bg-purple-500/20 text-purple-200 border border-purple-400/40":"text-slate-400 hover:text-slate-300"])},[w(c(A),{icon:"mdi:dice-d20",class:"w-4 h-4 inline mr-1.5"}),Y[3]||(Y[3]=Ee(" Ð‘Ð¾Ð½ÑƒÑÑ‹ Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð¾Ðº ",-1))],2)]),e("div",{class:"relative",style:ve({width:k.size+"px",height:k.size+"px"})},[(s(),l("svg",{width:k.size,height:k.size,viewBox:`0 0 ${k.size} ${k.size}`},[u.value==="stats"?(s(),l("g",an,[(s(),l(K,null,oe([0,2,4,6,8,10],p=>e("g",{key:p},[e("polygon",{points:R(p),fill:"none",stroke:p===10?"rgba(148, 163, 184, 0.3)":"rgba(148, 163, 184, 0.1)","stroke-width":p===10?1.5:1},null,8,cn)])),64))])):(s(),l("g",rn,[(s(),l(K,null,oe([0,2,4,6,8,10,12],p=>e("g",{key:p},[e("circle",{cx:n.value,cy:n.value,r:W(p),fill:"none",stroke:p===12?"rgba(148, 163, 184, 0.3)":"rgba(148, 163, 184, 0.1)","stroke-width":p===12?1.5:1},null,8,un)])),64))])),(s(!0),l(K,null,oe(c(_),(p,g)=>(s(),l("g",{key:p.id},[e("line",{x1:n.value,y1:n.value,x2:U(g).x,y2:U(g).y,stroke:"rgba(148, 163, 184, 0.2)","stroke-width":"1"},null,8,dn)]))),128)),u.value==="stats"?(s(),l("polygon",{key:2,points:H(),fill:"rgba(56, 189, 248, 0.3)",stroke:"rgba(56, 189, 248, 0.7)","stroke-width":"2",class:"transition-all duration-300"},null,8,vn)):(s(),l("polygon",{key:3,points:Q(),fill:"rgba(139, 92, 246, 0.2)",stroke:"rgba(139, 92, 246, 0.6)","stroke-width":"2",class:"transition-all duration-300"},null,8,hn)),(s(!0),l(K,null,oe(c(_),(p,g)=>{var h,X;return s(),l("g",{key:"point-"+p.id},[u.value==="stats"&&c(x)[p.id]>0?(s(),l("circle",{key:0,cx:d(g,c(x)[p.id]).x,cy:d(g,c(x)[p.id]).y,r:4,fill:$.value[p.id],stroke:$.value[p.id],"stroke-width":"2",class:"transition-all duration-300"},null,8,pn)):u.value==="checks"?(s(),l("circle",{key:1,cx:N(g,((h=O.value[p.id])==null?void 0:h.bonus)||0).x,cy:N(g,((X=O.value[p.id])==null?void 0:X.bonus)||0).y,r:5,fill:$.value[p.id],stroke:$.value[p.id],"stroke-width":"2",class:"transition-all duration-300"},null,8,mn)):T("",!0)])}),128)),(s(!0),l(K,null,oe(c(_),(p,g)=>{var h,X,q;return s(),l("g",{key:"label-"+p.id},[e("g",null,[e("title",null,v(u.value==="stats"?p.characteristic.name:(h=p.check)==null?void 0:h.name),1),(s(),l("foreignObject",{x:U(g).x-20,y:U(g).y-20,width:"40",height:"40"},[e("div",gn,[e("div",{class:"w-10 h-10 rounded-full flex items-center justify-center shadow-lg",style:ve({backgroundColor:$.value[p.id]+"25",borderColor:$.value[p.id]+"70",borderWidth:"2px"}),title:u.value==="stats"?p.characteristic.name:(X=p.check)==null?void 0:X.name},[w(c(A),{icon:u.value==="stats"?p.characteristicIcon:p.checkIcon,class:"w-6 h-6",style:ve({color:$.value[p.id]})},null,8,["icon","style"])],12,yn)])],8,fn))]),u.value==="stats"?(s(),l("foreignObject",{key:0,x:te(g).x-20,y:te(g).y-16,width:"40",height:"32"},[e("div",kn,[e("div",{class:"text-lg font-bold text-center min-w-[36px]",style:ve({color:$.value[p.id]})},v(c(x)[p.id]),5)])],8,xn)):T("",!0),u.value==="checks"?(s(),l("foreignObject",{key:1,x:te(g).x-22,y:te(g).y-16,width:"44",height:"32"},[e("div",_n,[e("div",{class:"text-lg font-bold text-center min-w-[40px]",style:ve({color:$.value[p.id]})},v(((q=O.value[p.id])==null?void 0:q.bonus)||0),5)])],8,bn)):T("",!0)])}),128))],8,on))],4)]))}},wn={class:"armor-carousel"},Cn={class:"armor-header"},Sn=["disabled"],Mn={class:"armor-title"},Tn={class:"armor-name"},An={class:"armor-index"},Pn=["disabled"],En={class:"armor-image-block"},Rn=["src","alt"],Dn={class:"armor-stats-row"},Vn={class:"stat-value"},jn={class:"stat-value"},Yn={class:"avail-text"},qn={__name:"ArmorCarousel",props:{modelValue:{type:String,default:"clothes"},wealth:{type:Number,default:5},epoch:{type:Number,default:10}},emits:["update:modelValue"],setup(k,{emit:ee}){const C=k,x=ee,_=Kt,u=Pt.items.filter(g=>g.category==="armor"),n=D(u.findIndex(g=>g.id===C.modelValue));n.value===-1&&(n.value=0),Me(()=>C.modelValue,g=>{const h=u.findIndex(X=>X.id===g);h!==-1&&(n.value=h)});const b=V(()=>u[n.value]),$=()=>{n.value>0&&(n.value--,x("update:modelValue",b.value.id))},O=()=>{n.value<u.length-1&&(n.value++,x("update:modelValue",b.value.id))},d=D({x:0,y:0}),N=g=>{d.value={x:g.touches[0].clientX,y:g.touches[0].clientY}},W=g=>{},U=g=>{const h=g.changedTouches[0].clientX-d.value.x,X=g.changedTouches[0].clientY-d.value.y;Math.abs(h)>50&&Math.abs(h)>Math.abs(X)&&(h>0?$():O())},R=g=>{const h=g.price-C.wealth;return g.epoch<=C.epoch?h<0?"avail-easy":h===0?"avail-normal":h===1?"avail-hard":"avail-blocked":"avail-blocked"},H=g=>{const h=g.price-C.wealth;return g.epoch<=C.epoch?h<0?"mdi:check-circle":h===0?"mdi:alert-circle":h===1?"mdi:alert":"mdi:close-circle":"mdi:clock-alert"},Q=g=>{var q;const h=g.price-C.wealth;return g.epoch<=C.epoch?h<0?"Ð›ÐµÐ³ÐºÐ¾ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾":h===0?"Ð—Ð½Ð°Ñ‡Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ Ñ‚Ñ€Ð°Ñ‚Ð°":h===1?"ÐžÐ³Ñ€Ð¾Ð¼Ð½Ð°Ñ Ñ‚Ñ€Ð°Ñ‚Ð° â€” Ð½ÑƒÐ¶Ð½Ð° Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ñ":"ÐÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ Ð¿Ð¾ Ñ†ÐµÐ½Ðµ":`Ð¢Ñ€ÐµÐ±ÑƒÐµÑ‚ ÑÐ¿Ð¾Ñ…Ñƒ ${((q=_[g.epoch])==null?void 0:q.name)||g.epoch}`},te=D(null),P={defence:"Ð§ÐµÐ¼ Ð²Ñ‹ÑˆÐµ Ð’Ð°ÑˆÐ° Ð·Ð°Ñ‰Ð¸Ñ‚Ð°, Ñ‚ÐµÐ¼ Ð±Ð¾Ð»ÑŒÑˆÐµ ÑˆÐ°Ð½Ñ, Ñ‡Ñ‚Ð¾ Ð¿Ñ€Ð¾Ñ‚Ð¸Ð²Ð½Ð¸Ðº Ð½Ðµ ÑÐ¼Ð¾Ð¶ÐµÑ‚ Ð½Ð°Ð½ÐµÑÑ‚Ð¸ Ð²Ð°Ð¼ Ð¾Ñ‰ÑƒÑ‚Ð¸Ð¼Ð¾Ð³Ð¾ ÑƒÑ€Ð¾Ð½Ð° ÑÐ²Ð¾Ð¸Ð¼ ÑƒÐ´Ð°Ñ€Ð¾Ð¼. ÐÑ‚Ð°ÐºÐ° Ð¿Ñ€Ð¾Ñ‚Ð¸Ð²Ð½Ð¸ÐºÐ° Ñ‚ÐµÐ¼ ÑÑ„Ñ„ÐµÐºÑ‚Ð¸Ð²Ð½ÐµÐµ, Ñ‡ÐµÐ¼ Ð±Ð¾Ð»ÑŒÑˆÐµ Ð¾Ð½ Ð¿Ñ€ÐµÐ²Ñ‹ÑÐ¸Ð» Ð²Ð°ÑˆÑƒ Ð·Ð°Ñ‰Ð¸Ñ‚Ñƒ â€” Ð²Ð¿Ð»Ð¾Ñ‚ÑŒ Ð´Ð¾ Ð¿Ð¾Ð»Ð½Ð¾Ð¹ Ð±ÐµÑÐ¿Ð¾Ð»ÐµÐ·Ð½Ð¾ÑÑ‚Ð¸, ÐµÑÐ»Ð¸ Ð·Ð°Ñ‰Ð¸Ñ‚Ð° Ð¾ÐºÐ°Ð·Ð°Ð»Ð°ÑÑŒ Ð²Ñ‹ÑˆÐµ.",resist:"Ð”Ð°Ð¶Ðµ ÑÐ°Ð¼Ð°Ñ ÑÑ„Ñ„ÐµÐºÑ‚Ð½Ð°Ñ Ð°Ñ‚Ð°ÐºÐ° Ð¼Ð¾Ð¶ÐµÑ‚ Ð¿Ñ€ÐµÐ²Ñ€Ð°Ñ‚Ð¸Ñ‚ÑŒÑÑ Ð² Ð¿ÑˆÐ¸Ðº, ÐµÑÐ»Ð¸ Ð²Ð°ÑˆÐ° Ð±Ñ€Ð¾Ð½Ñ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ñ…Ð¾Ñ€Ð¾ÑˆÐ°. Ð¡Ð½Ð¸Ð¶ÐµÐ½Ð¸Ðµ ÑƒÑ€Ð¾Ð½Ð° Ð½Ðµ Ð¼ÐµÑˆÐ°ÐµÑ‚ Ð²Ñ€Ð°Ð³Ð°Ð¼ Ð¿Ð¾Ð¿Ð°Ð´Ð°Ñ‚ÑŒ Ð¿Ð¾ Ð’Ð°Ð¼, Ð·Ð°Ñ‚Ð¾ Ð¿Ð¾ÑÐ»Ðµ Ð¿Ð¾Ð¿Ð°Ð´Ð°Ð½Ð¸Ñ ÑÐ½Ð¸Ð¶Ð°ÐµÑ‚ ÑƒÑ€Ð¾Ð½ ÑÑ€Ð°Ð·Ñƒ Ð½Ð° Ñ†ÐµÐ»Ñ‹Ðµ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸. ÐŸÑ€Ð¸ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ð¸ ÑÐ½Ð¸Ð¶ÐµÐ½Ð¸Ñ Ð² 1, Ñ‚ÑÐ¶Ñ‘Ð»Ñ‹Ðµ Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð¿Ñ€ÐµÐ²Ñ€Ð°Ñ‰Ð°ÑŽÑ‚ÑÑ Ð² Ð»Ñ‘Ð³ÐºÐ¸Ðµ, Ð»Ñ‘Ð³ÐºÐ¸Ðµ â€” Ð² Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ñ‹Ðµ Ñ†Ð°Ñ€Ð°Ð¿Ð¸Ð½Ñ‹. ÐŸÑ€Ð¸ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ð¸ Ð² 2 Ð²Ñ‹ Ð²Ð¾Ð²ÑÐµ Ð¸Ð³Ð½Ð¾Ñ€Ð¸Ñ€ÑƒÐµÑ‚Ðµ Ð¿ÐµÑ€Ð²Ñ‹Ðµ Ð´Ð²Ðµ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ ÑƒÑ€Ð¾Ð½Ð°.",movement:"Ð‘Ñ€Ð¾Ð½Ñ Ð¼Ð¾Ð¶ÐµÑ‚ ÑÐºÐ¾Ð²Ñ‹Ð²Ð°Ñ‚ÑŒ Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ñ, Ð½Ð°ÐºÐ»Ð°Ð´Ñ‹Ð²Ð°Ñ ÑˆÑ‚Ñ€Ð°Ñ„ Ð½Ð° Ð²Ð°ÑˆÐµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð¾Ñ‡ÐºÐ¾Ð² Ñ…Ð¾Ð´Ð°. Ð”Ð°Ð¶Ðµ Ñ Ð½ÐµÐ±Ð¾Ð»ÑŒÑˆÐ¸Ð¼ ÑˆÑ‚Ñ€Ð°Ñ„Ð¾Ð¼ Ð²Ñ‹ Ð¼Ð¾Ð¶ÐµÑ‚Ðµ Ð¾Ñ‚ÑÑ‚Ð°Ð²Ð°Ñ‚ÑŒ Ð¾Ñ‚ ÑÐ²Ð¾Ð¸Ñ… Ð±Ð¾Ð»ÐµÐµ Ð±Ñ‹ÑÑ‚Ñ€Ñ‹Ñ… ÑÐ¾ÑŽÐ·Ð½Ð¸ÐºÐ¾Ð² (Ð¸Ð»Ð¸ Ð¾Ñ‚ Ð»Ð¾Ð²ÐºÐ¸Ñ… Ð²Ñ€Ð°Ð³Ð¾Ð²!), Ð»Ð¸Ð±Ð¾ Ð¶Ðµ Ð’Ð°Ð¼ Ð¿Ñ€Ð¸Ð´Ñ‘Ñ‚ÑÑ Ñ‚Ñ€Ð°Ñ‚Ð¸Ñ‚ÑŒ Ð¾ÑÐ¾Ð±Ñ‹Ðµ Ñ€ÐµÑÑƒÑ€ÑÑ‹ Ð½Ð° Ñ‚Ð¾, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð´Ð¾Ð³Ð¾Ð½ÑÑ‚ÑŒ Ð¸Ñ….",bursts:"ÐŸÐ¾Ñ€Ñ‹Ð²Ñ‹ â€” Ð¾ÑÐ¾Ð±Ñ‹Ð¹ Ñ€ÐµÑÑƒÑ€Ñ, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¼Ð¾Ð¶Ð½Ð¾ Ñ‚Ñ€Ð°Ñ‚Ð¸Ñ‚ÑŒ Ð½Ð° Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ðµ Ð¸Ð»Ð¸ Ð°Ñ‚Ð°ÐºÐ¸, Ñ€ÐµÐ°ÐºÑ†Ð¸Ð¸ Ð¸Ð»Ð¸ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸. Ð‘Ð¾Ð»ÑŒÑˆÐ¸Ð½ÑÑ‚Ð²Ð¾ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶ÐµÐ¹ Ð½Ð° ÑÑ‚Ð°Ñ€Ñ‚Ðµ Ð¸Ð¼ÐµÑŽÑ‚ 2 Ð¿Ð¾Ñ€Ñ‹Ð²Ð° Ð² Ñ…Ð¾Ð´, Ð¿Ð¾Ñ‚Ð¾Ð¼Ñƒ ÑˆÑ‚Ñ€Ð°Ñ„ ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¼Ð¾Ð¶ÐµÑ‚ Ð½Ð°ÐºÐ»Ð°Ð´Ñ‹Ð²Ð°Ñ‚ÑŒ Ñ‚ÑÐ¶Ñ‘Ð»Ð°Ñ Ð±Ñ€Ð¾Ð½Ñ â€” Ð´Ð¾Ð²Ð¾Ð»ÑŒÐ½Ð¾ Ð²ÐµÑÐ¾Ð¼Ñ‹Ð¹."},Y=V(()=>P[te.value]||""),p=g=>{te.value=te.value===g?null:g,te.value&&setTimeout(()=>{te.value=null},5e3)};return(g,h)=>(s(),l("div",wn,[e("div",Cn,[e("button",{disabled:n.value===0,onClick:$,class:"nav-btn"},[w(c(A),{icon:"mdi:chevron-left"})],8,Sn),e("div",Mn,[e("span",Tn,v(b.value.name),1),e("span",An,v(n.value+1)+" / "+v(c(u).length),1)]),e("button",{disabled:n.value===c(u).length-1,onClick:O,class:"nav-btn"},[w(c(A),{icon:"mdi:chevron-right"})],8,Pn)]),e("div",{class:"armor-content",onTouchstart:N,onTouchmove:W,onTouchend:U},[e("div",En,[e("img",{src:c(St)(b.value.id),alt:b.value.name,class:"armor-img",onError:h[0]||(h[0]=X=>X.target.style.display="none")},null,40,Rn)]),e("div",Dn,[e("div",{class:"stat-cell",onClick:h[1]||(h[1]=X=>p("defence"))},[w(c(A),{icon:"mdi:shield",class:"stat-icon"}),e("span",Vn,v(b.value.defence),1),h[6]||(h[6]=e("span",{class:"stat-label"},"Ð—Ð°Ñ‰Ð¸Ñ‚Ð°",-1))]),e("div",{class:"stat-cell",onClick:h[2]||(h[2]=X=>p("resist"))},[w(c(A),{icon:"mdi:shield-check",class:"stat-icon"}),e("span",jn,v(b.value.resist),1),h[7]||(h[7]=e("span",{class:"stat-label"},"Ð¡Ð½Ð¸Ð¶ÐµÐ½Ð¸Ðµ",-1))]),e("div",{class:"stat-cell",onClick:h[3]||(h[3]=X=>p("movement"))},[w(c(A),{icon:"mdi:run-fast",class:"stat-icon"}),e("span",{class:Z(["stat-value",b.value.movement<0?"negative":""])},v(b.value.movement),3),h[8]||(h[8]=e("span",{class:"stat-label"},"Ð¥Ð¾Ð´",-1))]),e("div",{class:"stat-cell",onClick:h[4]||(h[4]=X=>p("bursts"))},[w(c(A),{icon:"mdi:lightning-bolt",class:"stat-icon"}),e("span",{class:Z(["stat-value",b.value.bursts<0?"negative":""])},v(b.value.bursts),3),h[9]||(h[9]=e("span",{class:"stat-label"},"ÐŸÐ¾Ñ€Ñ‹Ð²Ñ‹",-1))])])],32),e("div",{class:Z(["armor-availability",R(b.value)])},[w(c(A),{icon:H(b.value),class:"avail-icon"},null,8,["icon"]),e("span",Yn,v(Q(b.value)),1)],2),te.value?(s(),l("div",{key:0,class:"stat-tooltip",onClick:h[5]||(h[5]=X=>te.value=null)},v(Y.value),1)):T("",!0)]))}},Xn=Re(qn,[["__scopeId","data-v-ac33425c"]]),Bn={class:"weapons-grid"},On=["onClick"],Ln=["src","alt"],zn={key:0,class:"selected-overlay"},Nn={key:1,class:"locked-overlay"},Wn=["onClick"],Un={class:"weapon-bottom"},Fn=["onClick"],Hn=["onClick"],Gn={key:2,class:"action-btn locked",disabled:"",title:"ÐÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾"},In=["onClick"],Jn=["title"],Zn={key:0,class:"note"},Qn={key:3,class:"stat-mini defence",title:"Ð—Ð°Ñ‰Ð¸Ñ‚Ð°"},Kn={key:0,class:"note"},eo={class:"modal-header-compact"},to={class:"modal-weapon-image-compact"},so=["src","alt"],lo={class:"modal-header-info"},no={class:"modal-title"},oo={class:"attack-row-compact"},ao={class:"modal-body compact"},io={class:"stats-row-compact"},co={key:0,class:"shield-section compact"},ro={class:"shield-table compact"},uo={key:0,class:"shield-row"},vo={class:"shield-cell value"},ho={class:"shield-cell value"},po={key:1,class:"shield-row"},mo={class:"shield-cell value"},fo={class:"shield-cell value"},go={key:1,class:"damage-section compact"},yo={class:"damage-scale"},xo=["onClick"],ko={class:"damage-letter"},bo={key:0,class:"damage-threshold"},_o={key:2,class:"spec-box compact"},$o={key:3,class:"description-box compact"},wo={class:"bottom-info-row"},Co={key:4,class:"hint-area"},So={class:"hint-title"},Mo={class:"hint-text"},To={key:5,class:"hint-area placeholder"},Ao={class:"modal-footer compact"},Po=["disabled"],Eo={__name:"WeaponSelector",props:{modelValue:{type:Array,default:()=>[]},wealth:{type:Number,default:5},epoch:{type:Number,default:10},categoryFilter:{type:String,default:null},showUnavailable:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(k,{emit:ee}){const C=ps.levels,x=D(null),_={attack_short:{title:"ÐÑ‚Ð°ÐºÐ° Ð²Ð¿Ð»Ð¾Ñ‚Ð½ÑƒÑŽ",text:"ÐœÐ¾Ð´Ð¸Ñ„Ð¸ÐºÐ°Ñ‚Ð¾Ñ€ Ð±Ñ€Ð¾ÑÐºÐ° Ð°Ñ‚Ð°ÐºÐ¸ Ð¿Ñ€Ð¸ ÑƒÐ´Ð°Ñ€Ðµ Ð¿Ð¾ ÑÐ¾ÑÐµÐ´Ð½ÐµÐ¼Ñƒ Ð¿Ñ€Ð¾Ñ‚Ð¸Ð²Ð½Ð¸ÐºÑƒ (Ð½Ð° Ñ‚Ð¾Ð¹ Ð¶Ðµ Ð¸Ð»Ð¸ ÑÐ¾ÑÐµÐ´Ð½ÐµÐ¹ ÐºÐ»ÐµÑ‚ÐºÐµ). ÐŸÐ¾Ð»Ð¾Ð¶Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ â€” Ð±Ð¾Ð½ÑƒÑ, Ð¾Ñ‚Ñ€Ð¸Ñ†Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ â€” ÑˆÑ‚Ñ€Ð°Ñ„."},attack_long:{title:"ÐÑ‚Ð°ÐºÐ° Ñ‡ÐµÑ€ÐµÐ· ÐºÐ»ÐµÑ‚ÐºÑƒ",text:"ÐœÐ¾Ð´Ð¸Ñ„Ð¸ÐºÐ°Ñ‚Ð¾Ñ€ Ð±Ñ€Ð¾ÑÐºÐ° Ð°Ñ‚Ð°ÐºÐ¸ Ð¿Ñ€Ð¸ ÑƒÐ´Ð°Ñ€Ðµ Ð¿Ð¾ Ð¿Ñ€Ð¾Ñ‚Ð¸Ð²Ð½Ð¸ÐºÑƒ Ñ‡ÐµÑ€ÐµÐ· Ð¾Ð´Ð½Ñƒ ÐºÐ»ÐµÑ‚ÐºÑƒ (Ð´Ð»Ð¸Ð½Ð½Ð¾Ðµ Ð¾Ñ€ÑƒÐ¶Ð¸Ðµ). ÐŸÐ¾Ð»Ð¾Ð¶Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ â€” Ð±Ð¾Ð½ÑƒÑ, Ð¾Ñ‚Ñ€Ð¸Ñ†Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ â€” ÑˆÑ‚Ñ€Ð°Ñ„."},attack_ranged:{title:"Ð”Ð°Ð»ÑŒÐ½ÑÑ Ð°Ñ‚Ð°ÐºÐ°",text:"ÐœÐ¾Ð´Ð¸Ñ„Ð¸ÐºÐ°Ñ‚Ð¾Ñ€ Ð±Ñ€Ð¾ÑÐºÐ° Ð°Ñ‚Ð°ÐºÐ¸ Ð´Ð»Ñ ÑÑ‚Ñ€ÐµÐ»ÑŒÐ±Ñ‹. ÐŸÑ€Ð¸Ð¼ÐµÐ½ÑÐµÑ‚ÑÑ Ð¿Ñ€Ð¸ Ð°Ñ‚Ð°ÐºÐµ Ð½Ð° Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ð¸ Ð±Ð¾Ð»ÐµÐµ Ð´Ð²ÑƒÑ… ÐºÐ»ÐµÑ‚Ð¾Ðº."},defence:{title:"Ð—Ð°Ñ‰Ð¸Ñ‚Ð° Ð¾Ñ€ÑƒÐ¶Ð¸ÐµÐ¼",text:"Ð‘Ð¾Ð½ÑƒÑ Ðº Ð·Ð°Ñ‰Ð¸Ñ‚Ðµ Ð¿Ñ€Ð¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ð¸ ÑÑ‚Ð¾Ð³Ð¾ Ð¾Ñ€ÑƒÐ¶Ð¸Ñ Ð´Ð»Ñ Ð¿Ð°Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¸Ð»Ð¸ Ð¾Ñ‚ÐºÐ»Ð¾Ð½ÐµÐ½Ð¸Ñ ÑƒÐ´Ð°Ñ€Ð¾Ð² Ð¿Ñ€Ð¾Ñ‚Ð¸Ð²Ð½Ð¸ÐºÐ°."},armorPen:{title:"ÐŸÑ€Ð¾Ð±Ð¸Ð²Ð°Ð½Ð¸Ðµ Ð±Ñ€Ð¾Ð½Ð¸",text:"ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¾Ñ‡ÐºÐ¾Ð² Ð±Ñ€Ð¾Ð½Ð¸, ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ðµ ÑÑ‚Ð¾ Ð¾Ñ€ÑƒÐ¶Ð¸Ðµ Ð¸Ð³Ð½Ð¾Ñ€Ð¸Ñ€ÑƒÐµÑ‚ Ð¿Ñ€Ð¸ Ð½Ð°Ð½ÐµÑÐµÐ½Ð¸Ð¸ ÑƒÑ€Ð¾Ð½Ð°. Ð­Ñ„Ñ„ÐµÐºÑ‚Ð¸Ð²Ð½Ð¾ Ð¿Ñ€Ð¾Ñ‚Ð¸Ð² Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ñ… Ð¿Ñ€Ð¾Ñ‚Ð¸Ð²Ð½Ð¸ÐºÐ¾Ð²."},damageType:{title:"Ð¢Ð¸Ð¿ ÑƒÑ€Ð¾Ð½Ð°",text:"Ð’Ð¸Ð´ Ð¿Ð¾Ð²Ñ€ÐµÐ¶Ð´ÐµÐ½Ð¸Ð¹, Ð½Ð°Ð½Ð¾ÑÐ¸Ð¼Ñ‹Ñ… Ð¾Ñ€ÑƒÐ¶Ð¸ÐµÐ¼. Ð Ð°Ð·Ð½Ñ‹Ðµ Ñ‚Ð¸Ð¿Ñ‹ ÑƒÑ€Ð¾Ð½Ð° Ð¼Ð¾Ð³ÑƒÑ‚ Ð±Ñ‹Ñ‚ÑŒ Ð±Ð¾Ð»ÐµÐµ Ð¸Ð»Ð¸ Ð¼ÐµÐ½ÐµÐµ ÑÑ„Ñ„ÐµÐºÑ‚Ð¸Ð²Ð½Ñ‹ Ð¿Ñ€Ð¾Ñ‚Ð¸Ð² Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»Ñ‘Ð½Ð½Ð¾Ð¹ Ð±Ñ€Ð¾Ð½Ð¸ Ð¸Ð»Ð¸ ÑÑƒÑ‰ÐµÑÑ‚Ð²."},price:{title:"Ð¡Ñ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ",text:"Ð¦ÐµÐ½Ð¾Ð²Ð°Ñ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ Ð¾Ñ€ÑƒÐ¶Ð¸Ñ. ÐžÐ¿Ñ€ÐµÐ´ÐµÐ»ÑÐµÑ‚ Ð¼Ð¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ Ð´Ð¾ÑÑ‚Ð°Ñ‚ÐºÐ° Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð° Ð´Ð»Ñ Ð¿Ñ€Ð¸Ð¾Ð±Ñ€ÐµÑ‚ÐµÐ½Ð¸Ñ."},epoch:{title:"Ð­Ð¿Ð¾Ñ…Ð°",text:"Ð¢ÐµÑ…Ð½Ð¾Ð»Ð¾Ð³Ð¸Ñ‡ÐµÑÐºÐ°Ñ ÑÐ¿Ð¾Ñ…Ð°, Ð½Ð°Ñ‡Ð¸Ð½Ð°Ñ Ñ ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð¹ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ ÑÑ‚Ð¾ Ð¾Ñ€ÑƒÐ¶Ð¸Ðµ. Ð‘Ð¾Ð»ÐµÐµ Ð¿Ð¾Ð·Ð´Ð½Ð¸Ðµ ÑÐ¿Ð¾Ñ…Ð¸ Ð¿Ñ€ÐµÐ´Ð»Ð°Ð³Ð°ÑŽÑ‚ Ð»ÑƒÑ‡ÑˆÐµÐµ ÑÐ½Ð°Ñ€ÑÐ¶ÐµÐ½Ð¸Ðµ."},length:{title:"Ð”Ð»Ð¸Ð½Ð° Ð¾Ñ€ÑƒÐ¶Ð¸Ñ",text:"Ð”Ð»Ð¸Ð½Ð½Ð¾Ðµ Ð¾Ñ€ÑƒÐ¶Ð¸Ðµ Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚ Ð°Ñ‚Ð°ÐºÐ¾Ð²Ð°Ñ‚ÑŒ Ñ‡ÐµÑ€ÐµÐ· ÐºÐ»ÐµÑ‚ÐºÑƒ, Ð½Ð¾ Ð¼Ð¾Ð¶ÐµÑ‚ Ð±Ñ‹Ñ‚ÑŒ Ð¼ÐµÐ½ÐµÐµ ÑÑ„Ñ„ÐµÐºÑ‚Ð¸Ð²Ð½Ð¾ Ð²Ð¿Ð»Ð¾Ñ‚Ð½ÑƒÑŽ. ÐšÐ¾Ñ€Ð¾Ñ‚ÐºÐ¾Ðµ Ð¾Ñ€ÑƒÐ¶Ð¸Ðµ ÑƒÐ´Ð¾Ð±Ð½ÐµÐµ Ð² Ñ‚ÐµÑÐ½Ð¾Ð¼ Ð±Ð¾ÑŽ."},hands:{title:"Ð¥Ð²Ð°Ñ‚",text:"Ð¡ÐºÐ¾Ð»ÑŒÐºÐ¾ Ñ€ÑƒÐº Ñ‚Ñ€ÐµÐ±ÑƒÐµÑ‚ÑÑ Ð´Ð»Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ. ÐžÐ´Ð½Ð¾Ñ€ÑƒÑ‡Ð½Ð¾Ðµ Ð¾Ñ€ÑƒÐ¶Ð¸Ðµ Ð¾ÑÑ‚Ð°Ð²Ð»ÑÐµÑ‚ Ñ€ÑƒÐºÑƒ ÑÐ²Ð¾Ð±Ð¾Ð´Ð½Ð¾Ð¹ Ð´Ð»Ñ Ñ‰Ð¸Ñ‚Ð° Ð¸Ð»Ð¸ Ð²Ñ‚Ð¾Ñ€Ð¾Ð³Ð¾ Ð¾Ñ€ÑƒÐ¶Ð¸Ñ. Ð”Ð²ÑƒÑ€ÑƒÑ‡Ð½Ð¾Ðµ Ð¾Ð±Ñ‹Ñ‡Ð½Ð¾ Ð¼Ð¾Ñ‰Ð½ÐµÐµ."}},u=f=>{_[f]&&(x.value={type:"property",key:f,..._[f]})},n=(f,m)=>{const a=f.names.damage.ru;m===null?x.value={type:"damage",key:f.key,title:`${f.short} â€” ${a} ÑƒÑ€Ð¾Ð½`,text:"Ð­Ñ‚Ð¾ Ð¾Ñ€ÑƒÐ¶Ð¸Ðµ Ð½Ðµ ÑÐ¿Ð¾ÑÐ¾Ð±Ð½Ð¾ Ð½Ð°Ð½ÐµÑÑ‚Ð¸ ÑƒÑ€Ð¾Ð½ Ð´Ð°Ð½Ð½Ð¾Ð¹ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸."}:x.value={type:"damage",key:f.key,title:`${f.short} â€” ${a} ÑƒÑ€Ð¾Ð½`,text:`${y[f.key]}

Ð¢Ñ€ÐµÐ±ÑƒÐµÑ‚ÑÑ Ð¾Ñ‡ÐºÐ¾Ð² Ð¿Ñ€ÐµÐ²Ñ‹ÑˆÐµÐ½Ð¸Ñ Ð·Ð°Ñ‰Ð¸Ñ‚Ñ‹: ${m}+`}},b=k,$=ee,O=Pt.items.filter(f=>f.category==="weapon"||f.category==="shield"),d=D(null),N=V(()=>{let f=O;return b.categoryFilter&&(f=f.filter(m=>m.subcat===b.categoryFilter)),b.showUnavailable||(f=f.filter(m=>H(m))),f}),W=f=>{d.value=f,x.value=null},U=()=>{d.value=null,x.value=null},R=f=>b.modelValue.includes(f),H=f=>{const m=f.price-b.wealth,a=f.epoch<=b.epoch;return m<=1&&a},Q=f=>{const m=f.price-b.wealth;return m<0?"price-green":m===0?"price-yellow":m===1?"price-orange":"price-red"},te=f=>f.epoch<=b.epoch?"epoch-ok":"epoch-blocked",P=f=>{const m=R(f.id),a=H(f);return m?"card-selected":a?"card-available":"card-locked"},Y=f=>{var m,a;return typeof f.defence=="object"?((a=(m=f.defence)==null?void 0:m.front)==null?void 0:a.melee)||0:f.defence||0},p=f=>f.category==="shield"||typeof f.defence=="object",g=f=>{if(typeof f.attack!="object")return f.attack;const m=f.attack.short,a=f.attack.long,F=f.attack.ranged,se=m!==void 0?(m>=0,m):"-",ue=a!==void 0?(a>=0,a):"-";if(F!==void 0){const ce=(F>=0,F);return`${se}/${ue}/${ce}`}return m===a&&m!==void 0?`${m}`:`${se}/${ue}`},h=f=>{if(typeof f.attack!="object")return`ÐÑ‚Ð°ÐºÐ°: ${f.attack}`;const m=[];return f.attack.short!==void 0&&m.push(`Ð’Ð¿Ð»Ð¾Ñ‚Ð½ÑƒÑŽ: ${f.attack.short>=0?"+":""}${f.attack.short}`),f.attack.long!==void 0&&m.push(`Ð§ÐµÑ€ÐµÐ· ÐºÐ»ÐµÑ‚ÐºÑƒ: ${f.attack.long>=0?"+":""}${f.attack.long}`),f.attack.ranged!==void 0&&m.push(`Ð”Ð°Ð»ÑŒÐ½Ð¸Ð¹ Ð±Ð¾Ð¹: ${f.attack.ranged>=0?"+":""}${f.attack.ranged}`),m.join(" | ")},X=f=>f>0?`+${f}`:f.toString(),q=(f,m)=>!f.damage||f.damage[m]===void 0?null:f.damage[m],E=(f,m)=>m?{backgroundColor:f.color,color:f.lightText?"#fff":"#000"}:{backgroundColor:"#333",color:"#666"},y={t:"ÐŸÑƒÑÑ‚ÑÐºÐ¾Ð²Ñ‹Ð¹ ÑƒÑ€Ð¾Ð½ â€” Ð½Ð°Ð½Ð¾ÑÐ¸Ñ‚ Ñ†Ð°Ñ€Ð°Ð¿Ð¸Ð½Ñƒ. ÐÐµÐ¿Ñ€Ð¸ÑÑ‚Ð½Ð¾, Ð½Ð¾ Ð½Ðµ Ð¾Ð¿Ð°ÑÐ½Ð¾.",l:"Ð›Ñ‘Ð³ÐºÐ¸Ð¹ ÑƒÑ€Ð¾Ð½ â€” Ð½Ð°Ð½Ð¾ÑÐ¸Ñ‚ Ð»Ñ‘Ð³ÐºÐ¾Ðµ Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ. ÐŸÐµÑ€ÑÐ¾Ð½Ð°Ð¶ ÑÐ¿Ð¾ÑÐ¾Ð±ÐµÐ½ Ð¿ÐµÑ€ÐµÐ¶Ð¸Ñ‚ÑŒ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ñ‚Ð°ÐºÐ¸Ñ… Ñ€Ð°Ð½ Ð±ÐµÐ· ÑÐµÑ€ÑŒÑ‘Ð·Ð½Ñ‹Ñ… Ð¿Ð¾ÑÐ»ÐµÐ´ÑÑ‚Ð²Ð¸Ð¹.",m:"Ð¡ÐµÑ€ÑŒÑ‘Ð·Ð½Ñ‹Ð¹ ÑƒÑ€Ð¾Ð½ â€” Ð½Ð°Ð½Ð¾ÑÐ¸Ñ‚ Ñ‚ÑÐ¶Ñ‘Ð»Ð¾Ðµ Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ. ÐŸÐµÑ€ÑÐ¾Ð½Ð°Ð¶ Ð²Ñ‹Ð²ÐµÐ´ÐµÐ½ Ð¸Ð· ÑÑ‚Ñ€Ð¾Ñ Ð¸ Ð½ÑƒÐ¶Ð´Ð°ÐµÑ‚ÑÑ Ð² ÑÑ€Ð¾Ñ‡Ð½Ð¾Ð¹ Ð¿Ð¾Ð¼Ð¾Ñ‰Ð¸.",h:"Ð¢ÑÐ¶Ñ‘Ð»Ñ‹Ð¹ ÑƒÑ€Ð¾Ð½ â€” ÑÐ¼ÐµÑ€Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ. Ð‘ÐµÐ· ÑÐ½Ð¸Ð¶ÐµÐ½Ð¸Ñ ÑƒÑ€Ð¾Ð½Ð° Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶ Ð¿Ð¾Ð³Ð¸Ð±Ð°ÐµÑ‚.",g:"Ð–ÐµÑÑ‚Ð¾ÐºÐ¸Ð¹ ÑƒÑ€Ð¾Ð½ â€” Ð¼Ð³Ð½Ð¾Ð²ÐµÐ½Ð½Ð°Ñ ÑÐ¼ÐµÑ€Ñ‚ÑŒ Ð±ÐµÐ· Ð·Ð°Ñ‰Ð¸Ñ‚Ñ‹. Ð¢Ñ€ÐµÐ±ÑƒÐµÑ‚ÑÑ Ð¼Ð¸Ð½Ð¸Ð¼ÑƒÐ¼ 1 ÐµÐ´Ð¸Ð½Ð¸Ñ†Ð° ÑÐ½Ð¸Ð¶ÐµÐ½Ð¸Ñ ÑƒÑ€Ð¾Ð½Ð°, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð²Ñ‹Ð¶Ð¸Ñ‚ÑŒ.",n:"ÐšÐ¾ÑˆÐ¼Ð°Ñ€Ð½Ñ‹Ð¹ ÑƒÑ€Ð¾Ð½ â€” Ð¼Ð³Ð½Ð¾Ð²ÐµÐ½Ð½Ð°Ñ ÑÐ¼ÐµÑ€Ñ‚ÑŒ. Ð¢Ñ€ÐµÐ±ÑƒÐµÑ‚ÑÑ Ð¼Ð¸Ð½Ð¸Ð¼ÑƒÐ¼ 2 ÐµÐ´Ð¸Ð½Ð¸Ñ†Ñ‹ ÑÐ½Ð¸Ð¶ÐµÐ½Ð¸Ñ ÑƒÑ€Ð¾Ð½Ð°, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð²Ñ‹Ð¶Ð¸Ñ‚ÑŒ.",i:"ÐÐµÐ²Ñ‹Ð½Ð¾ÑÐ¸Ð¼Ñ‹Ð¹ ÑƒÑ€Ð¾Ð½ â€” Ð¼Ð³Ð½Ð¾Ð²ÐµÐ½Ð½Ð°Ñ ÑÐ¼ÐµÑ€Ñ‚ÑŒ. Ð¢Ñ€ÐµÐ±ÑƒÐµÑ‚ÑÑ Ð¼Ð¸Ð½Ð¸Ð¼ÑƒÐ¼ 3 ÐµÐ´Ð¸Ð½Ð¸Ñ†Ñ‹ ÑÐ½Ð¸Ð¶ÐµÐ½Ð¸Ñ ÑƒÑ€Ð¾Ð½Ð°, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð²Ñ‹Ð¶Ð¸Ñ‚ÑŒ."},S=f=>f===2?"2 Ñ€ÑƒÐºÐ¸":f===1?"1 Ñ€ÑƒÐºÐ°":f===1.5?"1.5 Ñ€ÑƒÐºÐ¸":f===.5?"0.5 Ñ€ÑƒÐºÐ¸":`${f}`,L=f=>{if(R(f.id)){const m=b.modelValue.filter(a=>a!==f.id);$("update:modelValue",m)}else H(f)&&$("update:modelValue",[...b.modelValue,f.id])},J=()=>{d.value&&H(d.value)&&($("update:modelValue",[...b.modelValue,d.value.id]),U())},ie=()=>{if(d.value){const f=b.modelValue.filter(m=>m!==d.value.id);$("update:modelValue",f),U()}};return(f,m)=>(s(),l("div",null,[e("div",Bn,[(s(!0),l(K,null,oe(N.value,a=>(s(),l("div",{key:a.id,class:Z(["weapon-card",P(a)])},[e("div",{class:"weapon-image-area",onClick:F=>W(a)},[e("div",{class:Z(["corner-badge top-left",Q(a)])},[w(c(A),{icon:"mdi:gold",class:"badge-icon"}),e("span",null,v(a.price),1)],2),e("div",{class:Z(["corner-badge top-right",te(a)])},[w(c(A),{icon:"mdi:clock-outline",class:"badge-icon"}),e("span",null,v(a.epoch),1)],2),e("img",{src:c(St)(a.id),alt:a.name,class:"weapon-image",onError:m[0]||(m[0]=F=>F.target.style.display="none")},null,40,Ln),R(a.id)?(s(),l("div",zn,[w(c(A),{icon:"mdi:check-bold",class:"check-icon"})])):T("",!0),H(a)?T("",!0):(s(),l("div",Nn,[w(c(A),{icon:"mdi:lock",class:"lock-icon"})]))],8,On),e("div",{class:"weapon-name",onClick:F=>W(a)},v(a.name),9,Wn),e("div",Un,[R(a.id)?(s(),l("button",{key:0,onClick:Pe(F=>L(a),["stop"]),class:"action-btn remove",title:"Ð£Ð±Ñ€Ð°Ñ‚ÑŒ"},[w(c(A),{icon:"mdi:minus"})],8,Fn)):H(a)?(s(),l("button",{key:1,onClick:Pe(F=>L(a),["stop"]),class:"action-btn take",title:"Ð’Ð·ÑÑ‚ÑŒ"},[w(c(A),{icon:"mdi:plus"})],8,Hn)):(s(),l("button",Gn,[w(c(A),{icon:"mdi:lock"})])),e("button",{onClick:Pe(F=>W(a),["stop"]),class:"action-btn info",title:"ÐŸÐ¾Ð´Ñ€Ð¾Ð±Ð½ÐµÐµ"},[w(c(A),{icon:"mdi:information-outline"})],8,In),e("div",{class:"stat-mini attack",title:h(a)},[w(c(A),{icon:"mdi:sword-cross",class:"stat-mini-icon"}),e("span",null,[Ee(v(g(a)),1),a.armorPen>0?(s(),l("span",Zn,"*")):T("",!0)])],8,Jn),Y(a)>0?(s(),l("div",Qn,[w(c(A),{icon:"mdi:shield",class:"stat-mini-icon"}),e("span",null,[Ee(v(Y(a)),1),p(a)?(s(),l("span",Kn,"*")):T("",!0)])])):T("",!0)])],2))),128))]),d.value?(s(),l("div",{key:0,class:"modal-overlay",onClick:U},[e("div",{class:"modal-content compact",onClick:m[12]||(m[12]=Pe(()=>{},["stop"]))},[e("div",eo,[e("div",to,[e("img",{src:c(St)(d.value.id),alt:d.value.name,onError:m[1]||(m[1]=a=>a.target.style.display="none")},null,40,so)]),e("div",lo,[e("h2",no,v(d.value.name),1),e("div",oo,[typeof d.value.attack=="object"?(s(),l(K,{key:0},[e("div",{class:Z(["attack-chip clickable",{negative:d.value.attack.short<0,disabled:d.value.attack.short===void 0}]),onClick:m[2]||(m[2]=a=>u("attack_short"))},[w(c(A),{icon:"mdi:knife"}),e("span",null,v(d.value.attack.short!==void 0?X(d.value.attack.short):"â€”"),1)],2),e("div",{class:Z(["attack-chip clickable",{negative:d.value.attack.long<0,disabled:d.value.attack.long===void 0}]),onClick:m[3]||(m[3]=a=>u("attack_long"))},[w(c(A),{icon:"mdi:spear"}),e("span",null,v(d.value.attack.long!==void 0?X(d.value.attack.long):"â€”"),1)],2),d.value.attack.ranged!==void 0?(s(),l("div",{key:0,class:Z(["attack-chip ranged clickable",{negative:d.value.attack.ranged<0}]),onClick:m[4]||(m[4]=a=>u("attack_ranged"))},[w(c(A),{icon:"mdi:bow-arrow"}),e("span",null,v(X(d.value.attack.ranged)),1)],2)):T("",!0)],64)):T("",!0)])]),e("button",{onClick:U,class:"close-button"},[w(c(A),{icon:"mdi:close"})])]),e("div",ao,[e("div",io,[typeof d.value.defence!="object"&&d.value.defence>0?(s(),l("div",{key:0,class:"stat-chip clickable",onClick:m[5]||(m[5]=a=>u("defence"))},[w(c(A),{icon:"mdi:shield"}),e("span",null,v(d.value.defence),1),m[13]||(m[13]=e("span",{class:"stat-label"},"Ð·Ð°Ñ‰Ð¸Ñ‚Ð°",-1))])):T("",!0),d.value.armorPen>0?(s(),l("div",{key:1,class:"stat-chip clickable",onClick:m[6]||(m[6]=a=>u("armorPen"))},[w(c(A),{icon:"mdi:shield-off"}),e("span",null,v(d.value.armorPen),1),m[14]||(m[14]=e("span",{class:"stat-label"},"Ð¿Ñ€Ð¾Ð±Ð¸Ð².",-1))])):T("",!0),d.value.damageType?(s(),l("div",{key:2,class:"stat-chip type clickable",onClick:m[7]||(m[7]=a=>u("damageType"))},[w(c(A),{icon:"mdi:fire"}),e("span",null,v(d.value.damageType),1)])):T("",!0)]),typeof d.value.defence=="object"?(s(),l("div",co,[e("div",ro,[m[17]||(m[17]=e("div",{class:"shield-row header"},[e("div",{class:"shield-cell"}),e("div",{class:"shield-cell"},"Ð‘Ð»Ð¸Ð¶."),e("div",{class:"shield-cell"},"Ð”Ð°Ð»ÑŒÐ½.")],-1)),d.value.defence.front?(s(),l("div",uo,[m[15]||(m[15]=e("div",{class:"shield-cell label"},"Ð¡Ð¿ÐµÑ€ÐµÐ´Ð¸",-1)),e("div",vo,v(d.value.defence.front.melee||0),1),e("div",ho,v(d.value.defence.front.ranged||0),1)])):T("",!0),d.value.defence.side?(s(),l("div",po,[m[16]||(m[16]=e("div",{class:"shield-cell label"},"Ð¡ Ñ„Ð»Ð°Ð½Ð³Ð°",-1)),e("div",mo,v(d.value.defence.side.melee||0),1),e("div",fo,v(d.value.defence.side.ranged||0),1)])):T("",!0)])])):T("",!0),d.value.damage?(s(),l("div",go,[e("div",yo,[(s(!0),l(K,null,oe(c(C),a=>{var F,se;return s(),l("div",{key:a.key,class:Z(["damage-level",{active:q(d.value,a.key)!==null,inactive:q(d.value,a.key)===null,selected:((F=x.value)==null?void 0:F.type)==="damage"&&((se=x.value)==null?void 0:se.key)===a.key}]),style:ve(E(a,q(d.value,a.key)!==null)),onClick:Pe(ue=>n(a,q(d.value,a.key)),["stop"])},[e("div",ko,v(a.short),1),q(d.value,a.key)!==null?(s(),l("div",bo," +"+v(q(d.value,a.key)),1)):T("",!0)],14,xo)}),128))])])):T("",!0),d.value.spec?(s(),l("div",_o,[w(c(A),{icon:"mdi:star-four-points"}),e("span",null,v(d.value.spec),1)])):T("",!0),d.value.desc?(s(),l("div",$o,v(d.value.desc),1)):T("",!0),e("div",wo,[e("div",{class:Z(["info-chip small clickable",Q(d.value)]),onClick:m[8]||(m[8]=a=>u("price"))},[w(c(A),{icon:"mdi:gold"}),e("span",null,v(d.value.price),1)],2),e("div",{class:Z(["info-chip small clickable",te(d.value)]),onClick:m[9]||(m[9]=a=>u("epoch"))},[w(c(A),{icon:"mdi:clock-outline"}),e("span",null,v(d.value.epoch),1)],2),e("div",{class:"info-chip small clickable",onClick:m[10]||(m[10]=a=>u("length"))},[w(c(A),{icon:d.value.length===2?"mdi:arrow-expand-horizontal":"mdi:minus"},null,8,["icon"]),e("span",null,v(d.value.length===2?"Ð”Ð»Ð¸Ð½Ð½.":"ÐšÐ¾Ñ€Ð¾Ñ‚Ðº."),1)]),d.value.hands?(s(),l("div",{key:0,class:"info-chip small clickable",onClick:m[11]||(m[11]=a=>u("hands"))},[w(c(A),{icon:"mdi:hand-back-left"}),e("span",null,v(S(d.value.hands)),1)])):T("",!0)]),x.value?(s(),l("div",Co,[e("div",So,v(x.value.title),1),e("div",Mo,v(x.value.text),1)])):(s(),l("div",To,[w(c(A),{icon:"mdi:gesture-tap"}),m[18]||(m[18]=e("span",null,"ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ Ð½Ð° Ð»ÑŽÐ±Ð¾Ð¹ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚ Ð´Ð»Ñ Ð¿Ð¾Ð´Ñ€Ð¾Ð±Ð½Ð¾ÑÑ‚ÐµÐ¹",-1))]))]),e("div",Ao,[R(d.value.id)?(s(),l("button",{key:1,onClick:ie,class:"modal-btn remove"},[w(c(A),{icon:"mdi:close-circle"}),m[20]||(m[20]=Ee(" Ð£Ð±Ñ€Ð°Ñ‚ÑŒ ",-1))])):(s(),l("button",{key:0,onClick:J,class:"modal-btn take",disabled:!H(d.value)},[w(c(A),{icon:"mdi:plus-circle"}),m[19]||(m[19]=Ee(" Ð’Ð·ÑÑ‚ÑŒ ",-1))],8,Po)),e("button",{onClick:U,class:"modal-btn close"}," Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ ")])])])):T("",!0)]))}},Ro=Re(Eo,[["__scopeId","data-v-8e0a9c36"]]),Do={class:"wealth-row"},Vo={class:"wealth-bar"},jo={class:"wealth-track"},Yo={class:"wealth-labels"},qo={class:"wealth-current"},Xo={class:"status-message"},Bo={class:"status-text error"},Oo={class:"status-text warning"},Lo={__name:"EquipmentStatusBar",props:{wealth:{type:Number,default:5},wealthLimit:{type:Number,default:5},selectedArmor:{type:String,default:""},selectedWeapons:{type:Array,default:()=>[]},epoch:{type:Number,default:10},validationErrors:{type:Array,default:()=>[]},recommendations:{type:Array,default:()=>[]},isValid:{type:Boolean,default:!0}},setup(k){const ee=k,C=V(()=>ee.wealthLimit/10*100),x=V(()=>(10-ee.wealthLimit)/10*100),_=V(()=>ee.validationErrors.length>0?"status-error":ee.recommendations.length>0?"status-warning":"status-success");return(u,n)=>(s(),l("div",{class:Z(["status-bar",_.value])},[e("div",Do,[w(c(A),{icon:"mdi:gold",class:"wealth-icon"}),e("div",Vo,[e("div",jo,[e("div",{class:"wealth-fill available",style:ve({width:C.value+"%"})},null,4),e("div",{class:"wealth-fill blocked",style:ve({left:C.value+"%",width:x.value+"%"})},null,4)]),e("div",Yo,[e("span",qo,v(k.wealthLimit),1),n[0]||(n[0]=e("span",{class:"wealth-max"},"/ 10",-1))])])]),e("div",Xo,[k.validationErrors.length>0?(s(),l(K,{key:0},[w(c(A),{icon:"mdi:close-circle",class:"status-icon error"}),e("span",Bo,v(k.validationErrors[0]),1)],64)):k.recommendations.length>0?(s(),l(K,{key:1},[w(c(A),{icon:"mdi:alert-circle",class:"status-icon warning"}),e("span",Oo,v(k.recommendations[0]),1)],64)):(s(),l(K,{key:2},[w(c(A),{icon:"mdi:check-circle",class:"status-icon success"}),n[1]||(n[1]=e("span",{class:"status-text success"},"Ð¡Ð½Ð°Ñ€ÑÐ¶ÐµÐ½Ð¸Ðµ Ð³Ð¾Ñ‚Ð¾Ð²Ð¾",-1))],64))])],2))}},zo=Re(Lo,[["__scopeId","data-v-eee099bd"]]),No={spears:{name:"ÐšÐ¾Ð¿ÑŒÑ",nameEn:"Spears",icon:"game-icons:broadhead-arrow"},swords:{name:"ÐœÐµÑ‡Ð¸",nameEn:"Swords",icon:"game-icons:croc-sword"},daggers:{name:"ÐšÐ¸Ð½Ð¶Ð°Ð»Ñ‹",nameEn:"Daggers",icon:"game-icons:plain-dagger"},bows:{name:"Ð›ÑƒÐºÐ¸",nameEn:"Bows",icon:"game-icons:bow-arrow"},crossbows:{name:"ÐÑ€Ð±Ð°Ð»ÐµÑ‚Ñ‹",nameEn:"Crossbows",icon:"game-icons:crossbow"},slings:{name:"ÐŸÑ€Ð°Ñ‰Ð¸",nameEn:"Slings",icon:"game-icons:sling"},axes:{name:"Ð¢Ð¾Ð¿Ð¾Ñ€Ñ‹",nameEn:"Axes",icon:"game-icons:battered-axe"},maces:{name:"Ð‘ÑƒÐ»Ð°Ð²Ñ‹",nameEn:"Maces",icon:"game-icons:flanged-mace"},flails:{name:"Ð¦ÐµÐ¿Ñ‹",nameEn:"Flails",icon:"game-icons:flail"},shields:{name:"Ð©Ð¸Ñ‚Ñ‹",nameEn:"Shields",icon:"game-icons:round-shield"}},Wo={light:{name:"Ð›Ñ‘Ð³ÐºÐ°Ñ",nameEn:"Light"},middle:{name:"Ð¡Ñ€ÐµÐ´Ð½ÑÑ",nameEn:"Medium"},heavy:{name:"Ð¢ÑÐ¶Ñ‘Ð»Ð°Ñ",nameEn:"Heavy"}},Uo={piercing:{name:"ÐšÐ¾Ð»ÑŽÑ‰Ð¸Ð¹",nameEn:"Piercing"},slashing:{name:"Ð ÐµÐ¶ÑƒÑ‰Ð¸Ð¹",nameEn:"Slashing"},bludgeoning:{name:"Ð”Ñ€Ð¾Ð±ÑÑ‰Ð¸Ð¹",nameEn:"Bludgeoning"}},Fo={weaponTypes:No,armorTypes:Wo,damageTypes:Uo},Ho={1:{name:"ÐšÑ€Ð°Ð¹Ð½ÑÑ Ð±ÐµÐ´Ð½Ð¾ÑÑ‚ÑŒ"},2:{name:"Ð‘ÐµÐ´Ð½Ð¾ÑÑ‚ÑŒ"},3:{name:"Ð£Ð¼ÐµÑ€ÐµÐ½Ð½Ð°Ñ Ð±ÐµÐ´Ð½Ð¾ÑÑ‚ÑŒ"},4:{name:"ÐÐ¸Ð¶Ðµ ÑÑ€ÐµÐ´Ð½ÐµÐ³Ð¾"},5:{name:"Ð¡Ñ€ÐµÐ´Ð½ÐµÐµ Ð±Ð»Ð°Ð³Ð¾Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ðµ"},6:{name:"Ð’Ñ‹ÑˆÐµ ÑÑ€ÐµÐ´Ð½ÐµÐ³Ð¾"},7:{name:"ÐÐµÐ±Ð¾Ð»ÑŒÑˆÐ¾Ðµ Ð±Ð¾Ð³Ð°Ñ‚ÑÑ‚Ð²Ð¾"},8:{name:"Ð‘Ð¾Ð³Ð°Ñ‚ÑÑ‚Ð²Ð¾"},9:{name:"ÐžÐ³Ñ€Ð¾Ð¼Ð½Ð¾Ðµ Ð±Ð¾Ð³Ð°Ñ‚ÑÑ‚Ð²Ð¾"},10:{name:"Ð£Ð¼Ð¾Ð¿Ð¾Ð¼Ñ€Ð°Ñ‡Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ Ð±Ð¾Ð³Ð°Ñ‚ÑÑ‚Ð²Ð¾"}},Go={class:"equipment-selector"},Io={class:"section-divider"},Jo={class:"section-divider"},Zo={class:"filter-row"},Qo=["onClick"],Ko=["title"],ea={__name:"EquipmentSelector",props:{modelValue:{type:Object,default:()=>({armor:"clothes",weapons:[],wealth:5,epoch:10})},wealthLimit:{type:Number,default:5}},emits:["update:modelValue","validation-change"],setup(k,{emit:ee}){var h,X,q,E;const C=k,x=ee,_=D(((h=C.modelValue)==null?void 0:h.wealth)??5),u=D(((X=C.modelValue)==null?void 0:X.epoch)??10),n=D(((q=C.modelValue)==null?void 0:q.armor)??"clothes"),b=D(((E=C.modelValue)==null?void 0:E.weapons)??[]),$=D(null),O=D(!1),d=Fo.weaponTypes,N=Kt,W=Ho,U=Pt.items;V(()=>{var y;return((y=W[_.value])==null?void 0:y.name)||""}),V(()=>{var y;return((y=N[u.value])==null?void 0:y.name)||""}),Me(()=>C.modelValue,y=>{y&&(y.wealth!==void 0&&(_.value=y.wealth),y.epoch!==void 0&&(u.value=y.epoch),y.armor!==void 0&&(n.value=y.armor),y.weapons!==void 0&&(b.value=y.weapons))},{deep:!0}),V(()=>b.value.filter(y=>{const S=U.find(L=>L.id===y);return S&&S.price<_.value}).length);const R=V(()=>b.value.filter(y=>{const S=U.find(L=>L.id===y);return S&&S.price===_.value}).length),H=V(()=>b.value.filter(y=>{const S=U.find(L=>L.id===y);return S&&S.price===_.value+1}).length),Q=V(()=>b.value.some(y=>{const S=U.find(J=>J.id===y);if(!S||S.category!=="weapon")return!1;const L=S.attack;return typeof L=="object"?L.ranged===void 0:!0})),te=V(()=>b.value.some(y=>{const S=U.find(ie=>ie.id===y);if(!S||S.category!=="weapon")return!1;const L=S.attack,J=typeof L=="object"&&L.ranged!==void 0;return S.length===2&&!J})),P=V(()=>b.value.some(y=>{const S=U.find(J=>J.id===y);if(!S||S.category!=="weapon")return!1;const L=S.attack;return typeof L=="object"&&L.ranged!==void 0})),Y=V(()=>{const y=[];return!Q.value&&!te.value&&y.push("Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐµÑ‚ÑÑ Ð²Ð·ÑÑ‚ÑŒ Ñ…Ð¾Ñ‚Ñ Ð±Ñ‹ Ð¾Ð´Ð½Ð¾ Ð¾Ñ€ÑƒÐ¶Ð¸Ðµ Ð±Ð»Ð¸Ð¶Ð½ÐµÐ³Ð¾ Ð±Ð¾Ñ"),P.value||y.push("Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐµÑ‚ÑÑ Ð²Ð·ÑÑ‚ÑŒ Ñ…Ð¾Ñ‚Ñ Ð±Ñ‹ Ð¾Ð´Ð½Ð¾ Ð¾Ñ€ÑƒÐ¶Ð¸Ðµ Ð´Ð°Ð»ÑŒÐ½ÐµÐ³Ð¾ Ð±Ð¾Ñ"),y}),p=V(()=>{const y=[],S=U.find(L=>L.id===n.value);return S&&(S.epoch>u.value&&y.push("Ð’Ñ‹Ð±Ñ€Ð°Ð½Ð½Ñ‹Ð¹ Ð´Ð¾ÑÐ¿ÐµÑ… Ð½ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½ Ð² ÑÑ‚Ñƒ ÑÐ¿Ð¾Ñ…Ñƒ"),S.price>_.value+1&&y.push("Ð’Ñ‹Ð±Ñ€Ð°Ð½Ð½Ñ‹Ð¹ Ð´Ð¾ÑÐ¿ÐµÑ… ÑÐ»Ð¸ÑˆÐºÐ¾Ð¼ Ð´Ð¾Ñ€Ð¾Ð³Ð¾Ð¹")),R.value>2&&y.push(`ÐŸÑ€ÐµÐ´Ð¼ÐµÑ‚Ð¾Ð² "Ð¶Ñ‘Ð»Ñ‚Ð¾Ð¹" Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ÑÑ‚Ð¸ Ð½Ðµ Ð¼Ð¾Ð¶ÐµÑ‚ Ð±Ñ‹Ñ‚ÑŒ Ð±Ð¾Ð»ÑŒÑˆÐµ Ð´Ð²ÑƒÑ… (Ñƒ Ð²Ð°Ñ: ${R.value})`),H.value>0&&R.value>0&&y.push('Ð•ÑÐ»Ð¸ Ð²Ð·ÑÑ‚ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚ "Ð¾Ñ€Ð°Ð½Ð¶ÐµÐ²Ð¾Ð¹" Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ÑÑ‚Ð¸, Ð½ÐµÐ»ÑŒÐ·Ñ Ð±Ñ€Ð°Ñ‚ÑŒ "Ð¶Ñ‘Ð»Ñ‚Ñ‹Ðµ" Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ñ‹'),H.value>1&&y.push(`ÐŸÑ€ÐµÐ´Ð¼ÐµÑ‚ "Ð¾Ñ€Ð°Ð½Ð¶ÐµÐ²Ð¾Ð¹" Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ÑÑ‚Ð¸ Ð¼Ð¾Ð¶ÐµÑ‚ Ð±Ñ‹Ñ‚ÑŒ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¾Ð´Ð¸Ð½ (Ñƒ Ð²Ð°Ñ: ${H.value})`),y}),g=V(()=>p.value.length===0);return Me([_,u,n,b],()=>{x("update:modelValue",{armor:n.value,weapons:b.value,wealth:_.value,epoch:u.value})},{deep:!0}),Me(g,y=>{x("validation-change",y)}),x("validation-change",g.value),(y,S)=>(s(),l("div",Go,[e("div",Io,[w(c(A),{icon:"mdi:shield",class:"text-emerald-400"}),S[4]||(S[4]=e("span",null,"Ð”Ð¾ÑÐ¿ÐµÑ…",-1))]),w(Xn,{modelValue:n.value,"onUpdate:modelValue":S[0]||(S[0]=L=>n.value=L),wealth:_.value,epoch:u.value},null,8,["modelValue","wealth","epoch"]),e("div",Jo,[w(c(A),{icon:"mdi:sword-cross",class:"text-red-400"}),S[5]||(S[5]=e("span",null,"ÐžÑ€ÑƒÐ¶Ð¸Ðµ",-1)),e("span",{class:Z(["value-badge",b.value.length>0?"emerald":"slate"])},v(b.value.length),3)]),e("div",Zo,[e("button",{onClick:S[1]||(S[1]=L=>$.value=null),class:Z(["filter-chip",{active:$.value===null}])}," Ð’ÑÐµ ",2),(s(!0),l(K,null,oe(c(d),(L,J)=>(s(),l("button",{key:J,onClick:ie=>$.value=J,class:Z(["filter-chip",{active:$.value===J}])},[w(c(A),{icon:L.icon},null,8,["icon"])],10,Qo))),128)),e("button",{onClick:S[2]||(S[2]=L=>O.value=!O.value),class:Z(["filter-chip availability-toggle",{active:O.value}]),title:O.value?"ÐŸÐ¾ÐºÐ°Ð·Ð°Ð½Ñ‹ Ð²ÑÐµ":"Ð¡ÐºÑ€Ñ‹Ñ‚Ñ‹ Ð½ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ðµ"},[w(c(A),{icon:O.value?"mdi:eye":"mdi:eye-off"},null,8,["icon"])],10,Ko)]),w(Ro,{modelValue:b.value,"onUpdate:modelValue":S[3]||(S[3]=L=>b.value=L),wealth:_.value,epoch:u.value,"category-filter":$.value,"show-unavailable":O.value},null,8,["modelValue","wealth","epoch","category-filter","show-unavailable"]),w(zo,{wealth:_.value,"wealth-limit":k.wealthLimit,"selected-armor":n.value,"selected-weapons":b.value,epoch:u.value,"validation-errors":p.value,recommendations:Y.value,"is-valid":g.value},null,8,["wealth","wealth-limit","selected-armor","selected-weapons","epoch","validation-errors","recommendations","is-valid"])]))}},ta=Re(ea,[["__scopeId","data-v-1fbcc380"]]),sa={class:"finalization-step"},la={class:"flex gap-4 items-start mb-6"},na={class:"portrait-block"},oa={class:"portrait-preview"},aa=["src"],ia=["src","alt"],ca={key:2,class:"portrait-placeholder"},ra={class:"flex-1"},ua={class:"name-hint"},da={key:0,class:"ready-badge"},va={class:"gallery-section"},ha={key:0,class:"gallery-container"},pa={class:"gallery-grid"},ma=["onClick"],fa=["src","alt"],ga={key:0,class:"check-icon"},Nt=96,ya={__name:"CharacterFinalization",props:{name:{type:String,default:""},portrait:{type:[Number,String],default:null}},emits:["update:name","update:portrait"],setup(k,{emit:ee}){const C=k,x=ee,_=D(C.name||""),u=D(typeof C.portrait=="number"?C.portrait:null),n=D(typeof C.portrait=="string"?C.portrait:null),b=D(null),$=D(!1),O=V(()=>{const R=_.value.trim().length>=2,H=u.value!==null||n.value!==null;return R&&H});Me(()=>C.name,R=>{_.value=R}),Me(()=>C.portrait,R=>{typeof R=="number"?(u.value=R,n.value=null):typeof R=="string"&&(n.value=R,u.value=null)});const d=R=>{u.value=R,n.value=null,x("update:portrait",R),$.value=!1},N=()=>{var R;(R=b.value)==null||R.click()},W=R=>{var te;const H=(te=R.target.files)==null?void 0:te[0];if(!H)return;if(H.size>2*1024*1024){alert("Ð¤Ð°Ð¹Ð» ÑÐ»Ð¸ÑˆÐºÐ¾Ð¼ Ð±Ð¾Ð»ÑŒÑˆÐ¾Ð¹. ÐœÐ°ÐºÑÐ¸Ð¼ÑƒÐ¼ 2 ÐœÐ‘.");return}const Q=new FileReader;Q.onload=P=>{n.value=P.target.result,u.value=null,x("update:portrait",P.target.result)},Q.readAsDataURL(H)},U=()=>{n.value=null,b.value.value="",u.value?x("update:portrait",u.value):x("update:portrait",null)};return(R,H)=>(s(),l("div",sa,[e("div",la,[e("div",na,[e("div",oa,[n.value?(s(),l("img",{key:0,src:n.value,alt:"Ð¡Ð²Ð¾Ð¹ Ð¿Ð¾Ñ€Ñ‚Ñ€ÐµÑ‚",class:"portrait-img"},null,8,aa)):u.value?(s(),l("img",{key:1,src:c(Mt)(u.value),alt:`ÐŸÐ¾Ñ€Ñ‚Ñ€ÐµÑ‚ ${u.value}`,class:"portrait-img"},null,8,ia)):(s(),l("div",ca,[w(c(A),{icon:"mdi:account-circle",class:"w-12 h-12 text-slate-600"})]))]),e("button",{onClick:N,class:"upload-btn"},[w(c(A),{icon:"mdi:upload",class:"w-4 h-4"}),H[3]||(H[3]=Ee(" Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ ",-1))]),n.value?(s(),l("button",{key:0,onClick:U,class:"clear-btn"}," Ð£Ð±Ñ€Ð°Ñ‚ÑŒ ")):T("",!0),e("input",{ref_key:"fileInput",ref:b,type:"file",accept:"image/*",class:"hidden",onChange:W},null,544)]),e("div",ra,[Gt(e("input",{"onUpdate:modelValue":H[0]||(H[0]=Q=>_.value=Q),type:"text",placeholder:"Ð˜Ð¼Ñ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð°",maxlength:"50",class:"name-input",onInput:H[1]||(H[1]=Q=>x("update:name",_.value))},null,544),[[It,_.value]]),e("div",ua,v(_.value.length<2?"ÐœÐ¸Ð½Ð¸Ð¼ÑƒÐ¼ 2 ÑÐ¸Ð¼Ð²Ð¾Ð»Ð°":""),1)]),O.value?(s(),l("div",da,[w(c(A),{icon:"mdi:check-circle",class:"w-5 h-5"})])):T("",!0)]),e("div",va,[e("button",{onClick:H[2]||(H[2]=Q=>$.value=!$.value),class:"gallery-toggle"},[w(c(A),{icon:$.value?"mdi:chevron-up":"mdi:chevron-down",class:"w-5 h-5"},null,8,["icon"]),H[4]||(H[4]=e("span",null,"Ð’Ñ‹Ð±Ñ€Ð°Ñ‚ÑŒ Ð¸Ð· Ð³Ð¾Ñ‚Ð¾Ð²Ñ‹Ñ… Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚Ð¾Ð²",-1)),e("span",{class:"text-slate-500 text-sm"},"("+v(Nt)+")")]),w(Ht,{name:"slide"},{default:Ft(()=>[$.value?(s(),l("div",ha,[e("div",pa,[(s(),l(K,null,oe(Nt,Q=>e("div",{key:Q,onClick:te=>d(Q),class:Z(["gallery-item",{selected:u.value===Q&&!n.value}])},[e("img",{src:c(Mt)(Q),alt:`ÐŸÐ¾Ñ€Ñ‚Ñ€ÐµÑ‚ ${Q}`,loading:"lazy"},null,8,fa),u.value===Q&&!n.value?(s(),l("div",ga,[w(c(A),{icon:"mdi:check",class:"w-4 h-4"})])):T("",!0)],10,ma)),64))])])):T("",!0)]),_:1})])]))}},xa=Re(ya,[["__scopeId","data-v-6be139a0"]]),ka=[{id:"storm",name:"Ð“Ñ€Ð¾Ð·Ð½Ñ‹Ðµ",nameEn:"Storm",aspect:"war",description:"Ð¢Ðµ, ÐºÑ‚Ð¾ ÑÐ²ÑÐ·Ð°Ð½ Ñ Ð°ÑÐ¿ÐµÐºÑ‚Ð¾Ð¼ Ð’Ð¾Ð¹Ð½Ñ‹"},{id:"light",name:"Ð¡Ð²ÐµÑ‚Ð»Ñ‹Ðµ",nameEn:"Light",aspect:"knowledge",description:"Ð¢Ðµ, ÐºÑ‚Ð¾ ÑÐ²ÑÐ·Ð°Ð½ Ñ Ð°ÑÐ¿ÐµÐºÑ‚Ð¾Ð¼ Ð—Ð½Ð°Ð½Ð¸Ñ"},{id:"high",name:"Ð’Ñ‹ÑÑˆÐ¸Ðµ",nameEn:"High",aspect:"community",description:"Ð¢Ðµ, ÐºÑ‚Ð¾ ÑÐ²ÑÐ·Ð°Ð½ Ñ Ð°ÑÐ¿ÐµÐºÑ‚Ð¾Ð¼ ÐžÐ±Ñ‰ÐµÑÑ‚Ð²Ð°"},{id:"dusk",name:"Ð¡ÑƒÐ¼ÐµÑ€ÐµÑ‡Ð½Ñ‹Ðµ",nameEn:"Dusk",aspect:"shadow",description:"Ð¢Ðµ, ÐºÑ‚Ð¾ ÑÐ²ÑÐ·Ð°Ð½ Ñ Ð°ÑÐ¿ÐµÐºÑ‚Ð¾Ð¼ Ð¢ÐµÐ½Ð¸"},{id:"moon",name:"Ð›ÑƒÐ½Ð½Ñ‹Ðµ",nameEn:"Moon",aspect:"mysticism",description:"Ð¢Ðµ, ÐºÑ‚Ð¾ ÑÐ²ÑÐ·Ð°Ð½ Ñ Ð°ÑÐ¿ÐµÐºÑ‚Ð¾Ð¼ ÐœÐ¸ÑÑ‚Ð¸ÐºÐ¸"},{id:"wild",name:"Ð’Ð¾Ð»ÑŒÐ½Ñ‹Ðµ",nameEn:"Wild",aspect:"nature",description:"Ð¢Ðµ, ÐºÑ‚Ð¾ ÑÐ²ÑÐ·Ð°Ð½ Ñ Ð°ÑÐ¿ÐµÐºÑ‚Ð¾Ð¼ ÐŸÑ€Ð¸Ñ€Ð¾Ð´Ñ‹"}],ba={subraces:ka},_a={class:"fixed inset-0 z-50 flex flex-col lg:flex-row bg-slate-950 select-none"},$a=["viewBox"],wa=["id"],Ca=["points"],Sa={id:"clip-center-race"},Ma=["points"],Ta=["transform"],Aa={key:0,class:"gender-selection"},Pa=["x","y","href"],Ea=["x","y","href"],Ra={key:1,class:"aspects"},Da=["cx","cy","fill","fill-opacity","onClick"],Va=["cx","cy","stroke"],ja=["x","y"],Ya=["x","y"],qa={key:2,class:"race-aspect-connections"},Xa=["x1","y1","x2","y2","stroke","stroke-opacity"],Ba=["x1","y1","x2","y2","stroke","stroke-opacity"],Oa={key:3,class:"races"},La=["onClick","onMouseenter"],za=["transform"],Na=["clip-path"],Wa=["href","onError"],Ua=["points","stroke","stroke-width","opacity"],Fa={key:4,class:"subrace-selection"},Ha=["x1","y1","x2","y2","stroke"],Ga=["cx","cy","fill","fill-opacity","stroke","stroke-opacity"],Ia=["x","y"],Ja={class:"flex items-center justify-center w-full h-full opacity-70"},Za=["x","y"],Qa=["transform"],Ka={"clip-path":"url(#clip-center-race)"},ei=["href"],ti=["points","stroke","stroke-width","opacity"],si=["cx","cy","onClick","onMouseenter"],li=["cx","cy"],ni=["cx","cy","fill"],oi=["cx","cy","stroke"],ai={key:5,class:"class-selection"},ii=["cx","cy","r"],ci=["cx","cy","fill","fill-opacity"],ri=["x","y"],ui=["d","stroke"],di=["d","stroke","stroke-opacity","stroke-width"],vi=["id","gradientTransform"],hi=["stop-color"],pi=["stop-color"],mi=["stop-color"],fi=["stop-color"],gi=["id"],yi=["points"],xi=["transform","onClick","onMouseenter"],ki=["fill","fill-opacity","clip-path"],bi=["points","stroke-opacity"],_i=["x","y","width","height"],$i=["src"],wi={key:1,class:"pointer-events-none"},Ci=["cx","cy","stroke"],Si={class:"sticky top-0 z-20 bg-slate-900/95 backdrop-blur-sm px-6 py-4 border-b border-slate-700/50"},Mi={class:"flex items-center justify-between"},Ti={class:"text-sm font-medium"},Ai={key:1},Pi={key:0,class:"mb-4"},Ei={class:"text-2xl font-bold text-slate-100"},Ri={class:"text-sm text-slate-400 mt-1"},Di={class:"pb-6"},Vi={key:0,class:"space-y-4"},ji={class:"text-lg font-semibold text-slate-100 mb-2"},Yi={class:"text-sm text-slate-300"},qi={class:"flex flex-wrap gap-2"},Xi={key:1,class:"space-y-4"},Bi={class:"text-lg font-semibold text-slate-100 mb-2"},Oi={class:"text-sm text-slate-300"},Li={key:2,class:"space-y-6"},zi={key:0,class:"step-4-container"},Ni={class:"step-4-grid gap-8 mb-6"},Wi={class:"step-4-left-column space-y-4"},Ui={class:"text-2xl font-bold text-slate-100 mb-1"},Fi={class:"text-sm text-slate-400"},Hi=["src","alt"],Gi={class:"flex items-center justify-center"},Ii={class:"bg-slate-800/30 border border-slate-700/50 rounded-lg p-5 mb-6"},Ji={class:"flex items-start justify-between gap-6 flex-wrap"},Zi={key:0,class:"bg-slate-800/20 border border-slate-700/30 rounded-lg p-5 mb-6"},Qi={class:"text-sm text-slate-400 leading-relaxed italic"},Ki={key:3},ec={key:4},tc={class:"p-6 pt-4 border-t border-white/5 bg-slate-900 flex gap-3 flex-shrink-0"},sc=["disabled"],lc=["disabled"],Wt=6,ne=800,Ce=1600,dt=5,wt=300,nc=100,oc={__name:"CharacterCreationCanvas",props:{constraints:{type:Object,default:null}},emits:["close","created"],setup(k,{emit:ee}){const C=k,x=ee,_=Ws();Jt(()=>{C.constraints&&_.setConstraints(C.constraints)});const u=V({get:()=>_.step,set:o=>_.setStep(o)}),n=V(()=>_.formData),b=o=>_.isRaceAllowed(o),$=o=>_.isSubraceAllowed(o),O=o=>_.isClassAllowed(o),d=D(1.9),N=D({x:0,y:0}),W=D(!1),U=D({x:0,y:0}),R=D(!1),H=D(0),Q=D(1),te=D({x:0,y:0}),P=D(null),Y=D(null),p=D(null),g=D(null),h=D(!1),X=D("forward"),q=D(!1),E=D(null),y=V(()=>u.value>=5),S=V(()=>y.value||q.value),L=D(!1),J=D(0),ie=D(null),f=D(null),m=D({stats:{..._.formData.stats},skills:{..._.formData.skills}}),a=D(!0),F=ms.races,se=vt.aspects,ue=vt.metadata.circularOrder,ce=Qt.classes,de=V(()=>F.find(o=>o.id===n.value.race)),xe=V(()=>{var j;if(!de.value||!n.value.subrace)return null;const o=n.value.subrace.split("-");if(o.length!==2)return null;const[r,M]=o,I=ba.subraces.find(ae=>ae.aspect===M);if(!I)return null;const t=(j=de.value.subraceAliases)==null?void 0:j[M];return{...I,id:n.value.subrace,name:(t==null?void 0:t.name)||`${I.name} ${de.value.name.toLowerCase()}`,description:(t==null?void 0:t.description)||I.description}}),pe=V(()=>{if(!n.value.subrace)return null;const o=n.value.subrace.split("-");return o.length===2?o[1]:null}),He=V(()=>{if(u.value!==2||!n.value.race||h.value)return[];const o=F.find(r=>r.id===n.value.race);return(o==null?void 0:o.position.aspects)||[]}),qe=V(()=>u.value!==2||!p.value||h.value?[]:F.filter(o=>o.position.aspects.includes(p.value)).map(o=>o.id)),De=V(()=>{switch(u.value){case 1:return n.value.gender!==null;case 2:return n.value.race!==null;case 3:return n.value.subrace!==null;case 4:{if(!n.value.class)return!1;const o=m.value.skills;return o.fromClass&&o.fromAspect1&&o.fromAspect2}case 5:return a.value&&n.value.equipment.armor!==null;case 6:return n.value.name.trim().length>=2&&n.value.portrait!==null;default:return!1}}),G=o=>{const r=se.find(re=>re.id===o);if(!r)return{x:0,y:0};const M=r.position.angle,I=ne*.32,t=(M-90)*(Math.PI/180),j=ne/2+I*Math.cos(t),ae=ne/2+I*Math.sin(t);return{x:j,y:ae}},Se=o=>{const[r,M]=o.position.aspects,I=G(r),t=G(M);return{x:(I.x+t.x)/2,y:(I.y+t.y)/2}},ge=o=>{const r=se.find(M=>M.id===o);return(r==null?void 0:r.color)||"#666"},Ke=o=>({war:"w",knowledge:"k",community:"c",shadow:"s",mysticism:"m",nature:"n"})[o]||o,et=(o,r,M=null)=>{if(M){const I=Ke(M);return _t(o,r,I)}return _t(o,r,"base")},tt=(o,r,M,I=null)=>{const t=o.target;if(!t)return;const j=t.src||"",ae=I?Ke(I):null;if(I&&ae&&j.includes(`/${r}/${M}/${ae}.png`)){console.log(`Subrace portrait not found: ${r}/${M}/${ae}.png (aspect: ${I}), falling back to base`),t.src=_t(r,M,"base");return}if(j.includes(`/${r}/${M}/base.png`)){console.error(`Base portrait not found for ${r} (${M}), hiding image`),t.style.display="none";return}console.error(`Unexpected image load error for ${r} (${M})`,j),t.style.display="none"},Ve=(o,r,M)=>{const I=[];for(let t=0;t<6;t++){const j=Math.PI/3*t,ae=o+M*Math.cos(j),re=r+M*Math.sin(j);I.push(`${ae},${re}`)}return I.join(" ")},st=o=>o.edges.filter(M=>M.type==="aspect").length===1,ht=o=>{if(st(o)){const me=o.aspects[0],he=G(me),fe=ne/2,ye=ne/2,be=he.x-fe,we=he.y-ye;let _e=Math.atan2(we,be)*(180/Math.PI);return _e<0&&(_e+=360),_e}const r=o.aspects[0],M=o.aspects[1],I=G(r),t=G(M),j=t.x-I.x,ae=t.y-I.y;let re=Math.atan2(ae,j)*(180/Math.PI);return re<0&&(re+=360),re},Le=o=>{const r=ne/2,M=ne/2;if(st(o)){const Ae=o.aspects[0],We=G(Ae),Ue=We.x-r,Fe=We.y-M,Et=Math.sqrt(Ue*Ue+Fe*Fe),es=Ue/Et,ts=Fe/Et,ut=ne*.43;let Rt=r+es*ut,Dt=M+ts*ut;if(o.edges.some(Ie=>Ie.type==="class")){const Ie=o.edges.find(Je=>Je.type==="class"),ss=Ie==null?void 0:Ie.id,Vt=ce.find(Je=>Je.id===ss);if(Vt){const Je=Vt.aspects[0],jt=se.find(Ze=>Ze.id===Ae),Yt=se.find(Ze=>Ze.id===Je);if(jt&&Yt){const Ze=jt.position.angle;let Qe=Yt.position.angle-Ze;for(;Qe>180;)Qe-=360;for(;Qe<-180;)Qe+=360;const ls=(Qe>0?14:-14)*(Math.PI/180),qt=Math.atan2(Fe,Ue)+ls;Rt=r+Math.cos(qt)*ut,Dt=M+Math.sin(qt)*ut}}}return{x:Rt,y:Dt}}const I=o.aspects[0],t=o.aspects[1],j=G(I),ae=G(t),re=o.edges.find(Ae=>Ae.id===I),me=o.edges.find(Ae=>Ae.id===t),he=(re==null?void 0:re.cost)||3,fe=(me==null?void 0:me.cost)||3,ye=he+fe,be=he/ye;let we=j.x+(ae.x-j.x)*be,_e=j.y+(ae.y-j.y)*be;if(he===2&&fe===4||he===4&&fe===2){const Ae=we-r,We=_e-M;we=r+Ae*.875,_e=M+We*.875}const Be=60;return o.id==="seeker"?_e-=Be:o.id==="heretic"?(we+=Be*Math.cos(-Math.PI/6),_e+=Be*Math.sin(Math.PI/6)):o.id==="cutthroat"&&(we+=Be*Math.cos(5*Math.PI/6),_e+=Be*Math.sin(Math.PI/6)),{x:we,y:_e}},lt=(o,r,M=.15)=>{const I=r.x-o.x,t=r.y-o.y,j=Math.sqrt(I*I+t*t),ae=I/j,re=t/j,me=30,he=18,fe=o.x+ae*me,ye=o.y+re*me,be=r.x-ae*he,we=r.y-re*he,_e=-re,Be=ae,Ae=(fe+be)/2,We=(ye+we)/2,Ue=Ae+_e*j*M,Fe=We+Be*j*M;return`M ${fe},${ye} Q ${Ue},${Fe} ${be},${we}`},pt=o=>{const r=Se(o),M=n.value.race===o.id,I=qe.value.includes(o.id);if(h.value&&M){const t=ne/2,j=ne/2;return`translate(${t}, ${j}) scale(2.5)`}return $e.value&&M&&!h.value?`translate(${r.x}, ${r.y}) scale(1.2)`:$e.value&&I&&!h.value?`translate(${r.x}, ${r.y}) scale(1.1)`:`translate(${r.x}, ${r.y})`},mt=o=>{o.preventDefault();const M=o.currentTarget.getBoundingClientRect(),I=o.clientX-M.left,t=o.clientY-M.top,j=-o.deltaY*.001,ae=Math.max(1,Math.min(4,d.value+j));if(ae!==d.value){const re=I/M.width*Ce,me=t/M.height*Ce,he=Ce/2,fe=ne/2,ye=(re-he-N.value.x)/d.value+fe,be=(me-he-N.value.y)/d.value+fe;N.value={x:re-he-(ye-fe)*ae,y:me-he-(be-fe)*ae},d.value=ae}},ft=o=>{if(o.button===0){R.value=!1;const r={x:o.clientX,y:o.clientY};W.value=!0,U.value={x:o.clientX-N.value.x,y:o.clientY-N.value.y,initialX:r.x,initialY:r.y}}else(o.button===1||o.button===2)&&(o.preventDefault(),R.value=!1,W.value=!0,U.value={x:o.clientX-N.value.x,y:o.clientY-N.value.y,initialX:o.clientX,initialY:o.clientY})},gt=o=>{if(W.value){const r=o.clientX-U.value.initialX,M=o.clientY-U.value.initialY;!R.value&&(Math.abs(r)>dt||Math.abs(M)>dt)&&(R.value=!0),R.value&&(N.value={x:o.clientX-U.value.x,y:o.clientY-U.value.y})}},nt=()=>{W.value=!1,setTimeout(()=>{R.value=!1},10)},yt=o=>{if(o.touches.length===1){const r=o.touches[0];W.value=!0,R.value=!1,U.value={x:r.clientX-N.value.x,y:r.clientY-N.value.y,initialX:r.clientX,initialY:r.clientY}}else if(o.touches.length===2){const r=o.touches[0],M=o.touches[1],I=Math.hypot(M.clientX-r.clientX,M.clientY-r.clientY);H.value=I,Q.value=d.value,te.value={...N.value},R.value=!1}},xt=o=>{if(o.preventDefault(),o.touches.length===1&&W.value){const r=o.touches[0],M=r.clientX-U.value.initialX,I=r.clientY-U.value.initialY;!R.value&&(Math.abs(M)>dt||Math.abs(I)>dt)&&(R.value=!0),R.value&&(N.value={x:r.clientX-U.value.x,y:r.clientY-U.value.y})}else if(o.touches.length===2){const r=o.touches[0],M=o.touches[1],I=Math.hypot(M.clientX-r.clientX,M.clientY-r.clientY),t=o.currentTarget.closest("svg");if(!t)return;const j=t.getBoundingClientRect(),ae=(r.clientX+M.clientX)/2,re=(r.clientY+M.clientY)/2,me=(ae-j.left)/j.width*Ce,he=(re-j.top)/j.height*Ce,fe=Math.max(1,Math.min(4,Q.value*(I/H.value))),ye=Ce/2,be=ne/2,we=(me-ye-te.value.x)/Q.value+be,_e=(he-ye-te.value.y)/Q.value+be;N.value={x:me-ye-(we-be)*fe,y:he-ye-(_e-be)*fe},d.value=fe,R.value=!0}},ot=()=>{W.value=!1,setTimeout(()=>{R.value=!1},10)},kt=V(()=>{const o=Ce/2,r=ne/2;return`translate(${o+N.value.x}, ${o+N.value.y}) scale(${d.value}) translate(${-r}, ${-r})`}),bt=()=>{_.reset(),x("close")},i=()=>{x("created",n.value),_.reset()},B=o=>{R.value||(_.setGender(o),L.value=!0,setTimeout(()=>{je(),setTimeout(()=>{L.value=!1},100)},400))},z=o=>{if(R.value||!b(o))return;const r=Date.now(),M=ie.value===o&&r-J.value<wt;J.value=r,ie.value=o,M&&u.value===2?(_.setRace(o),p.value=null,Te()):(_.setRace(o),p.value=null)},le=o=>{R.value||(u.value===2?p.value===o?p.value=null:(p.value=o,_.setRace(null)):u.value===3&&_.setSubrace(`${n.value.race}-${o}`))},ke=o=>{if(R.value)return;const r=`${n.value.race}-${o}`;if(!$(r))return;const M=Date.now(),I=ie.value===`subrace-${o}`&&M-J.value<wt;J.value=M,ie.value=`subrace-${o}`,I&&u.value===3?(_.setSubrace(r),Te()):_.setSubrace(r)},at=o=>{if(R.value||!O(o))return;const r=Date.now(),M=ie.value===`class-${o}`&&r-J.value<wt;J.value=r,ie.value=`class-${o}`,M&&u.value===4?(_.setClass(o),Te()):_.setClass(o)},ze=o=>{R.value||u.value===2&&(_.setRace(null),p.value=null)},Xe=o=>{if(R.value)return;const r=o.currentTarget.closest("svg");if(!r)return;const M=r.getBoundingClientRect(),I=o.clientX-M.left,t=o.clientY-M.top,j=I/M.width*Ce,ae=t/M.height*Ce,re=Ce/2,me=ne/2,he=(j-re-N.value.x)/d.value+me,fe=(ae-re-N.value.y)/d.value+me,ye=d.value<2.5?3.2:1.9;N.value={x:j-re-(he-me)*ye,y:ae-re-(fe-me)*ye},d.value=ye},je=()=>{De.value&&u.value<Wt&&u.value++},it=()=>{u.value>1&&(u.value===3&&n.value.race?(h.value=!0,X.value="backward",setTimeout(()=>{h.value=!1,u.value--},600)):u.value--)},Te=()=>{De.value&&(u.value===4&&(_.setStats(m.value.stats),_.setSkills(m.value.skills)),u.value===2&&n.value.race||u.value===3&&n.value.subrace||u.value===4&&n.value.class?(h.value=!0,X.value="forward",setTimeout(()=>{je(),setTimeout(()=>{h.value=!1},100)},600)):je())};V(()=>{if(u.value<3||!de.value)return null;const o=Se(de.value),r=ne/2,M=ne/2;return{translateX:r-o.x,translateY:M-o.y,scale:2.5}});const Ge=V(()=>u.value===1),$e=V(()=>u.value===2),ct=V(()=>u.value===3);V(()=>u.value===4),Me(u,()=>{q.value=!1});const rt=o=>{if(u.value!==4||y.value)return;const r=o.target.scrollTop;r>nc&&!q.value?q.value=!0:r<=20&&q.value&&(q.value=!1)},Ne=()=>{q.value=!1,E.value&&(E.value.scrollTop=0)};return(o,r)=>{var M,I;return s(),l("div",_a,[e("div",{class:Z(["canvas-container relative overflow-hidden touch-none bg-slate-950 flex-shrink-0 transition-all duration-500 ease-out",{"canvas-collapsed":S.value,"canvas-expanded":!S.value}]),onWheel:mt,onMousedown:ft,onMousemove:gt,onMouseup:nt,onMouseleave:nt,onTouchstart:yt,onTouchmove:xt,onTouchend:ot,onContextmenu:r[7]||(r[7]=Pe(()=>{},["prevent"]))},[(s(),l("svg",{viewBox:`0 0 ${Ce} ${Ce}`,class:"w-full h-full",preserveAspectRatio:"xMidYMid meet"},[e("defs",null,[(s(!0),l(K,null,oe(c(F),t=>(s(),l("clipPath",{key:`clip-${t.id}`,id:`clip-${t.id}`},[e("polygon",{points:Ve(0,0,48)},null,8,Ca)],8,wa))),128)),e("clipPath",Sa,[e("polygon",{points:Ve(0,0,120)},null,8,Ma)])]),e("g",{transform:kt.value,class:Z(["canvas-group",{panning:W.value}])},[e("rect",{x:"0",y:"0",width:ne,height:ne,fill:"#0f172a",class:"cursor-default",onClick:ze,onDblclick:Xe},null,32),Ge.value||L.value?(s(),l("g",Aa,[e("g",{class:Z(["gender-option",{"gender-sliding-left":L.value}])},[e("image",{x:ne/4-280,y:ne/2-350,width:"560",height:"700",href:c(Bt)("male"),class:Z(["cursor-pointer opacity-90 hover:opacity-100 transition-opacity",{"brightness-110":n.value.gender==="m"}]),onClick:r[0]||(r[0]=t=>B("m"))},null,10,Pa)],2),e("g",{class:Z(["gender-option",{"gender-sliding-right":L.value}])},[e("image",{x:ne*3/4-280,y:ne/2-350,width:"560",height:"700",href:c(Bt)("female"),class:Z(["cursor-pointer opacity-90 hover:opacity-100 transition-opacity",{"brightness-110":n.value.gender==="f"}]),onClick:r[1]||(r[1]=t=>B("f"))},null,10,Ea)],2)])):T("",!0),u.value>=2&&u.value!==3&&u.value!==4?(s(),l("g",Ra,[(s(!0),l(K,null,oe(c(se),t=>(s(),l("g",{key:t.id},[e("circle",{cx:G(t.id).x,cy:G(t.id).y,r:"32",fill:t.color,"fill-opacity":p.value===t.id?.8:He.value.includes(t.id)?.7:.4,class:"transition-all duration-300 cursor-pointer",onClick:Pe(j=>le(t.id),["stop"])},null,8,Da),p.value===t.id?(s(),l("circle",{key:0,cx:G(t.id).x,cy:G(t.id).y,r:"36",fill:"none",stroke:t.color,"stroke-width":"2",opacity:"0.9",class:"pointer-events-none animate-pulse"},null,8,Va)):T("",!0),(s(),l("foreignObject",{x:G(t.id).x-16,y:G(t.id).y-16,width:"32",height:"32",class:"pointer-events-none"},[e("div",{class:Z(["flex items-center justify-center w-full h-full transition-opacity duration-300",p.value===t.id?"opacity-90":He.value.includes(t.id)?"opacity-80":"opacity-50"])},[w(c(A),{icon:t.icon,class:"text-2xl"},null,8,["icon"])],2)],8,ja)),e("text",{x:G(t.id).x,y:G(t.id).y+ne*.055,"text-anchor":"middle",class:Z(["text-xs font-medium select-none transition-all duration-300 pointer-events-none",p.value===t.id?"fill-white font-semibold":He.value.includes(t.id)?"fill-slate-100":"fill-slate-300"])},v(t.name),11,Ya)]))),128))])):T("",!0),$e.value&&!h.value?(s(),l("g",qa,[(s(!0),l(K,null,oe(c(F),t=>(s(),l("line",{key:`line1-${t.id}`,x1:Se(t).x,y1:Se(t).y,x2:G(t.position.aspects[0]).x,y2:G(t.position.aspects[0]).y,stroke:ge(t.position.aspects[0]),"stroke-opacity":n.value.race===t.id?.5:.15,"stroke-width":"2",class:"transition-all duration-300"},null,8,Xa))),128)),(s(!0),l(K,null,oe(c(F),t=>(s(),l("line",{key:`line2-${t.id}`,x1:Se(t).x,y1:Se(t).y,x2:G(t.position.aspects[1]).x,y2:G(t.position.aspects[1]).y,stroke:ge(t.position.aspects[1]),"stroke-opacity":n.value.race===t.id?.5:.15,"stroke-width":"2",class:"transition-all duration-300"},null,8,Ba))),128))])):T("",!0),$e.value||h.value?(s(),l("g",Oa,[(s(!0),l(K,null,oe(c(F),t=>(s(),l("g",{key:t.id,class:Z([b(t.id)?"cursor-pointer":"cursor-not-allowed",h.value?"":"transition-all duration-300"]),style:ve([h.value&&n.value.race!==t.id&&X.value==="forward"?"opacity: 0; transition: opacity 600ms ease-out;":h.value&&X.value==="backward"&&n.value.race!==t.id?"opacity: 0; transition: opacity 600ms ease-in;":h.value&&X.value==="backward"&&n.value.race===t.id?"opacity: 1;":"",b(t.id)?"":"filter: grayscale(100%); opacity: 0.5;"].filter(Boolean).join(" ")),onClick:j=>z(t.id),onMouseenter:j=>P.value=t.id,onMouseleave:r[2]||(r[2]=j=>P.value=null)},[e("g",{transform:pt(t),style:ve(h.value&&n.value.race===t.id?"transition: transform 600ms cubic-bezier(0.4, 0, 0.2, 1);":!h.value&&(n.value.race===t.id||qe.value.includes(t.id))?"transition: transform 200ms ease-out;":"")},[e("g",{"clip-path":`url(#clip-${t.id})`},[e("image",{href:et(t.id,n.value.gender),x:"-48",y:"-48",width:"96",height:"96",preserveAspectRatio:"xMidYMid slice",onError:j=>tt(j,t.id,n.value.gender)},null,40,Wa)],8,Na),e("polygon",{points:Ve(0,0,48),fill:"none",stroke:n.value.race===t.id&&$e.value?"white":qe.value.includes(t.id)&&$e.value?"#fbbf24":P.value===t.id&&$e.value?"#64748b":"#1e293b","stroke-width":n.value.race===t.id&&$e.value||qe.value.includes(t.id)&&$e.value?2.5:2,opacity:n.value.race===t.id&&$e.value?.9:qe.value.includes(t.id)&&$e.value?.85:P.value===t.id&&$e.value?.8:.6,class:"transition-all duration-200"},null,8,Ua)],12,za)],46,La))),128))])):T("",!0),ct.value&&de.value?(s(),l("g",Fa,[pe.value?(s(),l("line",{key:0,x1:ne/2,y1:ne/2,x2:G(pe.value).x,y2:G(pe.value).y,stroke:ge(pe.value),"stroke-width":"3",opacity:"0.5",class:"transition-all duration-300"},null,8,Ha)):T("",!0),(s(!0),l(K,null,oe(c(ue),t=>(s(),l("g",{key:`aspect-bg-${t}`,class:"pointer-events-none"},[e("circle",{cx:G(t).x,cy:G(t).y,r:"36",fill:ge(t),"fill-opacity":pe.value===t?.6:.3,stroke:ge(t),"stroke-opacity":pe.value===t?.4:.2,"stroke-width":"1",class:"transition-all duration-300"},null,8,Ga)]))),128)),(s(!0),l(K,null,oe(c(se),t=>(s(),l("g",{key:`aspect-full-${t.id}`,class:"pointer-events-none"},[(s(),l("foreignObject",{x:G(t.id).x-16,y:G(t.id).y-16,width:"32",height:"32"},[e("div",Ja,[w(c(A),{icon:t.icon,class:"text-2xl"},null,8,["icon"])])],8,Ia)),e("text",{x:G(t.id).x,y:G(t.id).y+ne*.055,"text-anchor":"middle",class:"text-xs font-medium fill-slate-200 select-none"},v(t.name),9,Za)]))),128)),e("g",{transform:`translate(${ne/2}, ${ne/2})`},[e("g",Ka,[e("image",{href:et(de.value.id,n.value.gender,pe.value),x:"-120",y:"-120",width:"240",height:"240",preserveAspectRatio:"xMidYMid slice",onError:r[3]||(r[3]=t=>tt(t,de.value.id,n.value.gender,pe.value)),class:"transition-opacity duration-300"},null,40,ei)]),e("polygon",{points:Ve(0,0,120),fill:"none",stroke:pe.value?ge(pe.value):"white","stroke-width":pe.value?5:3,opacity:pe.value?.95:.7,class:"transition-all duration-300"},null,8,ti)],8,Qa),(s(!0),l(K,null,oe(c(ue),t=>(s(),l("g",{key:`subrace-${t}`},[e("circle",{cx:G(t).x,cy:G(t).y,r:"40",fill:"transparent",class:Z($(`${n.value.race}-${t}`)?"cursor-pointer":"cursor-not-allowed"),style:ve($(`${n.value.race}-${t}`)?"":"opacity: 0.3;"),onClick:j=>ke(t),onMouseenter:j=>Y.value=t,onMouseleave:r[4]||(r[4]=j=>Y.value=null)},null,46,si),$(`${n.value.race}-${t}`)?T("",!0):(s(),l("circle",{key:0,cx:G(t).x,cy:G(t).y,r:"36",fill:"gray",opacity:"0.4",class:"pointer-events-none"},null,8,li)),Y.value===t&&pe.value!==t&&$(`${n.value.race}-${t}`)?(s(),l("circle",{key:1,cx:G(t).x,cy:G(t).y,r:"36",fill:ge(t),opacity:"0.5",class:"pointer-events-none"},null,8,ni)):T("",!0),pe.value===t?(s(),l("circle",{key:2,cx:G(t).x,cy:G(t).y,r:"38",fill:"none",stroke:ge(t),"stroke-width":"3",opacity:"0.8",class:"pointer-events-none"},null,8,oi)):T("",!0)]))),128))])):T("",!0),u.value===4?(s(),l("g",ai,[e("rect",{x:"0",y:"0",width:ne,height:ne,fill:"transparent",class:"cursor-default",onClick:r[5]||(r[5]=()=>{n.value.class&&c(_).setClass(null)})}),e("circle",{cx:ne/2,cy:ne/2,r:ne*.32,fill:"none",stroke:"#ffffff","stroke-width":"8",opacity:"0.075",class:"pointer-events-none"},null,8,ii),(s(!0),l(K,null,oe(c(se),t=>{var j,ae;return s(),l("g",{key:`aspect-bg-${t.id}`},[e("circle",{cx:G(t.id).x,cy:G(t.id).y,r:"18",fill:ge(t.id),"fill-opacity":n.value.class?(j=c(ce).find(re=>re.id===n.value.class))!=null&&j.aspects.includes(t.id)?.35:.15:.4,class:"pointer-events-none transition-all duration-300"},null,8,ci),(s(),l("foreignObject",{x:G(t.id).x-16,y:G(t.id).y-16,width:"32",height:"32",class:"pointer-events-none"},[e("div",{class:Z(["flex items-center justify-center w-full h-full transition-opacity duration-300",n.value.class?(ae=c(ce).find(re=>re.id===n.value.class))!=null&&ae.aspects.includes(t.id)?"opacity-60":"opacity-30":"opacity-70"])},[w(c(A),{icon:t.icon,class:"text-2xl"},null,8,["icon"])],2)],8,ri))])}),128)),(s(!0),l(K,null,oe(c(ce),t=>(s(),l("g",{key:`class-lines-${t.id}`,class:"pointer-events-none"},[(s(!0),l(K,null,oe(t.edges.filter(j=>j.type==="aspect"),j=>(s(),l(K,{key:`edge-${t.id}-${j.id}`},[n.value.class===t.id?(s(),l("path",{key:0,d:lt(Le(t),G(j.id)),stroke:ge(j.id),"stroke-opacity":"0.6","stroke-width":"8",fill:"none",class:"transition-all duration-300",style:{filter:"blur(4px)"}},null,8,ui)):T("",!0),e("path",{d:lt(Le(t),G(j.id)),stroke:n.value.class===t.id?ge(j.id):g.value===t.id?"#64748b":"#475569","stroke-opacity":n.value.class===t.id?.9:g.value===t.id?.5:.2,"stroke-width":n.value.class===t.id?3:g.value===t.id?2:1.5,fill:"none",class:"transition-all duration-300"},null,8,di)],64))),128))]))),128)),n.value.class?(s(),l("rect",{key:0,x:"0",y:"0",width:ne,height:ne,fill:"#0a0f1a",opacity:"0.85",class:"transition-opacity duration-300 pointer-events-none"})):T("",!0),(s(!0),l(K,null,oe(c(ce),t=>(s(),l("g",{key:`class-${t.id}`},[e("defs",null,[e("linearGradient",{id:`class-gradient-${t.id}`,gradientTransform:`rotate(${ht(t)}, 0.5, 0.5)`},[e("stop",{offset:"0%","stop-color":ge(t.aspects[0])},null,8,hi),e("stop",{offset:"15%","stop-color":ge(t.aspects[0])},null,8,pi),e("stop",{offset:"85%","stop-color":ge(t.aspects[t.aspects.length>1?1:0])},null,8,mi),e("stop",{offset:"100%","stop-color":ge(t.aspects[t.aspects.length>1?1:0])},null,8,fi)],8,vi),e("clipPath",{id:`hexclip-${t.id}`},[e("polygon",{points:Ve(0,0,30)},null,8,yi)],8,gi)]),e("g",{transform:`translate(${Le(t).x}, ${Le(t).y}) scale(${n.value.class===t.id?1.5:1})`,class:Z([O(t.id)?"cursor-pointer":"cursor-not-allowed","transition-all duration-300",{"opacity-100":!n.value.class||n.value.class===t.id,"opacity-40":n.value.class&&n.value.class!==t.id}]),style:ve(O(t.id)?"":"filter: grayscale(100%); opacity: 0.35 !important;"),onClick:j=>at(t.id),onMouseenter:j=>g.value=t.id,onMouseleave:r[6]||(r[6]=j=>g.value=null)},[e("circle",{cx:"0",cy:"0",r:"30",fill:`url(#class-gradient-${t.id})`,"fill-opacity":n.value.class===t.id?.4:.25,"clip-path":`url(#hexclip-${t.id})`,class:"transition-all duration-300"},null,8,ki),e("polygon",{points:Ve(0,0,30),fill:"none",stroke:"#ffffff","stroke-opacity":n.value.class===t.id?.3:.15,"stroke-width":"1",class:"transition-all duration-300"},null,8,bi),(s(),l("foreignObject",{x:n.value.class===t.id?-38:-30,y:n.value.class===t.id?-38:-30,width:n.value.class===t.id?76:60,height:n.value.class===t.id?76:60,class:"pointer-events-none transition-all duration-300"},[e("img",{src:c(Ot)(t.id),style:{width:"100%",height:"100%",opacity:1,transition:"all 0.3s"}},null,8,$i)],8,_i))],46,xi)]))),128)),n.value.class?(s(),l("g",wi,[(s(!0),l(K,null,oe(((M=c(ce).find(t=>t.id===n.value.class))==null?void 0:M.aspects)||[],t=>(s(),l("g",{key:`highlight-${t}`},[e("circle",{cx:G(t).x,cy:G(t).y,r:"22",fill:"none",stroke:ge(t),"stroke-width":"2.5",opacity:"0.9",class:"transition-all duration-300"},null,8,Ci)]))),128))])):T("",!0)])):T("",!0)],10,Ta)],8,$a))],34),e("div",{class:Z(["bg-slate-900 border-t lg:border-t-0 lg:border-l border-white/10 flex flex-col relative overflow-hidden transition-all duration-300",S.value?"flex-1 lg:flex-none lg:w-full":"flex-1"])},[e("div",Si,[e("div",Mi,[u.value>1?(s(),l("button",{key:0,onClick:r[8]||(r[8]=t=>q.value&&u.value===4?Ne():it()),class:"flex items-center gap-2 px-4 py-2 rounded-lg bg-slate-800/50 hover:bg-slate-700 border border-slate-700/50 text-slate-300 transition"},[w(c(A),{icon:"mdi:arrow-left",class:"w-5 h-5"}),e("span",Ti,v(q.value&&u.value===4?"Ð”Ñ€ÑƒÐ³Ð¾Ð¹ ÐºÐ»Ð°ÑÑ":"ÐÐ°Ð·Ð°Ð´"),1)])):(s(),l("div",Ai)),e("button",{onClick:bt,class:"flex items-center gap-2 px-4 py-2 rounded-lg bg-red-900/20 hover:bg-red-900/30 border border-red-700/50 text-red-300 transition"},[w(c(A),{icon:"mdi:close",class:"w-5 h-5"}),r[16]||(r[16]=e("span",{class:"text-sm font-medium"},"Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ",-1))])])]),e("div",{ref_key:"infoPanelRef",ref:E,class:"flex-1 overflow-y-auto p-6 pb-0",onScroll:rt},[u.value<=3?(s(),l("div",Pi,[e("h2",Ei,v(u.value===1?"Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð¿Ð¾Ð»":u.value===2?"Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ñ€Ð°ÑÑƒ":"Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð¿Ð¾Ð´Ñ€Ð°ÑÑƒ"),1),e("p",Ri,v(u.value===1?"Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð¿Ð¾Ð» Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð° Ð´Ð»Ñ Ð½Ð°Ñ‡Ð°Ð»Ð°":u.value===2?"Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ñ€Ð°ÑÑƒ, Ñ€Ð°ÑÐ¿Ð¾Ð»Ð¾Ð¶ÐµÐ½Ð½ÑƒÑŽ Ð¼ÐµÐ¶Ð´Ñƒ Ð´Ð²ÑƒÐ¼Ñ Ð°ÑÐ¿ÐµÐºÑ‚Ð°Ð¼Ð¸":"ÐŸÐ¾Ð´Ñ€Ð°ÑÐ° Ð´Ð¾Ð±Ð°Ð²Ð»ÑÐµÑ‚ ÑÐ²ÑÐ·ÑŒ Ñ Ð¾Ð´Ð½Ð¸Ð¼ Ð¸Ð· Ð°ÑÐ¿ÐµÐºÑ‚Ð¾Ð²"),1)])):T("",!0),e("div",Di,[u.value===2&&de.value?(s(),l("div",Vi,[e("div",null,[e("h3",ji,v(de.value.name),1),e("p",Yi,v(de.value.description),1)]),e("div",null,[r[17]||(r[17]=e("h4",{class:"text-sm font-semibold text-slate-400 mb-2"},"ÐžÑÐ¾Ð±ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸:",-1)),e("div",qi,[(s(!0),l(K,null,oe(de.value.traits,t=>(s(),l("span",{key:t,class:"px-2 py-1 rounded text-xs bg-sky-500/20 text-sky-300"},v(t),1))),128))])])])):T("",!0),u.value===3&&xe.value?(s(),l("div",Xi,[e("div",null,[e("h3",Bi,v(xe.value.name),1),e("p",Oi,v(xe.value.description),1)])])):T("",!0),u.value===4&&n.value.class?(s(),l("div",Li,[c(ce).find(t=>t.id===n.value.class)?(s(),l("div",zi,[e("div",Ni,[e("div",Wi,[e("div",null,[e("h3",Ui,v(c(ce).find(t=>t.id===n.value.class).name[n.value.gender]),1),e("p",Fi,v(c(ce).find(t=>t.id===n.value.class).nameEn),1)]),e("img",{src:c(Ot)(n.value.class),alt:c(ce).find(t=>t.id===n.value.class).name[n.value.gender],class:"w-full aspect-square object-cover rounded-lg border-2 border-slate-700"},null,8,Hi)]),e("div",Gi,[w($n,{stats:m.value.stats,size:360,onSwapStats:r[9]||(r[9]=t=>{var j;return(j=f.value)==null?void 0:j.swapStats()})},null,8,["stats"])])]),e("div",Ii,[e("div",Ji,[r[19]||(r[19]=as('<div class="flex-1 text-sm text-slate-400 leading-relaxed min-w-[280px]" data-v-9fdd3093><p class="font-semibold text-slate-300 mb-2" data-v-9fdd3093>ÐšÐ°Ðº Ñ€Ð°ÑÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÑŽÑ‚ÑÑ Ð±Ð¾Ð½ÑƒÑÑ‹ Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð¾Ðº:</p><p class="mb-2" data-v-9fdd3093> ÐšÐ°Ð¶Ð´Ð°Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÐ²ÑÐ·Ð°Ð½Ð° Ñ Ð°ÑÐ¿ÐµÐºÑ‚Ð¾Ð¼ Ð¸ Ð¸Ð¼ÐµÐµÑ‚ ÑÐ¾ÑÐµÐ´Ð½Ð¸Ðµ Ð°ÑÐ¿ÐµÐºÑ‚Ñ‹. Ð‘Ð¾Ð½ÑƒÑ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ Ñ€Ð°Ð²ÐµÐ½ Ð¼Ð°ÐºÑÐ¸Ð¼ÑƒÐ¼Ñƒ Ð¸Ð· Ð´Ð²ÑƒÑ… Ñ„Ð¾Ñ€Ð¼ÑƒÐ»: </p><ul class="list-disc list-inside space-y-1 ml-2" data-v-9fdd3093><li data-v-9fdd3093><span class="font-mono text-sky-300" data-v-9fdd3093>ÐžÑÐ½Ð¾Ð²Ð½Ð¾Ð¹</span>: Ð¿Ð¾Ð»Ð½Ð¾Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð°ÑÐ¿ÐµÐºÑ‚Ð° + Ð¿Ð¾Ð»Ð¾Ð²Ð¸Ð½Ð° (Ð¾ÐºÑ€ÑƒÐ³Ð»Ñ‘Ð½Ð½Ð°Ñ Ð²Ð½Ð¸Ð·) ÐºÐ°Ð¶Ð´Ð¾Ð³Ð¾ ÑÐ¾ÑÐµÐ´Ð½ÐµÐ³Ð¾</li><li data-v-9fdd3093><span class="font-mono text-purple-300" data-v-9fdd3093>ÐÐ»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð½Ñ‹Ð¹</span>: Ð¿Ð¾Ð»Ð¾Ð²Ð¸Ð½Ð° (Ð¾ÐºÑ€ÑƒÐ³Ð»Ñ‘Ð½Ð½Ð°Ñ Ð²Ð½Ð¸Ð·) Ð¿Ñ€Ð¾Ñ‚Ð¸Ð²Ð¾Ð¿Ð¾Ð»Ð¾Ð¶Ð½Ð¾Ð³Ð¾ Ð°ÑÐ¿ÐµÐºÑ‚Ð°</li></ul></div>',1)),e("button",{onClick:r[10]||(r[10]=t=>{var j;return(j=f.value)==null?void 0:j.swapStats()}),class:"flex-shrink-0 flex items-center gap-2 px-4 py-2.5 rounded-lg bg-slate-700/50 hover:bg-slate-700 border border-slate-600/50 text-slate-300 transition"},[w(c(A),{icon:"mdi:swap-horizontal",class:"w-5 h-5"}),r[18]||(r[18]=e("span",{class:"text-sm font-medium"},"ÐŸÐ¾Ð¼ÐµÐ½ÑÑ‚ÑŒ 6 â†” 4",-1))])])]),(I=c(ce).find(t=>t.id===n.value.class))!=null&&I.description?(s(),l("div",Zi,[e("p",Qi,v(c(ce).find(t=>t.id===n.value.class).description),1)])):T("",!0),w(sn,{"class-id":n.value.class,modelValue:m.value,"onUpdate:modelValue":r[11]||(r[11]=t=>m.value=t),ref_key:"statsAndSkillsRef",ref:f,"show-stats":!1,"show-skills":!0},null,8,["class-id","modelValue"])])):T("",!0)])):T("",!0),u.value===5?(s(),l("div",Ki,[w(ta,{modelValue:n.value.equipment,"onUpdate:modelValue":r[12]||(r[12]=t=>n.value.equipment=t),onValidationChange:r[13]||(r[13]=t=>a.value=t)},null,8,["modelValue"])])):T("",!0),u.value===6?(s(),l("div",ec,[w(xa,{name:n.value.name,portrait:n.value.portrait,"onUpdate:name":r[14]||(r[14]=t=>c(_).setName(t)),"onUpdate:portrait":r[15]||(r[15]=t=>c(_).setPortrait(t))},null,8,["name","portrait"])])):T("",!0)])],544),e("div",tc,[u.value<Wt?(s(),l("button",{key:0,type:"button",class:Z(["flex-1 px-4 py-2 rounded-lg font-semibold transition",De.value?"bg-sky-500/20 border border-sky-400/60 text-sky-100 hover:bg-sky-500/30":"bg-slate-800 border border-slate-700 text-slate-500 cursor-not-allowed"]),disabled:!De.value,onClick:Te},v(u.value===2?"ÐŸÐ¾Ð´Ñ‚Ð²ÐµÑ€Ð´Ð¸Ñ‚ÑŒ Ñ€Ð°ÑÑƒ":u.value===3?"ÐŸÐ¾Ð´Ñ‚Ð²ÐµÑ€Ð´Ð¸Ñ‚ÑŒ Ð¿Ð¾Ð´Ñ€Ð°ÑÑƒ":u.value===4?"ÐŸÐ¾Ð´Ñ‚Ð²ÐµÑ€Ð´Ð¸Ñ‚ÑŒ ÐºÐ»Ð°ÑÑ":u.value===5?"ÐŸÐ¾Ð´Ñ‚Ð²ÐµÑ€Ð´Ð¸Ñ‚ÑŒ ÑÐ½Ð°Ñ€ÑÐ¶ÐµÐ½Ð¸Ðµ":u.value===6?"Ð—Ð°Ð²ÐµÑ€ÑˆÐ¸Ñ‚ÑŒ":"Ð”Ð°Ð»ÐµÐµ"),11,sc)):(s(),l("button",{key:1,type:"button",class:"flex-1 px-4 py-2 rounded-lg bg-emerald-500/20 border border-emerald-400/60 text-emerald-100 font-semibold hover:bg-emerald-500/30 transition",disabled:!De.value,onClick:i}," Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð° ",8,lc))])],2)])}}},ac=Re(oc,[["__scopeId","data-v-9fdd3093"]]),ic={__name:"CharacterWizard",props:{constraints:{type:Object,default:null},inviteId:{type:String,default:null}},emits:["close","created"],setup(k,{emit:ee}){const C=ee,x=Tt(),_=Zt(),u=At(),n=$=>{const O=$.portrait?Mt($.portrait):is($.name||"Unknown"),d=$.equipment||{},N=d.weapons||[],W=[{name:"ÐÐ°Ð±Ð¾Ñ€ 1",weapons:N.slice(0,2)},{name:"ÐÐ°Ð±Ð¾Ñ€ 2",weapons:[]}],U=N.slice(2),R=us($.stats||{}),H=_.createFromWizard(x.userId,x.nickname,{name:$.name||"Ð‘ÐµÐ·Ñ‹Ð¼ÑÐ½Ð½Ñ‹Ð¹",portrait:$.portrait,gender:$.gender,race:$.race,subrace:$.subrace,class:$.class,avatar:O,stats:$.stats,skills:$.skills,equipment:{armor:d.armor||"clothes",weaponSets:W,activeSetIndex:0,wealth:d.wealth||5,epoch:d.epoch||10},inventory:U,combat:{hp:R,maxHp:R,mp:0,maxMp:0}});setTimeout(()=>{u.sendCharactersToMaster()},100),C("created",H),C("close")},b=()=>{x.closeCharacterWizard(),C("close")};return($,O)=>(s(),Ye(ac,{constraints:k.constraints,onClose:b,onCreated:n},null,8,["constraints"]))}},cc={class:"profile-setup-modal"},rc={class:"form-section"},uc={class:"form-section"},dc={class:"icons-grid"},vc=["onClick","title"],hc={class:"icon-emoji"},pc={key:0,class:"taken-badge"},mc={class:"form-section"},fc={class:"colors-grid"},gc=["onClick","title"],yc={key:0,class:"taken-x"},xc={key:0,class:"preview-section"},kc={class:"preview-emoji"},bc={class:"preview-name"},_c={class:"modal-actions"},$c=["disabled"],wc={__name:"PlayerProfileSetup",props:{takenIcons:{type:Array,default:()=>[]}},emits:["complete","cancel"],setup(k,{emit:ee}){const C=k,x=ee,_=Tt(),{nickname:u,playerIcon:n,playerColor:b}=Ut(_),$=D(u.value||""),O=D(n.value||null),d=D(b.value||null);Me(()=>u.value,h=>{!$.value&&h&&($.value=h)},{immediate:!0});const N=V(()=>Lt.icons),W=V(()=>Lt.colors),U=(h,X)=>C.takenIcons.some(q=>q.iconId===h&&q.colorId===X),R=(h,X)=>{const q=C.takenIcons.find(E=>E.iconId===h&&E.colorId===X);return(q==null?void 0:q.playerName)||null},H=V(()=>N.value.find(h=>h.id===O.value)),Q=V(()=>W.value.find(h=>h.id===d.value)),te=V(()=>!(!$.value.trim()||!O.value||!d.value||U(O.value,d.value))),P=h=>{O.value=h},Y=h=>{O.value&&U(O.value,h)||(d.value=h)},p=()=>{te.value&&(_.setFullProfile({nickname:$.value.trim(),playerIcon:O.value,playerColor:d.value}),x("complete",{nickname:$.value.trim(),iconId:O.value,colorId:d.value}))},g=()=>{x("cancel")};return(h,X)=>(s(),l("div",{class:"profile-setup-overlay",onClick:Pe(g,["self"])},[e("div",cc,[X[5]||(X[5]=e("div",{class:"modal-header"},[e("h2",{class:"modal-title"},"ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ñ"),e("p",{class:"modal-subtitle"},"Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð¸Ð¼Ñ, Ð¸ÐºÐ¾Ð½ÐºÑƒ Ð¸ Ñ†Ð²ÐµÑ‚ Ð´Ð»Ñ Ð¸Ð³Ñ€Ñ‹")],-1)),e("div",rc,[X[1]||(X[1]=e("label",{class:"section-label"},"Ð’Ð°ÑˆÐµ Ð¸Ð¼Ñ",-1)),Gt(e("input",{"onUpdate:modelValue":X[0]||(X[0]=q=>$.value=q),type:"text",placeholder:"Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð¸Ð¼Ñ...",class:"name-input",maxlength:"20"},null,512),[[It,$.value]])]),e("div",uc,[X[2]||(X[2]=e("label",{class:"section-label"},"Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ñ„Ð¸Ð³ÑƒÑ€ÐºÑƒ",-1)),e("div",dc,[(s(!0),l(K,null,oe(N.value,q=>{var E;return s(),l("button",{key:q.id,class:Z(["icon-option",{selected:O.value===q.id,taken:d.value&&U(q.id,d.value)}]),onClick:y=>P(q.id),title:q.name},[e("span",hc,v(q.emoji),1),d.value&&U(q.id,d.value)?(s(),l("span",pc,v(((E=R(q.id,d.value))==null?void 0:E.slice(0,1))||"?"),1)):T("",!0)],10,vc)}),128))])]),e("div",mc,[X[3]||(X[3]=e("label",{class:"section-label"},"Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ñ†Ð²ÐµÑ‚",-1)),e("div",fc,[(s(!0),l(K,null,oe(W.value,q=>(s(),l("button",{key:q.id,class:Z(["color-option",{selected:d.value===q.id,taken:O.value&&U(O.value,q.id)}]),style:ve({backgroundColor:q.value}),onClick:E=>Y(q.id),title:O.value&&U(O.value,q.id)?`Ð—Ð°Ð½ÑÑ‚Ð¾: ${R(O.value,q.id)}`:q.name},[O.value&&U(O.value,q.id)?(s(),l("span",yc,"âœ•")):T("",!0)],14,gc))),128))])]),H.value&&Q.value?(s(),l("div",xc,[X[4]||(X[4]=e("div",{class:"preview-label"},"Ð’Ð°ÑˆÐ° Ñ„Ð¸Ð³ÑƒÑ€ÐºÐ°:",-1)),e("div",{class:"preview-icon",style:ve({color:Q.value.value})},[e("span",kc,v(H.value.emoji),1),e("span",bc,v($.value||"Ð˜Ð³Ñ€Ð¾Ðº"),1)],4)])):T("",!0),e("div",_c,[e("button",{type:"button",class:"btn-cancel",onClick:g}," ÐžÑ‚Ð¼ÐµÐ½Ð° "),e("button",{type:"button",class:"btn-save",disabled:!te.value,onClick:p}," ÐÐ°Ñ‡Ð°Ñ‚ÑŒ Ð¸Ð³Ñ€Ñƒ ",8,$c)])])]))}},Cc=Re(wc,[["__scopeId","data-v-e0b58fd9"]]),Sc={class:"h-screen bg-slate-950 text-slate-50 flex flex-col overflow-hidden"},Mc={key:0,class:"flex-1 flex items-center justify-center"},Tc={key:1,class:"flex-1 flex items-center justify-center"},Ac={class:"text-center"},Pc={class:"text-rose-400 mb-4"},Ec={key:0,class:"character-creator-modal"},Rc={__name:"PlayerRoom",setup(k){const ee=cs(),C=rs(),x=Oe(At,"session"),_=Oe(Tt,"user"),u=Oe(Zt,"characters"),n=Oe(ds,"battleMap"),b=Oe(vs,"sceneLog"),$=Oe(ys,"terrain"),O=Oe($s,"pointer"),{roomId:d=D(""),status:N=D(""),connections:W=D([])}=$t(x,"session"),{nickname:U=D(""),avatar:R=D(null),currentView:H=D("")}=$t(_,"user"),{characters:Q=D([])}=$t(u,"characters");V(()=>N.value==="in-room"||N.value==="ready"),V(()=>N.value==="connecting"?"ÐŸÐ¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ...":N.value==="in-room"?"â— ÐŸÐ¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¾":N.value==="error"?"â—‹ ÐžÑˆÐ¸Ð±ÐºÐ°":"â—‹ ÐžÑ‚ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¾"),V(()=>N.value==="in-room"?"bg-emerald-500/20 text-emerald-400":N.value==="connecting"?"bg-amber-500/20 text-amber-400":"bg-rose-500/20 text-rose-400");const te=D("battle-map"),P=D(!0),Y=D(""),p=D(zt()),g=D(null),h=D(!1),X=V(()=>(x.allPlayers||[]).filter(B=>B.id!==_.userId&&B.playerIcon&&B.playerColor).map(B=>({iconId:B.playerIcon,colorId:B.playerColor,playerName:B.name||"Ð˜Ð³Ñ€Ð¾Ðº"}))),q=D(!1),E=D(null),y=D(null),S=D(null),L=D(null),J=V(()=>{if(!F.value)return 0;const i=n.activeMapId;if(!i)return 0;const B=n.findTokenPosition(i,F.value.id);return(B==null?void 0:B.facing)||0}),ie=V(()=>{if(!F.value)return null;const i=n.activeMapId;return i?n.findTokenPosition(i,F.value.id):null}),f=V(()=>n.activeMap),m=V(()=>f.value?new hs({orientation:f.value.orientation||"flat",hexSize:f.value.hexSize||32}):null),{moveToken:a}=ks({battleMapStore:n,terrainStore:$,getHexGrid:()=>m.value}),F=V(()=>{const i=_.userId;console.log("ÐŸÐ¾Ð¸ÑÐº Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð° Ð¸Ð³Ñ€Ð¾ÐºÐ°:",{userId:i,characters:Q.value.length});const B=Q.value.find(z=>z.ownerId===i);return console.log("ÐÐ°Ð¹Ð´ÐµÐ½Ð½Ñ‹Ð¹ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶:",B),B}),se=D(null),ue=V(()=>!0);Jt(async()=>{const i=ee.params.roomId;if(!i){C.push("/");return}p.value&&fs(),_.isProfileComplete||(h.value=!0);try{x.joinRoom(i),P.value=!1,bt()}catch{Y.value="ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒÑÑ Ðº ÐºÐ¾Ð¼Ð½Ð°Ñ‚Ðµ",P.value=!1}const B=()=>{p.value=zt()};window.addEventListener("resize",B),Xt(()=>{window.removeEventListener("resize",B)})}),Xt(()=>{x.leaveRoom()});const ce=i=>{te.value=i},de=()=>{x.leaveRoom(),C.push("/")},xe=i=>{h.value=!1},pe=()=>{h.value=!1},He=i=>{g.value={id:i.id,title:i.label,description:tt(i.id),icon:i.icon,canConfirm:!1}},qe=()=>{g.value&&g.value.target&&(console.log("Ð’Ñ‹Ð¿Ð¾Ð»Ð½ÑÐµÐ¼ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ:",g.value.id,"Ñ†ÐµÐ»ÑŒ:",g.value.target),g.value.id==="move"&&g.value.target.type==="hex"?Se(g.value.target.hex):g.value.id==="attack"&&g.value.target.characterId&&ge(g.value.target),g.value=null)},De=(i=null)=>{const B=n.activeMapId;if(!B)return()=>null;const z=new Set;if(i){const le=i.movementModifiers||i.abilities||{};le.flight&&z.add("flight"),le.swimming&&z.add("swimming"),le.phasing&&z.add("phasing"),le.climbing&&z.add("climbing"),i.movementTags&&i.movementTags.forEach(ke=>z.add(ke))}return(le,ke)=>n.getHexPathfindingData(B,le,ke,$,{viewerId:i==null?void 0:i.id,characterTags:z})},G=i=>{var Xe,je;if(!i){O.hideMovementRange();return}const B=n.activeMapId;if(!B)return;const z=n.findTokenPosition(B,i.id);if(!z)return;let le=u.getAvailableMovement(i.id);if(le===0&&(le=((je=(Xe=i.combat)==null?void 0:Xe.movement)==null?void 0:je.current)??5),le<=0){O.hideMovementRange();return}const ke=De(i),at=bs({q:z.q,r:z.r},le,ke,{modifiers:i.movementModifiers||{}}),ze=_s(at);O.showMovementRange(i.id,{q:z.q,r:z.r},ze,le)},Se=(i,B=null)=>{var Xe;const z=F.value;if(!z){console.warn("ÐŸÐµÑ€ÑÐ¾Ð½Ð°Ð¶ Ð¸Ð³Ñ€Ð¾ÐºÐ° Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½");return}const le=n.activeMapId;if(!le){console.warn("ÐÐµÑ‚ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾Ð¹ ÐºÐ°Ñ€Ñ‚Ñ‹ Ð´Ð»Ñ Ð¿ÐµÑ€ÐµÐ¼ÐµÑ‰ÐµÐ½Ð¸Ñ");return}const ke=n.findTokenPosition(le,z.id);if(ke){const je=De(z),it=xs({q:ke.q,r:ke.r},{q:i.q,r:i.r},je,{modifiers:z.movementModifiers||{}});if(!it.found){console.warn("ÐŸÑƒÑ‚ÑŒ Ð´Ð¾ Ñ†ÐµÐ»ÐµÐ²Ð¾Ð³Ð¾ Ð³ÐµÐºÑÐ° Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½");return}const Te=it.totalCost,Ge=u.getAvailableMovement(z.id);if(console.log(`ÐŸÐµÑ€ÐµÐ¼ÐµÑ‰ÐµÐ½Ð¸Ðµ: ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ ${Te}, Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ ${Ge}`),Te>Ge){console.warn(`ÐÐµÐ´Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ñ‡Ð½Ð¾ Ð¾Ñ‡ÐºÐ¾Ð² Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ñ: Ð½ÑƒÐ¶Ð½Ð¾ ${Te}, ÐµÑÑ‚ÑŒ ${Ge}`);return}if(!u.spendMovement(z.id,Te)){console.warn("ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ ÑÐ¿Ð¸ÑÐ°Ñ‚ÑŒ Ð¾Ñ‡ÐºÐ¸ Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ñ");return}console.log(`ÐŸÐ¾Ñ‚Ñ€Ð°Ñ‡ÐµÐ½Ð¾ ${Te} ÐžÐ”, Ð¾ÑÑ‚Ð°Ð»Ð¾ÑÑŒ ${u.getAvailableMovement(z.id)}`);const ct=x.role==="player"&&x.status==="in-room",rt=a({characterId:z.id,targetHex:i,facing:B,pathfindingOptions:{modifiers:z.movementModifiers||{}},onBeforeAnimate:({characterId:Ne,path:o,duration:r,facing:M})=>{ct&&(console.log("ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ Ð°Ð½Ð¸Ð¼Ð°Ñ†Ð¸ÑŽ Ð¼Ð°ÑÑ‚ÐµÑ€Ñƒ Ð´Ð»Ñ ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð¸Ð·Ð°Ñ†Ð¸Ð¸..."),x.broadcastTokenAnimation(Ne,o,r,M))},onComplete:({finalFacing:Ne,targetHex:o})=>{var r;console.log("ÐÐ½Ð¸Ð¼Ð°Ñ†Ð¸Ñ Ð¿ÐµÑ€ÐµÐ¼ÐµÑ‰ÐµÐ½Ð¸Ñ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð°"),(r=z.combat)!=null&&r.position?u.moveOnMap(z.id,o.q,o.r):u.placeOnMap(z.id,le,o.q,o.r),G(z),ct&&(console.log("ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ Ñ„Ð¸Ð½Ð°Ð»ÑŒÐ½ÑƒÑŽ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸ÑŽ Ð¼Ð°ÑÑ‚ÐµÑ€Ñƒ, facing:",Ne),x.broadcastCharacterMove(z.id,o.q,o.r,Ne))}});rt.success||console.warn("ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿ÐµÑ€ÐµÐ¼ÐµÑ‰ÐµÐ½Ð¸Ñ:",rt.error);return}if(console.log(`Ð Ð°Ð·Ð¼ÐµÑ‰Ð°ÐµÐ¼ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð° ${z.name} Ð½Ð° Ð³ÐµÐºÑ q:${i.q}, r:${i.r}, facing:${B}`),n.placeToken(le,z.id,i.q,i.r,B||0))console.log("Ð¢Ð¾ÐºÐµÐ½ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ñ€Ð°Ð·Ð¼ÐµÑ‰ÐµÐ½ Ð½Ð° ÐºÐ°Ñ€Ñ‚Ðµ");else{console.warn("ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ñ€Ð°Ð·Ð¼ÐµÑÑ‚Ð¸Ñ‚ÑŒ Ñ‚Ð¾ÐºÐµÐ½ Ð½Ð° ÐºÐ°Ñ€Ñ‚Ðµ. Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ Ð³ÐµÐºÑ Ð·Ð°Ð½ÑÑ‚.");return}(Xe=z.combat)!=null&&Xe.position?u.moveOnMap(z.id,i.q,i.r):u.placeOnMap(z.id,le,i.q,i.r),G(z);const ze=x.role==="player"&&x.status==="in-room";console.log("ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÐµÑÑÐ¸Ð¸ Ð´Ð»Ñ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¸:",{role:x.role,status:x.status,isConnectedToMaster:ze}),ze&&(console.log("ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ Ð¿ÐµÑ€ÐµÐ¼ÐµÑ‰ÐµÐ½Ð¸Ðµ Ð¼Ð°ÑÑ‚ÐµÑ€Ñƒ..."),x.broadcastCharacterMove(z.id,i.q,i.r,B))},ge=i=>{console.log("ÐÑ‚Ð°ÐºÑƒÐµÐ¼ Ñ†ÐµÐ»ÑŒ:",i.characterId)},Ke=i=>{var B;g.value&&(g.value.target=i,g.value.canConfirm=!0,i.type==="hex"?g.value.description=`ÐŸÐµÑ€ÐµÐ¼ÐµÑÑ‚Ð¸Ñ‚ÑŒÑÑ Ð½Ð° Ð³ÐµÐºÑ (${i.hex.q}, ${i.hex.r})`:i.characterId&&(g.value.description=`Ð¦ÐµÐ»ÑŒ: ${((B=i.character)==null?void 0:B.name)||"ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ñ‹Ð¹"}`))},et=()=>{g.value=null},tt=i=>({move:"Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð¼ÐµÑÑ‚Ð¾ Ð´Ð»Ñ Ð¿ÐµÑ€ÐµÐ¼ÐµÑ‰ÐµÐ½Ð¸Ñ",attack:"Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ñ†ÐµÐ»ÑŒ Ð´Ð»Ñ Ð°Ñ‚Ð°ÐºÐ¸",defend:"Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ ÑÐµÐºÑ‚Ð¾Ñ€ Ð·Ð°Ñ‰Ð¸Ñ‚Ñ‹",skill:"Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð½Ð°Ð²Ñ‹Ðº Ð¸ Ñ†ÐµÐ»ÑŒ",ready:"Ð¡Ð¸Ð³Ð½Ð°Ð»Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¾ Ð³Ð¾Ñ‚Ð¾Ð²Ð½Ð¾ÑÑ‚Ð¸",help:"ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ ÑÐ¿Ñ€Ð°Ð²ÐºÑƒ"})[i]||"Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ",Ve=i=>{y.value=i,i&&(S.value=null)},st=i=>{S.value=i},ht=i=>{i&&(console.log("ÐŸÐµÑ€ÐµÐ¼ÐµÑ‰ÐµÐ½Ð¸Ðµ Ð½Ð° Ð³ÐµÐºÑ Ð¸Ð· Ð¸Ð½Ñ„Ð¾ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ¸:",i),Se(i),S.value=null)},Le=i=>{if(!i||!ue.value)return;const B={q:i.q,r:i.r},z=i.facing??null;console.log("Ð”Ð²Ð¾Ð¹Ð½Ð¾Ð¹ Ñ‚Ð°Ð¿ Ð¿Ð¾ Ð³ÐµÐºÑÑƒ - Ð¿ÐµÑ€ÐµÐ¼ÐµÑ‰ÐµÐ½Ð¸Ðµ:",B,"facing:",z),Se(B,z),S.value=null},lt=i=>{i!=null&&i.hex&&ue.value&&(console.log("Long press move - Ð¿ÐµÑ€ÐµÐ¼ÐµÑ‰ÐµÐ½Ð¸Ðµ Ñ Ð²Ñ‹Ð±Ð¾Ñ€Ð¾Ð¼ Ð½Ð°Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ:",i),Se(i.hex,i.facing))},pt=i=>{if(!(i!=null&&i.hex)||!ue.value)return;console.log("Long press confirm - Ñ„Ð¸Ð½Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð½Ð°Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ:",i);const B=F.value;if(!B)return;const z=n.activeMapId;if(!z)return;const le=n.findTokenPosition(z,B.id);le&&(n.rotateToken(z,le.q,le.r,i.facing),console.log(`ÐÐ°Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð° Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¾ Ð½Ð° ${i.facing}`),x.role==="player"&&x.status==="in-room"&&x.broadcastCharacterMove(B.id,le.q,le.r,i.facing)),S.value=null},mt=i=>{if(!i||!ue.value)return;console.log("Token rotate - Ð¿Ð¾Ð²Ð¾Ñ€Ð¾Ñ‚ Ð½Ð° Ð¼ÐµÑÑ‚Ðµ:",i);const B=F.value;if(!B)return;const z=n.activeMapId;if(!z)return;const le=n.findTokenPosition(z,B.id);le&&(n.rotateToken(z,le.q,le.r,i.facing),console.log(`ÐÐ°Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð° Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¾ Ð½Ð° ${i.facing}`),x.role==="player"&&x.status==="in-room"&&x.broadcastCharacterMove(B.id,le.q,le.r,i.facing))},ft=()=>{console.log("Ð¡Ð¼ÐµÐ½Ð° ÑÐ½Ð°Ñ€ÑÐ¶ÐµÐ½Ð¸Ñ")},gt=i=>{i&&u.setActiveCharacter(i),ce("character-sheet")},nt=i=>{console.log("Ð˜Ð³Ñ€Ð¾Ðº Ð¿Ñ€Ð¸Ð½ÑÐ» Ñ€ÐµÐ°ÐºÑ†Ð¸ÑŽ:",i),x.status==="in-room"&&x.sendReactionResponse(i,!0),L.value=null},yt=i=>{console.log("Ð˜Ð³Ñ€Ð¾Ðº Ð¾Ñ‚ÐºÐ»Ð¾Ð½Ð¸Ð» Ñ€ÐµÐ°ÐºÑ†Ð¸ÑŽ:",i),x.status==="in-room"&&x.sendReactionResponse(i,!1),L.value=null},xt=i=>{E.value=i||null,q.value=!0},ot=()=>{q.value=!1,E.value=null},kt=i=>{var B;if(console.log("ÐŸÐµÑ€ÑÐ¾Ð½Ð°Ð¶ ÑÐ¾Ð·Ð´Ð°Ð½:",i),(B=E.value)!=null&&B.inviteId&&i){const z=E.value.inviteId;b.markInviteUsed(z,{userId:_.userId,characterId:i.id,characterName:i.name,characterPortrait:i.portrait}),x.sendInviteUsed(z,{userId:_.userId,characterId:i.id,characterName:i.name,characterPortrait:i.portrait})}ot()},bt=()=>{x.onMessage("reaction-prompt",i=>{console.log("ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¾ Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ Ñ€ÐµÐ°ÐºÑ†Ð¸Ð¸:",i),L.value={id:i.id,title:i.title||"Ð ÐµÐ°ÐºÑ†Ð¸Ñ!",description:i.description||"ÐœÐ¾Ð¶ÐµÑ‚Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ñ€ÐµÐ°ÐºÑ†Ð¸ÑŽ",timeoutSeconds:i.timeoutSeconds||5,startedAt:Date.now()}}),x.onMessage("scene-event",i=>{console.log("ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¾ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ðµ ÑÑ†ÐµÐ½Ñ‹:",i),i.event&&b.handleIncomingEvent(i.event)}),x.onMessage("scene-sync",i=>{var B;console.log("ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð° ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð¸Ð·Ð°Ñ†Ð¸Ñ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹ ÑÑ†ÐµÐ½Ñ‹:",((B=i.events)==null?void 0:B.length)||0,"ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹"),i.events&&Array.isArray(i.events)&&b.syncEvents(i.events),i.currentImage&&b.setSceneImage(i.currentImage.url,i.currentImage.description,i.currentImage.sentBy)}),x.onMessage("scene-event-hide",i=>{console.log("ÐœÐ°ÑÑ‚ÐµÑ€ ÑÐºÑ€Ñ‹Ð» ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ðµ:",i.eventId),i.eventId&&b.removeEvent(i.eventId)})};return(i,B)=>{var z,le;return s(),l("div",Sc,[P.value?(s(),l("div",Mc,[...B[1]||(B[1]=[e("div",{class:"text-center"},[e("div",{class:"animate-spin text-4xl mb-4"},"â³"),e("p",{class:"text-slate-400"},"ÐŸÐ¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ðº ÐºÐ¾Ð¼Ð½Ð°Ñ‚Ðµ...")],-1)])])):Y.value?(s(),l("div",Tc,[e("div",Ac,[B[2]||(B[2]=e("div",{class:"text-4xl mb-4"},"ðŸ˜”",-1)),e("p",Pc,v(Y.value),1),e("button",{type:"button",class:"px-4 py-2 bg-sky-500 text-white rounded-lg hover:bg-sky-600 transition",onClick:B[0]||(B[0]=ke=>c(C).push("/"))}," Ð’ÐµÑ€Ð½ÑƒÑ‚ÑŒÑÑ ")])])):(s(),l(K,{key:2},[w(gs,{character:F.value,characters:c(Q),"selected-token":y.value,"selected-hex":S.value,"player-facing":J.value,"player-token-position":ie.value,"is-master":!1,"connection-status":c(N),"current-turn":se.value,"is-player-turn":ue.value,"pending-action":g.value,"reaction-prompt":L.value,onSetView:ce,onLeaveRoom:de,onSelectAction:He,onConfirmAction:qe,onCancelAction:et,onSwitchEquipment:ft,onReactionAccept:nt,onReactionDecline:yt,onOpenCharacterSheet:gt,onMoveToHex:ht,onTokenSelected:Ve,onHexSelected:st,onHexDoubleTap:Le,onHexLongPressMove:lt,onHexLongPressConfirm:pt,onTokenRotate:mt,onActionTargetSelected:Ke,onCreateCharacter:xt},null,8,["character","characters","selected-token","selected-hex","player-facing","player-token-position","connection-status","current-turn","is-player-turn","pending-action","reaction-prompt"]),(s(),Ye(Ct,{to:"body"},[q.value?(s(),l("div",Ec,[w(ic,{constraints:(z=E.value)==null?void 0:z.constraints,"invite-id":(le=E.value)==null?void 0:le.inviteId,onClose:ot,onCreated:kt},null,8,["constraints","invite-id"])])):T("",!0)])),(s(),Ye(Ct,{to:"body"},[h.value?(s(),Ye(Cc,{key:0,"taken-icons":X.value,onComplete:xe,onCancel:pe},null,8,["taken-icons"])):T("",!0)]))],64)),w(Ns)])}}},Lc=Re(Rc,[["__scopeId","data-v-207516d1"]]);export{Lc as default};

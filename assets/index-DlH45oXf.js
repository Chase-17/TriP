const __vite__fileDeps=["assets/WikiView-olZNx_wq.js","assets/WikiView-yA9WAXzX.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();/**
* @vue/shared v3.4.31
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function mh(i,e){const t=new Set(i.split(","));return r=>t.has(r)}const St={},Us=[],ki=()=>{},M_=()=>!1,Uc=i=>i.charCodeAt(0)===111&&i.charCodeAt(1)===110&&(i.charCodeAt(2)>122||i.charCodeAt(2)<97),gh=i=>i.startsWith("onUpdate:"),Pt=Object.assign,vh=(i,e)=>{const t=i.indexOf(e);t>-1&&i.splice(t,1)},E_=Object.prototype.hasOwnProperty,dt=(i,e)=>E_.call(i,e),Ue=Array.isArray,js=i=>Da(i)==="[object Map]",ao=i=>Da(i)==="[object Set]",Yf=i=>Da(i)==="[object Date]",Ye=i=>typeof i=="function",kt=i=>typeof i=="string",nr=i=>typeof i=="symbol",bt=i=>i!==null&&typeof i=="object",L0=i=>(bt(i)||Ye(i))&&Ye(i.then)&&Ye(i.catch),D0=Object.prototype.toString,Da=i=>D0.call(i),k_=i=>Da(i).slice(8,-1),P0=i=>Da(i)==="[object Object]",bh=i=>kt(i)&&i!=="NaN"&&i[0]!=="-"&&""+parseInt(i,10)===i,jo=mh(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),jc=i=>{const e=Object.create(null);return t=>e[t]||(e[t]=i(t))},C_=/-(\w)/g,sr=jc(i=>i.replace(C_,(e,t)=>t?t.toUpperCase():"")),T_=/\B([A-Z])/g,hs=jc(i=>i.replace(T_,"-$1").toLowerCase()),Wc=jc(i=>i.charAt(0).toUpperCase()+i.slice(1)),_d=jc(i=>i?`on${Wc(i)}`:""),bn=(i,e)=>!Object.is(i,e),$l=(i,...e)=>{for(let t=0;t<i.length;t++)i[t](...e)},R0=(i,e,t,r=!1)=>{Object.defineProperty(i,e,{configurable:!0,enumerable:!1,writable:r,value:t})},tc=i=>{const e=parseFloat(i);return isNaN(e)?i:e},A_=i=>{const e=kt(i)?Number(i):NaN;return isNaN(e)?i:e};let Xf;const I0=()=>Xf||(Xf=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Ut(i){if(Ue(i)){const e={};for(let t=0;t<i.length;t++){const r=i[t],n=kt(r)?R_(r):Ut(r);if(n)for(const s in n)e[s]=n[s]}return e}else if(kt(i)||bt(i))return i}const L_=/;(?![^(]*\))/g,D_=/:([^]+)/,P_=/\/\*[^]*?\*\//g;function R_(i){const e={};return i.replace(P_,"").split(L_).forEach(t=>{if(t){const r=t.split(D_);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function Se(i){let e="";if(kt(i))e=i;else if(Ue(i))for(let t=0;t<i.length;t++){const r=Se(i[t]);r&&(e+=r+" ")}else if(bt(i))for(const t in i)i[t]&&(e+=t+" ");return e.trim()}function yh(i){if(!i)return null;let{class:e,style:t}=i;return e&&!kt(e)&&(i.class=Se(e)),t&&(i.style=Ut(t)),i}const I_="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",O_=mh(I_);function O0(i){return!!i||i===""}function F_(i,e){if(i.length!==e.length)return!1;let t=!0;for(let r=0;t&&r<i.length;r++)t=ss(i[r],e[r]);return t}function ss(i,e){if(i===e)return!0;let t=Yf(i),r=Yf(e);if(t||r)return t&&r?i.getTime()===e.getTime():!1;if(t=nr(i),r=nr(e),t||r)return i===e;if(t=Ue(i),r=Ue(e),t||r)return t&&r?F_(i,e):!1;if(t=bt(i),r=bt(e),t||r){if(!t||!r)return!1;const n=Object.keys(i).length,s=Object.keys(e).length;if(n!==s)return!1;for(const o in i){const a=i.hasOwnProperty(o),l=e.hasOwnProperty(o);if(a&&!l||!a&&l||!ss(i[o],e[o]))return!1}}return String(i)===String(e)}function _h(i,e){return i.findIndex(t=>ss(t,e))}const F0=i=>!!(i&&i.__v_isRef===!0),U=i=>kt(i)?i:i==null?"":Ue(i)||bt(i)&&(i.toString===D0||!Ye(i.toString))?F0(i)?U(i.value):JSON.stringify(i,z0,2):String(i),z0=(i,e)=>F0(e)?z0(i,e.value):js(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[r,n],s)=>(t[wd(r,s)+" =>"]=n,t),{})}:ao(e)?{[`Set(${e.size})`]:[...e.values()].map(t=>wd(t))}:nr(e)?wd(e):bt(e)&&!Ue(e)&&!P0(e)?String(e):e,wd=(i,e="")=>{var t;return nr(i)?`Symbol(${(t=i.description)!=null?t:e})`:i};/**
* @vue/reactivity v3.4.31
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let ui;class z_{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=ui,!e&&ui&&(this.index=(ui.scopes||(ui.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const t=ui;try{return ui=this,e()}finally{ui=t}}}on(){ui=this}off(){ui=this.parent}stop(e){if(this._active){let t,r;for(t=0,r=this.effects.length;t<r;t++)this.effects[t].stop();for(t=0,r=this.cleanups.length;t<r;t++)this.cleanups[t]();if(this.scopes)for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].stop(!0);if(!this.detached&&this.parent&&!e){const n=this.parent.scopes.pop();n&&n!==this&&(this.parent.scopes[this.index]=n,n.index=this.index)}this.parent=void 0,this._active=!1}}}function N_(i,e=ui){e&&e.active&&e.effects.push(i)}function N0(){return ui}function $_(i){ui&&ui.cleanups.push(i)}let Jn;class wh{constructor(e,t,r,n){this.fn=e,this.trigger=t,this.scheduler=r,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,N_(this,n)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,En();for(let e=0;e<this._depsLength;e++){const t=this.deps[e];if(t.computed&&(B_(t.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),kn()}return this._dirtyLevel>=4}set dirty(e){this._dirtyLevel=e?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let e=fn,t=Jn;try{return fn=!0,Jn=this,this._runnings++,Kf(this),this.fn()}finally{Jf(this),this._runnings--,Jn=t,fn=e}}stop(){this.active&&(Kf(this),Jf(this),this.onStop&&this.onStop(),this.active=!1)}}function B_(i){return i.value}function Kf(i){i._trackId++,i._depsLength=0}function Jf(i){if(i.deps.length>i._depsLength){for(let e=i._depsLength;e<i.deps.length;e++)$0(i.deps[e],i);i.deps.length=i._depsLength}}function $0(i,e){const t=i.get(e);t!==void 0&&e._trackId!==t&&(i.delete(e),i.size===0&&i.cleanup())}let fn=!0,Lu=0;const B0=[];function En(){B0.push(fn),fn=!1}function kn(){const i=B0.pop();fn=i===void 0?!0:i}function xh(){Lu++}function Sh(){for(Lu--;!Lu&&Du.length;)Du.shift()()}function V0(i,e,t){if(e.get(i)!==i._trackId){e.set(i,i._trackId);const r=i.deps[i._depsLength];r!==e?(r&&$0(r,i),i.deps[i._depsLength++]=e):i._depsLength++}}const Du=[];function H0(i,e,t){xh();for(const r of i.keys()){let n;r._dirtyLevel<e&&(n??(n=i.get(r)===r._trackId))&&(r._shouldSchedule||(r._shouldSchedule=r._dirtyLevel===0),r._dirtyLevel=e),r._shouldSchedule&&(n??(n=i.get(r)===r._trackId))&&(r.trigger(),(!r._runnings||r.allowRecurse)&&r._dirtyLevel!==2&&(r._shouldSchedule=!1,r.scheduler&&Du.push(r.scheduler)))}Sh()}const U0=(i,e)=>{const t=new Map;return t.cleanup=i,t.computed=e,t},ic=new WeakMap,Zn=Symbol(""),Pu=Symbol("");function ai(i,e,t){if(fn&&Jn){let r=ic.get(i);r||ic.set(i,r=new Map);let n=r.get(t);n||r.set(t,n=U0(()=>r.delete(t))),V0(Jn,n)}}function Tr(i,e,t,r,n,s){const o=ic.get(i);if(!o)return;let a=[];if(e==="clear")a=[...o.values()];else if(t==="length"&&Ue(i)){const l=Number(r);o.forEach((c,d)=>{(d==="length"||!nr(d)&&d>=l)&&a.push(c)})}else switch(t!==void 0&&a.push(o.get(t)),e){case"add":Ue(i)?bh(t)&&a.push(o.get("length")):(a.push(o.get(Zn)),js(i)&&a.push(o.get(Pu)));break;case"delete":Ue(i)||(a.push(o.get(Zn)),js(i)&&a.push(o.get(Pu)));break;case"set":js(i)&&a.push(o.get(Zn));break}xh();for(const l of a)l&&H0(l,4);Sh()}function V_(i,e){const t=ic.get(i);return t&&t.get(e)}const H_=mh("__proto__,__v_isRef,__isVue"),j0=new Set(Object.getOwnPropertyNames(Symbol).filter(i=>i!=="arguments"&&i!=="caller").map(i=>Symbol[i]).filter(nr)),Zf=U_();function U_(){const i={};return["includes","indexOf","lastIndexOf"].forEach(e=>{i[e]=function(...t){const r=ft(this);for(let s=0,o=this.length;s<o;s++)ai(r,"get",s+"");const n=r[e](...t);return n===-1||n===!1?r[e](...t.map(ft)):n}}),["push","pop","shift","unshift","splice"].forEach(e=>{i[e]=function(...t){En(),xh();const r=ft(this)[e].apply(this,t);return Sh(),kn(),r}}),i}function j_(i){nr(i)||(i=String(i));const e=ft(this);return ai(e,"has",i),e.hasOwnProperty(i)}class W0{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,r){const n=this._isReadonly,s=this._isShallow;if(t==="__v_isReactive")return!n;if(t==="__v_isReadonly")return n;if(t==="__v_isShallow")return s;if(t==="__v_raw")return r===(n?s?r1:X0:s?Y0:q0).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(r)?e:void 0;const o=Ue(e);if(!n){if(o&&dt(Zf,t))return Reflect.get(Zf,t,r);if(t==="hasOwnProperty")return j_}const a=Reflect.get(e,t,r);return(nr(t)?j0.has(t):H_(t))||(n||ai(e,"get",t),s)?a:Ht(a)?o&&bh(t)?a:a.value:bt(a)?n?J0(a):lo(a):a}}class G0 extends W0{constructor(e=!1){super(!1,e)}set(e,t,r,n){let s=e[t];if(!this._isShallow){const l=ca(s);if(!rc(r)&&!ca(r)&&(s=ft(s),r=ft(r)),!Ue(e)&&Ht(s)&&!Ht(r))return l?!1:(s.value=r,!0)}const o=Ue(e)&&bh(t)?Number(t)<e.length:dt(e,t),a=Reflect.set(e,t,r,n);return e===ft(n)&&(o?bn(r,s)&&Tr(e,"set",t,r):Tr(e,"add",t,r)),a}deleteProperty(e,t){const r=dt(e,t);e[t];const n=Reflect.deleteProperty(e,t);return n&&r&&Tr(e,"delete",t,void 0),n}has(e,t){const r=Reflect.has(e,t);return(!nr(t)||!j0.has(t))&&ai(e,"has",t),r}ownKeys(e){return ai(e,"iterate",Ue(e)?"length":Zn),Reflect.ownKeys(e)}}class W_ extends W0{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const G_=new G0,q_=new W_,Y_=new G0(!0);const Mh=i=>i,Gc=i=>Reflect.getPrototypeOf(i);function qa(i,e,t=!1,r=!1){i=i.__v_raw;const n=ft(i),s=ft(e);t||(bn(e,s)&&ai(n,"get",e),ai(n,"get",s));const{has:o}=Gc(n),a=r?Mh:t?Ch:da;if(o.call(n,e))return a(i.get(e));if(o.call(n,s))return a(i.get(s));i!==n&&i.get(e)}function Ya(i,e=!1){const t=this.__v_raw,r=ft(t),n=ft(i);return e||(bn(i,n)&&ai(r,"has",i),ai(r,"has",n)),i===n?t.has(i):t.has(i)||t.has(n)}function Xa(i,e=!1){return i=i.__v_raw,!e&&ai(ft(i),"iterate",Zn),Reflect.get(i,"size",i)}function Qf(i){i=ft(i);const e=ft(this);return Gc(e).has.call(e,i)||(e.add(i),Tr(e,"add",i,i)),this}function ep(i,e){e=ft(e);const t=ft(this),{has:r,get:n}=Gc(t);let s=r.call(t,i);s||(i=ft(i),s=r.call(t,i));const o=n.call(t,i);return t.set(i,e),s?bn(e,o)&&Tr(t,"set",i,e):Tr(t,"add",i,e),this}function tp(i){const e=ft(this),{has:t,get:r}=Gc(e);let n=t.call(e,i);n||(i=ft(i),n=t.call(e,i)),r&&r.call(e,i);const s=e.delete(i);return n&&Tr(e,"delete",i,void 0),s}function ip(){const i=ft(this),e=i.size!==0,t=i.clear();return e&&Tr(i,"clear",void 0,void 0),t}function Ka(i,e){return function(r,n){const s=this,o=s.__v_raw,a=ft(o),l=e?Mh:i?Ch:da;return!i&&ai(a,"iterate",Zn),o.forEach((c,d)=>r.call(n,l(c),l(d),s))}}function Ja(i,e,t){return function(...r){const n=this.__v_raw,s=ft(n),o=js(s),a=i==="entries"||i===Symbol.iterator&&o,l=i==="keys"&&o,c=n[i](...r),d=t?Mh:e?Ch:da;return!e&&ai(s,"iterate",l?Pu:Zn),{next(){const{value:u,done:h}=c.next();return h?{value:u,done:h}:{value:a?[d(u[0]),d(u[1])]:d(u),done:h}},[Symbol.iterator](){return this}}}}function Fr(i){return function(...e){return i==="delete"?!1:i==="clear"?void 0:this}}function X_(){const i={get(s){return qa(this,s)},get size(){return Xa(this)},has:Ya,add:Qf,set:ep,delete:tp,clear:ip,forEach:Ka(!1,!1)},e={get(s){return qa(this,s,!1,!0)},get size(){return Xa(this)},has:Ya,add:Qf,set:ep,delete:tp,clear:ip,forEach:Ka(!1,!0)},t={get(s){return qa(this,s,!0)},get size(){return Xa(this,!0)},has(s){return Ya.call(this,s,!0)},add:Fr("add"),set:Fr("set"),delete:Fr("delete"),clear:Fr("clear"),forEach:Ka(!0,!1)},r={get(s){return qa(this,s,!0,!0)},get size(){return Xa(this,!0)},has(s){return Ya.call(this,s,!0)},add:Fr("add"),set:Fr("set"),delete:Fr("delete"),clear:Fr("clear"),forEach:Ka(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{i[s]=Ja(s,!1,!1),t[s]=Ja(s,!0,!1),e[s]=Ja(s,!1,!0),r[s]=Ja(s,!0,!0)}),[i,t,e,r]}const[K_,J_,Z_,Q_]=X_();function Eh(i,e){const t=e?i?Q_:Z_:i?J_:K_;return(r,n,s)=>n==="__v_isReactive"?!i:n==="__v_isReadonly"?i:n==="__v_raw"?r:Reflect.get(dt(t,n)&&n in r?t:r,n,s)}const e1={get:Eh(!1,!1)},t1={get:Eh(!1,!0)},i1={get:Eh(!0,!1)};const q0=new WeakMap,Y0=new WeakMap,X0=new WeakMap,r1=new WeakMap;function n1(i){switch(i){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function s1(i){return i.__v_skip||!Object.isExtensible(i)?0:n1(k_(i))}function lo(i){return ca(i)?i:kh(i,!1,G_,e1,q0)}function K0(i){return kh(i,!1,Y_,t1,Y0)}function J0(i){return kh(i,!0,q_,i1,X0)}function kh(i,e,t,r,n){if(!bt(i)||i.__v_raw&&!(e&&i.__v_isReactive))return i;const s=n.get(i);if(s)return s;const o=s1(i);if(o===0)return i;const a=new Proxy(i,o===2?r:t);return n.set(i,a),a}function Wo(i){return ca(i)?Wo(i.__v_raw):!!(i&&i.__v_isReactive)}function ca(i){return!!(i&&i.__v_isReadonly)}function rc(i){return!!(i&&i.__v_isShallow)}function Z0(i){return i?!!i.__v_raw:!1}function ft(i){const e=i&&i.__v_raw;return e?ft(e):i}function o1(i){return Object.isExtensible(i)&&R0(i,"__v_skip",!0),i}const da=i=>bt(i)?lo(i):i,Ch=i=>bt(i)?J0(i):i;class Q0{constructor(e,t,r,n){this.getter=e,this._setter=t,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new wh(()=>e(this._value),()=>Bl(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!n,this.__v_isReadonly=r}get value(){const e=ft(this);return(!e._cacheable||e.effect.dirty)&&bn(e._value,e._value=e.effect.run())&&Bl(e,4),ev(e),e.effect._dirtyLevel>=2&&Bl(e,2),e._value}set value(e){this._setter(e)}get _dirty(){return this.effect.dirty}set _dirty(e){this.effect.dirty=e}}function a1(i,e,t=!1){let r,n;const s=Ye(i);return s?(r=i,n=ki):(r=i.get,n=i.set),new Q0(r,n,s||!n,t)}function ev(i){var e;fn&&Jn&&(i=ft(i),V0(Jn,(e=i.dep)!=null?e:i.dep=U0(()=>i.dep=void 0,i instanceof Q0?i:void 0)))}function Bl(i,e=4,t,r){i=ft(i);const n=i.dep;n&&H0(n,e)}function Ht(i){return!!(i&&i.__v_isRef===!0)}function Qt(i){return tv(i,!1)}function l1(i){return tv(i,!0)}function tv(i,e){return Ht(i)?i:new c1(i,e)}class c1{constructor(e,t){this.__v_isShallow=t,this.dep=void 0,this.__v_isRef=!0,this._rawValue=t?e:ft(e),this._value=t?e:da(e)}get value(){return ev(this),this._value}set value(e){const t=this.__v_isShallow||rc(e)||ca(e);e=t?e:ft(e),bn(e,this._rawValue)&&(this._rawValue,this._rawValue=e,this._value=t?e:da(e),Bl(this,4))}}function Ee(i){return Ht(i)?i.value:i}const d1={get:(i,e,t)=>Ee(Reflect.get(i,e,t)),set:(i,e,t,r)=>{const n=i[e];return Ht(n)&&!Ht(t)?(n.value=t,!0):Reflect.set(i,e,t,r)}};function iv(i){return Wo(i)?i:new Proxy(i,d1)}function yn(i){const e=Ue(i)?new Array(i.length):{};for(const t in i)e[t]=rv(i,t);return e}class u1{constructor(e,t,r){this._object=e,this._key=t,this._defaultValue=r,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return V_(ft(this._object),this._key)}}class h1{constructor(e){this._getter=e,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function ua(i,e,t){return Ht(i)?i:Ye(i)?new h1(i):bt(i)&&arguments.length>1?rv(i,e,t):Qt(i)}function rv(i,e,t){const r=i[e];return Ht(r)?r:new u1(i,e,t)}/**
* @vue/runtime-core v3.4.31
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function pn(i,e,t,r){try{return r?i(...r):i()}catch(n){qc(n,e,t)}}function Ai(i,e,t,r){if(Ye(i)){const n=pn(i,e,t,r);return n&&L0(n)&&n.catch(s=>{qc(s,e,t)}),n}if(Ue(i)){const n=[];for(let s=0;s<i.length;s++)n.push(Ai(i[s],e,t,r));return n}}function qc(i,e,t,r=!0){const n=e?e.vnode:null;if(e){let s=e.parent;const o=e.proxy,a=`https://vuejs.org/error-reference/#runtime-${t}`;for(;s;){const c=s.ec;if(c){for(let d=0;d<c.length;d++)if(c[d](i,o,a)===!1)return}s=s.parent}const l=e.appContext.config.errorHandler;if(l){En(),pn(l,null,10,[i,o,a]),kn();return}}f1(i,t,n,r)}function f1(i,e,t,r=!0){console.error(i)}let ha=!1,Ru=!1;const Xt=[];let Zi=0;const Ws=[];let en=null,Hn=0;const nv=Promise.resolve();let Th=null;function co(i){const e=Th||nv;return i?e.then(this?i.bind(this):i):e}function p1(i){let e=Zi+1,t=Xt.length;for(;e<t;){const r=e+t>>>1,n=Xt[r],s=fa(n);s<i||s===i&&n.pre?e=r+1:t=r}return e}function Ah(i){(!Xt.length||!Xt.includes(i,ha&&i.allowRecurse?Zi+1:Zi))&&(i.id==null?Xt.push(i):Xt.splice(p1(i.id),0,i),sv())}function sv(){!ha&&!Ru&&(Ru=!0,Th=nv.then(av))}function m1(i){const e=Xt.indexOf(i);e>Zi&&Xt.splice(e,1)}function g1(i){Ue(i)?Ws.push(...i):(!en||!en.includes(i,i.allowRecurse?Hn+1:Hn))&&Ws.push(i),sv()}function rp(i,e,t=ha?Zi+1:0){for(;t<Xt.length;t++){const r=Xt[t];if(r&&r.pre){if(i&&r.id!==i.uid)continue;Xt.splice(t,1),t--,r()}}}function ov(i){if(Ws.length){const e=[...new Set(Ws)].sort((t,r)=>fa(t)-fa(r));if(Ws.length=0,en){en.push(...e);return}for(en=e,Hn=0;Hn<en.length;Hn++){const t=en[Hn];t.active!==!1&&t()}en=null,Hn=0}}const fa=i=>i.id==null?1/0:i.id,v1=(i,e)=>{const t=fa(i)-fa(e);if(t===0){if(i.pre&&!e.pre)return-1;if(e.pre&&!i.pre)return 1}return t};function av(i){Ru=!1,ha=!0,Xt.sort(v1);try{for(Zi=0;Zi<Xt.length;Zi++){const e=Xt[Zi];e&&e.active!==!1&&pn(e,null,14)}}finally{Zi=0,Xt.length=0,ov(),ha=!1,Th=null,(Xt.length||Ws.length)&&av()}}function b1(i,e,...t){if(i.isUnmounted)return;const r=i.vnode.props||St;let n=t;const s=e.startsWith("update:"),o=s&&e.slice(7);if(o&&o in r){const d=`${o==="modelValue"?"model":o}Modifiers`,{number:u,trim:h}=r[d]||St;h&&(n=t.map(p=>kt(p)?p.trim():p)),u&&(n=t.map(tc))}let a,l=r[a=_d(e)]||r[a=_d(sr(e))];!l&&s&&(l=r[a=_d(hs(e))]),l&&Ai(l,i,6,n);const c=r[a+"Once"];if(c){if(!i.emitted)i.emitted={};else if(i.emitted[a])return;i.emitted[a]=!0,Ai(c,i,6,n)}}function lv(i,e,t=!1){const r=e.emitsCache,n=r.get(i);if(n!==void 0)return n;const s=i.emits;let o={},a=!1;if(!Ye(i)){const l=c=>{const d=lv(c,e,!0);d&&(a=!0,Pt(o,d))};!t&&e.mixins.length&&e.mixins.forEach(l),i.extends&&l(i.extends),i.mixins&&i.mixins.forEach(l)}return!s&&!a?(bt(i)&&r.set(i,null),null):(Ue(s)?s.forEach(l=>o[l]=null):Pt(o,s),bt(i)&&r.set(i,o),o)}function Yc(i,e){return!i||!Uc(e)?!1:(e=e.slice(2).replace(/Once$/,""),dt(i,e[0].toLowerCase()+e.slice(1))||dt(i,hs(e))||dt(i,e))}let Bt=null,Xc=null;function nc(i){const e=Bt;return Bt=i,Xc=i&&i.type.__scopeId||null,e}function cv(i){Xc=i}function dv(){Xc=null}const y1=i=>K;function K(i,e=Bt,t){if(!e||i._n)return i;const r=(...n)=>{r._d&&gp(-1);const s=nc(e);let o;try{o=i(...n)}finally{nc(s),r._d&&gp(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function xd(i){const{type:e,vnode:t,proxy:r,withProxy:n,propsOptions:[s],slots:o,attrs:a,emit:l,render:c,renderCache:d,props:u,data:h,setupState:p,ctx:g,inheritAttrs:f}=i,m=nc(i);let b,y;try{if(t.shapeFlag&4){const _=n||r,M=_;b=Ki(c.call(M,_,d,u,p,h,g)),y=a}else{const _=e;b=Ki(_.length>1?_(u,{attrs:a,slots:o,emit:l}):_(u,null)),y=e.props?a:_1(a)}}catch(_){Xo.length=0,qc(_,i,1),b=H(Zt)}let w=b;if(y&&f!==!1){const _=Object.keys(y),{shapeFlag:M}=w;_.length&&M&7&&(s&&_.some(gh)&&(y=w1(y,s)),w=_n(w,y,!1,!0))}return t.dirs&&(w=_n(w,null,!1,!0),w.dirs=w.dirs?w.dirs.concat(t.dirs):t.dirs),t.transition&&(w.transition=t.transition),b=w,nc(m),b}const _1=i=>{let e;for(const t in i)(t==="class"||t==="style"||Uc(t))&&((e||(e={}))[t]=i[t]);return e},w1=(i,e)=>{const t={};for(const r in i)(!gh(r)||!(r.slice(9)in e))&&(t[r]=i[r]);return t};function x1(i,e,t){const{props:r,children:n,component:s}=i,{props:o,children:a,patchFlag:l}=e,c=s.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&l>=0){if(l&1024)return!0;if(l&16)return r?np(r,o,c):!!o;if(l&8){const d=e.dynamicProps;for(let u=0;u<d.length;u++){const h=d[u];if(o[h]!==r[h]&&!Yc(c,h))return!0}}}else return(n||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?np(r,o,c):!0:!!o;return!1}function np(i,e,t){const r=Object.keys(e);if(r.length!==Object.keys(i).length)return!0;for(let n=0;n<r.length;n++){const s=r[n];if(e[s]!==i[s]&&!Yc(t,s))return!0}return!1}function S1({vnode:i,parent:e},t){for(;e;){const r=e.subTree;if(r.suspense&&r.suspense.activeBranch===i&&(r.el=i.el),r===i)(i=e.vnode).el=t,e=e.parent;else break}}const Lh="components";function st(i,e){return fv(Lh,i,!0,e)||i}const uv=Symbol.for("v-ndc");function hv(i){return kt(i)?fv(Lh,i,!1)||i:i||uv}function fv(i,e,t=!0,r=!1){const n=Bt||jt;if(n){const s=n.type;if(i===Lh){const a=pw(s,!1);if(a&&(a===e||a===sr(e)||a===Wc(sr(e))))return s}const o=sp(n[i]||s[i],e)||sp(n.appContext[i],e);return!o&&r?s:o}}function sp(i,e){return i&&(i[e]||i[sr(e)]||i[Wc(sr(e))])}const M1=i=>i.__isSuspense;function E1(i,e){e&&e.pendingBranch?Ue(i)?e.effects.push(...i):e.effects.push(i):g1(i)}function Kc(i,e,t=jt,r=!1){if(t){const n=t[i]||(t[i]=[]),s=e.__weh||(e.__weh=(...o)=>{En();const a=Ra(t),l=Ai(e,t,i,o);return a(),kn(),l});return r?n.unshift(s):n.push(s),s}}const Rr=i=>(e,t=jt)=>{(!Qc||i==="sp")&&Kc(i,(...r)=>e(...r),t)},pv=Rr("bm"),uo=Rr("m"),k1=Rr("bu"),C1=Rr("u"),Dh=Rr("bum"),Ph=Rr("um"),T1=Rr("sp"),A1=Rr("rtg"),L1=Rr("rtc");function D1(i,e=jt){Kc("ec",i,e)}function At(i,e){if(Bt===null)return i;const t=ed(Bt),r=i.dirs||(i.dirs=[]);for(let n=0;n<e.length;n++){let[s,o,a,l=St]=e[n];s&&(Ye(s)&&(s={mounted:s,updated:s}),s.deep&&dn(o),r.push({dir:s,instance:t,value:o,oldValue:void 0,arg:a,modifiers:l}))}return i}function An(i,e,t,r){const n=i.dirs,s=e&&e.dirs;for(let o=0;o<n.length;o++){const a=n[o];s&&(a.oldValue=s[o].value);let l=a.dir[r];l&&(En(),Ai(l,t,8,[i.el,a,i,e]),kn())}}function Fe(i,e,t,r){let n;const s=t;if(Ue(i)||kt(i)){n=new Array(i.length);for(let o=0,a=i.length;o<a;o++)n[o]=e(i[o],o,void 0,s)}else if(typeof i=="number"){n=new Array(i);for(let o=0;o<i;o++)n[o]=e(o+1,o,void 0,s)}else if(bt(i))if(i[Symbol.iterator])n=Array.from(i,(o,a)=>e(o,a,void 0,s));else{const o=Object.keys(i);n=new Array(o.length);for(let a=0,l=o.length;a<l;a++){const c=o[a];n[a]=e(i[c],c,a,s)}}else n=[];return n}/*! #__NO_SIDE_EFFECTS__ */function ht(i,e){return Ye(i)?Pt({name:i.name},e,{setup:i}):i}const Go=i=>!!i.type.__asyncLoader;function Xe(i,e,t={},r,n){if(Bt.isCE||Bt.parent&&Go(Bt.parent)&&Bt.parent.isCE)return e!=="default"&&(t.name=e),H("slot",t,r&&r());let s=i[e];s&&s._c&&(s._d=!1),P();const o=s&&mv(s(t)),a=Ge(be,{key:t.key||o&&o.key||`_${e}`},o||(r?r():[]),o&&i._===1?64:-2);return!n&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),s&&s._c&&(s._d=!0),a}function mv(i){return i.some(e=>ac(e)?!(e.type===Zt||e.type===be&&!mv(e.children)):!0)?i:null}const Iu=i=>i?$v(i)?ed(i):Iu(i.parent):null,qo=Pt(Object.create(null),{$:i=>i,$el:i=>i.vnode.el,$data:i=>i.data,$props:i=>i.props,$attrs:i=>i.attrs,$slots:i=>i.slots,$refs:i=>i.refs,$parent:i=>Iu(i.parent),$root:i=>Iu(i.root),$emit:i=>i.emit,$options:i=>Rh(i),$forceUpdate:i=>i.f||(i.f=()=>{i.effect.dirty=!0,Ah(i.update)}),$nextTick:i=>i.n||(i.n=co.bind(i.proxy)),$watch:i=>Z1.bind(i)}),Sd=(i,e)=>i!==St&&!i.__isScriptSetup&&dt(i,e),P1={get({_:i},e){if(e==="__v_skip")return!0;const{ctx:t,setupState:r,data:n,props:s,accessCache:o,type:a,appContext:l}=i;let c;if(e[0]!=="$"){const p=o[e];if(p!==void 0)switch(p){case 1:return r[e];case 2:return n[e];case 4:return t[e];case 3:return s[e]}else{if(Sd(r,e))return o[e]=1,r[e];if(n!==St&&dt(n,e))return o[e]=2,n[e];if((c=i.propsOptions[0])&&dt(c,e))return o[e]=3,s[e];if(t!==St&&dt(t,e))return o[e]=4,t[e];Ou&&(o[e]=0)}}const d=qo[e];let u,h;if(d)return e==="$attrs"&&ai(i.attrs,"get",""),d(i);if((u=a.__cssModules)&&(u=u[e]))return u;if(t!==St&&dt(t,e))return o[e]=4,t[e];if(h=l.config.globalProperties,dt(h,e))return h[e]},set({_:i},e,t){const{data:r,setupState:n,ctx:s}=i;return Sd(n,e)?(n[e]=t,!0):r!==St&&dt(r,e)?(r[e]=t,!0):dt(i.props,e)||e[0]==="$"&&e.slice(1)in i?!1:(s[e]=t,!0)},has({_:{data:i,setupState:e,accessCache:t,ctx:r,appContext:n,propsOptions:s}},o){let a;return!!t[o]||i!==St&&dt(i,o)||Sd(e,o)||(a=s[0])&&dt(a,o)||dt(r,o)||dt(qo,o)||dt(n.config.globalProperties,o)},defineProperty(i,e,t){return t.get!=null?i._.accessCache[e]=0:dt(t,"value")&&this.set(i,e,t.value,null),Reflect.defineProperty(i,e,t)}};function gv(){return vv().slots}function R1(){return vv().attrs}function vv(){const i=zh();return i.setupContext||(i.setupContext=Vv(i))}function op(i){return Ue(i)?i.reduce((e,t)=>(e[t]=null,e),{}):i}let Ou=!0;function I1(i){const e=Rh(i),t=i.proxy,r=i.ctx;Ou=!1,e.beforeCreate&&ap(e.beforeCreate,i,"bc");const{data:n,computed:s,methods:o,watch:a,provide:l,inject:c,created:d,beforeMount:u,mounted:h,beforeUpdate:p,updated:g,activated:f,deactivated:m,beforeDestroy:b,beforeUnmount:y,destroyed:w,unmounted:_,render:M,renderTracked:S,renderTriggered:A,errorCaptured:x,serverPrefetch:E,expose:D,inheritAttrs:F,components:R,directives:B,filters:I}=e;if(c&&O1(c,r,null),o)for(const j in o){const Y=o[j];Ye(Y)&&(r[j]=Y.bind(t))}if(n){const j=n.call(t,t);bt(j)&&(i.data=lo(j))}if(Ou=!0,s)for(const j in s){const Y=s[j],W=Ye(Y)?Y.bind(t,t):Ye(Y.get)?Y.get.bind(t,t):ki,ee=!Ye(Y)&&Ye(Y.set)?Y.set.bind(t):ki,me=ke({get:W,set:ee});Object.defineProperty(r,j,{enumerable:!0,configurable:!0,get:()=>me.value,set:X=>me.value=X})}if(a)for(const j in a)bv(a[j],r,t,j);if(l){const j=Ye(l)?l.call(t):l;Reflect.ownKeys(j).forEach(Y=>{Bi(Y,j[Y])})}d&&ap(d,i,"c");function N(j,Y){Ue(Y)?Y.forEach(W=>j(W.bind(t))):Y&&j(Y.bind(t))}if(N(pv,u),N(uo,h),N(k1,p),N(C1,g),N(Q1,f),N(ew,m),N(D1,x),N(L1,S),N(A1,A),N(Dh,y),N(Ph,_),N(T1,E),Ue(D))if(D.length){const j=i.exposed||(i.exposed={});D.forEach(Y=>{Object.defineProperty(j,Y,{get:()=>t[Y],set:W=>t[Y]=W})})}else i.exposed||(i.exposed={});M&&i.render===ki&&(i.render=M),F!=null&&(i.inheritAttrs=F),R&&(i.components=R),B&&(i.directives=B)}function O1(i,e,t=ki){Ue(i)&&(i=Fu(i));for(const r in i){const n=i[r];let s;bt(n)?"default"in n?s=Vt(n.from||r,n.default,!0):s=Vt(n.from||r):s=Vt(n),Ht(s)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>s.value,set:o=>s.value=o}):e[r]=s}}function ap(i,e,t){Ai(Ue(i)?i.map(r=>r.bind(e.proxy)):i.bind(e.proxy),e,t)}function bv(i,e,t,r){const n=r.includes(".")?Dv(t,r):()=>t[r];if(kt(i)){const s=e[i];Ye(s)&&Ar(n,s)}else if(Ye(i))Ar(n,i.bind(t));else if(bt(i))if(Ue(i))i.forEach(s=>bv(s,e,t,r));else{const s=Ye(i.handler)?i.handler.bind(t):e[i.handler];Ye(s)&&Ar(n,s,i)}}function Rh(i){const e=i.type,{mixins:t,extends:r}=e,{mixins:n,optionsCache:s,config:{optionMergeStrategies:o}}=i.appContext,a=s.get(e);let l;return a?l=a:!n.length&&!t&&!r?l=e:(l={},n.length&&n.forEach(c=>sc(l,c,o,!0)),sc(l,e,o)),bt(e)&&s.set(e,l),l}function sc(i,e,t,r=!1){const{mixins:n,extends:s}=e;s&&sc(i,s,t,!0),n&&n.forEach(o=>sc(i,o,t,!0));for(const o in e)if(!(r&&o==="expose")){const a=F1[o]||t&&t[o];i[o]=a?a(i[o],e[o]):e[o]}return i}const F1={data:lp,props:cp,emits:cp,methods:$o,computed:$o,beforeCreate:Jt,created:Jt,beforeMount:Jt,mounted:Jt,beforeUpdate:Jt,updated:Jt,beforeDestroy:Jt,beforeUnmount:Jt,destroyed:Jt,unmounted:Jt,activated:Jt,deactivated:Jt,errorCaptured:Jt,serverPrefetch:Jt,components:$o,directives:$o,watch:N1,provide:lp,inject:z1};function lp(i,e){return e?i?function(){return Pt(Ye(i)?i.call(this,this):i,Ye(e)?e.call(this,this):e)}:e:i}function z1(i,e){return $o(Fu(i),Fu(e))}function Fu(i){if(Ue(i)){const e={};for(let t=0;t<i.length;t++)e[i[t]]=i[t];return e}return i}function Jt(i,e){return i?[...new Set([].concat(i,e))]:e}function $o(i,e){return i?Pt(Object.create(null),i,e):e}function cp(i,e){return i?Ue(i)&&Ue(e)?[...new Set([...i,...e])]:Pt(Object.create(null),op(i),op(e??{})):e}function N1(i,e){if(!i)return e;if(!e)return i;const t=Pt(Object.create(null),i);for(const r in e)t[r]=Jt(i[r],e[r]);return t}function yv(){return{app:null,config:{isNativeTag:M_,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let $1=0;function B1(i,e){return function(r,n=null){Ye(r)||(r=Pt({},r)),n!=null&&!bt(n)&&(n=null);const s=yv(),o=new WeakSet;let a=!1;const l=s.app={_uid:$1++,_component:r,_props:n,_container:null,_context:s,_instance:null,version:gw,get config(){return s.config},set config(c){},use(c,...d){return o.has(c)||(c&&Ye(c.install)?(o.add(c),c.install(l,...d)):Ye(c)&&(o.add(c),c(l,...d))),l},mixin(c){return s.mixins.includes(c)||s.mixins.push(c),l},component(c,d){return d?(s.components[c]=d,l):s.components[c]},directive(c,d){return d?(s.directives[c]=d,l):s.directives[c]},mount(c,d,u){if(!a){const h=H(r,n);return h.appContext=s,u===!0?u="svg":u===!1&&(u=void 0),d&&e?e(h,c):i(h,c,u),a=!0,l._container=c,c.__vue_app__=l,ed(h.component)}},unmount(){a&&(i(null,l._container),delete l._container.__vue_app__)},provide(c,d){return s.provides[c]=d,l},runWithContext(c){const d=Yo;Yo=l;try{return c()}finally{Yo=d}}};return l}}let Yo=null;function Bi(i,e){if(jt){let t=jt.provides;const r=jt.parent&&jt.parent.provides;r===t&&(t=jt.provides=Object.create(r)),t[i]=e}}function Vt(i,e,t=!1){const r=jt||Bt;if(r||Yo){const n=r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:Yo._context.provides;if(n&&i in n)return n[i];if(arguments.length>1)return t&&Ye(e)?e.call(r&&r.proxy):e}}const _v={},wv=()=>Object.create(_v),xv=i=>Object.getPrototypeOf(i)===_v;function V1(i,e,t,r=!1){const n={},s=wv();i.propsDefaults=Object.create(null),Sv(i,e,n,s);for(const o in i.propsOptions[0])o in n||(n[o]=void 0);t?i.props=r?n:K0(n):i.type.props?i.props=n:i.props=s,i.attrs=s}function H1(i,e,t,r){const{props:n,attrs:s,vnode:{patchFlag:o}}=i,a=ft(n),[l]=i.propsOptions;let c=!1;if((r||o>0)&&!(o&16)){if(o&8){const d=i.vnode.dynamicProps;for(let u=0;u<d.length;u++){let h=d[u];if(Yc(i.emitsOptions,h))continue;const p=e[h];if(l)if(dt(s,h))p!==s[h]&&(s[h]=p,c=!0);else{const g=sr(h);n[g]=zu(l,a,g,p,i,!1)}else p!==s[h]&&(s[h]=p,c=!0)}}}else{Sv(i,e,n,s)&&(c=!0);let d;for(const u in a)(!e||!dt(e,u)&&((d=hs(u))===u||!dt(e,d)))&&(l?t&&(t[u]!==void 0||t[d]!==void 0)&&(n[u]=zu(l,a,u,void 0,i,!0)):delete n[u]);if(s!==a)for(const u in s)(!e||!dt(e,u))&&(delete s[u],c=!0)}c&&Tr(i.attrs,"set","")}function Sv(i,e,t,r){const[n,s]=i.propsOptions;let o=!1,a;if(e)for(let l in e){if(jo(l))continue;const c=e[l];let d;n&&dt(n,d=sr(l))?!s||!s.includes(d)?t[d]=c:(a||(a={}))[d]=c:Yc(i.emitsOptions,l)||(!(l in r)||c!==r[l])&&(r[l]=c,o=!0)}if(s){const l=ft(t),c=a||St;for(let d=0;d<s.length;d++){const u=s[d];t[u]=zu(n,l,u,c[u],i,!dt(c,u))}}return o}function zu(i,e,t,r,n,s){const o=i[t];if(o!=null){const a=dt(o,"default");if(a&&r===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&Ye(l)){const{propsDefaults:c}=n;if(t in c)r=c[t];else{const d=Ra(n);r=c[t]=l.call(null,e),d()}}else r=l}o[0]&&(s&&!a?r=!1:o[1]&&(r===""||r===hs(t))&&(r=!0))}return r}function Mv(i,e,t=!1){const r=e.propsCache,n=r.get(i);if(n)return n;const s=i.props,o={},a=[];let l=!1;if(!Ye(i)){const d=u=>{l=!0;const[h,p]=Mv(u,e,!0);Pt(o,h),p&&a.push(...p)};!t&&e.mixins.length&&e.mixins.forEach(d),i.extends&&d(i.extends),i.mixins&&i.mixins.forEach(d)}if(!s&&!l)return bt(i)&&r.set(i,Us),Us;if(Ue(s))for(let d=0;d<s.length;d++){const u=sr(s[d]);dp(u)&&(o[u]=St)}else if(s)for(const d in s){const u=sr(d);if(dp(u)){const h=s[d],p=o[u]=Ue(h)||Ye(h)?{type:h}:Pt({},h);if(p){const g=fp(Boolean,p.type),f=fp(String,p.type);p[0]=g>-1,p[1]=f<0||g<f,(g>-1||dt(p,"default"))&&a.push(u)}}}const c=[o,a];return bt(i)&&r.set(i,c),c}function dp(i){return i[0]!=="$"&&!jo(i)}function up(i){return i===null?"null":typeof i=="function"?i.name||"":typeof i=="object"&&i.constructor&&i.constructor.name||""}function hp(i,e){return up(i)===up(e)}function fp(i,e){return Ue(e)?e.findIndex(t=>hp(t,i)):Ye(e)&&hp(e,i)?0:-1}const Ev=i=>i[0]==="_"||i==="$stable",Ih=i=>Ue(i)?i.map(Ki):[Ki(i)],U1=(i,e,t)=>{if(e._n)return e;const r=K((...n)=>Ih(e(...n)),t);return r._c=!1,r},kv=(i,e,t)=>{const r=i._ctx;for(const n in i){if(Ev(n))continue;const s=i[n];if(Ye(s))e[n]=U1(n,s,r);else if(s!=null){const o=Ih(s);e[n]=()=>o}}},Cv=(i,e)=>{const t=Ih(e);i.slots.default=()=>t},j1=(i,e)=>{const t=i.slots=wv();if(i.vnode.shapeFlag&32){const r=e._;r?(Pt(t,e),R0(t,"_",r,!0)):kv(e,t)}else e&&Cv(i,e)},W1=(i,e,t)=>{const{vnode:r,slots:n}=i;let s=!0,o=St;if(r.shapeFlag&32){const a=e._;a?t&&a===1?s=!1:(Pt(n,e),!t&&a===1&&delete n._):(s=!e.$stable,kv(e,n)),o=e}else e&&(Cv(i,e),o={default:1});if(s)for(const a in n)!Ev(a)&&o[a]==null&&delete n[a]};function Nu(i,e,t,r,n=!1){if(Ue(i)){i.forEach((h,p)=>Nu(h,e&&(Ue(e)?e[p]:e),t,r,n));return}if(Go(r)&&!n)return;const s=r.shapeFlag&4?ed(r.component):r.el,o=n?null:s,{i:a,r:l}=i,c=e&&e.r,d=a.refs===St?a.refs={}:a.refs,u=a.setupState;if(c!=null&&c!==l&&(kt(c)?(d[c]=null,dt(u,c)&&(u[c]=null)):Ht(c)&&(c.value=null)),Ye(l))pn(l,a,12,[o,d]);else{const h=kt(l),p=Ht(l);if(h||p){const g=()=>{if(i.f){const f=h?dt(u,l)?u[l]:d[l]:l.value;n?Ue(f)&&vh(f,s):Ue(f)?f.includes(s)||f.push(s):h?(d[l]=[s],dt(u,l)&&(u[l]=d[l])):(l.value=[s],i.k&&(d[i.k]=l.value))}else h?(d[l]=o,dt(u,l)&&(u[l]=o)):p&&(l.value=o,i.k&&(d[i.k]=o))};o?(g.id=-1,ni(g,t)):g()}}}const ni=E1;function G1(i){return q1(i)}function q1(i,e){const t=I0();t.__VUE__=!0;const{insert:r,remove:n,patchProp:s,createElement:o,createText:a,createComment:l,setText:c,setElementText:d,parentNode:u,nextSibling:h,setScopeId:p=ki,insertStaticContent:g}=i,f=(L,$,Z,le=null,oe=null,_e=null,we=void 0,xe=null,Me=!!$.dynamicChildren)=>{if(L===$)return;L&&!Un(L,$)&&(le=te(L),X(L,oe,_e,!0),L=null),$.patchFlag===-2&&(Me=!1,$.dynamicChildren=null);const{type:T,ref:C,shapeFlag:q}=$;switch(T){case Zc:m(L,$,Z,le);break;case Zt:b(L,$,Z,le);break;case kd:L==null&&y($,Z,le,we);break;case be:R(L,$,Z,le,oe,_e,we,xe,Me);break;default:q&1?M(L,$,Z,le,oe,_e,we,xe,Me):q&6?B(L,$,Z,le,oe,_e,we,xe,Me):(q&64||q&128)&&T.process(L,$,Z,le,oe,_e,we,xe,Me,de)}C!=null&&oe&&Nu(C,L&&L.ref,_e,$||L,!$)},m=(L,$,Z,le)=>{if(L==null)r($.el=a($.children),Z,le);else{const oe=$.el=L.el;$.children!==L.children&&c(oe,$.children)}},b=(L,$,Z,le)=>{L==null?r($.el=l($.children||""),Z,le):$.el=L.el},y=(L,$,Z,le)=>{[L.el,L.anchor]=g(L.children,$,Z,le,L.el,L.anchor)},w=({el:L,anchor:$},Z,le)=>{let oe;for(;L&&L!==$;)oe=h(L),r(L,Z,le),L=oe;r($,Z,le)},_=({el:L,anchor:$})=>{let Z;for(;L&&L!==$;)Z=h(L),n(L),L=Z;n($)},M=(L,$,Z,le,oe,_e,we,xe,Me)=>{$.type==="svg"?we="svg":$.type==="math"&&(we="mathml"),L==null?S($,Z,le,oe,_e,we,xe,Me):E(L,$,oe,_e,we,xe,Me)},S=(L,$,Z,le,oe,_e,we,xe)=>{let Me,T;const{props:C,shapeFlag:q,transition:re,dirs:ue}=L;if(Me=L.el=o(L.type,_e,C&&C.is,C),q&8?d(Me,L.children):q&16&&x(L.children,Me,null,le,oe,Md(L,_e),we,xe),ue&&An(L,null,le,"created"),A(Me,L,L.scopeId,we,le),C){for(const Re in C)Re!=="value"&&!jo(Re)&&s(Me,Re,null,C[Re],_e,L.children,le,oe,se);"value"in C&&s(Me,"value",null,C.value,_e),(T=C.onVnodeBeforeMount)&&Gi(T,le,L)}ue&&An(L,null,le,"beforeMount");const ve=Y1(oe,re);ve&&re.beforeEnter(Me),r(Me,$,Z),((T=C&&C.onVnodeMounted)||ve||ue)&&ni(()=>{T&&Gi(T,le,L),ve&&re.enter(Me),ue&&An(L,null,le,"mounted")},oe)},A=(L,$,Z,le,oe)=>{if(Z&&p(L,Z),le)for(let _e=0;_e<le.length;_e++)p(L,le[_e]);if(oe){let _e=oe.subTree;if($===_e){const we=oe.vnode;A(L,we,we.scopeId,we.slotScopeIds,oe.parent)}}},x=(L,$,Z,le,oe,_e,we,xe,Me=0)=>{for(let T=Me;T<L.length;T++){const C=L[T]=xe?rn(L[T]):Ki(L[T]);f(null,C,$,Z,le,oe,_e,we,xe)}},E=(L,$,Z,le,oe,_e,we)=>{const xe=$.el=L.el;let{patchFlag:Me,dynamicChildren:T,dirs:C}=$;Me|=L.patchFlag&16;const q=L.props||St,re=$.props||St;let ue;if(Z&&Ln(Z,!1),(ue=re.onVnodeBeforeUpdate)&&Gi(ue,Z,$,L),C&&An($,L,Z,"beforeUpdate"),Z&&Ln(Z,!0),T?D(L.dynamicChildren,T,xe,Z,le,Md($,oe),_e):we||Y(L,$,xe,null,Z,le,Md($,oe),_e,!1),Me>0){if(Me&16)F(xe,$,q,re,Z,le,oe);else if(Me&2&&q.class!==re.class&&s(xe,"class",null,re.class,oe),Me&4&&s(xe,"style",q.style,re.style,oe),Me&8){const ve=$.dynamicProps;for(let Re=0;Re<ve.length;Re++){const Q=ve[Re],Ie=q[Q],De=re[Q];(De!==Ie||Q==="value")&&s(xe,Q,Ie,De,oe,L.children,Z,le,se)}}Me&1&&L.children!==$.children&&d(xe,$.children)}else!we&&T==null&&F(xe,$,q,re,Z,le,oe);((ue=re.onVnodeUpdated)||C)&&ni(()=>{ue&&Gi(ue,Z,$,L),C&&An($,L,Z,"updated")},le)},D=(L,$,Z,le,oe,_e,we)=>{for(let xe=0;xe<$.length;xe++){const Me=L[xe],T=$[xe],C=Me.el&&(Me.type===be||!Un(Me,T)||Me.shapeFlag&70)?u(Me.el):Z;f(Me,T,C,null,le,oe,_e,we,!0)}},F=(L,$,Z,le,oe,_e,we)=>{if(Z!==le){if(Z!==St)for(const xe in Z)!jo(xe)&&!(xe in le)&&s(L,xe,Z[xe],null,we,$.children,oe,_e,se);for(const xe in le){if(jo(xe))continue;const Me=le[xe],T=Z[xe];Me!==T&&xe!=="value"&&s(L,xe,T,Me,we,$.children,oe,_e,se)}"value"in le&&s(L,"value",Z.value,le.value,we)}},R=(L,$,Z,le,oe,_e,we,xe,Me)=>{const T=$.el=L?L.el:a(""),C=$.anchor=L?L.anchor:a("");let{patchFlag:q,dynamicChildren:re,slotScopeIds:ue}=$;ue&&(xe=xe?xe.concat(ue):ue),L==null?(r(T,Z,le),r(C,Z,le),x($.children||[],Z,C,oe,_e,we,xe,Me)):q>0&&q&64&&re&&L.dynamicChildren?(D(L.dynamicChildren,re,Z,oe,_e,we,xe),($.key!=null||oe&&$===oe.subTree)&&Tv(L,$,!0)):Y(L,$,Z,C,oe,_e,we,xe,Me)},B=(L,$,Z,le,oe,_e,we,xe,Me)=>{$.slotScopeIds=xe,L==null?$.shapeFlag&512?oe.ctx.activate($,Z,le,we,Me):I($,Z,le,oe,_e,we,Me):V(L,$,Me)},I=(L,$,Z,le,oe,_e,we)=>{const xe=L.component=dw(L,le,oe);if(Jc(L)&&(xe.ctx.renderer=de),uw(xe),xe.asyncDep){if(oe&&oe.registerDep(xe,N,we),!L.el){const Me=xe.subTree=H(Zt);b(null,Me,$,Z)}}else N(xe,L,$,Z,oe,_e,we)},V=(L,$,Z)=>{const le=$.component=L.component;if(x1(L,$,Z))if(le.asyncDep&&!le.asyncResolved){j(le,$,Z);return}else le.next=$,m1(le.update),le.effect.dirty=!0,le.update();else $.el=L.el,le.vnode=$},N=(L,$,Z,le,oe,_e,we)=>{const xe=()=>{if(L.isMounted){let{next:C,bu:q,u:re,parent:ue,vnode:ve}=L;{const Ve=Av(L);if(Ve){C&&(C.el=ve.el,j(L,C,we)),Ve.asyncDep.then(()=>{L.isUnmounted||xe()});return}}let Re=C,Q;Ln(L,!1),C?(C.el=ve.el,j(L,C,we)):C=ve,q&&$l(q),(Q=C.props&&C.props.onVnodeBeforeUpdate)&&Gi(Q,ue,C,ve),Ln(L,!0);const Ie=xd(L),De=L.subTree;L.subTree=Ie,f(De,Ie,u(De.el),te(De),L,oe,_e),C.el=Ie.el,Re===null&&S1(L,Ie.el),re&&ni(re,oe),(Q=C.props&&C.props.onVnodeUpdated)&&ni(()=>Gi(Q,ue,C,ve),oe)}else{let C;const{el:q,props:re}=$,{bm:ue,m:ve,parent:Re}=L,Q=Go($);if(Ln(L,!1),ue&&$l(ue),!Q&&(C=re&&re.onVnodeBeforeMount)&&Gi(C,Re,$),Ln(L,!0),q&&$e){const Ie=()=>{L.subTree=xd(L),$e(q,L.subTree,L,oe,null)};Q?$.type.__asyncLoader().then(()=>!L.isUnmounted&&Ie()):Ie()}else{const Ie=L.subTree=xd(L);f(null,Ie,Z,le,L,oe,_e),$.el=Ie.el}if(ve&&ni(ve,oe),!Q&&(C=re&&re.onVnodeMounted)){const Ie=$;ni(()=>Gi(C,Re,Ie),oe)}($.shapeFlag&256||Re&&Go(Re.vnode)&&Re.vnode.shapeFlag&256)&&L.a&&ni(L.a,oe),L.isMounted=!0,$=Z=le=null}},Me=L.effect=new wh(xe,ki,()=>Ah(T),L.scope),T=L.update=()=>{Me.dirty&&Me.run()};T.id=L.uid,Ln(L,!0),T()},j=(L,$,Z)=>{$.component=L;const le=L.vnode.props;L.vnode=$,L.next=null,H1(L,$.props,le,Z),W1(L,$.children,Z),En(),rp(L),kn()},Y=(L,$,Z,le,oe,_e,we,xe,Me=!1)=>{const T=L&&L.children,C=L?L.shapeFlag:0,q=$.children,{patchFlag:re,shapeFlag:ue}=$;if(re>0){if(re&128){ee(T,q,Z,le,oe,_e,we,xe,Me);return}else if(re&256){W(T,q,Z,le,oe,_e,we,xe,Me);return}}ue&8?(C&16&&se(T,oe,_e),q!==T&&d(Z,q)):C&16?ue&16?ee(T,q,Z,le,oe,_e,we,xe,Me):se(T,oe,_e,!0):(C&8&&d(Z,""),ue&16&&x(q,Z,le,oe,_e,we,xe,Me))},W=(L,$,Z,le,oe,_e,we,xe,Me)=>{L=L||Us,$=$||Us;const T=L.length,C=$.length,q=Math.min(T,C);let re;for(re=0;re<q;re++){const ue=$[re]=Me?rn($[re]):Ki($[re]);f(L[re],ue,Z,null,oe,_e,we,xe,Me)}T>C?se(L,oe,_e,!0,!1,q):x($,Z,le,oe,_e,we,xe,Me,q)},ee=(L,$,Z,le,oe,_e,we,xe,Me)=>{let T=0;const C=$.length;let q=L.length-1,re=C-1;for(;T<=q&&T<=re;){const ue=L[T],ve=$[T]=Me?rn($[T]):Ki($[T]);if(Un(ue,ve))f(ue,ve,Z,null,oe,_e,we,xe,Me);else break;T++}for(;T<=q&&T<=re;){const ue=L[q],ve=$[re]=Me?rn($[re]):Ki($[re]);if(Un(ue,ve))f(ue,ve,Z,null,oe,_e,we,xe,Me);else break;q--,re--}if(T>q){if(T<=re){const ue=re+1,ve=ue<C?$[ue].el:le;for(;T<=re;)f(null,$[T]=Me?rn($[T]):Ki($[T]),Z,ve,oe,_e,we,xe,Me),T++}}else if(T>re)for(;T<=q;)X(L[T],oe,_e,!0),T++;else{const ue=T,ve=T,Re=new Map;for(T=ve;T<=re;T++){const tt=$[T]=Me?rn($[T]):Ki($[T]);tt.key!=null&&Re.set(tt.key,T)}let Q,Ie=0;const De=re-ve+1;let Ve=!1,Ne=0;const qe=new Array(De);for(T=0;T<De;T++)qe[T]=0;for(T=ue;T<=q;T++){const tt=L[T];if(Ie>=De){X(tt,oe,_e,!0);continue}let G;if(tt.key!=null)G=Re.get(tt.key);else for(Q=ve;Q<=re;Q++)if(qe[Q-ve]===0&&Un(tt,$[Q])){G=Q;break}G===void 0?X(tt,oe,_e,!0):(qe[G-ve]=T+1,G>=Ne?Ne=G:Ve=!0,f(tt,$[G],Z,null,oe,_e,we,xe,Me),Ie++)}const lt=Ve?X1(qe):Us;for(Q=lt.length-1,T=De-1;T>=0;T--){const tt=ve+T,G=$[tt],Oe=tt+1<C?$[tt+1].el:le;qe[T]===0?f(null,G,Z,Oe,oe,_e,we,xe,Me):Ve&&(Q<0||T!==lt[Q]?me(G,Z,Oe,2):Q--)}}},me=(L,$,Z,le,oe=null)=>{const{el:_e,type:we,transition:xe,children:Me,shapeFlag:T}=L;if(T&6){me(L.component.subTree,$,Z,le);return}if(T&128){L.suspense.move($,Z,le);return}if(T&64){we.move(L,$,Z,de);return}if(we===be){r(_e,$,Z);for(let q=0;q<Me.length;q++)me(Me[q],$,Z,le);r(L.anchor,$,Z);return}if(we===kd){w(L,$,Z);return}if(le!==2&&T&1&&xe)if(le===0)xe.beforeEnter(_e),r(_e,$,Z),ni(()=>xe.enter(_e),oe);else{const{leave:q,delayLeave:re,afterLeave:ue}=xe,ve=()=>r(_e,$,Z),Re=()=>{q(_e,()=>{ve(),ue&&ue()})};re?re(_e,ve,Re):Re()}else r(_e,$,Z)},X=(L,$,Z,le=!1,oe=!1)=>{const{type:_e,props:we,ref:xe,children:Me,dynamicChildren:T,shapeFlag:C,patchFlag:q,dirs:re,memoIndex:ue}=L;if(q===-2&&(oe=!1),xe!=null&&Nu(xe,null,Z,L,!0),ue!=null&&($.renderCache[ue]=void 0),C&256){$.ctx.deactivate(L);return}const ve=C&1&&re,Re=!Go(L);let Q;if(Re&&(Q=we&&we.onVnodeBeforeUnmount)&&Gi(Q,$,L),C&6)We(L.component,Z,le);else{if(C&128){L.suspense.unmount(Z,le);return}ve&&An(L,null,$,"beforeUnmount"),C&64?L.type.remove(L,$,Z,de,le):T&&(_e!==be||q>0&&q&64)?se(T,$,Z,!1,!0):(_e===be&&q&384||!oe&&C&16)&&se(Me,$,Z),le&&ye(L)}(Re&&(Q=we&&we.onVnodeUnmounted)||ve)&&ni(()=>{Q&&Gi(Q,$,L),ve&&An(L,null,$,"unmounted")},Z)},ye=L=>{const{type:$,el:Z,anchor:le,transition:oe}=L;if($===be){Ce(Z,le);return}if($===kd){_(L);return}const _e=()=>{n(Z),oe&&!oe.persisted&&oe.afterLeave&&oe.afterLeave()};if(L.shapeFlag&1&&oe&&!oe.persisted){const{leave:we,delayLeave:xe}=oe,Me=()=>we(Z,_e);xe?xe(L.el,_e,Me):Me()}else _e()},Ce=(L,$)=>{let Z;for(;L!==$;)Z=h(L),n(L),L=Z;n($)},We=(L,$,Z)=>{const{bum:le,scope:oe,update:_e,subTree:we,um:xe,m:Me,a:T}=L;pp(Me),pp(T),le&&$l(le),oe.stop(),_e&&(_e.active=!1,X(we,L,$,Z)),xe&&ni(xe,$),ni(()=>{L.isUnmounted=!0},$),$&&$.pendingBranch&&!$.isUnmounted&&L.asyncDep&&!L.asyncResolved&&L.suspenseId===$.pendingId&&($.deps--,$.deps===0&&$.resolve())},se=(L,$,Z,le=!1,oe=!1,_e=0)=>{for(let we=_e;we<L.length;we++)X(L[we],$,Z,le,oe)},te=L=>L.shapeFlag&6?te(L.component.subTree):L.shapeFlag&128?L.suspense.next():h(L.anchor||L.el);let fe=!1;const pe=(L,$,Z)=>{L==null?$._vnode&&X($._vnode,null,null,!0):f($._vnode||null,L,$,null,null,null,Z),fe||(fe=!0,rp(),ov(),fe=!1),$._vnode=L},de={p:f,um:X,m:me,r:ye,mt:I,mc:x,pc:Y,pbc:D,n:te,o:i};let He,$e;return{render:pe,hydrate:He,createApp:B1(pe,He)}}function Md({type:i,props:e},t){return t==="svg"&&i==="foreignObject"||t==="mathml"&&i==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function Ln({effect:i,update:e},t){i.allowRecurse=e.allowRecurse=t}function Y1(i,e){return(!i||i&&!i.pendingBranch)&&e&&!e.persisted}function Tv(i,e,t=!1){const r=i.children,n=e.children;if(Ue(r)&&Ue(n))for(let s=0;s<r.length;s++){const o=r[s];let a=n[s];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=n[s]=rn(n[s]),a.el=o.el),!t&&a.patchFlag!==-2&&Tv(o,a)),a.type===Zc&&(a.el=o.el)}}function X1(i){const e=i.slice(),t=[0];let r,n,s,o,a;const l=i.length;for(r=0;r<l;r++){const c=i[r];if(c!==0){if(n=t[t.length-1],i[n]<c){e[r]=n,t.push(r);continue}for(s=0,o=t.length-1;s<o;)a=s+o>>1,i[t[a]]<c?s=a+1:o=a;c<i[t[s]]&&(s>0&&(e[r]=t[s-1]),t[s]=r)}}for(s=t.length,o=t[s-1];s-- >0;)t[s]=o,o=e[o];return t}function Av(i){const e=i.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:Av(e)}function pp(i){if(i)for(let e=0;e<i.length;e++)i[e].active=!1}const K1=Symbol.for("v-scx"),J1=()=>Vt(K1),Za={};function Ar(i,e,t){return Lv(i,e,t)}function Lv(i,e,{immediate:t,deep:r,flush:n,once:s,onTrack:o,onTrigger:a}=St){if(e&&s){const S=e;e=(...A)=>{S(...A),M()}}const l=jt,c=S=>r===!0?S:dn(S,r===!1?1:void 0);let d,u=!1,h=!1;if(Ht(i)?(d=()=>i.value,u=rc(i)):Wo(i)?(d=()=>c(i),u=!0):Ue(i)?(h=!0,u=i.some(S=>Wo(S)||rc(S)),d=()=>i.map(S=>{if(Ht(S))return S.value;if(Wo(S))return c(S);if(Ye(S))return pn(S,l,2)})):Ye(i)?e?d=()=>pn(i,l,2):d=()=>(p&&p(),Ai(i,l,3,[g])):d=ki,e&&r){const S=d;d=()=>dn(S())}let p,g=S=>{p=w.onStop=()=>{pn(S,l,4),p=w.onStop=void 0}},f;if(Qc)if(g=ki,e?t&&Ai(e,l,3,[d(),h?[]:void 0,g]):d(),n==="sync"){const S=J1();f=S.__watcherHandles||(S.__watcherHandles=[])}else return ki;let m=h?new Array(i.length).fill(Za):Za;const b=()=>{if(!(!w.active||!w.dirty))if(e){const S=w.run();(r||u||(h?S.some((A,x)=>bn(A,m[x])):bn(S,m)))&&(p&&p(),Ai(e,l,3,[S,m===Za?void 0:h&&m[0]===Za?[]:m,g]),m=S)}else w.run()};b.allowRecurse=!!e;let y;n==="sync"?y=b:n==="post"?y=()=>ni(b,l&&l.suspense):(b.pre=!0,l&&(b.id=l.uid),y=()=>Ah(b));const w=new wh(d,ki,y),_=N0(),M=()=>{w.stop(),_&&vh(_.effects,w)};return e?t?b():m=w.run():n==="post"?ni(w.run.bind(w),l&&l.suspense):w.run(),f&&f.push(M),M}function Z1(i,e,t){const r=this.proxy,n=kt(i)?i.includes(".")?Dv(r,i):()=>r[i]:i.bind(r,r);let s;Ye(e)?s=e:(s=e.handler,t=e);const o=Ra(this),a=Lv(n,s.bind(r),t);return o(),a}function Dv(i,e){const t=e.split(".");return()=>{let r=i;for(let n=0;n<t.length&&r;n++)r=r[t[n]];return r}}function dn(i,e=1/0,t){if(e<=0||!bt(i)||i.__v_skip||(t=t||new Set,t.has(i)))return i;if(t.add(i),e--,Ht(i))dn(i.value,e,t);else if(Ue(i))for(let r=0;r<i.length;r++)dn(i[r],e,t);else if(ao(i)||js(i))i.forEach(r=>{dn(r,e,t)});else if(P0(i)){for(const r in i)dn(i[r],e,t);for(const r of Object.getOwnPropertySymbols(i))Object.prototype.propertyIsEnumerable.call(i,r)&&dn(i[r],e,t)}return i}const Jc=i=>i.type.__isKeepAlive;function Q1(i,e){Pv(i,"a",e)}function ew(i,e){Pv(i,"da",e)}function Pv(i,e,t=jt){const r=i.__wdc||(i.__wdc=()=>{let n=t;for(;n;){if(n.isDeactivated)return;n=n.parent}return i()});if(Kc(e,r,t),t){let n=t.parent;for(;n&&n.parent;)Jc(n.parent.vnode)&&tw(r,e,t,n),n=n.parent}}function tw(i,e,t,r){const n=Kc(e,i,r,!0);Ph(()=>{vh(r[e],n)},t)}const tn=Symbol("_leaveCb"),Qa=Symbol("_enterCb");function iw(){const i={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return uo(()=>{i.isMounted=!0}),Dh(()=>{i.isUnmounting=!0}),i}const wi=[Function,Array],Rv={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:wi,onEnter:wi,onAfterEnter:wi,onEnterCancelled:wi,onBeforeLeave:wi,onLeave:wi,onAfterLeave:wi,onLeaveCancelled:wi,onBeforeAppear:wi,onAppear:wi,onAfterAppear:wi,onAppearCancelled:wi},Iv=i=>{const e=i.subTree;return e.component?Iv(e.component):e},rw={name:"BaseTransition",props:Rv,setup(i,{slots:e}){const t=zh(),r=iw();return()=>{const n=e.default&&Fv(e.default(),!0);if(!n||!n.length)return;let s=n[0];if(n.length>1){for(const h of n)if(h.type!==Zt){s=h;break}}const o=ft(i),{mode:a}=o;if(r.isLeaving)return Ed(s);const l=mp(s);if(!l)return Ed(s);let c=$u(l,o,r,t,h=>c=h);oc(l,c);const d=t.subTree,u=d&&mp(d);if(u&&u.type!==Zt&&!Un(l,u)&&Iv(t).type!==Zt){const h=$u(u,o,r,t);if(oc(u,h),a==="out-in"&&l.type!==Zt)return r.isLeaving=!0,h.afterLeave=()=>{r.isLeaving=!1,t.update.active!==!1&&(t.effect.dirty=!0,t.update())},Ed(s);a==="in-out"&&l.type!==Zt&&(h.delayLeave=(p,g,f)=>{const m=Ov(r,u);m[String(u.key)]=u,p[tn]=()=>{g(),p[tn]=void 0,delete c.delayedLeave},c.delayedLeave=f})}return s}}},nw=rw;function Ov(i,e){const{leavingVNodes:t}=i;let r=t.get(e.type);return r||(r=Object.create(null),t.set(e.type,r)),r}function $u(i,e,t,r,n){const{appear:s,mode:o,persisted:a=!1,onBeforeEnter:l,onEnter:c,onAfterEnter:d,onEnterCancelled:u,onBeforeLeave:h,onLeave:p,onAfterLeave:g,onLeaveCancelled:f,onBeforeAppear:m,onAppear:b,onAfterAppear:y,onAppearCancelled:w}=e,_=String(i.key),M=Ov(t,i),S=(E,D)=>{E&&Ai(E,r,9,D)},A=(E,D)=>{const F=D[1];S(E,D),Ue(E)?E.every(R=>R.length<=1)&&F():E.length<=1&&F()},x={mode:o,persisted:a,beforeEnter(E){let D=l;if(!t.isMounted)if(s)D=m||l;else return;E[tn]&&E[tn](!0);const F=M[_];F&&Un(i,F)&&F.el[tn]&&F.el[tn](),S(D,[E])},enter(E){let D=c,F=d,R=u;if(!t.isMounted)if(s)D=b||c,F=y||d,R=w||u;else return;let B=!1;const I=E[Qa]=V=>{B||(B=!0,V?S(R,[E]):S(F,[E]),x.delayedLeave&&x.delayedLeave(),E[Qa]=void 0)};D?A(D,[E,I]):I()},leave(E,D){const F=String(i.key);if(E[Qa]&&E[Qa](!0),t.isUnmounting)return D();S(h,[E]);let R=!1;const B=E[tn]=I=>{R||(R=!0,D(),I?S(f,[E]):S(g,[E]),E[tn]=void 0,M[F]===i&&delete M[F])};M[F]=i,p?A(p,[E,B]):B()},clone(E){const D=$u(E,e,t,r,n);return n&&n(D),D}};return x}function Ed(i){if(Jc(i))return i=_n(i),i.children=null,i}function mp(i){if(!Jc(i))return i;const{shapeFlag:e,children:t}=i;if(t){if(e&16)return t[0];if(e&32&&Ye(t.default))return t.default()}}function oc(i,e){i.shapeFlag&6&&i.component?oc(i.component.subTree,e):i.shapeFlag&128?(i.ssContent.transition=e.clone(i.ssContent),i.ssFallback.transition=e.clone(i.ssFallback)):i.transition=e}function Fv(i,e=!1,t){let r=[],n=0;for(let s=0;s<i.length;s++){let o=i[s];const a=t==null?o.key:String(t)+String(o.key!=null?o.key:s);o.type===be?(o.patchFlag&128&&n++,r=r.concat(Fv(o.children,e,a))):(e||o.type!==Zt)&&r.push(a!=null?_n(o,{key:a}):o)}if(n>1)for(let s=0;s<r.length;s++)r[s].patchFlag=-2;return r}const sw=i=>i.__isTeleport,be=Symbol.for("v-fgt"),Zc=Symbol.for("v-txt"),Zt=Symbol.for("v-cmt"),kd=Symbol.for("v-stc"),Xo=[];let Vi=null;function P(i=!1){Xo.push(Vi=i?null:[])}function ow(){Xo.pop(),Vi=Xo[Xo.length-1]||null}let pa=1;function gp(i){pa+=i}function zv(i){return i.dynamicChildren=pa>0?Vi||Us:null,ow(),pa>0&&Vi&&Vi.push(i),i}function z(i,e,t,r,n,s){return zv(v(i,e,t,r,n,s,!0))}function Ge(i,e,t,r,n){return zv(H(i,e,t,r,n,!0))}function ac(i){return i?i.__v_isVNode===!0:!1}function Un(i,e){return i.type===e.type&&i.key===e.key}const Nv=({key:i})=>i??null,Vl=({ref:i,ref_key:e,ref_for:t})=>(typeof i=="number"&&(i=""+i),i!=null?kt(i)||Ht(i)||Ye(i)?{i:Bt,r:i,k:e,f:!!t}:i:null);function v(i,e=null,t=null,r=0,n=null,s=i===be?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:i,props:e,key:e&&Nv(e),ref:e&&Vl(e),scopeId:Xc,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:r,dynamicProps:n,dynamicChildren:null,appContext:null,ctx:Bt};return a?(Fh(l,t),s&128&&i.normalize(l)):t&&(l.shapeFlag|=kt(t)?8:16),pa>0&&!o&&Vi&&(l.patchFlag>0||s&6)&&l.patchFlag!==32&&Vi.push(l),l}const H=aw;function aw(i,e=null,t=null,r=0,n=null,s=!1){if((!i||i===uv)&&(i=Zt),ac(i)){const a=_n(i,e,!0);return t&&Fh(a,t),pa>0&&!s&&Vi&&(a.shapeFlag&6?Vi[Vi.indexOf(i)]=a:Vi.push(a)),a.patchFlag=-2,a}if(mw(i)&&(i=i.__vccOpts),e){e=Oh(e);let{class:a,style:l}=e;a&&!kt(a)&&(e.class=Se(a)),bt(l)&&(Z0(l)&&!Ue(l)&&(l=Pt({},l)),e.style=Ut(l))}const o=kt(i)?1:M1(i)?128:sw(i)?64:bt(i)?4:Ye(i)?2:0;return v(i,e,t,r,n,o,s,!0)}function Oh(i){return i?Z0(i)||xv(i)?Pt({},i):i:null}function _n(i,e,t=!1,r=!1){const{props:n,ref:s,patchFlag:o,children:a,transition:l}=i,c=e?Pa(n||{},e):n,d={__v_isVNode:!0,__v_skip:!0,type:i.type,props:c,key:c&&Nv(c),ref:e&&e.ref?t&&s?Ue(s)?s.concat(Vl(e)):[s,Vl(e)]:Vl(e):s,scopeId:i.scopeId,slotScopeIds:i.slotScopeIds,children:a,target:i.target,targetAnchor:i.targetAnchor,staticCount:i.staticCount,shapeFlag:i.shapeFlag,patchFlag:e&&i.type!==be?o===-1?16:o|16:o,dynamicProps:i.dynamicProps,dynamicChildren:i.dynamicChildren,appContext:i.appContext,dirs:i.dirs,transition:l,component:i.component,suspense:i.suspense,ssContent:i.ssContent&&_n(i.ssContent),ssFallback:i.ssFallback&&_n(i.ssFallback),el:i.el,anchor:i.anchor,ctx:i.ctx,ce:i.ce};return l&&r&&oc(d,l.clone(d)),d}function he(i=" ",e=0){return H(Zc,null,i,e)}function Le(i="",e=!1){return e?(P(),Ge(Zt,null,i)):H(Zt,null,i)}function Ki(i){return i==null||typeof i=="boolean"?H(Zt):Ue(i)?H(be,null,i.slice()):typeof i=="object"?rn(i):H(Zc,null,String(i))}function rn(i){return i.el===null&&i.patchFlag!==-1||i.memo?i:_n(i)}function Fh(i,e){let t=0;const{shapeFlag:r}=i;if(e==null)e=null;else if(Ue(e))t=16;else if(typeof e=="object")if(r&65){const n=e.default;n&&(n._c&&(n._d=!1),Fh(i,n()),n._c&&(n._d=!0));return}else{t=32;const n=e._;!n&&!xv(e)?e._ctx=Bt:n===3&&Bt&&(Bt.slots._===1?e._=1:(e._=2,i.patchFlag|=1024))}else Ye(e)?(e={default:e,_ctx:Bt},t=32):(e=String(e),r&64?(t=16,e=[he(e)]):t=8);i.children=e,i.shapeFlag|=t}function Pa(...i){const e={};for(let t=0;t<i.length;t++){const r=i[t];for(const n in r)if(n==="class")e.class!==r.class&&(e.class=Se([e.class,r.class]));else if(n==="style")e.style=Ut([e.style,r.style]);else if(Uc(n)){const s=e[n],o=r[n];o&&s!==o&&!(Ue(s)&&s.includes(o))&&(e[n]=s?[].concat(s,o):o)}else n!==""&&(e[n]=r[n])}return e}function Gi(i,e,t,r=null){Ai(i,e,7,[t,r])}const lw=yv();let cw=0;function dw(i,e,t){const r=i.type,n=(e?e.appContext:i.appContext)||lw,s={uid:cw++,vnode:i,type:r,parent:e,appContext:n,root:null,next:null,subTree:null,effect:null,update:null,scope:new z_(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(n.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Mv(r,n),emitsOptions:lv(r,n),emit:null,emitted:null,propsDefaults:St,inheritAttrs:r.inheritAttrs,ctx:St,data:St,props:St,attrs:St,slots:St,refs:St,setupState:St,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=b1.bind(null,s),i.ce&&i.ce(s),s}let jt=null;const zh=()=>jt||Bt;let lc,Bu;{const i=I0(),e=(t,r)=>{let n;return(n=i[t])||(n=i[t]=[]),n.push(r),s=>{n.length>1?n.forEach(o=>o(s)):n[0](s)}};lc=e("__VUE_INSTANCE_SETTERS__",t=>jt=t),Bu=e("__VUE_SSR_SETTERS__",t=>Qc=t)}const Ra=i=>{const e=jt;return lc(i),i.scope.on(),()=>{i.scope.off(),lc(e)}},vp=()=>{jt&&jt.scope.off(),lc(null)};function $v(i){return i.vnode.shapeFlag&4}let Qc=!1;function uw(i,e=!1){e&&Bu(e);const{props:t,children:r}=i.vnode,n=$v(i);V1(i,t,n,e),j1(i,r);const s=n?hw(i,e):void 0;return e&&Bu(!1),s}function hw(i,e){const t=i.type;i.accessCache=Object.create(null),i.proxy=new Proxy(i.ctx,P1);const{setup:r}=t;if(r){const n=i.setupContext=r.length>1?Vv(i):null,s=Ra(i);En();const o=pn(r,i,0,[i.props,n]);if(kn(),s(),L0(o)){if(o.then(vp,vp),e)return o.then(a=>{bp(i,a,e)}).catch(a=>{qc(a,i,0)});i.asyncDep=o}else bp(i,o,e)}else Bv(i,e)}function bp(i,e,t){Ye(e)?i.type.__ssrInlineRender?i.ssrRender=e:i.render=e:bt(e)&&(i.setupState=iv(e)),Bv(i,t)}let yp;function Bv(i,e,t){const r=i.type;if(!i.render){if(!e&&yp&&!r.render){const n=r.template||Rh(i).template;if(n){const{isCustomElement:s,compilerOptions:o}=i.appContext.config,{delimiters:a,compilerOptions:l}=r,c=Pt(Pt({isCustomElement:s,delimiters:a},o),l);r.render=yp(n,c)}}i.render=r.render||ki}{const n=Ra(i);En();try{I1(i)}finally{kn(),n()}}}const fw={get(i,e){return ai(i,"get",""),i[e]}};function Vv(i){const e=t=>{i.exposed=t||{}};return{attrs:new Proxy(i.attrs,fw),slots:i.slots,emit:i.emit,expose:e}}function ed(i){return i.exposed?i.exposeProxy||(i.exposeProxy=new Proxy(iv(o1(i.exposed)),{get(e,t){if(t in e)return e[t];if(t in qo)return qo[t](i)},has(e,t){return t in e||t in qo}})):i.proxy}function pw(i,e=!0){return Ye(i)?i.displayName||i.name:i.name||e&&i.__name}function mw(i){return Ye(i)&&"__vccOpts"in i}const ke=(i,e)=>a1(i,e,Qc);function ma(i,e,t){const r=arguments.length;return r===2?bt(e)&&!Ue(e)?ac(e)?H(i,null,[e]):H(i,e):H(i,null,e):(r>3?t=Array.prototype.slice.call(arguments,2):r===3&&ac(t)&&(t=[t]),H(i,e,t))}const gw="3.4.31";/**
* @vue/runtime-dom v3.4.31
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const vw="http://www.w3.org/2000/svg",bw="http://www.w3.org/1998/Math/MathML",Mr=typeof document<"u"?document:null,_p=Mr&&Mr.createElement("template"),yw={insert:(i,e,t)=>{e.insertBefore(i,t||null)},remove:i=>{const e=i.parentNode;e&&e.removeChild(i)},createElement:(i,e,t,r)=>{const n=e==="svg"?Mr.createElementNS(vw,i):e==="mathml"?Mr.createElementNS(bw,i):t?Mr.createElement(i,{is:t}):Mr.createElement(i);return i==="select"&&r&&r.multiple!=null&&n.setAttribute("multiple",r.multiple),n},createText:i=>Mr.createTextNode(i),createComment:i=>Mr.createComment(i),setText:(i,e)=>{i.nodeValue=e},setElementText:(i,e)=>{i.textContent=e},parentNode:i=>i.parentNode,nextSibling:i=>i.nextSibling,querySelector:i=>Mr.querySelector(i),setScopeId(i,e){i.setAttribute(e,"")},insertStaticContent(i,e,t,r,n,s){const o=t?t.previousSibling:e.lastChild;if(n&&(n===s||n.nextSibling))for(;e.insertBefore(n.cloneNode(!0),t),!(n===s||!(n=n.nextSibling)););else{_p.innerHTML=r==="svg"?`<svg>${i}</svg>`:r==="mathml"?`<math>${i}</math>`:i;const a=_p.content;if(r==="svg"||r==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,t)}return[o?o.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},zr="transition",_o="animation",ga=Symbol("_vtc"),Nh=(i,{slots:e})=>ma(nw,_w(i),e);Nh.displayName="Transition";const Hv={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};Nh.props=Pt({},Rv,Hv);const Dn=(i,e=[])=>{Ue(i)?i.forEach(t=>t(...e)):i&&i(...e)},wp=i=>i?Ue(i)?i.some(e=>e.length>1):i.length>1:!1;function _w(i){const e={};for(const R in i)R in Hv||(e[R]=i[R]);if(i.css===!1)return e;const{name:t="v",type:r,duration:n,enterFromClass:s=`${t}-enter-from`,enterActiveClass:o=`${t}-enter-active`,enterToClass:a=`${t}-enter-to`,appearFromClass:l=s,appearActiveClass:c=o,appearToClass:d=a,leaveFromClass:u=`${t}-leave-from`,leaveActiveClass:h=`${t}-leave-active`,leaveToClass:p=`${t}-leave-to`}=i,g=ww(n),f=g&&g[0],m=g&&g[1],{onBeforeEnter:b,onEnter:y,onEnterCancelled:w,onLeave:_,onLeaveCancelled:M,onBeforeAppear:S=b,onAppear:A=y,onAppearCancelled:x=w}=e,E=(R,B,I)=>{Pn(R,B?d:a),Pn(R,B?c:o),I&&I()},D=(R,B)=>{R._isLeaving=!1,Pn(R,u),Pn(R,p),Pn(R,h),B&&B()},F=R=>(B,I)=>{const V=R?A:y,N=()=>E(B,R,I);Dn(V,[B,N]),xp(()=>{Pn(B,R?l:s),Nr(B,R?d:a),wp(V)||Sp(B,r,f,N)})};return Pt(e,{onBeforeEnter(R){Dn(b,[R]),Nr(R,s),Nr(R,o)},onBeforeAppear(R){Dn(S,[R]),Nr(R,l),Nr(R,c)},onEnter:F(!1),onAppear:F(!0),onLeave(R,B){R._isLeaving=!0;const I=()=>D(R,B);Nr(R,u),Nr(R,h),Mw(),xp(()=>{R._isLeaving&&(Pn(R,u),Nr(R,p),wp(_)||Sp(R,r,m,I))}),Dn(_,[R,I])},onEnterCancelled(R){E(R,!1),Dn(w,[R])},onAppearCancelled(R){E(R,!0),Dn(x,[R])},onLeaveCancelled(R){D(R),Dn(M,[R])}})}function ww(i){if(i==null)return null;if(bt(i))return[Cd(i.enter),Cd(i.leave)];{const e=Cd(i);return[e,e]}}function Cd(i){return A_(i)}function Nr(i,e){e.split(/\s+/).forEach(t=>t&&i.classList.add(t)),(i[ga]||(i[ga]=new Set)).add(e)}function Pn(i,e){e.split(/\s+/).forEach(r=>r&&i.classList.remove(r));const t=i[ga];t&&(t.delete(e),t.size||(i[ga]=void 0))}function xp(i){requestAnimationFrame(()=>{requestAnimationFrame(i)})}let xw=0;function Sp(i,e,t,r){const n=i._endId=++xw,s=()=>{n===i._endId&&r()};if(t)return setTimeout(s,t);const{type:o,timeout:a,propCount:l}=Sw(i,e);if(!o)return r();const c=o+"end";let d=0;const u=()=>{i.removeEventListener(c,h),s()},h=p=>{p.target===i&&++d>=l&&u()};setTimeout(()=>{d<l&&u()},a+1),i.addEventListener(c,h)}function Sw(i,e){const t=window.getComputedStyle(i),r=g=>(t[g]||"").split(", "),n=r(`${zr}Delay`),s=r(`${zr}Duration`),o=Mp(n,s),a=r(`${_o}Delay`),l=r(`${_o}Duration`),c=Mp(a,l);let d=null,u=0,h=0;e===zr?o>0&&(d=zr,u=o,h=s.length):e===_o?c>0&&(d=_o,u=c,h=l.length):(u=Math.max(o,c),d=u>0?o>c?zr:_o:null,h=d?d===zr?s.length:l.length:0);const p=d===zr&&/\b(transform|all)(,|$)/.test(r(`${zr}Property`).toString());return{type:d,timeout:u,propCount:h,hasTransform:p}}function Mp(i,e){for(;i.length<e.length;)i=i.concat(i);return Math.max(...e.map((t,r)=>Ep(t)+Ep(i[r])))}function Ep(i){return i==="auto"?0:Number(i.slice(0,-1).replace(",","."))*1e3}function Mw(){return document.body.offsetHeight}function Ew(i,e,t){const r=i[ga];r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?i.removeAttribute("class"):t?i.setAttribute("class",e):i.className=e}const cc=Symbol("_vod"),Uv=Symbol("_vsh"),jv={beforeMount(i,{value:e},{transition:t}){i[cc]=i.style.display==="none"?"":i.style.display,t&&e?t.beforeEnter(i):wo(i,e)},mounted(i,{value:e},{transition:t}){t&&e&&t.enter(i)},updated(i,{value:e,oldValue:t},{transition:r}){!e!=!t&&(r?e?(r.beforeEnter(i),wo(i,!0),r.enter(i)):r.leave(i,()=>{wo(i,!1)}):wo(i,e))},beforeUnmount(i,{value:e}){wo(i,e)}};function wo(i,e){i.style.display=e?i[cc]:"none",i[Uv]=!e}const kw=Symbol(""),Cw=/(^|;)\s*display\s*:/;function Tw(i,e,t){const r=i.style,n=kt(t);let s=!1;if(t&&!n){if(e)if(kt(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();t[a]==null&&Hl(r,a,"")}else for(const o in e)t[o]==null&&Hl(r,o,"");for(const o in t)o==="display"&&(s=!0),Hl(r,o,t[o])}else if(n){if(e!==t){const o=r[kw];o&&(t+=";"+o),r.cssText=t,s=Cw.test(t)}}else e&&i.removeAttribute("style");cc in i&&(i[cc]=s?r.display:"",i[Uv]&&(r.display="none"))}const kp=/\s*!important$/;function Hl(i,e,t){if(Ue(t))t.forEach(r=>Hl(i,e,r));else if(t==null&&(t=""),e.startsWith("--"))i.setProperty(e,t);else{const r=Aw(i,e);kp.test(t)?i.setProperty(hs(r),t.replace(kp,""),"important"):i[r]=t}}const Cp=["Webkit","Moz","ms"],Td={};function Aw(i,e){const t=Td[e];if(t)return t;let r=sr(e);if(r!=="filter"&&r in i)return Td[e]=r;r=Wc(r);for(let n=0;n<Cp.length;n++){const s=Cp[n]+r;if(s in i)return Td[e]=s}return e}const Tp="http://www.w3.org/1999/xlink";function Ap(i,e,t,r,n,s=O_(e)){r&&e.startsWith("xlink:")?t==null?i.removeAttributeNS(Tp,e.slice(6,e.length)):i.setAttributeNS(Tp,e,t):t==null||s&&!O0(t)?i.removeAttribute(e):i.setAttribute(e,s?"":nr(t)?String(t):t)}function Lw(i,e,t,r,n,s,o){if(e==="innerHTML"||e==="textContent"){r&&o(r,n,s),i[e]=t??"";return}const a=i.tagName;if(e==="value"&&a!=="PROGRESS"&&!a.includes("-")){const c=a==="OPTION"?i.getAttribute("value")||"":i.value,d=t==null?"":String(t);(c!==d||!("_value"in i))&&(i.value=d),t==null&&i.removeAttribute(e),i._value=t;return}let l=!1;if(t===""||t==null){const c=typeof i[e];c==="boolean"?t=O0(t):t==null&&c==="string"?(t="",l=!0):c==="number"&&(t=0,l=!0)}try{i[e]=t}catch{}l&&i.removeAttribute(e)}function kr(i,e,t,r){i.addEventListener(e,t,r)}function Dw(i,e,t,r){i.removeEventListener(e,t,r)}const Lp=Symbol("_vei");function Pw(i,e,t,r,n=null){const s=i[Lp]||(i[Lp]={}),o=s[e];if(r&&o)o.value=r;else{const[a,l]=Rw(e);if(r){const c=s[e]=Fw(r,n);kr(i,a,c,l)}else o&&(Dw(i,a,o,l),s[e]=void 0)}}const Dp=/(?:Once|Passive|Capture)$/;function Rw(i){let e;if(Dp.test(i)){e={};let r;for(;r=i.match(Dp);)i=i.slice(0,i.length-r[0].length),e[r[0].toLowerCase()]=!0}return[i[2]===":"?i.slice(3):hs(i.slice(2)),e]}let Ad=0;const Iw=Promise.resolve(),Ow=()=>Ad||(Iw.then(()=>Ad=0),Ad=Date.now());function Fw(i,e){const t=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=t.attached)return;Ai(zw(r,t.value),e,5,[r])};return t.value=i,t.attached=Ow(),t}function zw(i,e){if(Ue(e)){const t=i.stopImmediatePropagation;return i.stopImmediatePropagation=()=>{t.call(i),i._stopped=!0},e.map(r=>n=>!n._stopped&&r&&r(n))}else return e}const Pp=i=>i.charCodeAt(0)===111&&i.charCodeAt(1)===110&&i.charCodeAt(2)>96&&i.charCodeAt(2)<123,Nw=(i,e,t,r,n,s,o,a,l)=>{const c=n==="svg";e==="class"?Ew(i,r,c):e==="style"?Tw(i,t,r):Uc(e)?gh(e)||Pw(i,e,t,r,o):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):$w(i,e,r,c))?(Lw(i,e,r,s,o,a,l),!i.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Ap(i,e,r,c,o,e!=="value")):(e==="true-value"?i._trueValue=r:e==="false-value"&&(i._falseValue=r),Ap(i,e,r,c))};function $w(i,e,t,r){if(r)return!!(e==="innerHTML"||e==="textContent"||e in i&&Pp(e)&&Ye(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&i.tagName==="INPUT"||e==="type"&&i.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const n=i.tagName;if(n==="IMG"||n==="VIDEO"||n==="CANVAS"||n==="SOURCE")return!1}return Pp(e)&&kt(t)?!1:e in i}const wn=i=>{const e=i.props["onUpdate:modelValue"]||!1;return Ue(e)?t=>$l(e,t):e};function Bw(i){i.target.composing=!0}function Rp(i){const e=i.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const Li=Symbol("_assign"),qt={created(i,{modifiers:{lazy:e,trim:t,number:r}},n){i[Li]=wn(n);const s=r||n.props&&n.props.type==="number";kr(i,e?"change":"input",o=>{if(o.target.composing)return;let a=i.value;t&&(a=a.trim()),s&&(a=tc(a)),i[Li](a)}),t&&kr(i,"change",()=>{i.value=i.value.trim()}),e||(kr(i,"compositionstart",Bw),kr(i,"compositionend",Rp),kr(i,"change",Rp))},mounted(i,{value:e}){i.value=e??""},beforeUpdate(i,{value:e,oldValue:t,modifiers:{lazy:r,trim:n,number:s}},o){if(i[Li]=wn(o),i.composing)return;const a=(s||i.type==="number")&&!/^0\d/.test(i.value)?tc(i.value):i.value,l=e??"";a!==l&&(document.activeElement===i&&i.type!=="range"&&(r&&e===t||n&&i.value.trim()===l)||(i.value=l))}},$h={deep:!0,created(i,e,t){i[Li]=wn(t),kr(i,"change",()=>{const r=i._modelValue,n=Zs(i),s=i.checked,o=i[Li];if(Ue(r)){const a=_h(r,n),l=a!==-1;if(s&&!l)o(r.concat(n));else if(!s&&l){const c=[...r];c.splice(a,1),o(c)}}else if(ao(r)){const a=new Set(r);s?a.add(n):a.delete(n),o(a)}else o(Gv(i,s))})},mounted:Ip,beforeUpdate(i,e,t){i[Li]=wn(t),Ip(i,e,t)}};function Ip(i,{value:e,oldValue:t},r){i._modelValue=e,Ue(e)?i.checked=_h(e,r.props.value)>-1:ao(e)?i.checked=e.has(r.props.value):e!==t&&(i.checked=ss(e,Gv(i,!0)))}const Vw={created(i,{value:e},t){i.checked=ss(e,t.props.value),i[Li]=wn(t),kr(i,"change",()=>{i[Li](Zs(i))})},beforeUpdate(i,{value:e,oldValue:t},r){i[Li]=wn(r),e!==t&&(i.checked=ss(e,r.props.value))}},Wv={deep:!0,created(i,{value:e,modifiers:{number:t}},r){const n=ao(e);kr(i,"change",()=>{const s=Array.prototype.filter.call(i.options,o=>o.selected).map(o=>t?tc(Zs(o)):Zs(o));i[Li](i.multiple?n?new Set(s):s:s[0]),i._assigning=!0,co(()=>{i._assigning=!1})}),i[Li]=wn(r)},mounted(i,{value:e,modifiers:{number:t}}){Op(i,e)},beforeUpdate(i,e,t){i[Li]=wn(t)},updated(i,{value:e,modifiers:{number:t}}){i._assigning||Op(i,e)}};function Op(i,e,t){const r=i.multiple,n=Ue(e);if(!(r&&!n&&!ao(e))){for(let s=0,o=i.options.length;s<o;s++){const a=i.options[s],l=Zs(a);if(r)if(n){const c=typeof l;c==="string"||c==="number"?a.selected=e.some(d=>String(d)===String(l)):a.selected=_h(e,l)>-1}else a.selected=e.has(l);else if(ss(Zs(a),e)){i.selectedIndex!==s&&(i.selectedIndex=s);return}}!r&&i.selectedIndex!==-1&&(i.selectedIndex=-1)}}function Zs(i){return"_value"in i?i._value:i.value}function Gv(i,e){const t=e?"_trueValue":"_falseValue";return t in i?i[t]:e}const Hw={created(i,e,t){el(i,e,t,null,"created")},mounted(i,e,t){el(i,e,t,null,"mounted")},beforeUpdate(i,e,t,r){el(i,e,t,r,"beforeUpdate")},updated(i,e,t,r){el(i,e,t,r,"updated")}};function Uw(i,e){switch(i){case"SELECT":return Wv;case"TEXTAREA":return qt;default:switch(e){case"checkbox":return $h;case"radio":return Vw;default:return qt}}}function el(i,e,t,r,n){const o=Uw(i.tagName,t.props&&t.props.type)[n];o&&o(i,e,t,r)}const jw=["ctrl","shift","alt","meta"],Ww={stop:i=>i.stopPropagation(),prevent:i=>i.preventDefault(),self:i=>i.target!==i.currentTarget,ctrl:i=>!i.ctrlKey,shift:i=>!i.shiftKey,alt:i=>!i.altKey,meta:i=>!i.metaKey,left:i=>"button"in i&&i.button!==0,middle:i=>"button"in i&&i.button!==1,right:i=>"button"in i&&i.button!==2,exact:(i,e)=>jw.some(t=>i[`${t}Key`]&&!e.includes(t))},Gw=(i,e)=>{const t=i._withMods||(i._withMods={}),r=e.join(".");return t[r]||(t[r]=(n,...s)=>{for(let o=0;o<e.length;o++){const a=Ww[e[o]];if(a&&a(n,e))return}return i(n,...s)})},qw={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},qv=(i,e)=>{const t=i._withKeys||(i._withKeys={}),r=e.join(".");return t[r]||(t[r]=n=>{if(!("key"in n))return;const s=hs(n.key);if(e.some(o=>o===s||qw[o]===s))return i(n)})},Yw=Pt({patchProp:Nw},yw);let Fp;function Xw(){return Fp||(Fp=G1(Yw))}const Kw=(...i)=>{const e=Xw().createApp(...i),{mount:t}=e;return e.mount=r=>{const n=Zw(r);if(!n)return;const s=e._component;!Ye(s)&&!s.render&&!s.template&&(s.template=n.innerHTML),n.innerHTML="";const o=t(n,!1,Jw(n));return n instanceof Element&&(n.removeAttribute("v-cloak"),n.setAttribute("data-v-app","")),o},e};function Jw(i){if(i instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&i instanceof MathMLElement)return"mathml"}function Zw(i){return kt(i)?document.querySelector(i):i}const Qw="/trip/logo_small.png";/*!
  * vue-router v4.4.0
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const $s=typeof document<"u";function ex(i){return i.__esModule||i[Symbol.toStringTag]==="Module"}const vt=Object.assign;function Ld(i,e){const t={};for(const r in e){const n=e[r];t[r]=ji(n)?n.map(i):i(n)}return t}const Ko=()=>{},ji=Array.isArray,Yv=/#/g,tx=/&/g,ix=/\//g,rx=/=/g,nx=/\?/g,Xv=/\+/g,sx=/%5B/g,ox=/%5D/g,Kv=/%5E/g,ax=/%60/g,Jv=/%7B/g,lx=/%7C/g,Zv=/%7D/g,cx=/%20/g;function Bh(i){return encodeURI(""+i).replace(lx,"|").replace(sx,"[").replace(ox,"]")}function dx(i){return Bh(i).replace(Jv,"{").replace(Zv,"}").replace(Kv,"^")}function Vu(i){return Bh(i).replace(Xv,"%2B").replace(cx,"+").replace(Yv,"%23").replace(tx,"%26").replace(ax,"`").replace(Jv,"{").replace(Zv,"}").replace(Kv,"^")}function ux(i){return Vu(i).replace(rx,"%3D")}function hx(i){return Bh(i).replace(Yv,"%23").replace(nx,"%3F")}function fx(i){return i==null?"":hx(i).replace(ix,"%2F")}function va(i){try{return decodeURIComponent(""+i)}catch{}return""+i}const px=/\/$/,mx=i=>i.replace(px,"");function Dd(i,e,t="/"){let r,n={},s="",o="";const a=e.indexOf("#");let l=e.indexOf("?");return a<l&&a>=0&&(l=-1),l>-1&&(r=e.slice(0,l),s=e.slice(l+1,a>-1?a:e.length),n=i(s)),a>-1&&(r=r||e.slice(0,a),o=e.slice(a,e.length)),r=yx(r??e,t),{fullPath:r+(s&&"?")+s+o,path:r,query:n,hash:va(o)}}function gx(i,e){const t=e.query?i(e.query):"";return e.path+(t&&"?")+t+(e.hash||"")}function zp(i,e){return!e||!i.toLowerCase().startsWith(e.toLowerCase())?i:i.slice(e.length)||"/"}function vx(i,e,t){const r=e.matched.length-1,n=t.matched.length-1;return r>-1&&r===n&&Qs(e.matched[r],t.matched[n])&&Qv(e.params,t.params)&&i(e.query)===i(t.query)&&e.hash===t.hash}function Qs(i,e){return(i.aliasOf||i)===(e.aliasOf||e)}function Qv(i,e){if(Object.keys(i).length!==Object.keys(e).length)return!1;for(const t in i)if(!bx(i[t],e[t]))return!1;return!0}function bx(i,e){return ji(i)?Np(i,e):ji(e)?Np(e,i):i===e}function Np(i,e){return ji(e)?i.length===e.length&&i.every((t,r)=>t===e[r]):i.length===1&&i[0]===e}function yx(i,e){if(i.startsWith("/"))return i;if(!i)return e;const t=e.split("/"),r=i.split("/"),n=r[r.length-1];(n===".."||n===".")&&r.push("");let s=t.length-1,o,a;for(o=0;o<r.length;o++)if(a=r[o],a!==".")if(a==="..")s>1&&s--;else break;return t.slice(0,s).join("/")+"/"+r.slice(o).join("/")}const $r={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var ba;(function(i){i.pop="pop",i.push="push"})(ba||(ba={}));var Jo;(function(i){i.back="back",i.forward="forward",i.unknown=""})(Jo||(Jo={}));function _x(i){if(!i)if($s){const e=document.querySelector("base");i=e&&e.getAttribute("href")||"/",i=i.replace(/^\w+:\/\/[^\/]+/,"")}else i="/";return i[0]!=="/"&&i[0]!=="#"&&(i="/"+i),mx(i)}const wx=/^[^#]+#/;function xx(i,e){return i.replace(wx,"#")+e}function Sx(i,e){const t=document.documentElement.getBoundingClientRect(),r=i.getBoundingClientRect();return{behavior:e.behavior,left:r.left-t.left-(e.left||0),top:r.top-t.top-(e.top||0)}}const td=()=>({left:window.scrollX,top:window.scrollY});function Mx(i){let e;if("el"in i){const t=i.el,r=typeof t=="string"&&t.startsWith("#"),n=typeof t=="string"?r?document.getElementById(t.slice(1)):document.querySelector(t):t;if(!n)return;e=Sx(n,i)}else e=i;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function $p(i,e){return(history.state?history.state.position-e:-1)+i}const Hu=new Map;function Ex(i,e){Hu.set(i,e)}function kx(i){const e=Hu.get(i);return Hu.delete(i),e}let Cx=()=>location.protocol+"//"+location.host;function eb(i,e){const{pathname:t,search:r,hash:n}=e,s=i.indexOf("#");if(s>-1){let a=n.includes(i.slice(s))?i.slice(s).length:1,l=n.slice(a);return l[0]!=="/"&&(l="/"+l),zp(l,"")}return zp(t,i)+r+n}function Tx(i,e,t,r){let n=[],s=[],o=null;const a=({state:h})=>{const p=eb(i,location),g=t.value,f=e.value;let m=0;if(h){if(t.value=p,e.value=h,o&&o===g){o=null;return}m=f?h.position-f.position:0}else r(p);n.forEach(b=>{b(t.value,g,{delta:m,type:ba.pop,direction:m?m>0?Jo.forward:Jo.back:Jo.unknown})})};function l(){o=t.value}function c(h){n.push(h);const p=()=>{const g=n.indexOf(h);g>-1&&n.splice(g,1)};return s.push(p),p}function d(){const{history:h}=window;h.state&&h.replaceState(vt({},h.state,{scroll:td()}),"")}function u(){for(const h of s)h();s=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",d)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",d,{passive:!0}),{pauseListeners:l,listen:c,destroy:u}}function Bp(i,e,t,r=!1,n=!1){return{back:i,current:e,forward:t,replaced:r,position:window.history.length,scroll:n?td():null}}function Ax(i){const{history:e,location:t}=window,r={value:eb(i,t)},n={value:e.state};n.value||s(r.value,{back:null,current:r.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function s(l,c,d){const u=i.indexOf("#"),h=u>-1?(t.host&&document.querySelector("base")?i:i.slice(u))+l:Cx()+i+l;try{e[d?"replaceState":"pushState"](c,"",h),n.value=c}catch(p){console.error(p),t[d?"replace":"assign"](h)}}function o(l,c){const d=vt({},e.state,Bp(n.value.back,l,n.value.forward,!0),c,{position:n.value.position});s(l,d,!0),r.value=l}function a(l,c){const d=vt({},n.value,e.state,{forward:l,scroll:td()});s(d.current,d,!0);const u=vt({},Bp(r.value,l,null),{position:d.position+1},c);s(l,u,!1),r.value=l}return{location:r,state:n,push:a,replace:o}}function Lx(i){i=_x(i);const e=Ax(i),t=Tx(i,e.state,e.location,e.replace);function r(s,o=!0){o||t.pauseListeners(),history.go(s)}const n=vt({location:"",base:i,go:r,createHref:xx.bind(null,i)},e,t);return Object.defineProperty(n,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(n,"state",{enumerable:!0,get:()=>e.state.value}),n}function Dx(i){return typeof i=="string"||i&&typeof i=="object"}function tb(i){return typeof i=="string"||typeof i=="symbol"}const ib=Symbol("");var Vp;(function(i){i[i.aborted=4]="aborted",i[i.cancelled=8]="cancelled",i[i.duplicated=16]="duplicated"})(Vp||(Vp={}));function eo(i,e){return vt(new Error,{type:i,[ib]:!0},e)}function dr(i,e){return i instanceof Error&&ib in i&&(e==null||!!(i.type&e))}const Hp="[^/]+?",Px={sensitive:!1,strict:!1,start:!0,end:!0},Rx=/[.+*?^${}()[\]/\\]/g;function Ix(i,e){const t=vt({},Px,e),r=[];let n=t.start?"^":"";const s=[];for(const c of i){const d=c.length?[]:[90];t.strict&&!c.length&&(n+="/");for(let u=0;u<c.length;u++){const h=c[u];let p=40+(t.sensitive?.25:0);if(h.type===0)u||(n+="/"),n+=h.value.replace(Rx,"\\$&"),p+=40;else if(h.type===1){const{value:g,repeatable:f,optional:m,regexp:b}=h;s.push({name:g,repeatable:f,optional:m});const y=b||Hp;if(y!==Hp){p+=10;try{new RegExp(`(${y})`)}catch(_){throw new Error(`Invalid custom RegExp for param "${g}" (${y}): `+_.message)}}let w=f?`((?:${y})(?:/(?:${y}))*)`:`(${y})`;u||(w=m&&c.length<2?`(?:/${w})`:"/"+w),m&&(w+="?"),n+=w,p+=20,m&&(p+=-8),f&&(p+=-20),y===".*"&&(p+=-50)}d.push(p)}r.push(d)}if(t.strict&&t.end){const c=r.length-1;r[c][r[c].length-1]+=.7000000000000001}t.strict||(n+="/?"),t.end?n+="$":t.strict&&(n+="(?:/|$)");const o=new RegExp(n,t.sensitive?"":"i");function a(c){const d=c.match(o),u={};if(!d)return null;for(let h=1;h<d.length;h++){const p=d[h]||"",g=s[h-1];u[g.name]=p&&g.repeatable?p.split("/"):p}return u}function l(c){let d="",u=!1;for(const h of i){(!u||!d.endsWith("/"))&&(d+="/"),u=!1;for(const p of h)if(p.type===0)d+=p.value;else if(p.type===1){const{value:g,repeatable:f,optional:m}=p,b=g in c?c[g]:"";if(ji(b)&&!f)throw new Error(`Provided param "${g}" is an array but it is not repeatable (* or + modifiers)`);const y=ji(b)?b.join("/"):b;if(!y)if(m)h.length<2&&(d.endsWith("/")?d=d.slice(0,-1):u=!0);else throw new Error(`Missing required param "${g}"`);d+=y}}return d||"/"}return{re:o,score:r,keys:s,parse:a,stringify:l}}function Ox(i,e){let t=0;for(;t<i.length&&t<e.length;){const r=e[t]-i[t];if(r)return r;t++}return i.length<e.length?i.length===1&&i[0]===80?-1:1:i.length>e.length?e.length===1&&e[0]===80?1:-1:0}function rb(i,e){let t=0;const r=i.score,n=e.score;for(;t<r.length&&t<n.length;){const s=Ox(r[t],n[t]);if(s)return s;t++}if(Math.abs(n.length-r.length)===1){if(Up(r))return 1;if(Up(n))return-1}return n.length-r.length}function Up(i){const e=i[i.length-1];return i.length>0&&e[e.length-1]<0}const Fx={type:0,value:""},zx=/[a-zA-Z0-9_]/;function Nx(i){if(!i)return[[]];if(i==="/")return[[Fx]];if(!i.startsWith("/"))throw new Error(`Invalid path "${i}"`);function e(p){throw new Error(`ERR (${t})/"${c}": ${p}`)}let t=0,r=t;const n=[];let s;function o(){s&&n.push(s),s=[]}let a=0,l,c="",d="";function u(){c&&(t===0?s.push({type:0,value:c}):t===1||t===2||t===3?(s.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),s.push({type:1,value:c,regexp:d,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),c="")}function h(){c+=l}for(;a<i.length;){if(l=i[a++],l==="\\"&&t!==2){r=t,t=4;continue}switch(t){case 0:l==="/"?(c&&u(),o()):l===":"?(u(),t=1):h();break;case 4:h(),t=r;break;case 1:l==="("?t=2:zx.test(l)?h():(u(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&a--);break;case 2:l===")"?d[d.length-1]=="\\"?d=d.slice(0,-1)+l:t=3:d+=l;break;case 3:u(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&a--,d="";break;default:e("Unknown state");break}}return t===2&&e(`Unfinished custom RegExp for param "${c}"`),u(),o(),n}function $x(i,e,t){const r=Ix(Nx(i.path),t),n=vt(r,{record:i,parent:e,children:[],alias:[]});return e&&!n.record.aliasOf==!e.record.aliasOf&&e.children.push(n),n}function Bx(i,e){const t=[],r=new Map;e=Gp({strict:!1,end:!0,sensitive:!1},e);function n(u){return r.get(u)}function s(u,h,p){const g=!p,f=Vx(u);f.aliasOf=p&&p.record;const m=Gp(e,u),b=[f];if("alias"in u){const _=typeof u.alias=="string"?[u.alias]:u.alias;for(const M of _)b.push(vt({},f,{components:p?p.record.components:f.components,path:M,aliasOf:p?p.record:f}))}let y,w;for(const _ of b){const{path:M}=_;if(h&&M[0]!=="/"){const S=h.record.path,A=S[S.length-1]==="/"?"":"/";_.path=h.record.path+(M&&A+M)}if(y=$x(_,h,m),p?p.alias.push(y):(w=w||y,w!==y&&w.alias.push(y),g&&u.name&&!Wp(y)&&o(u.name)),nb(y)&&l(y),f.children){const S=f.children;for(let A=0;A<S.length;A++)s(S[A],y,p&&p.children[A])}p=p||y}return w?()=>{o(w)}:Ko}function o(u){if(tb(u)){const h=r.get(u);h&&(r.delete(u),t.splice(t.indexOf(h),1),h.children.forEach(o),h.alias.forEach(o))}else{const h=t.indexOf(u);h>-1&&(t.splice(h,1),u.record.name&&r.delete(u.record.name),u.children.forEach(o),u.alias.forEach(o))}}function a(){return t}function l(u){const h=jx(u,t);t.splice(h,0,u),u.record.name&&!Wp(u)&&r.set(u.record.name,u)}function c(u,h){let p,g={},f,m;if("name"in u&&u.name){if(p=r.get(u.name),!p)throw eo(1,{location:u});m=p.record.name,g=vt(jp(h.params,p.keys.filter(w=>!w.optional).concat(p.parent?p.parent.keys.filter(w=>w.optional):[]).map(w=>w.name)),u.params&&jp(u.params,p.keys.map(w=>w.name))),f=p.stringify(g)}else if(u.path!=null)f=u.path,p=t.find(w=>w.re.test(f)),p&&(g=p.parse(f),m=p.record.name);else{if(p=h.name?r.get(h.name):t.find(w=>w.re.test(h.path)),!p)throw eo(1,{location:u,currentLocation:h});m=p.record.name,g=vt({},h.params,u.params),f=p.stringify(g)}const b=[];let y=p;for(;y;)b.unshift(y.record),y=y.parent;return{name:m,path:f,params:g,matched:b,meta:Ux(b)}}i.forEach(u=>s(u));function d(){t.length=0,r.clear()}return{addRoute:s,resolve:c,removeRoute:o,clearRoutes:d,getRoutes:a,getRecordMatcher:n}}function jp(i,e){const t={};for(const r of e)r in i&&(t[r]=i[r]);return t}function Vx(i){return{path:i.path,redirect:i.redirect,name:i.name,meta:i.meta||{},aliasOf:void 0,beforeEnter:i.beforeEnter,props:Hx(i),children:i.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in i?i.components||null:i.component&&{default:i.component}}}function Hx(i){const e={},t=i.props||!1;if("component"in i)e.default=t;else for(const r in i.components)e[r]=typeof t=="object"?t[r]:t;return e}function Wp(i){for(;i;){if(i.record.aliasOf)return!0;i=i.parent}return!1}function Ux(i){return i.reduce((e,t)=>vt(e,t.meta),{})}function Gp(i,e){const t={};for(const r in i)t[r]=r in e?e[r]:i[r];return t}function jx(i,e){let t=0,r=e.length;for(;t!==r;){const s=t+r>>1;rb(i,e[s])<0?r=s:t=s+1}const n=Wx(i);return n&&(r=e.lastIndexOf(n,r-1)),r}function Wx(i){let e=i;for(;e=e.parent;)if(nb(e)&&rb(i,e)===0)return e}function nb({record:i}){return!!(i.name||i.components&&Object.keys(i.components).length||i.redirect)}function Gx(i){const e={};if(i===""||i==="?")return e;const r=(i[0]==="?"?i.slice(1):i).split("&");for(let n=0;n<r.length;++n){const s=r[n].replace(Xv," "),o=s.indexOf("="),a=va(o<0?s:s.slice(0,o)),l=o<0?null:va(s.slice(o+1));if(a in e){let c=e[a];ji(c)||(c=e[a]=[c]),c.push(l)}else e[a]=l}return e}function qp(i){let e="";for(let t in i){const r=i[t];if(t=ux(t),r==null){r!==void 0&&(e+=(e.length?"&":"")+t);continue}(ji(r)?r.map(s=>s&&Vu(s)):[r&&Vu(r)]).forEach(s=>{s!==void 0&&(e+=(e.length?"&":"")+t,s!=null&&(e+="="+s))})}return e}function qx(i){const e={};for(const t in i){const r=i[t];r!==void 0&&(e[t]=ji(r)?r.map(n=>n==null?null:""+n):r==null?r:""+r)}return e}const Yx=Symbol(""),Yp=Symbol(""),Vh=Symbol(""),sb=Symbol(""),Uu=Symbol("");function xo(){let i=[];function e(r){return i.push(r),()=>{const n=i.indexOf(r);n>-1&&i.splice(n,1)}}function t(){i=[]}return{add:e,list:()=>i.slice(),reset:t}}function nn(i,e,t,r,n,s=o=>o()){const o=r&&(r.enterCallbacks[n]=r.enterCallbacks[n]||[]);return()=>new Promise((a,l)=>{const c=h=>{h===!1?l(eo(4,{from:t,to:e})):h instanceof Error?l(h):Dx(h)?l(eo(2,{from:e,to:h})):(o&&r.enterCallbacks[n]===o&&typeof h=="function"&&o.push(h),a())},d=s(()=>i.call(r&&r.instances[n],e,t,c));let u=Promise.resolve(d);i.length<3&&(u=u.then(c)),u.catch(h=>l(h))})}function Pd(i,e,t,r,n=s=>s()){const s=[];for(const o of i)for(const a in o.components){let l=o.components[a];if(!(e!=="beforeRouteEnter"&&!o.instances[a]))if(Xx(l)){const d=(l.__vccOpts||l)[e];d&&s.push(nn(d,t,r,o,a,n))}else{let c=l();s.push(()=>c.then(d=>{if(!d)return Promise.reject(new Error(`Couldn't resolve component "${a}" at "${o.path}"`));const u=ex(d)?d.default:d;o.components[a]=u;const p=(u.__vccOpts||u)[e];return p&&nn(p,t,r,o,a,n)()}))}}return s}function Xx(i){return typeof i=="object"||"displayName"in i||"props"in i||"__vccOpts"in i}function Xp(i){const e=Vt(Vh),t=Vt(sb),r=ke(()=>{const l=Ee(i.to);return e.resolve(l)}),n=ke(()=>{const{matched:l}=r.value,{length:c}=l,d=l[c-1],u=t.matched;if(!d||!u.length)return-1;const h=u.findIndex(Qs.bind(null,d));if(h>-1)return h;const p=Kp(l[c-2]);return c>1&&Kp(d)===p&&u[u.length-1].path!==p?u.findIndex(Qs.bind(null,l[c-2])):h}),s=ke(()=>n.value>-1&&Zx(t.params,r.value.params)),o=ke(()=>n.value>-1&&n.value===t.matched.length-1&&Qv(t.params,r.value.params));function a(l={}){return Jx(l)?e[Ee(i.replace)?"replace":"push"](Ee(i.to)).catch(Ko):Promise.resolve()}return{route:r,href:ke(()=>r.value.href),isActive:s,isExactActive:o,navigate:a}}const Kx=ht({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Xp,setup(i,{slots:e}){const t=lo(Xp(i)),{options:r}=Vt(Vh),n=ke(()=>({[Jp(i.activeClass,r.linkActiveClass,"router-link-active")]:t.isActive,[Jp(i.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:t.isExactActive}));return()=>{const s=e.default&&e.default(t);return i.custom?s:ma("a",{"aria-current":t.isExactActive?i.ariaCurrentValue:null,href:t.href,onClick:t.navigate,class:n.value},s)}}}),Ul=Kx;function Jx(i){if(!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)&&!i.defaultPrevented&&!(i.button!==void 0&&i.button!==0)){if(i.currentTarget&&i.currentTarget.getAttribute){const e=i.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return i.preventDefault&&i.preventDefault(),!0}}function Zx(i,e){for(const t in e){const r=e[t],n=i[t];if(typeof r=="string"){if(r!==n)return!1}else if(!ji(n)||n.length!==r.length||r.some((s,o)=>s!==n[o]))return!1}return!0}function Kp(i){return i?i.aliasOf?i.aliasOf.path:i.path:""}const Jp=(i,e,t)=>i??e??t,Qx=ht({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(i,{attrs:e,slots:t}){const r=Vt(Uu),n=ke(()=>i.route||r.value),s=Vt(Yp,0),o=ke(()=>{let c=Ee(s);const{matched:d}=n.value;let u;for(;(u=d[c])&&!u.components;)c++;return c}),a=ke(()=>n.value.matched[o.value]);Bi(Yp,ke(()=>o.value+1)),Bi(Yx,a),Bi(Uu,n);const l=Qt();return Ar(()=>[l.value,a.value,i.name],([c,d,u],[h,p,g])=>{d&&(d.instances[u]=c,p&&p!==d&&c&&c===h&&(d.leaveGuards.size||(d.leaveGuards=p.leaveGuards),d.updateGuards.size||(d.updateGuards=p.updateGuards))),c&&d&&(!p||!Qs(d,p)||!h)&&(d.enterCallbacks[u]||[]).forEach(f=>f(c))},{flush:"post"}),()=>{const c=n.value,d=i.name,u=a.value,h=u&&u.components[d];if(!h)return Zp(t.default,{Component:h,route:c});const p=u.props[d],g=p?p===!0?c.params:typeof p=="function"?p(c):p:null,m=ma(h,vt({},g,e,{onVnodeUnmounted:b=>{b.component.isUnmounted&&(u.instances[d]=null)},ref:l}));return Zp(t.default,{Component:m,route:c})||m}}});function Zp(i,e){if(!i)return null;const t=i(e);return t.length===1?t[0]:t}const ob=Qx;function eS(i){const e=Bx(i.routes,i),t=i.parseQuery||Gx,r=i.stringifyQuery||qp,n=i.history,s=xo(),o=xo(),a=xo(),l=l1($r);let c=$r;$s&&i.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const d=Ld.bind(null,te=>""+te),u=Ld.bind(null,fx),h=Ld.bind(null,va);function p(te,fe){let pe,de;return tb(te)?(pe=e.getRecordMatcher(te),de=fe):de=te,e.addRoute(de,pe)}function g(te){const fe=e.getRecordMatcher(te);fe&&e.removeRoute(fe)}function f(){return e.getRoutes().map(te=>te.record)}function m(te){return!!e.getRecordMatcher(te)}function b(te,fe){if(fe=vt({},fe||l.value),typeof te=="string"){const $=Dd(t,te,fe.path),Z=e.resolve({path:$.path},fe),le=n.createHref($.fullPath);return vt($,Z,{params:h(Z.params),hash:va($.hash),redirectedFrom:void 0,href:le})}let pe;if(te.path!=null)pe=vt({},te,{path:Dd(t,te.path,fe.path).path});else{const $=vt({},te.params);for(const Z in $)$[Z]==null&&delete $[Z];pe=vt({},te,{params:u($)}),fe.params=u(fe.params)}const de=e.resolve(pe,fe),He=te.hash||"";de.params=d(h(de.params));const $e=gx(r,vt({},te,{hash:dx(He),path:de.path})),L=n.createHref($e);return vt({fullPath:$e,hash:He,query:r===qp?qx(te.query):te.query||{}},de,{redirectedFrom:void 0,href:L})}function y(te){return typeof te=="string"?Dd(t,te,l.value.path):vt({},te)}function w(te,fe){if(c!==te)return eo(8,{from:fe,to:te})}function _(te){return A(te)}function M(te){return _(vt(y(te),{replace:!0}))}function S(te){const fe=te.matched[te.matched.length-1];if(fe&&fe.redirect){const{redirect:pe}=fe;let de=typeof pe=="function"?pe(te):pe;return typeof de=="string"&&(de=de.includes("?")||de.includes("#")?de=y(de):{path:de},de.params={}),vt({query:te.query,hash:te.hash,params:de.path!=null?{}:te.params},de)}}function A(te,fe){const pe=c=b(te),de=l.value,He=te.state,$e=te.force,L=te.replace===!0,$=S(pe);if($)return A(vt(y($),{state:typeof $=="object"?vt({},He,$.state):He,force:$e,replace:L}),fe||pe);const Z=pe;Z.redirectedFrom=fe;let le;return!$e&&vx(r,de,pe)&&(le=eo(16,{to:Z,from:de}),me(de,de,!0,!1)),(le?Promise.resolve(le):D(Z,de)).catch(oe=>dr(oe)?dr(oe,2)?oe:ee(oe):Y(oe,Z,de)).then(oe=>{if(oe){if(dr(oe,2))return A(vt({replace:L},y(oe.to),{state:typeof oe.to=="object"?vt({},He,oe.to.state):He,force:$e}),fe||Z)}else oe=R(Z,de,!0,L,He);return F(Z,de,oe),oe})}function x(te,fe){const pe=w(te,fe);return pe?Promise.reject(pe):Promise.resolve()}function E(te){const fe=Ce.values().next().value;return fe&&typeof fe.runWithContext=="function"?fe.runWithContext(te):te()}function D(te,fe){let pe;const[de,He,$e]=tS(te,fe);pe=Pd(de.reverse(),"beforeRouteLeave",te,fe);for(const $ of de)$.leaveGuards.forEach(Z=>{pe.push(nn(Z,te,fe))});const L=x.bind(null,te,fe);return pe.push(L),se(pe).then(()=>{pe=[];for(const $ of s.list())pe.push(nn($,te,fe));return pe.push(L),se(pe)}).then(()=>{pe=Pd(He,"beforeRouteUpdate",te,fe);for(const $ of He)$.updateGuards.forEach(Z=>{pe.push(nn(Z,te,fe))});return pe.push(L),se(pe)}).then(()=>{pe=[];for(const $ of $e)if($.beforeEnter)if(ji($.beforeEnter))for(const Z of $.beforeEnter)pe.push(nn(Z,te,fe));else pe.push(nn($.beforeEnter,te,fe));return pe.push(L),se(pe)}).then(()=>(te.matched.forEach($=>$.enterCallbacks={}),pe=Pd($e,"beforeRouteEnter",te,fe,E),pe.push(L),se(pe))).then(()=>{pe=[];for(const $ of o.list())pe.push(nn($,te,fe));return pe.push(L),se(pe)}).catch($=>dr($,8)?$:Promise.reject($))}function F(te,fe,pe){a.list().forEach(de=>E(()=>de(te,fe,pe)))}function R(te,fe,pe,de,He){const $e=w(te,fe);if($e)return $e;const L=fe===$r,$=$s?history.state:{};pe&&(de||L?n.replace(te.fullPath,vt({scroll:L&&$&&$.scroll},He)):n.push(te.fullPath,He)),l.value=te,me(te,fe,pe,L),ee()}let B;function I(){B||(B=n.listen((te,fe,pe)=>{if(!We.listening)return;const de=b(te),He=S(de);if(He){A(vt(He,{replace:!0}),de).catch(Ko);return}c=de;const $e=l.value;$s&&Ex($p($e.fullPath,pe.delta),td()),D(de,$e).catch(L=>dr(L,12)?L:dr(L,2)?(A(L.to,de).then($=>{dr($,20)&&!pe.delta&&pe.type===ba.pop&&n.go(-1,!1)}).catch(Ko),Promise.reject()):(pe.delta&&n.go(-pe.delta,!1),Y(L,de,$e))).then(L=>{L=L||R(de,$e,!1),L&&(pe.delta&&!dr(L,8)?n.go(-pe.delta,!1):pe.type===ba.pop&&dr(L,20)&&n.go(-1,!1)),F(de,$e,L)}).catch(Ko)}))}let V=xo(),N=xo(),j;function Y(te,fe,pe){ee(te);const de=N.list();return de.length?de.forEach(He=>He(te,fe,pe)):console.error(te),Promise.reject(te)}function W(){return j&&l.value!==$r?Promise.resolve():new Promise((te,fe)=>{V.add([te,fe])})}function ee(te){return j||(j=!te,I(),V.list().forEach(([fe,pe])=>te?pe(te):fe()),V.reset()),te}function me(te,fe,pe,de){const{scrollBehavior:He}=i;if(!$s||!He)return Promise.resolve();const $e=!pe&&kx($p(te.fullPath,0))||(de||!pe)&&history.state&&history.state.scroll||null;return co().then(()=>He(te,fe,$e)).then(L=>L&&Mx(L)).catch(L=>Y(L,te,fe))}const X=te=>n.go(te);let ye;const Ce=new Set,We={currentRoute:l,listening:!0,addRoute:p,removeRoute:g,clearRoutes:e.clearRoutes,hasRoute:m,getRoutes:f,resolve:b,options:i,push:_,replace:M,go:X,back:()=>X(-1),forward:()=>X(1),beforeEach:s.add,beforeResolve:o.add,afterEach:a.add,onError:N.add,isReady:W,install(te){const fe=this;te.component("RouterLink",Ul),te.component("RouterView",ob),te.config.globalProperties.$router=fe,Object.defineProperty(te.config.globalProperties,"$route",{enumerable:!0,get:()=>Ee(l)}),$s&&!ye&&l.value===$r&&(ye=!0,_(n.location).catch(He=>{}));const pe={};for(const He in $r)Object.defineProperty(pe,He,{get:()=>l.value[He],enumerable:!0});te.provide(Vh,fe),te.provide(sb,K0(pe)),te.provide(Uu,l);const de=te.unmount;Ce.add(te),te.unmount=function(){Ce.delete(te),Ce.size<1&&(c=$r,B&&B(),B=null,l.value=$r,ye=!1,j=!1),de()}}};function se(te){return te.reduce((fe,pe)=>fe.then(()=>E(pe)),Promise.resolve())}return We}function tS(i,e){const t=[],r=[],n=[],s=Math.max(e.matched.length,i.matched.length);for(let o=0;o<s;o++){const a=e.matched[o];a&&(i.matched.find(c=>Qs(c,a))?r.push(a):t.push(a));const l=i.matched[o];l&&(e.matched.find(c=>Qs(c,l))||n.push(l))}return[t,r,n]}function Bo(i,e,t){this.k=i,this.x=e,this.y=t}Bo.prototype={constructor:Bo,scale:function(i){return i===1?this:new Bo(this.k*i,this.x,this.y)},translate:function(i,e){return i===0&e===0?this:new Bo(this.k,this.x+this.k*i,this.y+this.k*e)},apply:function(i){return[i[0]*this.k+this.x,i[1]*this.k+this.y]},applyX:function(i){return i*this.k+this.x},applyY:function(i){return i*this.k+this.y},invert:function(i){return[(i[0]-this.x)/this.k,(i[1]-this.y)/this.k]},invertX:function(i){return(i-this.x)/this.k},invertY:function(i){return(i-this.y)/this.k},rescaleX:function(i){return i.copy().domain(i.range().map(this.invertX,this).map(i.invert,i))},rescaleY:function(i){return i.copy().domain(i.range().map(this.invertY,this).map(i.invert,i))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Bo.prototype;const Br={might:"Мощь",reason:"Разум",charisma:"Харизма",trickery:"Хитрость",intuition:"Интуиция",perception:"Восприятие",attack:"Конфликт",order:"Порядок",impact:"Влияние",defence:"Коварство",sabotage:"Хаос",research:"Поиск"},gt={war:{id:"war",name:"Война",attr:"might",opposite:"shadow",checks:"attack",traits:[{name:"Первый удар",desc:"",levels:["Противник не может отреагировать на Ваше передвижение, если Вы атакуете сразу после сближения. Тем не менее, он может отреагировать после.","Противник, по которому Вы попали после сближения, теряет один порыв прямо перед атакой. Если у него не оставалось порывов, его защита ниже на одну категорию до конца Вашей атаки.","Противник, которого Вы атакуете сразу после сближения, теряет два порыва и не может отреагировать даже после атаки. Если у него не хватает порывов, он теряет по одной категории защиты за каждый, эффект длится до начала Вашего следующего хода"]},{name:"Шквал ударов",desc:"",levels:["Потратив два порыва, Вы можете провести одну атаку.","Потратив два порыва, Вы можете провести одну атаку, при этом Вы добавляете к броску кость порыва.","В свой ход Вы можете проводить дополнительную атаку, затратив всего одну кость порыва. Кость порыва к броску при этом не добавляется."]},{name:"Подавление",desc:"",levels:["Ваши атаки мешают противнику действовать, даже если они не попадают по цели. Тот, кого Вы атаковали в свой ход с порывом считается подавленным до конца Вашего следующего хода. Он получает штраф к передвижению в одну клетку, атаке и защите - в одну категорию. Эти штрафы не складываются.","Противнику приходится тратить всё больше времени и внимания, чтобы бороться с Вашим напором. Каждая атака с порывом по уже подавленному противнику забирает у него один порыв (если он есть), или понижает защиту на две категории вместо одной (если порывы закончились)","Вы достигли мастерства в подавлении противника. Вам больше не обязательно вкладывать порывы в свои атаки, чтобы подавление сработало."]}]},knowledge:{id:"knowledge",name:"Знания",attr:"reason",opposite:"mystics",checks:"order",traits:[{name:"Образование",desc:"",levels:["Получив хорошую обучающую книгу о каком-то навыке, Вы можете научиться его первому уровню, затратив на это не менее месяца времени. Обучение обойдётся Вам в одно очко повышения, если у Вас нет необходимого класса или бесплатно, если он есть. Вы не можете таким образом изучать навыки противоположных аспектов (или их смежные)","Найдя хорошего мастера навыка (владеющего его третьей ступенью), Вы можете научиться второму уровню. На это Вам и Вашему учителю придётся потратить как минимум месяц времени. Это обойдётся Вам в два очка повышения, если у Вас нет необходимого класса или бесплатно, если он есть. ","Вы можете обучать других тем навыкам, которыми владеете сами. Вам и Вашему ученику потребуется не менее месяца, а обучаемый так же потратит одно очко повышения за уровень навыка, если у него нет необходимого класса. Вашему ученику не обязательно иметь навык “Образование”. На этом уровне Вы можете обучаться навыкам противоположных аспектов. "]},{name:"Живой ум",desc:"",levels:["Ваш пытливый ум позволяет Вам быстрее разбираться в любых сферах знаний, которыми владеют разумные. Поиск информации в книгах и библиотеках для Вас на две категории проще. Вы хорошо читаете карты, Вам на одну категорию проще планировать маршрут так, чтобы избежать опасностей или выйти на желаемую точку боевой карты.","Вы постоянно подмечаете и запоминаете, Ваш разум анализирует и раскладывает по полочкам. Если Вы видите за работой специалиста гражданского профиля на протяжении хотя бы нескольких часов, все Ваши проверки по его профессии впоследствии на одну категорию проще. Если он взялся обучать Вас и на это был затрачен хотя бы один день, проверки на две категории проще. Кроме того, Вы хорошо разбираетесь в общеизвестной истории, в курсе новейших открытий и изобретений."," Вы знаете и понимаете так много, что зачастую можете дать полезную подсказку даже хорошему специалисту. Если он готов принять Вашу помощь и делится своими планами или соображениями, Вы можете снизить сложность проверки на одну категорию или даже на две, если область знания принадлежит Вашему классу или смежному."]},{name:"В руках мастера",desc:"",levels:["Пока для других механизмы - просто инструмент достижения целей, для Вас это ещё и загадка, которую хочется разгадать. Починка механических устройств и обезвреживание механических ловушек с Вашей помощью легче на две категории. Кроме того, Вы можете потратить некоторое время на то, чтобы аккуратно разобрать устройство и понять, как создавать подобные в будущем. Для этого Вам нужно будет пройти проверку, тем более сложную, чем более сложное оборудование Вы разбираете. Это умение не распространяется на магические предметы и артефакты.","Большой опыт в работе с различными механизмами дал свои плоды - затратив достаточно времени Вы можете сами изобрести некое механическое устройство. Придуманный Вами предмет должен быть принципиально возможным в этом мире и должен опережать технический уровень общества не слишком сильно. Сложность проверки для попытки изобрести нечто определяется мастером. Теперь Вы можете разбирать чтобы изучить и магические предметы, а также Ваш бонус на починку и обезвреживание теперь распространяется и на магические устройства и ловушки. Вы можете создавать простые механические ловушки.","Теперь Вы можете изобретать и магические устройства и ловушки. Ваше глубокое понимание магии также даёт Вам значительный бонус к заклинаниям - теперь вызов заклинания основным действием всегда работает так, как будто Вы так же затратили один порыв."]}]},society:{id:"society",name:"Общество",opposite:"nature",attr:"charisma",checks:"impact",traits:[{name:"Всё продаётся",desc:"",levels:["Вы тонко чувствуете потребности окружающих и что они готовы отдать за желаемое. Если Вы пытаетесь выяснить мотивацию персонажа или распознать ложь, Ваши проверки на две категории проще (6). Занимаясь любой работой, Вы можете подняться на одну ступень Богатства выше, чем остальные. Скорость набора Богатства, впрочем, остаётся прежней. Если Вы живёте в городе, Ваш уровень Богатства никогда не опускается ниже Среднего (5)","Продавая добычу после боевого похода Вы можете выручить на две категории больше. Занимаясь любой работой, Вы набираете Богатство вдвое быстрее других.","Один раз в месяц Вы можете покупать предмет выше своего уровня Богатства на 1 без затрат, либо на 2 уровня, потеряв при этом только один уровень Богатства"]},{name:"Прочные связи",desc:"",levels:["Большинство окружающих, которым Вы не чинили явного зла, считают Вас как минимум приятелем (Симпатия, 1). Вы знаете как найти выходы на всех влиятельных людей Вашего поселения, а также можете за несколько дней найти общих знакомых с специалистом какой-то профессии, если он есть в Вашем поселении. Вы можете давать взятки на одну категорию меньшие, чтобы добиться того же эффекта.","Проведя хотя бы три месяца в поселении, Вы обретаете влияние, с которым приходится считаться. Ваши просьбы и угрозы звучат гораздо весомее. Вам также значительно проще искать что-то в обществе - будь это скрывающийся человек или особый товар. Проверки проще на две категории (6). Даже если Вам не удаётся найти искомое, велика вероятность что Вам дадут хотя бы наводку на того, кто может знать ответ. Помогать Вам будут только те силы и фракции, с которыми Вы как минимум не враждуете. Затраты Влияния на значительные услуги снижены на одну категорию.","Если Вы проводите в поселении хотя бы полгода, Вам удаётся наладить контакт со всеми лидерами фракций (Значительное Влияние, 3) кроме тех что к Вам враждебны. Ваше Влияние на фракции растёт с удвоенной скоростью и никогда не опускается ниже Значительного (3). Когда Вы впервые посещаете поселения, которые активно контактируют с Вашим, Вы сразу получаете преимущества второго уровня этого умения. Преимущества третьего Вы можете получить, проведя в нём месяц. Вам легче внедрять свои задумки в другие фракции, ведь во всех (даже во враждебных) у Вас есть свои люди. Эти проверки проще на две категории."]},{name:"Друг моего друга",desc:"",levels:["Имея как минимум Высокое (5) влияние на фракцию, Вы можете попросить их порекомендовать Вас кому-то. При этом Вы потратите два уровня Репутации, но приобретёте один у цели. Для этого Ваша цель должна быть в хороших отношениях с фракцией.","Вам удаётся поддерживать связь даже со знакомыми в других поселениях и государствах. Вы можете найти знакомого или знакомого знакомого почти в любом крупном поселении. В результате Ваши проверки на Поиск в других поселениях проще на две категории. Кроме того, Вы получаете информацию и новости из далёких земель значительно раньше других.","Ваш круг знакомых и друзей превращается в настоящую паутину. Ваша Репутация у невраждебных фракций в других поселениях как минимум Неплохая (2), проверки на Порядок и Диверсию проще на категорию. Если Ваш уровень Богатства как минимум Зажиточный (7), проверки становятся проще ещё на одну категорию."]}]},shadow:{id:"shadow",name:"Тень",attr:"trickery",opposite:"war",checks:"defence",traits:[{name:"Хитрый план",desc:"",levels:["Один раз в месяц Вы можете добавить облегчить свою проверку социального Влияния, используя свою Хитрость. Сложность снижается на одну категорию за каждые три полные единицы в параметре Хитрость. Есть некая верятность, что местные власти сочтут Ваши действия незаконными.","Вы можете использовать эту способность два раза в месяц.","Теперь Вы можете использовать эту способность на проверках Диверсии"]},{name:"Военная хитрость",desc:"",levels:["Проводя первую атаку по противнику за свой ход, Вы добавляете к броску кость порыва, не затрачивая порыв, если сразу после этого разрываете дистанцию (ближний бой) или скрываетесь из виду (дальний бой).","Вы учитесь использовать быстрый отскок - затратив один порыв, Вы можете отскочить назад на две клетки. Такое действие не вызывает срабатывания реакций. ","В бою Вы можете двигаться боком с полной скоростью. Кроме того, если Вы видите как противник пытается атаковать Вас, Вы можете отреагировать за мгновение до этой атаки, если Ваша Защита превосходит его Атаку. Это распространяется даже на дистанционные атаки."]},{name:"Порхай как бабочка",desc:"",levels:["Вы научились наносить невероятно точные удары. Максимальное количество костей порыва, которые Вы можете использовать в броске атаки увеличивается до двух.","Ваша скорость передвижения увеличивается на единицу. Доступное Вам максимальное количество порывов также увеличивается на единицу.","Идеальный способ обезопасить себя - закончить бой одним невероятно точным ударом. Максимальное количество костей порыва, которые Вы можете использовать в броске атаки увеличивается до трёх."]}]},mystics:{id:"mystics",name:"Мистика",attr:"intuition",opposite:"knowledge",checks:"sabotage",traits:[{name:"Духовные практики",desc:"",levels:["Вы чувствуете мир иначе чем другие и можете находить связь там где другие её не увидят. Вы можете повысить любую характеристику на 1, пока следуете некоторой духовной практике. Это может быть аскеза, обет, небольшой ежедневный ритуал. Объясните, как эта практика мистически связана с пользой, которую Вы получаете. Вы начинаете получать преимущества когда использовали практику как минимум месяц.","Вы можете одновременно получать пользу от двух духовных практик направленных на две разные характеристики, или от одной более сложной, повышающей характеристику на 2. В обоих случаях это уже не может быть чем-то небольшим, никак не влияющим на Ваш уровень комфорта.","Погружаясь в практики всё дальше, Вы можете использовать 3 очков повышения, распределив их как угодно по трём характеристикам, выбирая значения 1, 2 или 3. Такой уровень погружения требует значительных затрат времени и ресурсов, может вызывать непонимание в обществе и иногда создавать значительные проблемы."]},{name:"Невозможные знания",desc:"",levels:["Иногда Вы просто знаете то, чего никак не могли знать. В боевых ситуациях один раз в день Вы можете задать вопрос, в ответ на который Вам явится подсказка. Вопрос должен касаться того, с чем Вы взаимодействуете или как минимум находитесь на расстоянии нескольких минут движения пешком. Подсказка должна быть правдивой, но не всегда будет точно отвечать на Ваш вопрос, иногда лишь касаться его косвенно.","Вы научились взывать к таинственному источнику знаний вселенной и вне напряжённых боевых ситуаций. Затратив месяц на поиск и обучение, Вы можете получить навык чужого аспекта или класса по обычной цене, а своего аспекта или класса - на одно очко дешевле. Вы всё ещё не можете изучать противоположные аспекты и их классы.","Направляя свой взор всё глубже внутрь себя Вы получаете всё больше знаний из таинственного источника. Любая местность для Вас - как минимум Знакомая (3). Теперь Вы можете задавать вопрос мирозданию до трёх раз в боевую сцену или за месяц другой деятельности. Вы можете потратить использование такого вопроса чтобы получить информацию о слабых местах противника, снижая его защиту от Ваших будущих атак на две категории или о слабых местах фракции или организации чтобы облегчить проверки Порядка или Диверсии на две категории"]},{name:"Капли одного моря",desc:"",levels:["Вы чувствуете необъяснимое родство с другими разумными, даже если Ваши взгляды и цели расходятся. Иногда Вы ощущаете небольшие отблески их мыслей и чувств, и умеете воспользоваться этим себе на пользу. Окружающие оценивают это как удачу, но Вы точно знаете что это навык, доступный немногим. Если на Вашем кубе д12 выпадает 3 или меньше в вопросах связанных с разумными, один раз за боевую сцену или за месяц другой деятельности Вы можете его перебросить.","Теперь Вы ощущаете подобное родство даже с дикими животными. Количество использований навыка увеличено до двух, а помимо разумных он теперь распространяется на любых живых существ."," Вы чувствуете мир вокруг как своё продолжение. Всё вокруг - лишь разные узоры на волнах единого моря реальности. Количество использований навыка увеличено до трёх, теперь Вы можете использовать его в любых проверках, в том числе связанных с магией, стихиями, духами и прочим."]}]},nature:{id:"nature",name:"Природа",attr:"perception",opposite:"society",checks:"research",traits:[{name:"Законы бытия",desc:"",levels:["Вы принимаете природу вокруг себя - и она отвечает Вам тем же. Вы можете комфортно жить и выживать в диких условиях, если там вообще могут выживать разумные Вашего вида. На это Вам нужно тратить всё своё время, но вы не нуждаетесь в припасах, добывая их самостоятельно, а Ваше снаряжение почти не ветшает. При этом Вы изучаете данную местность с удвоенной скоростью.","Вы можете комфортно выживать даже в агрессивных средах, где разумные Вашего вида не живут (пустыни, пещеры и прочее подобное), но не в тех, которые обусловлены магическими эффектами. В обычной дикой местности (такой как лес или степь) Вы теперь можете выживать, практически не тратя на это времени. Скорость освоения местности так же удвоена.","Глубоко понимая порядки каждой экосистемы, Вы мастерски находите в них место для себя. Вы можете комфортно выживать даже в магических аномалиях, если это вообще возможно для существа с Вашими способностями. Вы должны тратить всё своё время на это только до уровня Изученная (5). Магические аномалии Вы изучаете с обычной скоростью."]},{name:"Сбор ингредиентов",desc:"",levels:["Если Ваш уровень знания местности хотя бы 5, Вы можете каждый ход выращивать или собирать одну меру качественных немагических ингредиентов, характерных для этой местности, потратив на это всё своё время.","Вы можете собирать ингредиенты, не затрачивая на это времени, если живёте в этой местности.","Вы можете собирать качественные магические ингредиенты, в количестве двух мер за один ход, если живёте в этой местности."]},{name:"Как рыба в воде",desc:"",levels:["Если Ваш уровень знания местности как минимум 3, Вы получаете дополнительную скорость передвижения в 1 клетку.","Если Ваш уровень знания местности как минимум 5, Вы можете проходить через сложную местность без дополнительных трат передвижения. Подходящие объекты Вы также можете использовать как укрытия или подспорье в бою","Если Ваш уровень знания местности как минимум 7, вы получаете дополнительный порыв, а обнаружить Вас сложнее на три категории (9)"]}]}},Qp={scholar:{id:"scholar",name:"Учёный",desc:"",professions:[],aspects:["knowledge","nature"],traits:[{name:"Знание природы",desc:"",levels:["Все проверки Поиска для Вас на одну категорию проще.","Вы можете выполнить две проверки Поиска вместо одной за каждый ход.","Вы можете выполнить любые две проверки одного типа вместо одной за каждый ход. Проверки Поиска проще на две категории"]},{name:"Знание врага",desc:"",levels:["Любые атаки по противникам, которых Вам уже удалось ранить - на одну категорию проще.","Если Вы успешно отбили удар противника, Ваша защита против него повышается на одну категорию, пока вы дееспособны","Вам достаточно видеть как другие ранят противника или успешно отражают его удары, чтобы адаптироваться к ним и получить преимущества."]},{name:"Конструктор",desc:"",levels:["Вы получаете преимущество в две категории на создание предметов с помощью немагических ремёсел. В этот список входят самодельное оружие и доспехи, эликсиры и яды, особые боеприпасы, но не ловушки. Для создания Вам всё ещё нужен рецепт достаточного качества.","Вы можете подбирать рецепты самостоятельно, ориентируясь на найденные слухи и общеизвестную информацию. Для этого Вам нужно провести проверку Поиска или Влияния, если это уместно в данной ситуации","Вы можете сами создавать рецепты, изучая природные материалы. Проведя успешную проверку Поиска Вы можете узнать о свойствах того или иного материала и придумать ему применение. Проверка на первое создание предмета тем проще, чем более реалистичный у вас план. На усмотрение мастера"]}]},mastermind:{id:"mastermind",name:"Комбинатор",desc:"",professions:[],aspects:["shadow","society"],traits:[{name:"Засадный мастер",desc:"",levels:["Вы можете подготовить хорошее место для засады, если потратите на это некоторое время. Противнику будет сложнее Вас обнаружить на две категории, а в случае успеха в первый ход все Ваши герои атакуют и защищаются на две категории эффективнее.","Если вы отражаете атаку, Вы можете пройти проверку Влияния (против разумных) или  Поиска (против зверей и монстров), чтобы симулировать тяжёлое ранение или даже смерть. Если Ваш обман не раскрыт, Вы можете получить преимущество в две категории на атаку, если наносите неожиданный удар в полную мощь.","Вы можете провести проверку Влияния (против разумных) или Поиска (против зверей и монстров), чтобы инициировать ложное отступление. Сложность её будет тем больше, чем меньше у Вас понятных врагу причин для отступления, на усмотрение мастера. В случае успеха Вы должны отходить назад один ход, увлекая противника за собой, а затем обрушиться на него снова, получая преимущества как от засады."]},{name:"Преступные схемы",desc:"",levels:["Потратив не менее месяца на подготовку, Вы можете организовать серьёзное преступление в поселении. Это может быть кража, похищение или убийство влиятельного лица. Сложность проверки определяет мастер исходя из степени реалистичности Вашего плана. Вы можете отказаться от реализации плана, когда мастер объявил сложность. Выполнить задуманное нелегко, ещё сложнее - не попасться после.  Вероятность того, что кто-то выйдет на Ваш след, зависит от превышения проверки.","Потратив не менее месяца на подготовку, Вы можете инициировать войну между разными фракциями в пределах одного поселения. Потратив не менее трёх месяцев - глобальную вражду между глобальными фракциями, не менее шести - войну. Формат войны или вражды может быть разным, в зависимости от сути фракций, например, купеческие гильдии будут враждовать совсем не так, как гильдии воров. Ваши преступные планы на две категории эффективнее, если затрагивают интересы воюющих.","Проведя полгода в поселении, вы можете подчинить себе все его преступные организации, при этом оставаясь в тени. Они не знают Вас в лицо и не будут подчиняться напрямую, но дёргая за правильные ниточки Вы можете заставлять их делать то, что нужно Вам. Все проверки Влияния удаются Вам проще на три категории, а уровень Вашего влияния на эти организации не может опускаться ниже Крепкой Дружбы"]},{name:"Без особых примет",desc:"",levels:["Вы умеете затеряться в толпе, знаете толк в маскировке в поселениях разумных. Искать Вас сложнее на две категории, если Вы только не хотите быть найденным. Иначе - на две категории проще.","Ваше умение скрываться с глаз оказывается полезным и на поле боя. Вы умеете быть неприметным и не угрожающим. Если противник собирается атаковать Вас, когда имеет возможность бить по Вашему союзнику, Вы можете пройти проверку Влияния, чтобы переключить его внимание. На это не требуется никаких действий, Вы можете сделать это сколько угодно раз за ход, но каждая следующая проверка будет сложнее.","Если Вам удаётся переключить внимание противника на своего союзника - вы можете нанести неожиданную атаку по нему в самый неподходящий момент. Такая атака стоит один порыв, и может быть усилена, но выполняется только один раз за ход."]}]},weapon_master:{id:"weapon_master",name:"Оружейник",desc:"",professions:[],aspects:["war","knowledge"],traits:[{name:"И сталь блестит",desc:"",levels:["Вы знаете толк в боевом снаряжении и со всей скурпулёзностью подходите к его выбору. Ваша броня или один из наборов вооружения качественнее на целую категорию.","Прежде чем стать популярным, более эффективное оружие появляется на рынке в малом количестве. Используя свои связи (не менее 4 уровня) и деньги (не менее 7 уровня), Вы можете найти такие редкие образцы и пополнить свою коллекцию. Теперь более высоким качеством могут отличаться два набора вооружения, или один набор и броня.","Если вы привыкаете к оружию не менее месяца, необходимое превышение защиты за каждый вид травмы сокращается на единицу (мин 1). Кроме того, Вы можете использовать особые удары экзотического оружия без штрафов. Одновременно вы можете таким образом привыкнуть только к трём наборам снаряжения. "]},{name:"Таких мечей много, но этот - мой",desc:"",levels:["Если Вы организуете что-то, связанное с оружием или вооружёнными людьми, Ваши проверки Порядка легче на две категории (6). Нанимать и вооружать отряд наёмников для Вас дешевле на одну категорию.","Вооружённые с Вашей помощью отряды защищаются и атакуют эффективнее на одну категорию.","Если Ваши товарищи по команде прислушиваются к Вашим советам, каждый может сделать один набор оружия или свою броню более эффективными (на одну категорию). На этом уровне Вы также получаете такое преимущество."]},{name:"Дороже золота",desc:"",levels:["Оружие даёт силу, а сила - власть. Попадая в новые сообщества Вы сразу получаете как минимум Небольшое Влияние на воинское и дворянское сословие, если готовы демонстрировать своё превосходное снаряжение.","Внешний вид Вашего снаряжения заставляет нанимателей задуматься о цене за Ваши услуги. Если Вашему заказчику это по карману, он предложит на одну категорию более высокую оплату. Если нет - он и вовсе не станет предлагать Вам работу.","Раз в три месяца Вы можете купить действительно очень редкое оружие, совершив покупку не менее чем 7 уровня богатства. Такую редкость с удовольствием купят любые коллекционеры, вполне вероятно - даже короли и императоры."]}]},tactician:{id:"tactician",name:"Тактик",desc:"",professions:[],aspects:["war","knowledge"],traits:[{name:"Держись!",desc:"",levels:["За один ход Вы можете помочь союзнику советом два раза, а не один. Кроме того, Ваши советы могут увеличить не только защиту, но и нападение. Ваши советы должны быть реалистичны, иначе мастер может решить, что они не принесут пользу.","Стоящие плечом к плечу с Вами товарищи атакуют и защищаются на одну категорию эффективнее, но это преимущество не складывается с эффектом от вербальной помощи.","Вы можете помочь союзнику трижды за один ход, эффект суммируется с преимуществом от второго уровня этого умения."]},{name:"Офицерские курсы",desc:"",levels:["Вы можете невзначай демонстрировать свои познания в тактике в разговоре, если хотите этого. Все Ваши проверки Влияния на невраждебных разумных-воинов эффективнее на две категории.","Вам проще находить грамотных командиров, все нанятые Вами воины атакуют и защищаются эффективнее на одну категорию.","Ваша слава идёт впереди Вас, больше хороших бойцов хотят служить под Вашим началом, меньше дураков готовы на Вас напасть. Проверки Влияния на поиск бойцов легче на две категории, проверки организации диверсий и нападений на Вас на две категории сложнее"]},{name:"Искусство войны",desc:"",levels:["Война требует денег, денег и ещё раз денег. А ещё, бизнес здорово похож на войну. Ваши проверки Порядка и Диверсии на одну категории проще, если они касаются организации прибыльной компании или борьбы с конкурентами.","Какой бы важной не была тактика, она не может обойтись без стратегии. Проверки Поиска и Влияния на одну категорию проще, если касаются исследования рынков или стратегических позиций противника.","Проверки Порядка, Диверсии, Поиска и Влияния первых двух уровней умения становятся проще не на одну, а на три категории."]}]},monk:{id:"monk",name:"Монах",desc:"",professions:[],aspects:["war","mystics"],traits:[{name:"Боевые искусства",desc:"",levels:["Ваша скорость передвижения увеличивается на 2, а рукопашные атаки без оружия становятся эффективнее на одну категорию. Кроме того, Ваша защита в ближнем бою повышается на одну категорию, а в дальнем - на две. Эти бонусы работают только в том случае, если Вы носите броню не тяжелее лёгкой. ","Вы больше не получаете штрафов к защите сбоку. Ваши сокрушительные удары без оружия - всегда точные. ","Бой для вас - особая форма транса, вы умудряетесь замечать всё происходящее вокруг. Вы больше не получаете штрафов к защите сзади, а также можете реагировать на происходящее за своей спиной. Ваши безоружные атаки становятся эффективнее ещё на одну категорию, а ваши тяжёлые удары оружием ближнего боя становятся всегда точными."]},{name:"Бастион духа",desc:"",levels:["Боевые искусства - не просто способ убрать врага со своей дороги. Для Вас - это способ обратиться к себе, познать мир через себя, а себя - через мир вокруг. Вы должны проводить не менее 10 часов в неделю в изнуряющих тренировках, но в результате Вы чувствуете происходящее вокруг невероятно тонко. Любые проверки Диверсии на две категории проще, если Вы участвуете в них лично.","Вы должны тратить на тренировки не менее 20 часов в неделю, но Ваша потребность в сне значительно сократилась. Теперь Вы высыпаетесь всего за 6 часов в сутки. Проверки Порядка проще на одну категорию, если Вы участвуете в них лично.","Ваше тело - всего лишь продолжение Вашей несгибаемой воли. Вам больше не нужно спать, но Вы должны проводить не меньше 4х часов в сутки в медитациях, поддерживающих Ваш дух. Пока Вам удаётся выполнять это условие, Вам нужно вдвое меньше припасов для выживания, Ваши раны кровоточат вдвое меньше, а ранить Ваше тело значительно сложнее. Ваш класс брони увеличивается на 1."]},{name:"Внутреннее спокойствие",desc:"",levels:["Вам одинаково просто выживать в дикой природе, в суетливом городе или горном додзё. Однако внешний мир Вам не особенно интересен. Ваш уровень знания немагической местности не может быть ниже 4х, но выше этого значения растёт вдвое медленнее обычного.","Ваш путь боевых искусств провёл Вас через множество стран и регионов - Ваши проверки Влияния на впервые встреченных незнакомцев на две категории легче.","Ваше паранормальное предчувствие опасности позволяет точно знать, когда Вас держат на прицеле, а иногда и заранее знать, что кто-то замыслил недоброе. Это предчувствие иногда может давать ложноположительный результат."]}]},commander:{id:"commander",name:"Командир",desc:"",professions:[],aspects:["war","nature"],traits:[{name:"За мной!",desc:"",levels:["Перед боем командир может повысить мораль союзных бойцов ниже или равных по рангу на 3 единицы, если успешно пройдёт проверку Влияния или на 1, если провалит её.","Вербальная команда командира во время боя поднимает мораль бойца на единицу, а так же позволяет один ход игнорировать негативные последствия тяжёлой травмы.","Потратив основное действие во время боя, командир может повысить мораль всех способных его слышать бойцов на 2 единицы, снизить мораль всех разумных бойцов противника на 2 единицы. "]},{name:"Всё по порядку",desc:"",levels:["Составить хороший план - половина успеха. Ваши проверки Порядка на одну категорию легче.","Мало составить план - нужно ещё и ему следовать. Ваши проверки Порядка на две категории проще, если Вы выполняете работу самостоятельно или с проверенными исполнителями, с которыми Вам уже доводилось работать раньше.","Вы умеете составлять чёткие исчерпывающие инструкции, такие, чтобы по ним выполнить работу смогла и обезьяна. Ваши проверки Порядка легче на две категории, если исполнителями на месте руководит выбранный Вами смышлёный человек. Этот бонус работает и если вы руководите лично."]},{name:"Вместе сильнее",desc:"",levels:["Если несколько персонажей думают над решением одной проблемы и готовы доверить Вам руководство, Вы можете сделать так, чтобы проверку проходил персонаж с самой высокой характеристикой, а бонусы учитывались от персонажа с самыми высокими бонусами.","Если это проверка Войны, Порядка или Влияния, Вы так же можете облегчить её ещё на одну категорию.","Для любых проверок Вы можете сложить все бонусы всех участников, однако полученное преимущество не должно быть больше чем в два раза большим, чем самый большой бонус."]}]},ranger:{id:"ranger",name:"Следопыт",desc:"",professions:[],aspects:["war","nature"],traits:[{name:"По кровавому следу",desc:"",levels:["Вы не уличный задира, Вы - профессиональный убийца. Вы выслеживаете свою цель и наносите удар издалека. Проверки Поиска на категорию легче, если вы ищете живое существо. Первый удар по не подозревающей о Вас цели эффективнее дополнительно на две категории, но это не должен быть удар с соседней клетки.","Ваши атаки по не подозревающему о Вашем присутствии противнику - всегда считаются точными, если Вы успели изучить его по следам или наблюдая в течении хотя бы одной минуты.","Ваши дальние атаки (даже через одну клетку) эффективнее на одну категорию даже по обнаружившим Вас противникам, если Вы успели изучить их по следам. Ваша защита в ближнем и дальнем бою против них так же выше на категорию."]},{name:"Как у себя дома",desc:"",levels:["Если Ваше знание местности хотя бы 5, обнаружить Вас сложнее на одну категорию.","Если Ваше знание местности хотя бы 5, обнаружить весь Ваш отряд сложнее на одну категорию. Это касается как попыток спрятаться в засаде, так и передвижения по глобальной карте.","Ваше мастерство скрытности достигло своего апогея. Если Вы знаете местность хотя бы до уровня 3, Вы можете скрыть себя с дополнительной сложностью в три категории, или весь отряд - со сложностью в две. Кроме того, Ваш первый удар по не подозревающему о Вашем присутствии врагу получает дополнительный бонус в одну категорию"]},{name:"Тайные тропы",desc:"",levels:["Вы знаете, как выбирать дорогу, чтобы меньше уставать и больше успевать. Ваша скорость передвижения по глобальной карте увеличена на два. Вы значительно эффективнее обнаруживаете другие отряды неподалёку, на две категории. ","С Вашей помощью весь отряд может двигаться по глобальной карте быстрее на единицу. Если Вы прокладываете маршрут движения какого-нибудь отряда, он оказывается на одну категорию безопаснее.","Ваши проверки Диверсии против отрядов, движущихся по дикой местности, эффективнее на две категории. Маршруты, проложенные Вами на две категории безопаснее."]}]},hunter:{id:"hunter",name:"Охотник",desc:"",professions:[],aspects:["war","nature"],traits:[{name:"На ловца",desc:"",levels:["Вопреки расхожему мифу, рыцарь в латах и на коне не сумеет одолеть дракона. А вот хорошо подготовленный охотник - сможет. Вы очень хороши в бою против зверей и монстров из крови и плоти - атака и защита эффективнее на одну категорию.","Кое-что из Ваших навыков прекрасно работает и на разумных. Ваши ловушки на одну категорию эффективнее, а кровотечение спровоцированное Вашими атаками, вдвое тяжелее.","В бою против зверей и монстров, с которыми Вы уже сталкивались раньше, Ваша атака и защита эффективнее на две категории."]},{name:"Боевые трофеи",desc:"",levels:["Если Ваш уровень знания местности хотя бы 4, Вы можете собирать одну меру немагических полезных ингредиентов из тел живущих в ней животных в месяц. Для этого Вам нужно найти подходящее место и остановиться в нём. Вы также можете извлекать обычные ингредиенты из поверженных в бою монстров","Вы можете собирать редкие ингредиенты, тратя на это всё своё время или обычные - прямо на ходу. Из побеждённых в бою Вы можете извлекать обычные или редкие ингредиенты","Вы можете собирать даже магические материалы из монстров, которых победили в бою или на которых охотились."]},{name:"Начинаем год назад",desc:"",levels:["Хорошая подготовка - ключ к успешной охоте. Имея большой опыт в вещах такого рода, Вы можете неплохо организовывать и другие дела. Проверки Порядка проще на одну категорию, если они хоть как-то связаны с пребыванием в дикой местности.","Что будет, если Ваши конкуретны забудут палатку? Проверки Диверсии так же проще на одну категорию, если связаны с пребыванием Вашей цели в дикой местности.","Ваше снаряжениие подобрано так хорошо, что Вы можете использовать его исключительно быстро. Полным действием в бою Вы можете подготовить ловушку, это может быть заранее подготовленный капкан на медведя или некая импровизация на месте. В случае импровизации, вы будете проходить проверку Порядка, сложность которой зависит от реалистичности Вашей задумки."]}]},druid:{id:"druid",name:"Друид",desc:"",professions:[],aspects:["nature","mystics"],traits:[{name:"Свой среди зверей",desc:"",levels:["Вы умеете вести себя так, чтобы не провоцировать диких животных. Они нападут на Вас только по исключительной причине, например, умирая от голода или защищая своё потомство. Проверки Поиска связанные со зверьми для вас на одну категорию проще.","Звери рассматривают Вас как доброго приятеля. Драться на Вашей стороне они, конечно, не станут, но могут предупредить о приближающейся опасности. Ваш отряд на одну категорию сложнее обнаружить, а Вы обнаруживаете другие на одну проще","Вы учитесь гораздо лучше понимать, что пытаются Вам сказать наши братья меньшие. Ваши проверки Поиска в местности, где есть звери на две категории эффективнее. Сообщения от зверей мастер теперь передаёт Вам как короткие предложения из двух-трёх простых слов."]},{name:"Духи леса",desc:"",levels:["Ежедневно жертвуя духам местности, в которой Вы находитесь, нечто ценное (обычно подходят съестные припасы) за одну неделю Вы можете наладить с ними контакт. Если духи благоволят Вам, один раз за боевую сцену (или один раз в месяц вне боя), Вы можете пройти проверку автоматически, если это возможно хотя бы при каком-то значении на кубике.","Регулярно жертвуя духам местности нечто ценное (отлично подойдут ценные материалы) Вы можете расположить их к себе ещё больше. Проверка, которую Вы видите, может получить максимум или минимум на кубиках по Вашему желанию. Это умение можно применить один раз за бой или раз в месяц в небоевых сценах.","Регулярно жертвуя духам местности магические ингредиенты или артефакты (не менее месяца), Вы достигаете максимального расположения с их стороны. Они могут самостоятельно помогать Вам как посчитают нужным, будь это подсказки или помощь в бою."]},{name:"Как рыба в воде",desc:"",levels:["Вы чувствуете присутствие крупных зверей на расстоянии в сотню метров. Ваши проверки Поиска в отношении зверей проще на три категории.","Монстры - совершенно чуждые природе существа. Земля стонет и плачет там, где они ходят по ней. Вы слышите этот плач издалека, за несколько километров определяя направление до ближайшего монстра. Проверки Поиска в отношении монстров на две категории проще.","Магия вплетена в природу, но всё же выделяется на фоне всего остального ярким пятном. Вы чувствуете магические артефакты и ингредиенты, находящиеся в дикой природе за несколько километров. Поиск таких предметов проще на три категории, но имейте ввиду - духи местности могут разозлиться на Вас, если Вы заберёте что-то ценное."]}]},outlaw:{id:"outlaw",name:"Беглец",desc:"",professions:[],aspects:["shadow","nature"],traits:[{name:"Пастух паршивых овец",desc:"",levels:["В любом обществе есть те, кто промышляет тёмными делишками. Вы легко определяете таких, сложность проверки ниже на две категории.","Вы можете не только успешно определять криминальные элементы, но ещё и ловить их на горячем. Чтобы затем шантажировать. Ваши проверки Влияния на них на две категории эффективнее.","Вы безошибочно определяете тёмных дельцов, воров, взяточников в любом обществе, проведя с ними в разговоре хотя бы несколько минут. Размеры взяток для Вас снижены на две категории. Пройдя дополнительную проверку, Вы можете разгадать схему, в которой кто-то замешан."]},{name:"Постоянно оглядываясь",desc:"",levels:["Вы так долго скрывались от властей, что теперь чувствуете себя гораздо лучше вне поселений. Скорость изучения местности удвоена вплоть до уровня 4, если это не магическая местность.","Уходить от погони - сильнейший из Ваших талантов. Если Вас преследуют, (в бою или на стратегической карте) Ваша скорость передвижения увеличивается на два.","Проведя в поселении хотя бы месяц, Вы узнаёте обо всех тайных ходах, не закрытых от простых людей или криминальных элементов. Если это поселение около границы другого государства, Вы также узнаёте как проникнуть туда незамеченным."]},{name:"Не останавливаясь",desc:"",levels:["Вы учитесь атаковать на бегу, не разворачиваясь. Для Вас возможны атаки вбок с штрафом эффективности в одну категорию.","От привычки не так легко избавиться. Если Ваши атаки наносят хотя бы лёгкую травму, они снижают скорость передвижения противника на одну клетку длительностью на два хода. Если только Вы явно не захотите обратного.","Вы можете атаковать назад не разворачиваясь со штрафом в одну категорию, или вбок - без штрафа. Кроме того, Ваша защита с тыла становится сильнее на одну категорию."]}]},warlock:{id:"warlock",name:"Колдун",desc:"",professions:[],aspects:["mystics","shadow"],traits:[{name:"Жертва крови",desc:"",levels:["Вы учитесь общаться с потусторонними сущностями, принося им в жертву кровь живых существ. Отдавая свою кровь тёмным сущностям трудно остановиться, потому Вы должны бросить кубик д12 в случае, если решили пожертвовать свою. На значения 1-6 бы получаете царапину, 7-11 - лёгкое ранение, 12 - тяжёлое. Сила заклинания при этом так же растёт по категориям - одна за царапину, три за тяжёлое ранение. Вы можете приносить в жертву и крупных животных, но эффективность их крови на две категории меньше.","Если Вы раните разумное существо в ближнем бою, Вы можете принести его кровь в жертву для следующего ритуала. Мистические сущности будут помнить об этом подношении в течении Вашего следующего хода, но затем забудут. Кровь других разумных на одну категорию менее эффективна, чем Ваша собственная","Тяжесть ранения от жертвы собственной крови снижается на одну категорию, но сила растёт как прежде. Теперь Вы можете самостоятельно выбрать получить тяжёлое (или даже смертельное) ранение, чтобы повысить силу ритуала ещё больше."]},{name:"Магия связи",desc:"",levels:["Прикоснувшись, Вы можете незримо связывать некоторые объекты и сущности друг с другом. Вы смутно чувствуете направление и расстояние до объектов, которые связали с собой. Связанные друг с другом объекты мистическим образом стремятся к воссоединению. Одновременно Вы можете поддерживать не более трёх таких связей.","Затратив основное действие, Вы можете более точно определить местоположение связанного объекта (расстояние вплоть до нескольких километров, направление - до 30 градусов). Теперь Вы можете передавать через связи свои мистические силы - в том числе усиленные магией крови или печатями. Категория силы ритуала при этом снижается на две. Вы можете принимать жертву крови от связанного оружия, но сила жертвы при этом снижается на две категории. Вы можете активировать свои связанные печати дистанционно.","Вы можете ощущать ближайшее пространство вокруг связанных с собой объектов, но не визуально, а образно. Особенно хорошо при этом чувствуется наличие печатей и жизненной силы. Вы можете узнавать жизненную силу хорошо знакомого существа. Сила передаваемая через связь теперь ослабевает не на две, а на одну категорию. Вы можете передавать связанным разумным эмоционально-образные сообщения."]},{name:"Магия печатей",desc:"",levels:["Вы можете взывать к мистическим силам реальности, создавая в пространстве символы, обращающиеся к тем или иным сущностям. Для этого вы должны основным действием войти в особый транс, затем исполнить сложный ритуальный танец, сопровождая его громким пением. Сила печати зависит от её размера (в клетках). Когда Вы исполняете танец, противник может реагировать на Ваши действия даже издалека. Если Вы отвлекаетесь на другие действия или получаете урон, ритуал срывается.","Заканчивая создание печати, Вам больше не обязательно активировать её сразу же. Одновременно может существовать до трёх печатей (действующих, ждущих активации). Чтобы активировать печать, Вам нужно к ней прикоснуться. Кроме того, Вы можете размещать малые печати на движущихся объектах. Ваша скорость передвижения в ритуальном танце больше на две единицы.","Вы достигли такого уровня мастерства, что теперь можете атаковать в ближнем бою во время наложения печати, а так же создавать малые печати не отвлекаясь от основной, затратив два порыва. Ритуал больше не срывается, если Вы получаете урон ниже тяжёлого ранения. Кроме того, если Вы проливаете кровь, свою или чужую, она может быть использовала для усиления ритуала магией крови."]}]},specialist:{id:"specialist",name:"Специалист",desc:"",professions:[],aspects:["society","knowledge"],traits:[{name:"Быстрее и выше",desc:"",levels:["Вы копаете глубоко и не останавливаетесь на достигнутом. И это даёт свои плоды - в любом ремесле, распространённом в обществе, Вы преуспеваете больше других. Работая по любой профессии, не связанной с Мистикой, Вы можете заработать на один уровень богатства больше. Кроме того, все проверки Порядка для Вас на одну категорию проще.","Хороших профессионалов ценят. Ваши проверки Влияния на категорию проще, а искать специалистов в какой-то области - проще на две.","Занимаясь своим ремеслом, Вы можете заработать на две категории больше богатства больше, чем другие. Ваши проверки Влияния на две категории эффективнее, если Вы проработали по профессии в этом поселении хотя бы месяц."]},{name:"Всё по полочкам",desc:"",levels:["Вы бы не смогли достичь таких высот в своих ремёслах, если бы не анализировали и не систематизировали всё. Все проверки Порядка на одну категорию проще, если они связаны с освоенным Вами ремеслом - на две.","Вы можете осваивать новые профессии и ремёсла гораздо быстрее остальных - всего за месяц обучения Вы достигаете уровня среднего специалиста. Ремесло в таком случае считается усвоенным. Вам всё ещё не доступны профессии, связанные с мистикой.","Даже мистические профессии теперь доступны Вам, однако Вы должны потратить втрое больше времени, чтобы разобраться в них. Освоив совершенно новую для себя профессию, Вы получите одно очко развития."]},{name:"Почти шахматы",desc:"",levels:["Потратив основное действие в бою, Вы можете попробовать разгадать тактический замысел противника, если он есть. Это проверка Порядка или Диверсии, на Ваш выбор. Если проверка пройдена успешно, мастер раскрывает Вам суть задумки, а Вы и Ваши товарищи получают преимущество в атаке и защите в одну категорию на следующий раунд боя.","Проанализировав как минимум три взаимодействия с враждебными силами, Вы можете попробовать разгадать стратегический замысел противника. Это проверка Порядка или Диверсии на Ваш выбор, сложность тем больше, чем меньше Ваш персонаж узнал предварительно. В случае успеха Вы получаете преимущество в две категории на все проверки (кроме боя) в отношении этой фракции на месяц","Преимущество, которое Вы получаете от первых двух уровней этого умения, длится вдвое дольше. Кроме того, если Вы прошли изначальную проверку (Порядка или Диверсии), Вы можете предложить план, как помешать врагу и пройти другую (Диверсии для Порядка или наоборот), чтобы удвоить и силу Вашего преимущества. Сложность проверки выставляет мастер ориентируясь на реалистичность Вашего плана."]}]},skald:{id:"skald",name:"Скальд",desc:"",professions:[],aspects:["society","knowledge"],traits:[{name:"Знаю сказ, который начинался...",desc:"",levels:["Ничто не ново в этом мире, и Вы, как хранитель легенд ушедших эпох, знаете это лучше других. В любой ситуации Вы можете попробовать пройти проверку Порядка, чтобы вспомнить, не было ли уже на свете подобной ситуации. Проверка тем сложнее, чем более необычный пример Вы пытаетесь вспомнить, но если она пройдена, Вы можете поделиться поучительной историей из прошлого с другими, облегчая следующую проверку (свою или чужую) на две категории. Вы можете упрощать подобным образом только проверки Конфликта, Порядка или Влияния.","Многие баллады сложены о героизме или о любви, но не стоит забывать и тёмные сказки, которые народ тоже исправно хранит в своей памяти. Теперь Вы можете усиливать этим умением и проверки Диверсии, Защиты и Поиска. Кроме того, раз в месяц Вы можете усилить свою проверку, не затрачивая хода.","Вам не составляет труда вывернуть любую историю так, чтобы она выставляла Вас в выгодном свете. Ваши собственные проверки Влияния всегда проще на две категории, а Репутация Вашей группы с любыми невраждебными фракциями всегда как минимум 2 (Небольшое Влияние)"]},{name:"Наш последний и решительный",desc:"",levels:["Жизнь жестока и вопрос не в том, выживешь ли ты. Только в том, каким тебя запомнят. Те, кто дерётся с Вами плечом к плечу понимают, что каждый бой - их шанс занять своё место в героической легенде. Боевой дух всех бойцов ниже рангом чем Вы выше на единицу.","Когда Вы успешно побеждаете противника в бою, Вы можете сопровождать свои действия вдохновляющими союзников репликами. Все увидевшие и услышавшие это в бою бойцы ниже Вас рангом получат преимущество в одну категорию при атаке на один раунд.","Преимущества двух предыдущих уровней теперь действуют даже на бойцов Вашего ранга, включая товарищей по команде и даже Вас."]},{name:"Золотые страницы",desc:"",levels:["Не только простые бойцы хотят остаться в легендах, выдающимся людям своей эпохи тоже не чужда жажда славы. Вам на две категории проще находить выход на тех, кто не стремится общаться с простым людом, а Ваши проверки Влияния против них на одну категорию проще.","Вам на две категории проще убеждать нейтральные стороны оказать Вам какую-то помощь - подкрепления, припасы, деньги или снаряжение. Это работает только в том случае, если по мнению люда Вам противостоит серьёный враг.","Здорово казаться всем храбрым... но и сойти богатым и щедрым - тоже неплохо. Вы можете рассчитывать на награду на одну категорию выше, если заказчик способен её себе позволить."]}]},cutthroat:{id:"cutthroat",name:"Головорез",desc:"",professions:[],aspects:["war","shadow"],traits:[{name:"Гроза всему живому",desc:"",levels:["Вы славитесь своей безпринципностью и безжалостностью. Проверки Влияния на одну категорию эффективнее, если Вы предпочитаете действовать через угрозы. Однако, вероятность того, что Ваша деятельность привлечёт внимание властей ничуть не меньше.","Враждебные фракции подумают дважды, прежде чем чинить Вам какие-то неудобства. Но уж если они решатся - бросят в бой всё, что имеют. Враждебные фракции решаются на активные действия только при репутации Ненависть (-4) или Лютая Ненависть (-5)","Ваши проверки Влияния эффективнее на одну категорию при попытках договориться или на две, если Вы используете угрозы. Любые предприятия и организации связанные с Вашим именем на одну категорию больше защищены от нападок разумных."]},{name:"Умопомрачительная жестокость",desc:"",levels:["Пришедшие за Вашей головой морально готовы умереть, но никто не готов умереть ТАК. Если противник уже не может эффективно сопротивляться, Вы можете устроить показательную жестокую казнь, подрывая мораль всех, кто это увидел и услышал. Противники получают -2 морали, союзники и нейтральные бойцы -1. На это нужно затратить основное действие, но в следующий ход противники будут защищаться и нападать на одну категорию хуже. Этот эффект не проймёт бойцов более высокого ранга, чем убитый.","Захватив в бою пленного, Вы можете жестоко казнить его позже прилюдно. Такое действие снизит вероятность нападок на Вас со стороны враждебных фракций на две категории на следующий месяц.","Вы можете проводить казнь в бою, затрачивая всего один порыв. Это действие больше не подрывает мораль Ваших союзников, а кроме того может пронять бойцов даже более опытных, чем убитый."]},{name:"Честь - для идиотов и мертвецов",desc:"",levels:["Ваши атаки во фланг и тыл получают преимущество в одну категорию.","Ваши атаки во фланг и тыл - всегда точные.","Ваши атаки во фланг и тыл не вызывают срабатывания реакции, а кроме того забирают у цели один порыв даже в случае промаха."]}]},heretic:{id:"heretic",name:"Еретик",desc:"",professions:[],aspects:["mystics","knowledge"],traits:[{name:"Постигая непостижимое",desc:"",levels:["Парадокс - Ваше второе имя. Проходя любую проверку, Вы можете выбрать противоположную ей и преуспеть необъяснимым образом. Такая проверка, правда, будет на одну категорию сложнее заявленной. Вы должны объяснить, каким образом применяете свои навыки для того, чтобы пройти проверку.","Странно для других, естественно - для Вас. Вы можете выбрать соседнюю проверку вместо противоположной, но она будет на две категории сложнее.","Гениальность или безумие? Главное, чтобы это работало. Противоположные проверки больше не получают штрафа, а штраф при использовании соседних проверок снижен до одной категории."]},{name:"Вербальная магия",desc:"",levels:["Посвятив месяц изучению и анализу необъяснимых мистических сущностей, вы всё же находите кое-какие закономерности. Вы способны создавать заклинания - нелепые высказывания, которые нужно громко пропевать странно пританцовывая, чтобы они сработали. Каждое использование заклинания - парная проверка Порядка и Диверсии, требующая основного действия в бою или полного хода в небоевой сцене. Сложность определяется мастером по степени реалистичности задумки. Эти проверки нельзя заменить на другие, к ним не применяются никакие бонусы. Если обе пройдены - заклинание срабатывает как и планировалось, если провалена одна - не происходит ничего, если провалены обе - срабатывает наоборот. Одновременно Вы можете помнить только три заклинания.","Вы учитесь записывать свои заклинания и лучше запоминать, как именно их следует выполнять. Проверки сложности теперь проще на одну категорию, а если Вам нужно выбросить на кубике 6 или меньше, Вы проходите проверку автоматически. Теперь Вы можете хранить в своей памяти три заклинания и ещё три - в своих записях. Заклинания из памяти используются основным действием, заклинания из записей - основным действием и двумя порывами.","Вы научились так хорошо записывать свои заклинания, что даже другие могут их повторять. Потратив не менее двух недель и одного очка развития на изучение, Ваш товарищ может научиться использовать заклинание. В вашей собственной памяти теперь может храниться до шести заклинаний, ещё три - в записях."]},{name:"Дорисовать картину",desc:"",levels:["Высокие аналитические способности и хорошая интуиция - невероятно редкое сочетание, но благодаря этой связке Вы можете понимать то, что для других - недоступно. Например, разгадывать самые запутанные истории по обрывкам информации. Раз в месяц Вы можете сделать невероятную догадку - точно узнать причину какого-то события, которое Вы подробно изучали.","Будущее не может быть секретом для того, кто так хорошо понимает прошлое. Раз в месяц Вы можете сделать невероятную догадку - точно узнать последствия какого-то события, которое Вы подробно изучали или действия, которое собираетесь совершить.","Остальные видят только разрозренные кусочки, а Вы - полную картину. Жаль, что такие озарения посещают Вас лишь иногда. Раз в месяц Вы можете точно узнать самый лучший, простой и надёжный способ добиться каких-то результатов."]}]},seeker:{id:"seeker",name:"Искатель",desc:"",professions:[],aspects:["nature","society"],traits:[{name:"Волк волку человек",desc:"",levels:["Дух первооткрывателя толкает Вас почти всё время проводить в экспедициях по неизведанным землям. Вы здорово научились находить общий язык с местными дикими сообществами, Ваша Репутация с ними начинается с Небольшого Влияния (2), а все проверки Поиска и Влияния с их помощью на две категории проще.","Вы легко можете затеряться в дикой местности, поселившись в диком сообществе. За месяц проживания с ними, Вы можете хорошо выучить их язык, подняв попутно уровень Репутации до Дружбы (5). Ваши проверки Поиска в этой местности с помощью дружественных аборигенов проще на три категории.","Затратив достаточно времени, Вы способны, кажется, подружиться с кем угодно. Теперь Вы можете вжиться в сообщество любых животных или монстров, если им свойственна хотя бы какая-то стайность или социальность. На это придётся потратить не менее трёх месяцев, но в результате вы получите полное знание местности Как Свои Пять Пальцев (10), и одно очко развития."]},{name:"Чутьё артефактора",desc:"",levels:["Пока другие покупают безделушки по цене магических артефактов, Вы делаете обратное. Паранормальное чутьё позволяет Вам находить действительно магические предметы даже в куче хлама, если они там есть. Проверки Поиска и Влияния проще на две категории при попытке найти артефакты.","Продажа магических материалов, ингредиентов и артефактов позволяет Вам выручить на одну категорию больше богатства.","Собирая вместе все знания о местной природе, слухи и легенды местного населения и своё таинственное чутьё, Вы гораздо легче находите древние руины, гробницы, затерянные города, магические места силы и прочее подобное. Проверки такого рода легче на три категории."]},{name:"До победного",desc:"",levels:["Простая неудача не может остановить Вашу несгибаемую волю Искателя. Раз в месяц Вы можете попробовать пройти проверку ещё два раза, если провалили первую попытку. Если вы пройдёте хотя бы одну из трёх - это зачитывается как успех. Мастер может наложить на Вас какой-нибудь штраф за приложение чрезмерных усилий.","Если Вы преуспели со второй попытки, третью можете использовать на другой проверке в этом же месяце.","Если Вы проваливаете проверку все три раза, при следующей попытке Ваша проверка будет на одну категорию проще."]}]},dervish:{id:"dervish",name:"Дервиш",desc:"",professions:[],aspects:["society","mystics"],traits:[{name:"Танец блаженства",desc:"",levels:["Потратив действие в свой ход, Вы можете войти в особый боевой танец, в процессе которого не можете использовать атаки дальнего боя, но получаете преимущество в атаке в одну категорию.","Ваши движения иррациональны и непредсказуемы. Если Ваше передвижение или атака вызывает реакцию, пройдите проверку Влияния против Поиска противника. В случае успеха ему не удаётся отреагировать на Ваше действие, но затраченный порыв всё равно тратится.","Во время танца вы не получаете штрафов из-за ранений и морали (кроме смертельных), в к Вашей проверке Влияния на реакцию противника прибавляется две категории сложности."]},{name:"Зажигающий сердца",desc:"",levels:["Свет вашей безграничной веры зажигает сердца и увлекает за собой. Ваши проверки Влияния вне боя легче на две категории, если цель не настроена враждебно по отношению к Вам.","Вы учитесь входить в особый транс в танце, который позволяет Вам лучше настроиться на следующую проверку. Проведя особый ритуал, Вы можете снизить сложность следующей проверки на категорию.","Ваш фанатизм сияет настолько ярко, что способен заворожить даже врага в бою. Теперь Ваши проверки Влияния легче на две категории даже в бою, даже в отношении врагов."]},{name:"Как будто никто не видит",desc:"",levels:["Дервиш - это юродивый, которого никто не замечает, если он только сам того не хочет. Найти Вас в поселении с помощью Влияния на категорию сложнее.","Паранормальное чувство опасности ведёт Вас, позволяя избегать недоброжелателей. Найти Вас с помощью Влияния или Поиска становится сложнее на две категории. Этот бонус работает как в поселениях, так и в дикой природе.","Если Вас никто не видит, Вы можете делать что захотите. Проверки Диверсии становятся проще на две категории, если Вы лично участвуете в деле."]}]},bard:{id:"bard",name:"Бард",desc:"",professions:[],aspects:["society","shadow"],traits:[{name:"А без музыки…",desc:"",levels:["Хотя бардам и не часто приходится участвовать в сражениях, в кабацких драках они бывают чаще прочих. Те, кто не научился защищать себя - попросту не выжили. Потратив два порыва Вы можете провести проверку Влияния против Влияния противника, чтобы отвлечь его и заставить потерять оставшиеся действия и порывы.","Пока Ваша собственная мораль высока и у Вас нет тяжёлых ранений, Вы можете петь в бою, не затрачивая никаких ресурсов. Это укрепляет мораль окружающих, добавляя единицу.","Ваше пение теперь повышает мораль на две единицы, а затратив в свой ход полное действие Вы можете подключить к нему игру на инструменте, попробовав, таким образом, отвлечь внимание сразу всей противников, которые способны Вас видеть и слышать. С высокой долей вероятности они вскоре захотят атаковать Вас."]},{name:"Желанный гость",desc:"",levels:["Любое застолье проходит приятнее под хорошую музыку. Мало кто откажется от присутствия барда на светском рауте. Вы в курсе всех слухов поселения, в котором провели хотя бы один месяц, это упрощает Ваши проверки Влияния в поселении на три категории. ","Если Вы проводите в поселении хотя бы месяц, все фракции кроме враждебных, начинают относиться к Вам как минимум с Симпатией (1).","Если Вы проводите в поселении хотя бы месяц, все фракции кроме враждебных начинают относиться к Вам как к доброму приятелю (Сопереживание, 4), а жители окрестных селений - с Симпатией (1)"]},{name:"Свет клином",desc:"",levels:["Любое тёмное дело гораздо проще провернуть, если в нём участвует яркий фанфарон, привлекающий всё внимание. Вы не можете действовать в одиночку, но облегчаете проверки Диверсии для своих друзей на одну категорию. Этот бонус складывается с другими, которыми они обладают.","Как же не помочь хорошим ребятам! Вы облегчаете проверки Влияния на одну категорию для своих друзей, этот бонус складывается с другими. Размер бонуса к Диверсии увеличивается до двух категорий."," Как складно говорит! Проверки Порядка для Ваших друзей становятся легче на одну, Влияния - на две, Порядка - на три категории. Все эти бонусы складываются с другими, которые есть у этих персонажей."]}]},assassin:{id:"assassin",name:"Убийца",desc:"",professions:[],aspects:["mystics","shadow"],traits:[{name:"Скользящий в тени",desc:"",levels:["Договариваться и подкупать стражу - не для Вас. Вам больше по душе верёвка с крюком и немного акробатики. А ещё Вы тонко чувствуете опасности, потому знаете, куда и когда лучше не соваться. Проверки Диверсии на проникновение на защищаемые объекты легче на две категории. Вы гарантированно успешно проникаете на объект, если его охраняют только Бойцы или ниже.","Затратив полный ход (включая порывы и передвижения) Вы можете попробовать настроиться на своё сверхъестественное чувство и узнать, какие опасности есть поблизости. Этот талант работает нестабильно, но всё же много раз спасал Вам жизнь.","Тени вокруг Вас неестественно темны, а под Вашими шагами не хрустят ветки и не скрипят половицы. Вне боя противник может заметить Вас, только если вы попадёте в его фронтальное поле зрения без укрытия. Противник не может протрубить тревогу в тот же ход, когда обнаружил Вас, если Вы нанесли ему хотя бы лёгкую травму. Проверки Диверсии теперь легче на три категории, если Вы можете обосновать, как будете использовать своё мастерство проникновения. "]},{name:"Летящая смерть",desc:"",levels:["Вопреки расхожим мифам, убийца - вовсе не лучший воин на свете. Ваше лучшее оружие - неожиданность и удары в спину. Затрачивая порыв на передвижение, Вы можете сделать один шаг и метнуть небольшой металлический шип через одну клетку. При попадании, он нанесёт травму категории “царапина”.","Вы можете метать своё оружие через две клетки, а при попадании вы можете выбрать “точный удар” категории царапина или “лёгкая травма”.","Ваши метательные ножи отравлены. Если Вы наносите хотя бы “лёгкую травму” своим метательным шипом, противник подвергается воздействию сильного яда, который удвоит этот урон на следующий ход. Теперь Вы можете метать ножи порывом, не затормаживая своего движения, в Вашем распоряжении остаются все два очка передвижения."]},{name:"Помни о смерти",desc:"",levels:["Хотя вы не афишируете свои умения, многие знают, что Ваши недоброжелатели долго не живут. Кто-то захлебнулся чаем, кто-то накормил в лесу стаю волков, а кто-то упал на собственный кухонный нож 18 раз. Проверки Влияния на две категории (6) проще, если Вы пытаетесь запугать кого-то.","Доказательств нет, но слухи… Преступные сообщества поселения, в котором Вы живёте не менее месяца, относятся к Вам с опаской. Быть безразличными им не удаётся - либо ненависть, либо уважение. Уровни влияния с -2 до +2 недоступны, все сообщества должны выбрать свою сторону. Те, кому Вы не чинили явного зла, будут склонны выбрать дружбу. Переходить из -3 до +3 для Вас вдвое проще, чем в обратную сторону..","Кроме тех, кто Вас боится, есть ещё и те, кто Вам должен. Все проверки Влияния на категорию проще, если Вы провели в этом поселении не менее месяца. Этот бонус складывается с бонусом при угрозах."]}]},shaman:{id:"shaman",name:"Шаман",desc:"",professions:[],aspects:["mystics","nature"],traits:[{name:"Медвежья шкура",desc:"",levels:["В бою Вы способны впадать в кровавую ярость - за каждую степень этого эффекта Ваши защита и атака повышаются на одну категорию, но Вы не можете сопротивляться соблазну рвать на части зубами и когтями тело поверженного врага, если оказываетесь вплотную к нему. Активация ярости происходит мгновенно, сразу на второй степени. Вы можете потратить действие, чтобы снизить уровень эффекта на единицу, проведя проверку категории Простая + степень эффекта. В случае провала, Вы не можете контролировать своего персонажа следующий ход. Расправа над поверженным занимает целое действие.","За каждого разодранного противника Вы получаете дополнительную степень эффекта, вплоть до пяти. Начиная с третьей, расправа над противником требует только один порыв.","Максимальная степень эффекта теперь шестая. Начиная с третьей Вы мгновенно раздираете противника на части, если добиваете своей атакой. Если же он уже был повержен к тому моменту, Вам требуется один порыв."]},{name:"Я вижу",desc:"",levels:["Духи говорят с Вами, позволяют видеть своими глазами. Вы получаете дополнительную информацию о том, что происходит в пределах километра от Вас. Проверки Поиска легче на одну категорию.","Духи видят прошлое и будущее. Вы можете узнать прошлое и будущее места, которое посетили, если свяжетесь с духами, которые здесь живут. Доступна особая проверка Интуиции, сложность на усмотрение мастера.","Духи помнят, помнят всё. Вы можете ограниченно получать информацию от мёртвых. Доступна особая проверка интуиции, сложность на усмотрение мастера."]},{name:"Видения",desc:"",levels:["Знать - недостаточно, нужно ещё суметь применить эти знания на пользу делу. Вы учитесь использовать полученную информацию для шпионажа и диверсий, таким образом можете облегчить любую проверку Диверсии на одну категорию.","Предупреждён - значит вооружён. Позволяет усложнить вражеские проверки Диверсии против какого-то предприятия на одну категорию.","Удваивает бонусы двух предыдущих уровней этого умения."]}]},shady:{id:"shady",name:"Делец",desc:"",professions:[],aspects:["knowledge","shadow"],traits:[{name:"Подлый удар",desc:"",levels:["Вы не рыцарь в сверкающих доспехах, а всего лишь деловой человек, который не хочет проблем. Но иногда проблемы приходят сами… Потратив один порыв Вы можете нанести точный лёгкий удар рукой по противнику. Если Вы держите в руках оружие, считается что Вы ударили рукоятью, гардой, древком. Этот удар гарантировано сработает против противника, который ещё не знает что Вы так умеете. Но только один раз, и всех увидевших Вы уже не сможете удивить повторно.","Ваша точная неожиданная атага теперь наносит лёгкую травму, а не царапину. После такой атаки защита противника снижена на две категории.","Разнообразие. Вы знаете столько приёмов, что можете удивить каждого. Если Вы используете подлый удар, в течении этого хода Вы можете применить его несколько раз до полного исчерпания порывов."]},{name:"Пока никто не видит",desc:"",levels:["Ваша специализация - тёмные дела, чаще всего торговые. Вы проводите теневые сделки проще, зарабатываете с них больше. Проверки проще на одну категорию, прибыль также больше на одну.","Ваши шансы найти что-то действительно ценное значительно повышаются, если Вы занимаетесь торговлей. Поиск через Влияние работает на две категории проще, если Вы знаете, что именно ищете.","Торговля удаётся Вам всё лучше - теперь проверки и прибыль лучше сразу на две категории. Раз в месяц Вы можете провести особенно крупную сделку, с повышенными шансами на провал и на то, что Вас поймают."]},{name:"Повязанные кровью",desc:"",levels:["У Вас обширная сеть контактов в криминальном мире, преимущественно - среди гильдий воров. Ваши отношения с ними изначально на уровне 4, Сопереживание, но могут и меняться со временем.","В любом поселении цивилизованного мира Вы легко можете найти своих. За звонкую монету они готовы выполнить любой заказ. Доступен особый тип наёмников - разъярённые бедняки. Они способны устроить беспорядки в своём селении, но не покинут его пределов.","Вам доступен особый тип наёмников - городские бандиты. Могут наниматься только в крупных городах, их дисциплина хромает, как и мораль. Зато они обходятся крайне дёшево и с такими потерями можно не считаться."]}]}},ur={0:{name:"Нулевая",class:"bg-red-100",short:"0"},3:{name:"Плохая",class:"bg-white",short:"П"},6:{name:"Базовая",class:"bg-sky-200",short:"Б"},9:{name:"Ниже лёгкой",class:"bg-green-200",short:"НЛ"},12:{name:"Лёгкая",class:"bg-green-300",short:"Л"},15:{name:"Выше лёгкой",class:"bg-green-400",short:"ВЛ"},18:{name:"Ниже средней",class:"bg-yellow-200",short:"НС"},21:{name:"Средняя",class:"bg-yellow-300",short:"С"},24:{name:"Выше средней",class:"bg-yellow-400",short:"ВС"},27:{name:"Ниже тяжёлой",class:"bg-red-200",short:"НТ"},30:{name:"Тяжёлая",class:"bg-red-300",short:"Т"},33:{name:"Выше тяжёлой",class:"bg-red-400",short:"ВТ"},36:{name:"Нереальная",class:"bg-black text-white",short:"Н"}},iS=[{label:"Нулевая",sub:{"":0}},{label:"Плохая",sub:{"":3}},{label:"Базовая",sub:{"":6}},{label:"Лёгкая",sub:{Ниже:9,"":12,Выше:15}},{label:"Средняя",sub:{Ниже:18,"":21,Выше:24}},{label:"Тяжёлая",sub:{Ниже:27,"":30,Выше:33}},{label:"Нереал",sub:{"":36}}];var rS=function(){function i(e,t){t===void 0&&(t=[]),this._eventType=e,this._eventFunctions=t}return i.prototype.init=function(){var e=this;this._eventFunctions.forEach(function(t){typeof window<"u"&&window.addEventListener(e._eventType,t)})},i}(),nS=function(){function i(){this._instances={Accordion:{},Carousel:{},Collapse:{},Dial:{},Dismiss:{},Drawer:{},Dropdown:{},Modal:{},Popover:{},Tabs:{},Tooltip:{},InputCounter:{},CopyClipboard:{},Datepicker:{}}}return i.prototype.addInstance=function(e,t,r,n){if(n===void 0&&(n=!1),!this._instances[e])return console.warn("Flowbite: Component ".concat(e," does not exist.")),!1;if(this._instances[e][r]&&!n){console.warn("Flowbite: Instance with ID ".concat(r," already exists."));return}n&&this._instances[e][r]&&this._instances[e][r].destroyAndRemoveInstance(),this._instances[e][r||this._generateRandomId()]=t},i.prototype.getAllInstances=function(){return this._instances},i.prototype.getInstances=function(e){return this._instances[e]?this._instances[e]:(console.warn("Flowbite: Component ".concat(e," does not exist.")),!1)},i.prototype.getInstance=function(e,t){if(this._componentAndInstanceCheck(e,t)){if(!this._instances[e][t]){console.warn("Flowbite: Instance with ID ".concat(t," does not exist."));return}return this._instances[e][t]}},i.prototype.destroyAndRemoveInstance=function(e,t){this._componentAndInstanceCheck(e,t)&&(this.destroyInstanceObject(e,t),this.removeInstance(e,t))},i.prototype.removeInstance=function(e,t){this._componentAndInstanceCheck(e,t)&&delete this._instances[e][t]},i.prototype.destroyInstanceObject=function(e,t){this._componentAndInstanceCheck(e,t)&&this._instances[e][t].destroy()},i.prototype.instanceExists=function(e,t){return!(!this._instances[e]||!this._instances[e][t])},i.prototype._generateRandomId=function(){return Math.random().toString(36).substr(2,9)},i.prototype._componentAndInstanceCheck=function(e,t){return this._instances[e]?this._instances[e][t]?!0:(console.warn("Flowbite: Instance with ID ".concat(t," does not exist.")),!1):(console.warn("Flowbite: Component ".concat(e," does not exist.")),!1)},i}(),Qe=new nS;typeof window<"u"&&(window.FlowbiteInstances=Qe);var dc=function(){return dc=Object.assign||function(i){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n])}return i},dc.apply(this,arguments)},uc={alwaysOpen:!1,activeClasses:"bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-white",inactiveClasses:"text-gray-500 dark:text-gray-400",onOpen:function(){},onClose:function(){},onToggle:function(){}},sS={id:null,override:!0},ab=function(){function i(e,t,r,n){e===void 0&&(e=null),t===void 0&&(t=[]),r===void 0&&(r=uc),n===void 0&&(n=sS),this._instanceId=n.id?n.id:e.id,this._accordionEl=e,this._items=t,this._options=dc(dc({},uc),r),this._initialized=!1,this.init(),Qe.addInstance("Accordion",this,this._instanceId,n.override)}return i.prototype.init=function(){var e=this;this._items.length&&!this._initialized&&(this._items.forEach(function(t){t.active&&e.open(t.id);var r=function(){e.toggle(t.id)};t.triggerEl.addEventListener("click",r),t.clickHandler=r}),this._initialized=!0)},i.prototype.destroy=function(){this._items.length&&this._initialized&&(this._items.forEach(function(e){e.triggerEl.removeEventListener("click",e.clickHandler),delete e.clickHandler}),this._initialized=!1)},i.prototype.removeInstance=function(){Qe.removeInstance("Accordion",this._instanceId)},i.prototype.destroyAndRemoveInstance=function(){this.destroy(),this.removeInstance()},i.prototype.getItem=function(e){return this._items.filter(function(t){return t.id===e})[0]},i.prototype.open=function(e){var t,r,n=this,s=this.getItem(e);this._options.alwaysOpen||this._items.map(function(o){var a,l;o!==s&&((a=o.triggerEl.classList).remove.apply(a,n._options.activeClasses.split(" ")),(l=o.triggerEl.classList).add.apply(l,n._options.inactiveClasses.split(" ")),o.targetEl.classList.add("hidden"),o.triggerEl.setAttribute("aria-expanded","false"),o.active=!1,o.iconEl&&o.iconEl.classList.add("rotate-180"))}),(t=s.triggerEl.classList).add.apply(t,this._options.activeClasses.split(" ")),(r=s.triggerEl.classList).remove.apply(r,this._options.inactiveClasses.split(" ")),s.triggerEl.setAttribute("aria-expanded","true"),s.targetEl.classList.remove("hidden"),s.active=!0,s.iconEl&&s.iconEl.classList.remove("rotate-180"),this._options.onOpen(this,s)},i.prototype.toggle=function(e){var t=this.getItem(e);t.active?this.close(e):this.open(e),this._options.onToggle(this,t)},i.prototype.close=function(e){var t,r,n=this.getItem(e);(t=n.triggerEl.classList).remove.apply(t,this._options.activeClasses.split(" ")),(r=n.triggerEl.classList).add.apply(r,this._options.inactiveClasses.split(" ")),n.targetEl.classList.add("hidden"),n.triggerEl.setAttribute("aria-expanded","false"),n.active=!1,n.iconEl&&n.iconEl.classList.add("rotate-180"),this._options.onClose(this,n)},i.prototype.updateOnOpen=function(e){this._options.onOpen=e},i.prototype.updateOnClose=function(e){this._options.onClose=e},i.prototype.updateOnToggle=function(e){this._options.onToggle=e},i}();function Hh(){document.querySelectorAll("[data-accordion]").forEach(function(i){var e=i.getAttribute("data-accordion"),t=i.getAttribute("data-active-classes"),r=i.getAttribute("data-inactive-classes"),n=[];i.querySelectorAll("[data-accordion-target]").forEach(function(s){if(s.closest("[data-accordion]")===i){var o={id:s.getAttribute("data-accordion-target"),triggerEl:s,targetEl:document.querySelector(s.getAttribute("data-accordion-target")),iconEl:s.querySelector("[data-accordion-icon]"),active:s.getAttribute("aria-expanded")==="true"};n.push(o)}}),new ab(i,n,{alwaysOpen:e==="open",activeClasses:t||uc.activeClasses,inactiveClasses:r||uc.inactiveClasses})})}typeof window<"u"&&(window.Accordion=ab,window.initAccordions=Hh);var hc=function(){return hc=Object.assign||function(i){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n])}return i},hc.apply(this,arguments)},em={onCollapse:function(){},onExpand:function(){},onToggle:function(){}},oS={id:null,override:!0},ju=function(){function i(e,t,r,n){e===void 0&&(e=null),t===void 0&&(t=null),r===void 0&&(r=em),n===void 0&&(n=oS),this._instanceId=n.id?n.id:e.id,this._targetEl=e,this._triggerEl=t,this._options=hc(hc({},em),r),this._visible=!1,this._initialized=!1,this.init(),Qe.addInstance("Collapse",this,this._instanceId,n.override)}return i.prototype.init=function(){var e=this;this._triggerEl&&this._targetEl&&!this._initialized&&(this._triggerEl.hasAttribute("aria-expanded")?this._visible=this._triggerEl.getAttribute("aria-expanded")==="true":this._visible=!this._targetEl.classList.contains("hidden"),this._clickHandler=function(){e.toggle()},this._triggerEl.addEventListener("click",this._clickHandler),this._initialized=!0)},i.prototype.destroy=function(){this._triggerEl&&this._initialized&&(this._triggerEl.removeEventListener("click",this._clickHandler),this._initialized=!1)},i.prototype.removeInstance=function(){Qe.removeInstance("Collapse",this._instanceId)},i.prototype.destroyAndRemoveInstance=function(){this.destroy(),this.removeInstance()},i.prototype.collapse=function(){this._targetEl.classList.add("hidden"),this._triggerEl&&this._triggerEl.setAttribute("aria-expanded","false"),this._visible=!1,this._options.onCollapse(this)},i.prototype.expand=function(){this._targetEl.classList.remove("hidden"),this._triggerEl&&this._triggerEl.setAttribute("aria-expanded","true"),this._visible=!0,this._options.onExpand(this)},i.prototype.toggle=function(){this._visible?this.collapse():this.expand(),this._options.onToggle(this)},i.prototype.updateOnCollapse=function(e){this._options.onCollapse=e},i.prototype.updateOnExpand=function(e){this._options.onExpand=e},i.prototype.updateOnToggle=function(e){this._options.onToggle=e},i}();function Uh(){document.querySelectorAll("[data-collapse-toggle]").forEach(function(i){var e=i.getAttribute("data-collapse-toggle"),t=document.getElementById(e);t?Qe.instanceExists("Collapse",t.getAttribute("id"))?new ju(t,i,{},{id:t.getAttribute("id")+"_"+Qe._generateRandomId()}):new ju(t,i):console.error('The target element with id "'.concat(e,'" does not exist. Please check the data-collapse-toggle attribute.'))})}typeof window<"u"&&(window.Collapse=ju,window.initCollapses=Uh);var jn=function(){return jn=Object.assign||function(i){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n])}return i},jn.apply(this,arguments)},jl={defaultPosition:0,indicators:{items:[],activeClasses:"bg-white dark:bg-gray-800",inactiveClasses:"bg-white/50 dark:bg-gray-800/50 hover:bg-white dark:hover:bg-gray-800"},interval:3e3,onNext:function(){},onPrev:function(){},onChange:function(){}},aS={id:null,override:!0},lb=function(){function i(e,t,r,n){e===void 0&&(e=null),t===void 0&&(t=[]),r===void 0&&(r=jl),n===void 0&&(n=aS),this._instanceId=n.id?n.id:e.id,this._carouselEl=e,this._items=t,this._options=jn(jn(jn({},jl),r),{indicators:jn(jn({},jl.indicators),r.indicators)}),this._activeItem=this.getItem(this._options.defaultPosition),this._indicators=this._options.indicators.items,this._intervalDuration=this._options.interval,this._intervalInstance=null,this._initialized=!1,this.init(),Qe.addInstance("Carousel",this,this._instanceId,n.override)}return i.prototype.init=function(){var e=this;this._items.length&&!this._initialized&&(this._items.map(function(t){t.el.classList.add("absolute","inset-0","transition-transform","transform")}),this.getActiveItem()?this.slideTo(this.getActiveItem().position):this.slideTo(0),this._indicators.map(function(t,r){t.el.addEventListener("click",function(){e.slideTo(r)})}),this._initialized=!0)},i.prototype.destroy=function(){this._initialized&&(this._initialized=!1)},i.prototype.removeInstance=function(){Qe.removeInstance("Carousel",this._instanceId)},i.prototype.destroyAndRemoveInstance=function(){this.destroy(),this.removeInstance()},i.prototype.getItem=function(e){return this._items[e]},i.prototype.slideTo=function(e){var t=this._items[e],r={left:t.position===0?this._items[this._items.length-1]:this._items[t.position-1],middle:t,right:t.position===this._items.length-1?this._items[0]:this._items[t.position+1]};this._rotate(r),this._setActiveItem(t),this._intervalInstance&&(this.pause(),this.cycle()),this._options.onChange(this)},i.prototype.next=function(){var e=this.getActiveItem(),t=null;e.position===this._items.length-1?t=this._items[0]:t=this._items[e.position+1],this.slideTo(t.position),this._options.onNext(this)},i.prototype.prev=function(){var e=this.getActiveItem(),t=null;e.position===0?t=this._items[this._items.length-1]:t=this._items[e.position-1],this.slideTo(t.position),this._options.onPrev(this)},i.prototype._rotate=function(e){if(this._items.map(function(t){t.el.classList.add("hidden")}),this._items.length===1){e.middle.el.classList.remove("-translate-x-full","translate-x-full","translate-x-0","hidden","z-10"),e.middle.el.classList.add("translate-x-0","z-20");return}e.left.el.classList.remove("-translate-x-full","translate-x-full","translate-x-0","hidden","z-20"),e.left.el.classList.add("-translate-x-full","z-10"),e.middle.el.classList.remove("-translate-x-full","translate-x-full","translate-x-0","hidden","z-10"),e.middle.el.classList.add("translate-x-0","z-30"),e.right.el.classList.remove("-translate-x-full","translate-x-full","translate-x-0","hidden","z-30"),e.right.el.classList.add("translate-x-full","z-20")},i.prototype.cycle=function(){var e=this;typeof window<"u"&&(this._intervalInstance=window.setInterval(function(){e.next()},this._intervalDuration))},i.prototype.pause=function(){clearInterval(this._intervalInstance)},i.prototype.getActiveItem=function(){return this._activeItem},i.prototype._setActiveItem=function(e){var t,r,n=this;this._activeItem=e;var s=e.position;this._indicators.length&&(this._indicators.map(function(o){var a,l;o.el.setAttribute("aria-current","false"),(a=o.el.classList).remove.apply(a,n._options.indicators.activeClasses.split(" ")),(l=o.el.classList).add.apply(l,n._options.indicators.inactiveClasses.split(" "))}),(t=this._indicators[s].el.classList).add.apply(t,this._options.indicators.activeClasses.split(" ")),(r=this._indicators[s].el.classList).remove.apply(r,this._options.indicators.inactiveClasses.split(" ")),this._indicators[s].el.setAttribute("aria-current","true"))},i.prototype.updateOnNext=function(e){this._options.onNext=e},i.prototype.updateOnPrev=function(e){this._options.onPrev=e},i.prototype.updateOnChange=function(e){this._options.onChange=e},i}();function jh(){document.querySelectorAll("[data-carousel]").forEach(function(i){var e=i.getAttribute("data-carousel-interval"),t=i.getAttribute("data-carousel")==="slide",r=[],n=0;i.querySelectorAll("[data-carousel-item]").length&&Array.from(i.querySelectorAll("[data-carousel-item]")).map(function(c,d){r.push({position:d,el:c}),c.getAttribute("data-carousel-item")==="active"&&(n=d)});var s=[];i.querySelectorAll("[data-carousel-slide-to]").length&&Array.from(i.querySelectorAll("[data-carousel-slide-to]")).map(function(c){s.push({position:parseInt(c.getAttribute("data-carousel-slide-to")),el:c})});var o=new lb(i,r,{defaultPosition:n,indicators:{items:s},interval:e||jl.interval});t&&o.cycle();var a=i.querySelector("[data-carousel-next]"),l=i.querySelector("[data-carousel-prev]");a&&a.addEventListener("click",function(){o.next()}),l&&l.addEventListener("click",function(){o.prev()})})}typeof window<"u"&&(window.Carousel=lb,window.initCarousels=jh);var fc=function(){return fc=Object.assign||function(i){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n])}return i},fc.apply(this,arguments)},tm={transition:"transition-opacity",duration:300,timing:"ease-out",onHide:function(){}},lS={id:null,override:!0},cb=function(){function i(e,t,r,n){e===void 0&&(e=null),t===void 0&&(t=null),r===void 0&&(r=tm),n===void 0&&(n=lS),this._instanceId=n.id?n.id:e.id,this._targetEl=e,this._triggerEl=t,this._options=fc(fc({},tm),r),this._initialized=!1,this.init(),Qe.addInstance("Dismiss",this,this._instanceId,n.override)}return i.prototype.init=function(){var e=this;this._triggerEl&&this._targetEl&&!this._initialized&&(this._clickHandler=function(){e.hide()},this._triggerEl.addEventListener("click",this._clickHandler),this._initialized=!0)},i.prototype.destroy=function(){this._triggerEl&&this._initialized&&(this._triggerEl.removeEventListener("click",this._clickHandler),this._initialized=!1)},i.prototype.removeInstance=function(){Qe.removeInstance("Dismiss",this._instanceId)},i.prototype.destroyAndRemoveInstance=function(){this.destroy(),this.removeInstance()},i.prototype.hide=function(){var e=this;this._targetEl.classList.add(this._options.transition,"duration-".concat(this._options.duration),this._options.timing,"opacity-0"),setTimeout(function(){e._targetEl.classList.add("hidden")},this._options.duration),this._options.onHide(this,this._targetEl)},i.prototype.updateOnHide=function(e){this._options.onHide=e},i}();function Wh(){document.querySelectorAll("[data-dismiss-target]").forEach(function(i){var e=i.getAttribute("data-dismiss-target"),t=document.querySelector(e);t?new cb(t,i):console.error('The dismiss element with id "'.concat(e,'" does not exist. Please check the data-dismiss-target attribute.'))})}typeof window<"u"&&(window.Dismiss=cb,window.initDismisses=Wh);var si="top",Pi="bottom",Ri="right",oi="left",Gh="auto",Ia=[si,Pi,Ri,oi],to="start",ya="end",cS="clippingParents",db="viewport",So="popper",dS="reference",im=Ia.reduce(function(i,e){return i.concat([e+"-"+to,e+"-"+ya])},[]),ub=[].concat(Ia,[Gh]).reduce(function(i,e){return i.concat([e,e+"-"+to,e+"-"+ya])},[]),uS="beforeRead",hS="read",fS="afterRead",pS="beforeMain",mS="main",gS="afterMain",vS="beforeWrite",bS="write",yS="afterWrite",_S=[uS,hS,fS,pS,mS,gS,vS,bS,yS];function or(i){return i?(i.nodeName||"").toLowerCase():null}function mi(i){if(i==null)return window;if(i.toString()!=="[object Window]"){var e=i.ownerDocument;return e&&e.defaultView||window}return i}function os(i){var e=mi(i).Element;return i instanceof e||i instanceof Element}function Di(i){var e=mi(i).HTMLElement;return i instanceof e||i instanceof HTMLElement}function qh(i){if(typeof ShadowRoot>"u")return!1;var e=mi(i).ShadowRoot;return i instanceof e||i instanceof ShadowRoot}function wS(i){var e=i.state;Object.keys(e.elements).forEach(function(t){var r=e.styles[t]||{},n=e.attributes[t]||{},s=e.elements[t];!Di(s)||!or(s)||(Object.assign(s.style,r),Object.keys(n).forEach(function(o){var a=n[o];a===!1?s.removeAttribute(o):s.setAttribute(o,a===!0?"":a)}))})}function xS(i){var e=i.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(r){var n=e.elements[r],s=e.attributes[r]||{},o=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:t[r]),a=o.reduce(function(l,c){return l[c]="",l},{});!Di(n)||!or(n)||(Object.assign(n.style,a),Object.keys(s).forEach(function(l){n.removeAttribute(l)}))})}}const SS={name:"applyStyles",enabled:!0,phase:"write",fn:wS,effect:xS,requires:["computeStyles"]};function er(i){return i.split("-")[0]}var Qn=Math.max,pc=Math.min,io=Math.round;function Wu(){var i=navigator.userAgentData;return i!=null&&i.brands&&Array.isArray(i.brands)?i.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function hb(){return!/^((?!chrome|android).)*safari/i.test(Wu())}function ro(i,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var r=i.getBoundingClientRect(),n=1,s=1;e&&Di(i)&&(n=i.offsetWidth>0&&io(r.width)/i.offsetWidth||1,s=i.offsetHeight>0&&io(r.height)/i.offsetHeight||1);var o=os(i)?mi(i):window,a=o.visualViewport,l=!hb()&&t,c=(r.left+(l&&a?a.offsetLeft:0))/n,d=(r.top+(l&&a?a.offsetTop:0))/s,u=r.width/n,h=r.height/s;return{width:u,height:h,top:d,right:c+u,bottom:d+h,left:c,x:c,y:d}}function Yh(i){var e=ro(i),t=i.offsetWidth,r=i.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:i.offsetLeft,y:i.offsetTop,width:t,height:r}}function fb(i,e){var t=e.getRootNode&&e.getRootNode();if(i.contains(e))return!0;if(t&&qh(t)){var r=e;do{if(r&&i.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function Lr(i){return mi(i).getComputedStyle(i)}function MS(i){return["table","td","th"].indexOf(or(i))>=0}function Cn(i){return((os(i)?i.ownerDocument:i.document)||window.document).documentElement}function id(i){return or(i)==="html"?i:i.assignedSlot||i.parentNode||(qh(i)?i.host:null)||Cn(i)}function rm(i){return!Di(i)||Lr(i).position==="fixed"?null:i.offsetParent}function ES(i){var e=/firefox/i.test(Wu()),t=/Trident/i.test(Wu());if(t&&Di(i)){var r=Lr(i);if(r.position==="fixed")return null}var n=id(i);for(qh(n)&&(n=n.host);Di(n)&&["html","body"].indexOf(or(n))<0;){var s=Lr(n);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||e&&s.willChange==="filter"||e&&s.filter&&s.filter!=="none")return n;n=n.parentNode}return null}function Oa(i){for(var e=mi(i),t=rm(i);t&&MS(t)&&Lr(t).position==="static";)t=rm(t);return t&&(or(t)==="html"||or(t)==="body"&&Lr(t).position==="static")?e:t||ES(i)||e}function Xh(i){return["top","bottom"].indexOf(i)>=0?"x":"y"}function Zo(i,e,t){return Qn(i,pc(e,t))}function kS(i,e,t){var r=Zo(i,e,t);return r>t?t:r}function pb(){return{top:0,right:0,bottom:0,left:0}}function mb(i){return Object.assign({},pb(),i)}function gb(i,e){return e.reduce(function(t,r){return t[r]=i,t},{})}var CS=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,mb(typeof e!="number"?e:gb(e,Ia))};function TS(i){var e,t=i.state,r=i.name,n=i.options,s=t.elements.arrow,o=t.modifiersData.popperOffsets,a=er(t.placement),l=Xh(a),c=[oi,Ri].indexOf(a)>=0,d=c?"height":"width";if(!(!s||!o)){var u=CS(n.padding,t),h=Yh(s),p=l==="y"?si:oi,g=l==="y"?Pi:Ri,f=t.rects.reference[d]+t.rects.reference[l]-o[l]-t.rects.popper[d],m=o[l]-t.rects.reference[l],b=Oa(s),y=b?l==="y"?b.clientHeight||0:b.clientWidth||0:0,w=f/2-m/2,_=u[p],M=y-h[d]-u[g],S=y/2-h[d]/2+w,A=Zo(_,S,M),x=l;t.modifiersData[r]=(e={},e[x]=A,e.centerOffset=A-S,e)}}function AS(i){var e=i.state,t=i.options,r=t.element,n=r===void 0?"[data-popper-arrow]":r;n!=null&&(typeof n=="string"&&(n=e.elements.popper.querySelector(n),!n)||fb(e.elements.popper,n)&&(e.elements.arrow=n))}const LS={name:"arrow",enabled:!0,phase:"main",fn:TS,effect:AS,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function no(i){return i.split("-")[1]}var DS={top:"auto",right:"auto",bottom:"auto",left:"auto"};function PS(i,e){var t=i.x,r=i.y,n=e.devicePixelRatio||1;return{x:io(t*n)/n||0,y:io(r*n)/n||0}}function nm(i){var e,t=i.popper,r=i.popperRect,n=i.placement,s=i.variation,o=i.offsets,a=i.position,l=i.gpuAcceleration,c=i.adaptive,d=i.roundOffsets,u=i.isFixed,h=o.x,p=h===void 0?0:h,g=o.y,f=g===void 0?0:g,m=typeof d=="function"?d({x:p,y:f}):{x:p,y:f};p=m.x,f=m.y;var b=o.hasOwnProperty("x"),y=o.hasOwnProperty("y"),w=oi,_=si,M=window;if(c){var S=Oa(t),A="clientHeight",x="clientWidth";if(S===mi(t)&&(S=Cn(t),Lr(S).position!=="static"&&a==="absolute"&&(A="scrollHeight",x="scrollWidth")),S=S,n===si||(n===oi||n===Ri)&&s===ya){_=Pi;var E=u&&S===M&&M.visualViewport?M.visualViewport.height:S[A];f-=E-r.height,f*=l?1:-1}if(n===oi||(n===si||n===Pi)&&s===ya){w=Ri;var D=u&&S===M&&M.visualViewport?M.visualViewport.width:S[x];p-=D-r.width,p*=l?1:-1}}var F=Object.assign({position:a},c&&DS),R=d===!0?PS({x:p,y:f},mi(t)):{x:p,y:f};if(p=R.x,f=R.y,l){var B;return Object.assign({},F,(B={},B[_]=y?"0":"",B[w]=b?"0":"",B.transform=(M.devicePixelRatio||1)<=1?"translate("+p+"px, "+f+"px)":"translate3d("+p+"px, "+f+"px, 0)",B))}return Object.assign({},F,(e={},e[_]=y?f+"px":"",e[w]=b?p+"px":"",e.transform="",e))}function RS(i){var e=i.state,t=i.options,r=t.gpuAcceleration,n=r===void 0?!0:r,s=t.adaptive,o=s===void 0?!0:s,a=t.roundOffsets,l=a===void 0?!0:a,c={placement:er(e.placement),variation:no(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:n,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,nm(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:o,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,nm(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const IS={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:RS,data:{}};var tl={passive:!0};function OS(i){var e=i.state,t=i.instance,r=i.options,n=r.scroll,s=n===void 0?!0:n,o=r.resize,a=o===void 0?!0:o,l=mi(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return s&&c.forEach(function(d){d.addEventListener("scroll",t.update,tl)}),a&&l.addEventListener("resize",t.update,tl),function(){s&&c.forEach(function(d){d.removeEventListener("scroll",t.update,tl)}),a&&l.removeEventListener("resize",t.update,tl)}}const FS={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:OS,data:{}};var zS={left:"right",right:"left",bottom:"top",top:"bottom"};function Wl(i){return i.replace(/left|right|bottom|top/g,function(e){return zS[e]})}var NS={start:"end",end:"start"};function sm(i){return i.replace(/start|end/g,function(e){return NS[e]})}function Kh(i){var e=mi(i),t=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:t,scrollTop:r}}function Jh(i){return ro(Cn(i)).left+Kh(i).scrollLeft}function $S(i,e){var t=mi(i),r=Cn(i),n=t.visualViewport,s=r.clientWidth,o=r.clientHeight,a=0,l=0;if(n){s=n.width,o=n.height;var c=hb();(c||!c&&e==="fixed")&&(a=n.offsetLeft,l=n.offsetTop)}return{width:s,height:o,x:a+Jh(i),y:l}}function BS(i){var e,t=Cn(i),r=Kh(i),n=(e=i.ownerDocument)==null?void 0:e.body,s=Qn(t.scrollWidth,t.clientWidth,n?n.scrollWidth:0,n?n.clientWidth:0),o=Qn(t.scrollHeight,t.clientHeight,n?n.scrollHeight:0,n?n.clientHeight:0),a=-r.scrollLeft+Jh(i),l=-r.scrollTop;return Lr(n||t).direction==="rtl"&&(a+=Qn(t.clientWidth,n?n.clientWidth:0)-s),{width:s,height:o,x:a,y:l}}function Zh(i){var e=Lr(i),t=e.overflow,r=e.overflowX,n=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+n+r)}function vb(i){return["html","body","#document"].indexOf(or(i))>=0?i.ownerDocument.body:Di(i)&&Zh(i)?i:vb(id(i))}function Qo(i,e){var t;e===void 0&&(e=[]);var r=vb(i),n=r===((t=i.ownerDocument)==null?void 0:t.body),s=mi(r),o=n?[s].concat(s.visualViewport||[],Zh(r)?r:[]):r,a=e.concat(o);return n?a:a.concat(Qo(id(o)))}function Gu(i){return Object.assign({},i,{left:i.x,top:i.y,right:i.x+i.width,bottom:i.y+i.height})}function VS(i,e){var t=ro(i,!1,e==="fixed");return t.top=t.top+i.clientTop,t.left=t.left+i.clientLeft,t.bottom=t.top+i.clientHeight,t.right=t.left+i.clientWidth,t.width=i.clientWidth,t.height=i.clientHeight,t.x=t.left,t.y=t.top,t}function om(i,e,t){return e===db?Gu($S(i,t)):os(e)?VS(e,t):Gu(BS(Cn(i)))}function HS(i){var e=Qo(id(i)),t=["absolute","fixed"].indexOf(Lr(i).position)>=0,r=t&&Di(i)?Oa(i):i;return os(r)?e.filter(function(n){return os(n)&&fb(n,r)&&or(n)!=="body"}):[]}function US(i,e,t,r){var n=e==="clippingParents"?HS(i):[].concat(e),s=[].concat(n,[t]),o=s[0],a=s.reduce(function(l,c){var d=om(i,c,r);return l.top=Qn(d.top,l.top),l.right=pc(d.right,l.right),l.bottom=pc(d.bottom,l.bottom),l.left=Qn(d.left,l.left),l},om(i,o,r));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function bb(i){var e=i.reference,t=i.element,r=i.placement,n=r?er(r):null,s=r?no(r):null,o=e.x+e.width/2-t.width/2,a=e.y+e.height/2-t.height/2,l;switch(n){case si:l={x:o,y:e.y-t.height};break;case Pi:l={x:o,y:e.y+e.height};break;case Ri:l={x:e.x+e.width,y:a};break;case oi:l={x:e.x-t.width,y:a};break;default:l={x:e.x,y:e.y}}var c=n?Xh(n):null;if(c!=null){var d=c==="y"?"height":"width";switch(s){case to:l[c]=l[c]-(e[d]/2-t[d]/2);break;case ya:l[c]=l[c]+(e[d]/2-t[d]/2);break}}return l}function _a(i,e){e===void 0&&(e={});var t=e,r=t.placement,n=r===void 0?i.placement:r,s=t.strategy,o=s===void 0?i.strategy:s,a=t.boundary,l=a===void 0?cS:a,c=t.rootBoundary,d=c===void 0?db:c,u=t.elementContext,h=u===void 0?So:u,p=t.altBoundary,g=p===void 0?!1:p,f=t.padding,m=f===void 0?0:f,b=mb(typeof m!="number"?m:gb(m,Ia)),y=h===So?dS:So,w=i.rects.popper,_=i.elements[g?y:h],M=US(os(_)?_:_.contextElement||Cn(i.elements.popper),l,d,o),S=ro(i.elements.reference),A=bb({reference:S,element:w,strategy:"absolute",placement:n}),x=Gu(Object.assign({},w,A)),E=h===So?x:S,D={top:M.top-E.top+b.top,bottom:E.bottom-M.bottom+b.bottom,left:M.left-E.left+b.left,right:E.right-M.right+b.right},F=i.modifiersData.offset;if(h===So&&F){var R=F[n];Object.keys(D).forEach(function(B){var I=[Ri,Pi].indexOf(B)>=0?1:-1,V=[si,Pi].indexOf(B)>=0?"y":"x";D[B]+=R[V]*I})}return D}function jS(i,e){e===void 0&&(e={});var t=e,r=t.placement,n=t.boundary,s=t.rootBoundary,o=t.padding,a=t.flipVariations,l=t.allowedAutoPlacements,c=l===void 0?ub:l,d=no(r),u=d?a?im:im.filter(function(g){return no(g)===d}):Ia,h=u.filter(function(g){return c.indexOf(g)>=0});h.length===0&&(h=u);var p=h.reduce(function(g,f){return g[f]=_a(i,{placement:f,boundary:n,rootBoundary:s,padding:o})[er(f)],g},{});return Object.keys(p).sort(function(g,f){return p[g]-p[f]})}function WS(i){if(er(i)===Gh)return[];var e=Wl(i);return[sm(i),e,sm(e)]}function GS(i){var e=i.state,t=i.options,r=i.name;if(!e.modifiersData[r]._skip){for(var n=t.mainAxis,s=n===void 0?!0:n,o=t.altAxis,a=o===void 0?!0:o,l=t.fallbackPlacements,c=t.padding,d=t.boundary,u=t.rootBoundary,h=t.altBoundary,p=t.flipVariations,g=p===void 0?!0:p,f=t.allowedAutoPlacements,m=e.options.placement,b=er(m),y=b===m,w=l||(y||!g?[Wl(m)]:WS(m)),_=[m].concat(w).reduce(function(Ce,We){return Ce.concat(er(We)===Gh?jS(e,{placement:We,boundary:d,rootBoundary:u,padding:c,flipVariations:g,allowedAutoPlacements:f}):We)},[]),M=e.rects.reference,S=e.rects.popper,A=new Map,x=!0,E=_[0],D=0;D<_.length;D++){var F=_[D],R=er(F),B=no(F)===to,I=[si,Pi].indexOf(R)>=0,V=I?"width":"height",N=_a(e,{placement:F,boundary:d,rootBoundary:u,altBoundary:h,padding:c}),j=I?B?Ri:oi:B?Pi:si;M[V]>S[V]&&(j=Wl(j));var Y=Wl(j),W=[];if(s&&W.push(N[R]<=0),a&&W.push(N[j]<=0,N[Y]<=0),W.every(function(Ce){return Ce})){E=F,x=!1;break}A.set(F,W)}if(x)for(var ee=g?3:1,me=function(We){var se=_.find(function(te){var fe=A.get(te);if(fe)return fe.slice(0,We).every(function(pe){return pe})});if(se)return E=se,"break"},X=ee;X>0;X--){var ye=me(X);if(ye==="break")break}e.placement!==E&&(e.modifiersData[r]._skip=!0,e.placement=E,e.reset=!0)}}const qS={name:"flip",enabled:!0,phase:"main",fn:GS,requiresIfExists:["offset"],data:{_skip:!1}};function am(i,e,t){return t===void 0&&(t={x:0,y:0}),{top:i.top-e.height-t.y,right:i.right-e.width+t.x,bottom:i.bottom-e.height+t.y,left:i.left-e.width-t.x}}function lm(i){return[si,Ri,Pi,oi].some(function(e){return i[e]>=0})}function YS(i){var e=i.state,t=i.name,r=e.rects.reference,n=e.rects.popper,s=e.modifiersData.preventOverflow,o=_a(e,{elementContext:"reference"}),a=_a(e,{altBoundary:!0}),l=am(o,r),c=am(a,n,s),d=lm(l),u=lm(c);e.modifiersData[t]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:d,hasPopperEscaped:u},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":u})}const XS={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:YS};function KS(i,e,t){var r=er(i),n=[oi,si].indexOf(r)>=0?-1:1,s=typeof t=="function"?t(Object.assign({},e,{placement:i})):t,o=s[0],a=s[1];return o=o||0,a=(a||0)*n,[oi,Ri].indexOf(r)>=0?{x:a,y:o}:{x:o,y:a}}function JS(i){var e=i.state,t=i.options,r=i.name,n=t.offset,s=n===void 0?[0,0]:n,o=ub.reduce(function(d,u){return d[u]=KS(u,e.rects,s),d},{}),a=o[e.placement],l=a.x,c=a.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[r]=o}const ZS={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:JS};function QS(i){var e=i.state,t=i.name;e.modifiersData[t]=bb({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const eM={name:"popperOffsets",enabled:!0,phase:"read",fn:QS,data:{}};function tM(i){return i==="x"?"y":"x"}function iM(i){var e=i.state,t=i.options,r=i.name,n=t.mainAxis,s=n===void 0?!0:n,o=t.altAxis,a=o===void 0?!1:o,l=t.boundary,c=t.rootBoundary,d=t.altBoundary,u=t.padding,h=t.tether,p=h===void 0?!0:h,g=t.tetherOffset,f=g===void 0?0:g,m=_a(e,{boundary:l,rootBoundary:c,padding:u,altBoundary:d}),b=er(e.placement),y=no(e.placement),w=!y,_=Xh(b),M=tM(_),S=e.modifiersData.popperOffsets,A=e.rects.reference,x=e.rects.popper,E=typeof f=="function"?f(Object.assign({},e.rects,{placement:e.placement})):f,D=typeof E=="number"?{mainAxis:E,altAxis:E}:Object.assign({mainAxis:0,altAxis:0},E),F=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,R={x:0,y:0};if(S){if(s){var B,I=_==="y"?si:oi,V=_==="y"?Pi:Ri,N=_==="y"?"height":"width",j=S[_],Y=j+m[I],W=j-m[V],ee=p?-x[N]/2:0,me=y===to?A[N]:x[N],X=y===to?-x[N]:-A[N],ye=e.elements.arrow,Ce=p&&ye?Yh(ye):{width:0,height:0},We=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:pb(),se=We[I],te=We[V],fe=Zo(0,A[N],Ce[N]),pe=w?A[N]/2-ee-fe-se-D.mainAxis:me-fe-se-D.mainAxis,de=w?-A[N]/2+ee+fe+te+D.mainAxis:X+fe+te+D.mainAxis,He=e.elements.arrow&&Oa(e.elements.arrow),$e=He?_==="y"?He.clientTop||0:He.clientLeft||0:0,L=(B=F==null?void 0:F[_])!=null?B:0,$=j+pe-L-$e,Z=j+de-L,le=Zo(p?pc(Y,$):Y,j,p?Qn(W,Z):W);S[_]=le,R[_]=le-j}if(a){var oe,_e=_==="x"?si:oi,we=_==="x"?Pi:Ri,xe=S[M],Me=M==="y"?"height":"width",T=xe+m[_e],C=xe-m[we],q=[si,oi].indexOf(b)!==-1,re=(oe=F==null?void 0:F[M])!=null?oe:0,ue=q?T:xe-A[Me]-x[Me]-re+D.altAxis,ve=q?xe+A[Me]+x[Me]-re-D.altAxis:C,Re=p&&q?kS(ue,xe,ve):Zo(p?ue:T,xe,p?ve:C);S[M]=Re,R[M]=Re-xe}e.modifiersData[r]=R}}const rM={name:"preventOverflow",enabled:!0,phase:"main",fn:iM,requiresIfExists:["offset"]};function nM(i){return{scrollLeft:i.scrollLeft,scrollTop:i.scrollTop}}function sM(i){return i===mi(i)||!Di(i)?Kh(i):nM(i)}function oM(i){var e=i.getBoundingClientRect(),t=io(e.width)/i.offsetWidth||1,r=io(e.height)/i.offsetHeight||1;return t!==1||r!==1}function aM(i,e,t){t===void 0&&(t=!1);var r=Di(e),n=Di(e)&&oM(e),s=Cn(e),o=ro(i,n,t),a={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(r||!r&&!t)&&((or(e)!=="body"||Zh(s))&&(a=sM(e)),Di(e)?(l=ro(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):s&&(l.x=Jh(s))),{x:o.left+a.scrollLeft-l.x,y:o.top+a.scrollTop-l.y,width:o.width,height:o.height}}function lM(i){var e=new Map,t=new Set,r=[];i.forEach(function(s){e.set(s.name,s)});function n(s){t.add(s.name);var o=[].concat(s.requires||[],s.requiresIfExists||[]);o.forEach(function(a){if(!t.has(a)){var l=e.get(a);l&&n(l)}}),r.push(s)}return i.forEach(function(s){t.has(s.name)||n(s)}),r}function cM(i){var e=lM(i);return _S.reduce(function(t,r){return t.concat(e.filter(function(n){return n.phase===r}))},[])}function dM(i){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(i())})})),e}}function uM(i){var e=i.reduce(function(t,r){var n=t[r.name];return t[r.name]=n?Object.assign({},n,r,{options:Object.assign({},n.options,r.options),data:Object.assign({},n.data,r.data)}):r,t},{});return Object.keys(e).map(function(t){return e[t]})}var cm={placement:"bottom",modifiers:[],strategy:"absolute"};function dm(){for(var i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function hM(i){i===void 0&&(i={});var e=i,t=e.defaultModifiers,r=t===void 0?[]:t,n=e.defaultOptions,s=n===void 0?cm:n;return function(a,l,c){c===void 0&&(c=s);var d={placement:"bottom",orderedModifiers:[],options:Object.assign({},cm,s),modifiersData:{},elements:{reference:a,popper:l},attributes:{},styles:{}},u=[],h=!1,p={state:d,setOptions:function(b){var y=typeof b=="function"?b(d.options):b;f(),d.options=Object.assign({},s,d.options,y),d.scrollParents={reference:os(a)?Qo(a):a.contextElement?Qo(a.contextElement):[],popper:Qo(l)};var w=cM(uM([].concat(r,d.options.modifiers)));return d.orderedModifiers=w.filter(function(_){return _.enabled}),g(),p.update()},forceUpdate:function(){if(!h){var b=d.elements,y=b.reference,w=b.popper;if(dm(y,w)){d.rects={reference:aM(y,Oa(w),d.options.strategy==="fixed"),popper:Yh(w)},d.reset=!1,d.placement=d.options.placement,d.orderedModifiers.forEach(function(D){return d.modifiersData[D.name]=Object.assign({},D.data)});for(var _=0;_<d.orderedModifiers.length;_++){if(d.reset===!0){d.reset=!1,_=-1;continue}var M=d.orderedModifiers[_],S=M.fn,A=M.options,x=A===void 0?{}:A,E=M.name;typeof S=="function"&&(d=S({state:d,options:x,name:E,instance:p})||d)}}}},update:dM(function(){return new Promise(function(m){p.forceUpdate(),m(d)})}),destroy:function(){f(),h=!0}};if(!dm(a,l))return p;p.setOptions(c).then(function(m){!h&&c.onFirstUpdate&&c.onFirstUpdate(m)});function g(){d.orderedModifiers.forEach(function(m){var b=m.name,y=m.options,w=y===void 0?{}:y,_=m.effect;if(typeof _=="function"){var M=_({state:d,name:b,instance:p,options:w}),S=function(){};u.push(M||S)}})}function f(){u.forEach(function(m){return m()}),u=[]}return p}}var fM=[FS,eM,IS,SS,ZS,qS,rM,LS,XS],Qh=hM({defaultModifiers:fM}),sn=function(){return sn=Object.assign||function(i){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n])}return i},sn.apply(this,arguments)},il=function(i,e,t){if(t||arguments.length===2)for(var r=0,n=e.length,s;r<n;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return i.concat(s||Array.prototype.slice.call(e))},on={placement:"bottom",triggerType:"click",offsetSkidding:0,offsetDistance:10,delay:300,ignoreClickOutsideClass:!1,onShow:function(){},onHide:function(){},onToggle:function(){}},pM={id:null,override:!0},yb=function(){function i(e,t,r,n){e===void 0&&(e=null),t===void 0&&(t=null),r===void 0&&(r=on),n===void 0&&(n=pM),this._instanceId=n.id?n.id:e.id,this._targetEl=e,this._triggerEl=t,this._options=sn(sn({},on),r),this._popperInstance=null,this._visible=!1,this._initialized=!1,this.init(),Qe.addInstance("Dropdown",this,this._instanceId,n.override)}return i.prototype.init=function(){this._triggerEl&&this._targetEl&&!this._initialized&&(this._popperInstance=this._createPopperInstance(),this._setupEventListeners(),this._initialized=!0)},i.prototype.destroy=function(){var e=this,t=this._getTriggerEvents();this._options.triggerType==="click"&&t.showEvents.forEach(function(r){e._triggerEl.removeEventListener(r,e._clickHandler)}),this._options.triggerType==="hover"&&(t.showEvents.forEach(function(r){e._triggerEl.removeEventListener(r,e._hoverShowTriggerElHandler),e._targetEl.removeEventListener(r,e._hoverShowTargetElHandler)}),t.hideEvents.forEach(function(r){e._triggerEl.removeEventListener(r,e._hoverHideHandler),e._targetEl.removeEventListener(r,e._hoverHideHandler)})),this._popperInstance.destroy(),this._initialized=!1},i.prototype.removeInstance=function(){Qe.removeInstance("Dropdown",this._instanceId)},i.prototype.destroyAndRemoveInstance=function(){this.destroy(),this.removeInstance()},i.prototype._setupEventListeners=function(){var e=this,t=this._getTriggerEvents();this._clickHandler=function(){e.toggle()},this._options.triggerType==="click"&&t.showEvents.forEach(function(r){e._triggerEl.addEventListener(r,e._clickHandler)}),this._hoverShowTriggerElHandler=function(r){r.type==="click"?e.toggle():setTimeout(function(){e.show()},e._options.delay)},this._hoverShowTargetElHandler=function(){e.show()},this._hoverHideHandler=function(){setTimeout(function(){e._targetEl.matches(":hover")||e.hide()},e._options.delay)},this._options.triggerType==="hover"&&(t.showEvents.forEach(function(r){e._triggerEl.addEventListener(r,e._hoverShowTriggerElHandler),e._targetEl.addEventListener(r,e._hoverShowTargetElHandler)}),t.hideEvents.forEach(function(r){e._triggerEl.addEventListener(r,e._hoverHideHandler),e._targetEl.addEventListener(r,e._hoverHideHandler)}))},i.prototype._createPopperInstance=function(){return Qh(this._triggerEl,this._targetEl,{placement:this._options.placement,modifiers:[{name:"offset",options:{offset:[this._options.offsetSkidding,this._options.offsetDistance]}}]})},i.prototype._setupClickOutsideListener=function(){var e=this;this._clickOutsideEventListener=function(t){e._handleClickOutside(t,e._targetEl)},document.body.addEventListener("click",this._clickOutsideEventListener,!0)},i.prototype._removeClickOutsideListener=function(){document.body.removeEventListener("click",this._clickOutsideEventListener,!0)},i.prototype._handleClickOutside=function(e,t){var r=e.target,n=this._options.ignoreClickOutsideClass,s=!1;if(n){var o=document.querySelectorAll(".".concat(n));o.forEach(function(a){if(a.contains(r)){s=!0;return}})}r!==t&&!t.contains(r)&&!this._triggerEl.contains(r)&&!s&&this.isVisible()&&this.hide()},i.prototype._getTriggerEvents=function(){switch(this._options.triggerType){case"hover":return{showEvents:["mouseenter","click"],hideEvents:["mouseleave"]};case"click":return{showEvents:["click"],hideEvents:[]};case"none":return{showEvents:[],hideEvents:[]};default:return{showEvents:["click"],hideEvents:[]}}},i.prototype.toggle=function(){this.isVisible()?this.hide():this.show(),this._options.onToggle(this)},i.prototype.isVisible=function(){return this._visible},i.prototype.show=function(){this._targetEl.classList.remove("hidden"),this._targetEl.classList.add("block"),this._popperInstance.setOptions(function(e){return sn(sn({},e),{modifiers:il(il([],e.modifiers,!0),[{name:"eventListeners",enabled:!0}],!1)})}),this._setupClickOutsideListener(),this._popperInstance.update(),this._visible=!0,this._options.onShow(this)},i.prototype.hide=function(){this._targetEl.classList.remove("block"),this._targetEl.classList.add("hidden"),this._popperInstance.setOptions(function(e){return sn(sn({},e),{modifiers:il(il([],e.modifiers,!0),[{name:"eventListeners",enabled:!1}],!1)})}),this._visible=!1,this._removeClickOutsideListener(),this._options.onHide(this)},i.prototype.updateOnShow=function(e){this._options.onShow=e},i.prototype.updateOnHide=function(e){this._options.onHide=e},i.prototype.updateOnToggle=function(e){this._options.onToggle=e},i}();function ef(){document.querySelectorAll("[data-dropdown-toggle]").forEach(function(i){var e=i.getAttribute("data-dropdown-toggle"),t=document.getElementById(e);if(t){var r=i.getAttribute("data-dropdown-placement"),n=i.getAttribute("data-dropdown-offset-skidding"),s=i.getAttribute("data-dropdown-offset-distance"),o=i.getAttribute("data-dropdown-trigger"),a=i.getAttribute("data-dropdown-delay"),l=i.getAttribute("data-dropdown-ignore-click-outside-class");new yb(t,i,{placement:r||on.placement,triggerType:o||on.triggerType,offsetSkidding:n?parseInt(n):on.offsetSkidding,offsetDistance:s?parseInt(s):on.offsetDistance,delay:a?parseInt(a):on.delay,ignoreClickOutsideClass:l||on.ignoreClickOutsideClass})}else console.error('The dropdown element with id "'.concat(e,'" does not exist. Please check the data-dropdown-toggle attribute.'))})}typeof window<"u"&&(window.Dropdown=yb,window.initDropdowns=ef);var mc=function(){return mc=Object.assign||function(i){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n])}return i},mc.apply(this,arguments)},gc={placement:"center",backdropClasses:"bg-gray-900/50 dark:bg-gray-900/80 fixed inset-0 z-40",backdrop:"dynamic",closable:!0,onHide:function(){},onShow:function(){},onToggle:function(){}},mM={id:null,override:!0},_b=function(){function i(e,t,r){e===void 0&&(e=null),t===void 0&&(t=gc),r===void 0&&(r=mM),this._eventListenerInstances=[],this._instanceId=r.id?r.id:e.id,this._targetEl=e,this._options=mc(mc({},gc),t),this._isHidden=!0,this._backdropEl=null,this._initialized=!1,this.init(),Qe.addInstance("Modal",this,this._instanceId,r.override)}return i.prototype.init=function(){var e=this;this._targetEl&&!this._initialized&&(this._getPlacementClasses().map(function(t){e._targetEl.classList.add(t)}),this._initialized=!0)},i.prototype.destroy=function(){this._initialized&&(this.removeAllEventListenerInstances(),this._destroyBackdropEl(),this._initialized=!1)},i.prototype.removeInstance=function(){Qe.removeInstance("Modal",this._instanceId)},i.prototype.destroyAndRemoveInstance=function(){this.destroy(),this.removeInstance()},i.prototype._createBackdrop=function(){var e;if(this._isHidden){var t=document.createElement("div");(e=t.classList).add.apply(e,this._options.backdropClasses.split(" ")),document.querySelector("body").append(t),this._backdropEl=t}},i.prototype._destroyBackdropEl=function(){!this._isHidden&&this._backdropEl&&(this._backdropEl.remove(),this._backdropEl=null)},i.prototype._setupModalCloseEventListeners=function(){var e=this;this._options.backdrop==="dynamic"&&(this._clickOutsideEventListener=function(t){e._handleOutsideClick(t.target)},this._targetEl.addEventListener("click",this._clickOutsideEventListener,!0)),this._keydownEventListener=function(t){t.key==="Escape"&&e.hide()},document.body.addEventListener("keydown",this._keydownEventListener,!0)},i.prototype._removeModalCloseEventListeners=function(){this._options.backdrop==="dynamic"&&this._targetEl.removeEventListener("click",this._clickOutsideEventListener,!0),document.body.removeEventListener("keydown",this._keydownEventListener,!0)},i.prototype._handleOutsideClick=function(e){(e===this._targetEl||e===this._backdropEl&&this.isVisible())&&this.hide()},i.prototype._getPlacementClasses=function(){switch(this._options.placement){case"top-left":return["justify-start","items-start"];case"top-center":return["justify-center","items-start"];case"top-right":return["justify-end","items-start"];case"center-left":return["justify-start","items-center"];case"center":return["justify-center","items-center"];case"center-right":return["justify-end","items-center"];case"bottom-left":return["justify-start","items-end"];case"bottom-center":return["justify-center","items-end"];case"bottom-right":return["justify-end","items-end"];default:return["justify-center","items-center"]}},i.prototype.toggle=function(){this._isHidden?this.show():this.hide(),this._options.onToggle(this)},i.prototype.show=function(){this.isHidden&&(this._targetEl.classList.add("flex"),this._targetEl.classList.remove("hidden"),this._targetEl.setAttribute("aria-modal","true"),this._targetEl.setAttribute("role","dialog"),this._targetEl.removeAttribute("aria-hidden"),this._createBackdrop(),this._isHidden=!1,this._options.closable&&this._setupModalCloseEventListeners(),document.body.classList.add("overflow-hidden"),this._options.onShow(this))},i.prototype.hide=function(){this.isVisible&&(this._targetEl.classList.add("hidden"),this._targetEl.classList.remove("flex"),this._targetEl.setAttribute("aria-hidden","true"),this._targetEl.removeAttribute("aria-modal"),this._targetEl.removeAttribute("role"),this._destroyBackdropEl(),this._isHidden=!0,document.body.classList.remove("overflow-hidden"),this._options.closable&&this._removeModalCloseEventListeners(),this._options.onHide(this))},i.prototype.isVisible=function(){return!this._isHidden},i.prototype.isHidden=function(){return this._isHidden},i.prototype.addEventListenerInstance=function(e,t,r){this._eventListenerInstances.push({element:e,type:t,handler:r})},i.prototype.removeAllEventListenerInstances=function(){this._eventListenerInstances.map(function(e){e.element.removeEventListener(e.type,e.handler)}),this._eventListenerInstances=[]},i.prototype.getAllEventListenerInstances=function(){return this._eventListenerInstances},i.prototype.updateOnShow=function(e){this._options.onShow=e},i.prototype.updateOnHide=function(e){this._options.onHide=e},i.prototype.updateOnToggle=function(e){this._options.onToggle=e},i}();function tf(){document.querySelectorAll("[data-modal-target]").forEach(function(i){var e=i.getAttribute("data-modal-target"),t=document.getElementById(e);if(t){var r=t.getAttribute("data-modal-placement"),n=t.getAttribute("data-modal-backdrop");new _b(t,{placement:r||gc.placement,backdrop:n||gc.backdrop})}else console.error("Modal with id ".concat(e," does not exist. Are you sure that the data-modal-target attribute points to the correct modal id?."))}),document.querySelectorAll("[data-modal-toggle]").forEach(function(i){var e=i.getAttribute("data-modal-toggle"),t=document.getElementById(e);if(t){var r=Qe.getInstance("Modal",e);if(r){var n=function(){r.toggle()};i.addEventListener("click",n),r.addEventListenerInstance(i,"click",n)}else console.error("Modal with id ".concat(e," has not been initialized. Please initialize it using the data-modal-target attribute."))}else console.error("Modal with id ".concat(e," does not exist. Are you sure that the data-modal-toggle attribute points to the correct modal id?"))}),document.querySelectorAll("[data-modal-show]").forEach(function(i){var e=i.getAttribute("data-modal-show"),t=document.getElementById(e);if(t){var r=Qe.getInstance("Modal",e);if(r){var n=function(){r.show()};i.addEventListener("click",n),r.addEventListenerInstance(i,"click",n)}else console.error("Modal with id ".concat(e," has not been initialized. Please initialize it using the data-modal-target attribute."))}else console.error("Modal with id ".concat(e," does not exist. Are you sure that the data-modal-show attribute points to the correct modal id?"))}),document.querySelectorAll("[data-modal-hide]").forEach(function(i){var e=i.getAttribute("data-modal-hide"),t=document.getElementById(e);if(t){var r=Qe.getInstance("Modal",e);if(r){var n=function(){r.hide()};i.addEventListener("click",n),r.addEventListenerInstance(i,"click",n)}else console.error("Modal with id ".concat(e," has not been initialized. Please initialize it using the data-modal-target attribute."))}else console.error("Modal with id ".concat(e," does not exist. Are you sure that the data-modal-hide attribute points to the correct modal id?"))})}typeof window<"u"&&(window.Modal=_b,window.initModals=tf);var vc=function(){return vc=Object.assign||function(i){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n])}return i},vc.apply(this,arguments)},Wn={placement:"left",bodyScrolling:!1,backdrop:!0,edge:!1,edgeOffset:"bottom-[60px]",backdropClasses:"bg-gray-900/50 dark:bg-gray-900/80 fixed inset-0 z-30",onShow:function(){},onHide:function(){},onToggle:function(){}},gM={id:null,override:!0},wb=function(){function i(e,t,r){e===void 0&&(e=null),t===void 0&&(t=Wn),r===void 0&&(r=gM),this._eventListenerInstances=[],this._instanceId=r.id?r.id:e.id,this._targetEl=e,this._options=vc(vc({},Wn),t),this._visible=!1,this._initialized=!1,this.init(),Qe.addInstance("Drawer",this,this._instanceId,r.override)}return i.prototype.init=function(){var e=this;this._targetEl&&!this._initialized&&(this._targetEl.setAttribute("aria-hidden","true"),this._targetEl.classList.add("transition-transform"),this._getPlacementClasses(this._options.placement).base.map(function(t){e._targetEl.classList.add(t)}),this._handleEscapeKey=function(t){t.key==="Escape"&&e.isVisible()&&e.hide()},document.addEventListener("keydown",this._handleEscapeKey),this._initialized=!0)},i.prototype.destroy=function(){this._initialized&&(this.removeAllEventListenerInstances(),this._destroyBackdropEl(),document.removeEventListener("keydown",this._handleEscapeKey),this._initialized=!1)},i.prototype.removeInstance=function(){Qe.removeInstance("Drawer",this._instanceId)},i.prototype.destroyAndRemoveInstance=function(){this.destroy(),this.removeInstance()},i.prototype.hide=function(){var e=this;this._options.edge?(this._getPlacementClasses(this._options.placement+"-edge").active.map(function(t){e._targetEl.classList.remove(t)}),this._getPlacementClasses(this._options.placement+"-edge").inactive.map(function(t){e._targetEl.classList.add(t)})):(this._getPlacementClasses(this._options.placement).active.map(function(t){e._targetEl.classList.remove(t)}),this._getPlacementClasses(this._options.placement).inactive.map(function(t){e._targetEl.classList.add(t)})),this._targetEl.setAttribute("aria-hidden","true"),this._targetEl.removeAttribute("aria-modal"),this._targetEl.removeAttribute("role"),this._options.bodyScrolling||document.body.classList.remove("overflow-hidden"),this._options.backdrop&&this._destroyBackdropEl(),this._visible=!1,this._options.onHide(this)},i.prototype.show=function(){var e=this;this._options.edge?(this._getPlacementClasses(this._options.placement+"-edge").active.map(function(t){e._targetEl.classList.add(t)}),this._getPlacementClasses(this._options.placement+"-edge").inactive.map(function(t){e._targetEl.classList.remove(t)})):(this._getPlacementClasses(this._options.placement).active.map(function(t){e._targetEl.classList.add(t)}),this._getPlacementClasses(this._options.placement).inactive.map(function(t){e._targetEl.classList.remove(t)})),this._targetEl.setAttribute("aria-modal","true"),this._targetEl.setAttribute("role","dialog"),this._targetEl.removeAttribute("aria-hidden"),this._options.bodyScrolling||document.body.classList.add("overflow-hidden"),this._options.backdrop&&this._createBackdrop(),this._visible=!0,this._options.onShow(this)},i.prototype.toggle=function(){this.isVisible()?this.hide():this.show()},i.prototype._createBackdrop=function(){var e,t=this;if(!this._visible){var r=document.createElement("div");r.setAttribute("drawer-backdrop",""),(e=r.classList).add.apply(e,this._options.backdropClasses.split(" ")),document.querySelector("body").append(r),r.addEventListener("click",function(){t.hide()})}},i.prototype._destroyBackdropEl=function(){this._visible&&document.querySelector("[drawer-backdrop]")!==null&&document.querySelector("[drawer-backdrop]").remove()},i.prototype._getPlacementClasses=function(e){switch(e){case"top":return{base:["top-0","left-0","right-0"],active:["transform-none"],inactive:["-translate-y-full"]};case"right":return{base:["right-0","top-0"],active:["transform-none"],inactive:["translate-x-full"]};case"bottom":return{base:["bottom-0","left-0","right-0"],active:["transform-none"],inactive:["translate-y-full"]};case"left":return{base:["left-0","top-0"],active:["transform-none"],inactive:["-translate-x-full"]};case"bottom-edge":return{base:["left-0","top-0"],active:["transform-none"],inactive:["translate-y-full",this._options.edgeOffset]};default:return{base:["left-0","top-0"],active:["transform-none"],inactive:["-translate-x-full"]}}},i.prototype.isHidden=function(){return!this._visible},i.prototype.isVisible=function(){return this._visible},i.prototype.addEventListenerInstance=function(e,t,r){this._eventListenerInstances.push({element:e,type:t,handler:r})},i.prototype.removeAllEventListenerInstances=function(){this._eventListenerInstances.map(function(e){e.element.removeEventListener(e.type,e.handler)}),this._eventListenerInstances=[]},i.prototype.getAllEventListenerInstances=function(){return this._eventListenerInstances},i.prototype.updateOnShow=function(e){this._options.onShow=e},i.prototype.updateOnHide=function(e){this._options.onHide=e},i.prototype.updateOnToggle=function(e){this._options.onToggle=e},i}();function rf(){document.querySelectorAll("[data-drawer-target]").forEach(function(i){var e=i.getAttribute("data-drawer-target"),t=document.getElementById(e);if(t){var r=i.getAttribute("data-drawer-placement"),n=i.getAttribute("data-drawer-body-scrolling"),s=i.getAttribute("data-drawer-backdrop"),o=i.getAttribute("data-drawer-edge"),a=i.getAttribute("data-drawer-edge-offset");new wb(t,{placement:r||Wn.placement,bodyScrolling:n?n==="true":Wn.bodyScrolling,backdrop:s?s==="true":Wn.backdrop,edge:o?o==="true":Wn.edge,edgeOffset:a||Wn.edgeOffset})}else console.error("Drawer with id ".concat(e," not found. Are you sure that the data-drawer-target attribute points to the correct drawer id?"))}),document.querySelectorAll("[data-drawer-toggle]").forEach(function(i){var e=i.getAttribute("data-drawer-toggle"),t=document.getElementById(e);if(t){var r=Qe.getInstance("Drawer",e);if(r){var n=function(){r.toggle()};i.addEventListener("click",n),r.addEventListenerInstance(i,"click",n)}else console.error("Drawer with id ".concat(e," has not been initialized. Please initialize it using the data-drawer-target attribute."))}else console.error("Drawer with id ".concat(e," not found. Are you sure that the data-drawer-target attribute points to the correct drawer id?"))}),document.querySelectorAll("[data-drawer-dismiss], [data-drawer-hide]").forEach(function(i){var e=i.getAttribute("data-drawer-dismiss")?i.getAttribute("data-drawer-dismiss"):i.getAttribute("data-drawer-hide"),t=document.getElementById(e);if(t){var r=Qe.getInstance("Drawer",e);if(r){var n=function(){r.hide()};i.addEventListener("click",n),r.addEventListenerInstance(i,"click",n)}else console.error("Drawer with id ".concat(e," has not been initialized. Please initialize it using the data-drawer-target attribute."))}else console.error("Drawer with id ".concat(e," not found. Are you sure that the data-drawer-target attribute points to the correct drawer id"))}),document.querySelectorAll("[data-drawer-show]").forEach(function(i){var e=i.getAttribute("data-drawer-show"),t=document.getElementById(e);if(t){var r=Qe.getInstance("Drawer",e);if(r){var n=function(){r.show()};i.addEventListener("click",n),r.addEventListenerInstance(i,"click",n)}else console.error("Drawer with id ".concat(e," has not been initialized. Please initialize it using the data-drawer-target attribute."))}else console.error("Drawer with id ".concat(e," not found. Are you sure that the data-drawer-target attribute points to the correct drawer id?"))})}typeof window<"u"&&(window.Drawer=wb,window.initDrawers=rf);var bc=function(){return bc=Object.assign||function(i){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n])}return i},bc.apply(this,arguments)},yc={defaultTabId:null,activeClasses:"text-blue-600 hover:text-blue-600 dark:text-blue-500 dark:hover:text-blue-500 border-blue-600 dark:border-blue-500",inactiveClasses:"dark:border-transparent text-gray-500 hover:text-gray-600 dark:text-gray-400 border-gray-100 hover:border-gray-300 dark:border-gray-700 dark:hover:text-gray-300",onShow:function(){}},vM={id:null,override:!0},xb=function(){function i(e,t,r,n){e===void 0&&(e=null),t===void 0&&(t=[]),r===void 0&&(r=yc),n===void 0&&(n=vM),this._instanceId=n.id?n.id:e.id,this._tabsEl=e,this._items=t,this._activeTab=r?this.getTab(r.defaultTabId):null,this._options=bc(bc({},yc),r),this._initialized=!1,this.init(),Qe.addInstance("Tabs",this,this._instanceId,n.override)}return i.prototype.init=function(){var e=this;this._items.length&&!this._initialized&&(this._activeTab||this.setActiveTab(this._items[0]),this.show(this._activeTab.id,!0),this._items.map(function(t){t.triggerEl.addEventListener("click",function(r){r.preventDefault(),e.show(t.id)})}))},i.prototype.destroy=function(){this._initialized&&(this._initialized=!1)},i.prototype.removeInstance=function(){this.destroy(),Qe.removeInstance("Tabs",this._instanceId)},i.prototype.destroyAndRemoveInstance=function(){this.destroy(),this.removeInstance()},i.prototype.getActiveTab=function(){return this._activeTab},i.prototype.setActiveTab=function(e){this._activeTab=e},i.prototype.getTab=function(e){return this._items.filter(function(t){return t.id===e})[0]},i.prototype.show=function(e,t){var r,n,s=this;t===void 0&&(t=!1);var o=this.getTab(e);o===this._activeTab&&!t||(this._items.map(function(a){var l,c;a!==o&&((l=a.triggerEl.classList).remove.apply(l,s._options.activeClasses.split(" ")),(c=a.triggerEl.classList).add.apply(c,s._options.inactiveClasses.split(" ")),a.targetEl.classList.add("hidden"),a.triggerEl.setAttribute("aria-selected","false"))}),(r=o.triggerEl.classList).add.apply(r,this._options.activeClasses.split(" ")),(n=o.triggerEl.classList).remove.apply(n,this._options.inactiveClasses.split(" ")),o.triggerEl.setAttribute("aria-selected","true"),o.targetEl.classList.remove("hidden"),this.setActiveTab(o),this._options.onShow(this,o))},i.prototype.updateOnShow=function(e){this._options.onShow=e},i}();function nf(){document.querySelectorAll("[data-tabs-toggle]").forEach(function(i){var e=[],t=i.getAttribute("data-tabs-active-classes"),r=i.getAttribute("data-tabs-inactive-classes"),n=null;i.querySelectorAll('[role="tab"]').forEach(function(s){var o=s.getAttribute("aria-selected")==="true",a={id:s.getAttribute("data-tabs-target"),triggerEl:s,targetEl:document.querySelector(s.getAttribute("data-tabs-target"))};e.push(a),o&&(n=a.id)}),new xb(i,e,{defaultTabId:n,activeClasses:t||yc.activeClasses,inactiveClasses:r||yc.inactiveClasses})})}typeof window<"u"&&(window.Tabs=xb,window.initTabs=nf);var an=function(){return an=Object.assign||function(i){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n])}return i},an.apply(this,arguments)},rl=function(i,e,t){if(t||arguments.length===2)for(var r=0,n=e.length,s;r<n;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return i.concat(s||Array.prototype.slice.call(e))},_c={placement:"top",triggerType:"hover",onShow:function(){},onHide:function(){},onToggle:function(){}},bM={id:null,override:!0},Sb=function(){function i(e,t,r,n){e===void 0&&(e=null),t===void 0&&(t=null),r===void 0&&(r=_c),n===void 0&&(n=bM),this._instanceId=n.id?n.id:e.id,this._targetEl=e,this._triggerEl=t,this._options=an(an({},_c),r),this._popperInstance=null,this._visible=!1,this._initialized=!1,this.init(),Qe.addInstance("Tooltip",this,this._instanceId,n.override)}return i.prototype.init=function(){this._triggerEl&&this._targetEl&&!this._initialized&&(this._setupEventListeners(),this._popperInstance=this._createPopperInstance(),this._initialized=!0)},i.prototype.destroy=function(){var e=this;if(this._initialized){var t=this._getTriggerEvents();t.showEvents.forEach(function(r){e._triggerEl.removeEventListener(r,e._showHandler)}),t.hideEvents.forEach(function(r){e._triggerEl.removeEventListener(r,e._hideHandler)}),this._removeKeydownListener(),this._removeClickOutsideListener(),this._popperInstance&&this._popperInstance.destroy(),this._initialized=!1}},i.prototype.removeInstance=function(){Qe.removeInstance("Tooltip",this._instanceId)},i.prototype.destroyAndRemoveInstance=function(){this.destroy(),this.removeInstance()},i.prototype._setupEventListeners=function(){var e=this,t=this._getTriggerEvents();this._showHandler=function(){e.show()},this._hideHandler=function(){e.hide()},t.showEvents.forEach(function(r){e._triggerEl.addEventListener(r,e._showHandler)}),t.hideEvents.forEach(function(r){e._triggerEl.addEventListener(r,e._hideHandler)})},i.prototype._createPopperInstance=function(){return Qh(this._triggerEl,this._targetEl,{placement:this._options.placement,modifiers:[{name:"offset",options:{offset:[0,8]}}]})},i.prototype._getTriggerEvents=function(){switch(this._options.triggerType){case"hover":return{showEvents:["mouseenter","focus"],hideEvents:["mouseleave","blur"]};case"click":return{showEvents:["click","focus"],hideEvents:["focusout","blur"]};case"none":return{showEvents:[],hideEvents:[]};default:return{showEvents:["mouseenter","focus"],hideEvents:["mouseleave","blur"]}}},i.prototype._setupKeydownListener=function(){var e=this;this._keydownEventListener=function(t){t.key==="Escape"&&e.hide()},document.body.addEventListener("keydown",this._keydownEventListener,!0)},i.prototype._removeKeydownListener=function(){document.body.removeEventListener("keydown",this._keydownEventListener,!0)},i.prototype._setupClickOutsideListener=function(){var e=this;this._clickOutsideEventListener=function(t){e._handleClickOutside(t,e._targetEl)},document.body.addEventListener("click",this._clickOutsideEventListener,!0)},i.prototype._removeClickOutsideListener=function(){document.body.removeEventListener("click",this._clickOutsideEventListener,!0)},i.prototype._handleClickOutside=function(e,t){var r=e.target;r!==t&&!t.contains(r)&&!this._triggerEl.contains(r)&&this.isVisible()&&this.hide()},i.prototype.isVisible=function(){return this._visible},i.prototype.toggle=function(){this.isVisible()?this.hide():this.show()},i.prototype.show=function(){this._targetEl.classList.remove("opacity-0","invisible"),this._targetEl.classList.add("opacity-100","visible"),this._popperInstance.setOptions(function(e){return an(an({},e),{modifiers:rl(rl([],e.modifiers,!0),[{name:"eventListeners",enabled:!0}],!1)})}),this._setupClickOutsideListener(),this._setupKeydownListener(),this._popperInstance.update(),this._visible=!0,this._options.onShow(this)},i.prototype.hide=function(){this._targetEl.classList.remove("opacity-100","visible"),this._targetEl.classList.add("opacity-0","invisible"),this._popperInstance.setOptions(function(e){return an(an({},e),{modifiers:rl(rl([],e.modifiers,!0),[{name:"eventListeners",enabled:!1}],!1)})}),this._removeClickOutsideListener(),this._removeKeydownListener(),this._visible=!1,this._options.onHide(this)},i.prototype.updateOnShow=function(e){this._options.onShow=e},i.prototype.updateOnHide=function(e){this._options.onHide=e},i.prototype.updateOnToggle=function(e){this._options.onToggle=e},i}();function sf(){document.querySelectorAll("[data-tooltip-target]").forEach(function(i){var e=i.getAttribute("data-tooltip-target"),t=document.getElementById(e);if(t){var r=i.getAttribute("data-tooltip-trigger"),n=i.getAttribute("data-tooltip-placement");new Sb(t,i,{placement:n||_c.placement,triggerType:r||_c.triggerType})}else console.error('The tooltip element with id "'.concat(e,'" does not exist. Please check the data-tooltip-target attribute.'))})}typeof window<"u"&&(window.Tooltip=Sb,window.initTooltips=sf);var ln=function(){return ln=Object.assign||function(i){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n])}return i},ln.apply(this,arguments)},nl=function(i,e,t){if(t||arguments.length===2)for(var r=0,n=e.length,s;r<n;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return i.concat(s||Array.prototype.slice.call(e))},ea={placement:"top",offset:10,triggerType:"hover",onShow:function(){},onHide:function(){},onToggle:function(){}},yM={id:null,override:!0},Mb=function(){function i(e,t,r,n){e===void 0&&(e=null),t===void 0&&(t=null),r===void 0&&(r=ea),n===void 0&&(n=yM),this._instanceId=n.id?n.id:e.id,this._targetEl=e,this._triggerEl=t,this._options=ln(ln({},ea),r),this._popperInstance=null,this._visible=!1,this._initialized=!1,this.init(),Qe.addInstance("Popover",this,n.id?n.id:this._targetEl.id,n.override)}return i.prototype.init=function(){this._triggerEl&&this._targetEl&&!this._initialized&&(this._setupEventListeners(),this._popperInstance=this._createPopperInstance(),this._initialized=!0)},i.prototype.destroy=function(){var e=this;if(this._initialized){var t=this._getTriggerEvents();t.showEvents.forEach(function(r){e._triggerEl.removeEventListener(r,e._showHandler),e._targetEl.removeEventListener(r,e._showHandler)}),t.hideEvents.forEach(function(r){e._triggerEl.removeEventListener(r,e._hideHandler),e._targetEl.removeEventListener(r,e._hideHandler)}),this._removeKeydownListener(),this._removeClickOutsideListener(),this._popperInstance&&this._popperInstance.destroy(),this._initialized=!1}},i.prototype.removeInstance=function(){Qe.removeInstance("Popover",this._instanceId)},i.prototype.destroyAndRemoveInstance=function(){this.destroy(),this.removeInstance()},i.prototype._setupEventListeners=function(){var e=this,t=this._getTriggerEvents();this._showHandler=function(){e.show()},this._hideHandler=function(){setTimeout(function(){e._targetEl.matches(":hover")||e.hide()},100)},t.showEvents.forEach(function(r){e._triggerEl.addEventListener(r,e._showHandler),e._targetEl.addEventListener(r,e._showHandler)}),t.hideEvents.forEach(function(r){e._triggerEl.addEventListener(r,e._hideHandler),e._targetEl.addEventListener(r,e._hideHandler)})},i.prototype._createPopperInstance=function(){return Qh(this._triggerEl,this._targetEl,{placement:this._options.placement,modifiers:[{name:"offset",options:{offset:[0,this._options.offset]}}]})},i.prototype._getTriggerEvents=function(){switch(this._options.triggerType){case"hover":return{showEvents:["mouseenter","focus"],hideEvents:["mouseleave","blur"]};case"click":return{showEvents:["click","focus"],hideEvents:["focusout","blur"]};case"none":return{showEvents:[],hideEvents:[]};default:return{showEvents:["mouseenter","focus"],hideEvents:["mouseleave","blur"]}}},i.prototype._setupKeydownListener=function(){var e=this;this._keydownEventListener=function(t){t.key==="Escape"&&e.hide()},document.body.addEventListener("keydown",this._keydownEventListener,!0)},i.prototype._removeKeydownListener=function(){document.body.removeEventListener("keydown",this._keydownEventListener,!0)},i.prototype._setupClickOutsideListener=function(){var e=this;this._clickOutsideEventListener=function(t){e._handleClickOutside(t,e._targetEl)},document.body.addEventListener("click",this._clickOutsideEventListener,!0)},i.prototype._removeClickOutsideListener=function(){document.body.removeEventListener("click",this._clickOutsideEventListener,!0)},i.prototype._handleClickOutside=function(e,t){var r=e.target;r!==t&&!t.contains(r)&&!this._triggerEl.contains(r)&&this.isVisible()&&this.hide()},i.prototype.isVisible=function(){return this._visible},i.prototype.toggle=function(){this.isVisible()?this.hide():this.show(),this._options.onToggle(this)},i.prototype.show=function(){this._targetEl.classList.remove("opacity-0","invisible"),this._targetEl.classList.add("opacity-100","visible"),this._popperInstance.setOptions(function(e){return ln(ln({},e),{modifiers:nl(nl([],e.modifiers,!0),[{name:"eventListeners",enabled:!0}],!1)})}),this._setupClickOutsideListener(),this._setupKeydownListener(),this._popperInstance.update(),this._visible=!0,this._options.onShow(this)},i.prototype.hide=function(){this._targetEl.classList.remove("opacity-100","visible"),this._targetEl.classList.add("opacity-0","invisible"),this._popperInstance.setOptions(function(e){return ln(ln({},e),{modifiers:nl(nl([],e.modifiers,!0),[{name:"eventListeners",enabled:!1}],!1)})}),this._removeClickOutsideListener(),this._removeKeydownListener(),this._visible=!1,this._options.onHide(this)},i.prototype.updateOnShow=function(e){this._options.onShow=e},i.prototype.updateOnHide=function(e){this._options.onHide=e},i.prototype.updateOnToggle=function(e){this._options.onToggle=e},i}();function of(){document.querySelectorAll("[data-popover-target]").forEach(function(i){var e=i.getAttribute("data-popover-target"),t=document.getElementById(e);if(t){var r=i.getAttribute("data-popover-trigger"),n=i.getAttribute("data-popover-placement"),s=i.getAttribute("data-popover-offset");new Mb(t,i,{placement:n||ea.placement,offset:s?parseInt(s):ea.offset,triggerType:r||ea.triggerType})}else console.error('The popover element with id "'.concat(e,'" does not exist. Please check the data-popover-target attribute.'))})}typeof window<"u"&&(window.Popover=Mb,window.initPopovers=of);var wc=function(){return wc=Object.assign||function(i){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n])}return i},wc.apply(this,arguments)},qu={triggerType:"hover",onShow:function(){},onHide:function(){},onToggle:function(){}},_M={id:null,override:!0},Eb=function(){function i(e,t,r,n,s){e===void 0&&(e=null),t===void 0&&(t=null),r===void 0&&(r=null),n===void 0&&(n=qu),s===void 0&&(s=_M),this._instanceId=s.id?s.id:r.id,this._parentEl=e,this._triggerEl=t,this._targetEl=r,this._options=wc(wc({},qu),n),this._visible=!1,this._initialized=!1,this.init(),Qe.addInstance("Dial",this,this._instanceId,s.override)}return i.prototype.init=function(){var e=this;if(this._triggerEl&&this._targetEl&&!this._initialized){var t=this._getTriggerEventTypes(this._options.triggerType);this._showEventHandler=function(){e.show()},t.showEvents.forEach(function(r){e._triggerEl.addEventListener(r,e._showEventHandler),e._targetEl.addEventListener(r,e._showEventHandler)}),this._hideEventHandler=function(){e._parentEl.matches(":hover")||e.hide()},t.hideEvents.forEach(function(r){e._parentEl.addEventListener(r,e._hideEventHandler)}),this._initialized=!0}},i.prototype.destroy=function(){var e=this;if(this._initialized){var t=this._getTriggerEventTypes(this._options.triggerType);t.showEvents.forEach(function(r){e._triggerEl.removeEventListener(r,e._showEventHandler),e._targetEl.removeEventListener(r,e._showEventHandler)}),t.hideEvents.forEach(function(r){e._parentEl.removeEventListener(r,e._hideEventHandler)}),this._initialized=!1}},i.prototype.removeInstance=function(){Qe.removeInstance("Dial",this._instanceId)},i.prototype.destroyAndRemoveInstance=function(){this.destroy(),this.removeInstance()},i.prototype.hide=function(){this._targetEl.classList.add("hidden"),this._triggerEl&&this._triggerEl.setAttribute("aria-expanded","false"),this._visible=!1,this._options.onHide(this)},i.prototype.show=function(){this._targetEl.classList.remove("hidden"),this._triggerEl&&this._triggerEl.setAttribute("aria-expanded","true"),this._visible=!0,this._options.onShow(this)},i.prototype.toggle=function(){this._visible?this.hide():this.show()},i.prototype.isHidden=function(){return!this._visible},i.prototype.isVisible=function(){return this._visible},i.prototype._getTriggerEventTypes=function(e){switch(e){case"hover":return{showEvents:["mouseenter","focus"],hideEvents:["mouseleave","blur"]};case"click":return{showEvents:["click","focus"],hideEvents:["focusout","blur"]};case"none":return{showEvents:[],hideEvents:[]};default:return{showEvents:["mouseenter","focus"],hideEvents:["mouseleave","blur"]}}},i.prototype.updateOnShow=function(e){this._options.onShow=e},i.prototype.updateOnHide=function(e){this._options.onHide=e},i.prototype.updateOnToggle=function(e){this._options.onToggle=e},i}();function af(){document.querySelectorAll("[data-dial-init]").forEach(function(i){var e=i.querySelector("[data-dial-toggle]");if(e){var t=e.getAttribute("data-dial-toggle"),r=document.getElementById(t);if(r){var n=e.getAttribute("data-dial-trigger");new Eb(i,e,r,{triggerType:n||qu.triggerType})}else console.error("Dial with id ".concat(t," does not exist. Are you sure that the data-dial-toggle attribute points to the correct modal id?"))}else console.error("Dial with id ".concat(i.id," does not have a trigger element. Are you sure that the data-dial-toggle attribute exists?"))})}typeof window<"u"&&(window.Dial=Eb,window.initDials=af);var xc=function(){return xc=Object.assign||function(i){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n])}return i},xc.apply(this,arguments)},um={minValue:null,maxValue:null,onIncrement:function(){},onDecrement:function(){}},wM={id:null,override:!0},kb=function(){function i(e,t,r,n,s){e===void 0&&(e=null),t===void 0&&(t=null),r===void 0&&(r=null),n===void 0&&(n=um),s===void 0&&(s=wM),this._instanceId=s.id?s.id:e.id,this._targetEl=e,this._incrementEl=t,this._decrementEl=r,this._options=xc(xc({},um),n),this._initialized=!1,this.init(),Qe.addInstance("InputCounter",this,this._instanceId,s.override)}return i.prototype.init=function(){var e=this;this._targetEl&&!this._initialized&&(this._inputHandler=function(t){{var r=t.target;/^\d*$/.test(r.value)||(r.value=r.value.replace(/[^\d]/g,"")),e._options.maxValue!==null&&parseInt(r.value)>e._options.maxValue&&(r.value=e._options.maxValue.toString()),e._options.minValue!==null&&parseInt(r.value)<e._options.minValue&&(r.value=e._options.minValue.toString())}},this._incrementClickHandler=function(){e.increment()},this._decrementClickHandler=function(){e.decrement()},this._targetEl.addEventListener("input",this._inputHandler),this._incrementEl&&this._incrementEl.addEventListener("click",this._incrementClickHandler),this._decrementEl&&this._decrementEl.addEventListener("click",this._decrementClickHandler),this._initialized=!0)},i.prototype.destroy=function(){this._targetEl&&this._initialized&&(this._targetEl.removeEventListener("input",this._inputHandler),this._incrementEl&&this._incrementEl.removeEventListener("click",this._incrementClickHandler),this._decrementEl&&this._decrementEl.removeEventListener("click",this._decrementClickHandler),this._initialized=!1)},i.prototype.removeInstance=function(){Qe.removeInstance("InputCounter",this._instanceId)},i.prototype.destroyAndRemoveInstance=function(){this.destroy(),this.removeInstance()},i.prototype.getCurrentValue=function(){return parseInt(this._targetEl.value)||0},i.prototype.increment=function(){this._options.maxValue!==null&&this.getCurrentValue()>=this._options.maxValue||(this._targetEl.value=(this.getCurrentValue()+1).toString(),this._options.onIncrement(this))},i.prototype.decrement=function(){this._options.minValue!==null&&this.getCurrentValue()<=this._options.minValue||(this._targetEl.value=(this.getCurrentValue()-1).toString(),this._options.onDecrement(this))},i.prototype.updateOnIncrement=function(e){this._options.onIncrement=e},i.prototype.updateOnDecrement=function(e){this._options.onDecrement=e},i}();function lf(){document.querySelectorAll("[data-input-counter]").forEach(function(i){var e=i.id,t=document.querySelector('[data-input-counter-increment="'+e+'"]'),r=document.querySelector('[data-input-counter-decrement="'+e+'"]'),n=i.getAttribute("data-input-counter-min"),s=i.getAttribute("data-input-counter-max");i?Qe.instanceExists("InputCounter",i.getAttribute("id"))||new kb(i,t||null,r||null,{minValue:n?parseInt(n):null,maxValue:s?parseInt(s):null}):console.error('The target element with id "'.concat(e,'" does not exist. Please check the data-input-counter attribute.'))})}typeof window<"u"&&(window.InputCounter=kb,window.initInputCounters=lf);var Sc=function(){return Sc=Object.assign||function(i){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n])}return i},Sc.apply(this,arguments)},Mc={htmlEntities:!1,contentType:"input",onCopy:function(){}},xM={id:null,override:!0},Cb=function(){function i(e,t,r,n){e===void 0&&(e=null),t===void 0&&(t=null),r===void 0&&(r=Mc),n===void 0&&(n=xM),this._instanceId=n.id?n.id:t.id,this._triggerEl=e,this._targetEl=t,this._options=Sc(Sc({},Mc),r),this._initialized=!1,this.init(),Qe.addInstance("CopyClipboard",this,this._instanceId,n.override)}return i.prototype.init=function(){var e=this;this._targetEl&&this._triggerEl&&!this._initialized&&(this._triggerElClickHandler=function(){e.copy()},this._triggerEl&&this._triggerEl.addEventListener("click",this._triggerElClickHandler),this._initialized=!0)},i.prototype.destroy=function(){this._triggerEl&&this._targetEl&&this._initialized&&(this._triggerEl&&this._triggerEl.removeEventListener("click",this._triggerElClickHandler),this._initialized=!1)},i.prototype.removeInstance=function(){Qe.removeInstance("CopyClipboard",this._instanceId)},i.prototype.destroyAndRemoveInstance=function(){this.destroy(),this.removeInstance()},i.prototype.getTargetValue=function(){if(this._options.contentType==="input")return this._targetEl.value;if(this._options.contentType==="innerHTML")return this._targetEl.innerHTML;if(this._options.contentType==="textContent")return this._targetEl.textContent.replace(/\s+/g," ").trim()},i.prototype.copy=function(){var e=this.getTargetValue();this._options.htmlEntities&&(e=this.decodeHTML(e));var t=document.createElement("textarea");return t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),this._options.onCopy(this),e},i.prototype.decodeHTML=function(e){var t=document.createElement("textarea");return t.innerHTML=e,t.textContent},i.prototype.updateOnCopyCallback=function(e){this._options.onCopy=e},i}();function cf(){document.querySelectorAll("[data-copy-to-clipboard-target]").forEach(function(i){var e=i.getAttribute("data-copy-to-clipboard-target"),t=document.getElementById(e),r=i.getAttribute("data-copy-to-clipboard-content-type"),n=i.getAttribute("data-copy-to-clipboard-html-entities");t?Qe.instanceExists("CopyClipboard",t.getAttribute("id"))||new Cb(i,t,{htmlEntities:n&&n==="true"?!0:Mc.htmlEntities,contentType:r||Mc.contentType}):console.error('The target element with id "'.concat(e,'" does not exist. Please check the data-copy-to-clipboard-target attribute.'))})}typeof window<"u"&&(window.CopyClipboard=Cb,window.initClipboards=cf);function Yu(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,r=Array(e);t<e;t++)r[t]=i[t];return r}function SM(i){if(Array.isArray(i))return i}function MM(i){if(Array.isArray(i))return Yu(i)}function EM(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function df(i,e,t){return e=xn(e),LM(i,Tb()?Reflect.construct(e,t||[],xn(i).constructor):e.apply(i,t))}function fs(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function hm(i,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(i,RM(r.key),r)}}function ps(i,e,t){return e&&hm(i.prototype,e),t&&hm(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}function wa(){return wa=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(i,e,t){var r=DM(i,e);if(r){var n=Object.getOwnPropertyDescriptor(r,e);return n.get?n.get.call(arguments.length<3?i:t):n.value}},wa.apply(null,arguments)}function xn(i){return xn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},xn(i)}function uf(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&Xu(i,e)}function Tb(){try{var i=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Tb=function(){return!!i})()}function kM(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function CM(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var r,n,s,o,a=[],l=!0,c=!1;try{if(s=(t=t.call(i)).next,e===0){if(Object(t)!==t)return;l=!1}else for(;!(l=(r=s.call(t)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(d){c=!0,n=d}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(c)throw n}}return a}}function TM(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AM(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LM(i,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return EM(i)}function Xu(i,e){return Xu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},Xu(i,e)}function pi(i,e){return SM(i)||CM(i,e)||Ab(i,e)||TM()}function DM(i,e){for(;!{}.hasOwnProperty.call(i,e)&&(i=xn(i))!==null;);return i}function Fa(i){return MM(i)||kM(i)||Ab(i)||AM()}function PM(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(i)}function RM(i){var e=PM(i,"string");return typeof e=="symbol"?e:e+""}function Ec(i){"@babel/helpers - typeof";return Ec=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ec(i)}function Ab(i,e){if(i){if(typeof i=="string")return Yu(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Yu(i,e):void 0}}function Dr(i,e){return Object.prototype.hasOwnProperty.call(i,e)}function hf(i){return i[i.length-1]}function as(i){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return t.forEach(function(n){i.includes(n)||i.push(n)}),i}function Rd(i,e){return i?i.split(e):[]}function ff(i,e,t){var r=e===void 0||i>=e,n=t===void 0||i<=t;return r&&n}function Lb(i,e,t){return i<e?e:i>t?t:i}function so(i,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"",s=Object.keys(t).reduce(function(a,l){var c=t[l];return typeof c=="function"&&(c=c(r)),"".concat(a," ").concat(l,'="').concat(c,'"')},i);n+="<".concat(s,"></").concat(i,">");var o=r+1;return o<e?so(i,e,t,o,n):n}function pf(i){return i.replace(/>\s+/g,">").replace(/\s+</,"<")}function Ku(i){return new Date(i).setHours(0,0,0,0)}function ms(){return new Date().setHours(0,0,0,0)}function mn(){switch(arguments.length){case 0:return ms();case 1:return Ku(arguments.length<=0?void 0:arguments[0])}var i=new Date(0);return i.setFullYear.apply(i,arguments),i.setHours(0,0,0,0)}function Gs(i,e){var t=new Date(i);return t.setDate(t.getDate()+e)}function IM(i,e){return Gs(i,e*7)}function kc(i,e){var t=new Date(i),r=t.getMonth()+e,n=r%12;n<0&&(n+=12);var s=t.setMonth(r);return t.getMonth()!==n?t.setDate(0):s}function qs(i,e){var t=new Date(i),r=t.getMonth(),n=t.setFullYear(t.getFullYear()+e);return r===1&&t.getMonth()===2?t.setDate(0):n}function fm(i,e){return(i-e+7)%7}function Cc(i,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=new Date(i).getDay();return Gs(i,fm(e,t)-fm(r,t))}function OM(i){var e=Cc(i,4,1),t=Cc(new Date(e).setMonth(0,4),4,1);return Math.round((e-t)/6048e5)+1}function Nn(i,e){var t=new Date(i).getFullYear();return Math.floor(t/e)*e}var Ju=/dd?|DD?|mm?|MM?|yy?(?:yy)?/,FM=/[\s!-/:-@[-`{-~年月日]+/,Id={},pm={y:function(e,t){return new Date(e).setFullYear(parseInt(t,10))},m:function(e,t,r){var n=new Date(e),s=parseInt(t,10)-1;if(isNaN(s)){if(!t)return NaN;var o=t.toLowerCase(),a=function(c){return c.toLowerCase().startsWith(o)};if(s=r.monthsShort.findIndex(a),s<0&&(s=r.months.findIndex(a)),s<0)return NaN}return n.setMonth(s),n.getMonth()!==Db(s)?n.setDate(0):n.getTime()},d:function(e,t){return new Date(e).setDate(parseInt(t,10))}},zM={d:function(e){return e.getDate()},dd:function(e){return sl(e.getDate(),2)},D:function(e,t){return t.daysShort[e.getDay()]},DD:function(e,t){return t.days[e.getDay()]},m:function(e){return e.getMonth()+1},mm:function(e){return sl(e.getMonth()+1,2)},M:function(e,t){return t.monthsShort[e.getMonth()]},MM:function(e,t){return t.months[e.getMonth()]},y:function(e){return e.getFullYear()},yy:function(e){return sl(e.getFullYear(),2).slice(-2)},yyyy:function(e){return sl(e.getFullYear(),4)}};function Db(i){return i>-1?i%12:Db(i+12)}function sl(i,e){return i.toString().padStart(e,"0")}function Pb(i){if(typeof i!="string")throw new Error("Invalid date format.");if(i in Id)return Id[i];var e=i.split(Ju),t=i.match(new RegExp(Ju,"g"));if(e.length===0||!t)throw new Error("Invalid date format.");var r=t.map(function(s){return zM[s]}),n=Object.keys(pm).reduce(function(s,o){var a=t.find(function(l){return l[0]!=="D"&&l[0].toLowerCase()===o});return a&&s.push(o),s},[]);return Id[i]={parser:function(o,a){var l=o.split(FM).reduce(function(c,d,u){if(d.length>0&&t[u]){var h=t[u][0];h==="M"?c.m=d:h!=="D"&&(c[h]=d)}return c},{});return n.reduce(function(c,d){var u=pm[d](c,l[d],a);return isNaN(u)?c:u},ms())},formatter:function(o,a){var l=r.reduce(function(c,d,u){return c+="".concat(e[u]).concat(d(o,a))},"");return l+=hf(e)}}}function xa(i,e,t){if(i instanceof Date||typeof i=="number"){var r=Ku(i);return isNaN(r)?void 0:r}if(i){if(i==="today")return ms();if(e&&e.toValue){var n=e.toValue(i,e,t);return isNaN(n)?void 0:Ku(n)}return Pb(e).parser(i,t)}}function Sa(i,e,t){if(isNaN(i)||!i&&i!==0)return"";var r=typeof i=="number"?new Date(i):i;return e.toDisplay?e.toDisplay(r,e,t):Pb(e).formatter(r,t)}var Tc=new WeakMap,Rb=EventTarget.prototype,mm=Rb.addEventListener,gm=Rb.removeEventListener;function mf(i,e){var t=Tc.get(i);t||(t=[],Tc.set(i,t)),e.forEach(function(r){mm.call.apply(mm,Fa(r)),t.push(r)})}function Ib(i){var e=Tc.get(i);e&&(e.forEach(function(t){gm.call.apply(gm,Fa(t))}),Tc.delete(i))}if(!Event.prototype.composedPath){var NM=function i(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];t.push(e);var r;return e.parentNode?r=e.parentNode:e.host?r=e.host:e.defaultView&&(r=e.defaultView),r?i(r,t):t};Event.prototype.composedPath=function(){return NM(this.target)}}function Ob(i,e,t){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,n=i[r];return e(n)?n:n===t||!n.parentElement?void 0:Ob(i,e,t,r+1)}function Fb(i,e){var t=typeof e=="function"?e:function(r){return r.matches(e)};return Ob(i.composedPath(),t,i.currentTarget)}var Mo={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear",titleFormat:"MM y"}},za={autohide:!1,beforeShowDay:null,beforeShowDecade:null,beforeShowMonth:null,beforeShowYear:null,calendarWeeks:!1,clearBtn:!1,dateDelimiter:",",datesDisabled:[],daysOfWeekDisabled:[],daysOfWeekHighlighted:[],defaultViewDate:void 0,disableTouchKeyboard:!1,format:"mm/dd/yyyy",language:"en",maxDate:null,maxNumberOfDates:1,maxView:3,minDate:null,nextArrow:'<svg class="w-4 h-4 rtl:rotate-180 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 10"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 5h12m0 0L9 1m4 4L9 9"/></svg>',orientation:"auto",pickLevel:0,prevArrow:'<svg class="w-4 h-4 rtl:rotate-180 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 10"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5H1m0 0 4 4M1 5l4-4"/></svg>',showDaysOfWeek:!0,showOnClick:!0,showOnFocus:!0,startView:0,title:"",todayBtn:!1,todayBtnMode:0,todayHighlight:!1,updateOnBlur:!0,weekStart:0},$M=document.createRange();function Pr(i){return $M.createContextualFragment(i)}function ta(i){i.style.display!=="none"&&(i.style.display&&(i.dataset.styleDisplay=i.style.display),i.style.display="none")}function ia(i){i.style.display==="none"&&(i.dataset.styleDisplay?(i.style.display=i.dataset.styleDisplay,delete i.dataset.styleDisplay):i.style.display="")}function Ac(i){i.firstChild&&(i.removeChild(i.firstChild),Ac(i))}function BM(i,e){Ac(i),e instanceof DocumentFragment?i.appendChild(e):typeof e=="string"?i.appendChild(Pr(e)):typeof e.forEach=="function"&&e.forEach(function(t){i.appendChild(t)})}var Od=za.language,VM=za.format,HM=za.weekStart;function vm(i,e){return i.length<6&&e>=0&&e<7?as(i,e):i}function bm(i){return(i+6)%7}function ym(i,e,t,r){var n=xa(i,e,t);return n!==void 0?n:r}function Fd(i,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,r=parseInt(i,10);return r>=0&&r<=t?r:e}function zd(i,e){var t=Object.assign({},i),r={},n=e.constructor.locales,s=e.config||{},o=s.format,a=s.language,l=s.locale,c=s.maxDate,d=s.maxView,u=s.minDate,h=s.pickLevel,p=s.startView,g=s.weekStart;if(t.language){var f;if(t.language!==a&&(n[t.language]?f=t.language:(f=t.language.split("-")[0],n[f]===void 0&&(f=!1))),delete t.language,f){a=r.language=f;var m=l||n[Od];l=Object.assign({format:VM,weekStart:HM},n[Od]),a!==Od&&Object.assign(l,n[a]),r.locale=l,o===m.format&&(o=r.format=l.format),g===m.weekStart&&(g=r.weekStart=l.weekStart,r.weekEnd=bm(l.weekStart))}}if(t.format){var b=typeof t.format.toDisplay=="function",y=typeof t.format.toValue=="function",w=Ju.test(t.format);(b&&y||w)&&(o=r.format=t.format),delete t.format}var _=u,M=c;if(t.minDate!==void 0&&(_=t.minDate===null?mn(0,0,1):ym(t.minDate,o,l,_),delete t.minDate),t.maxDate!==void 0&&(M=t.maxDate===null?void 0:ym(t.maxDate,o,l,M),delete t.maxDate),M<_?(u=r.minDate=M,c=r.maxDate=_):(u!==_&&(u=r.minDate=_),c!==M&&(c=r.maxDate=M)),t.datesDisabled&&(r.datesDisabled=t.datesDisabled.reduce(function(V,N){var j=xa(N,o,l);return j!==void 0?as(V,j):V},[]),delete t.datesDisabled),t.defaultViewDate!==void 0){var S=xa(t.defaultViewDate,o,l);S!==void 0&&(r.defaultViewDate=S),delete t.defaultViewDate}if(t.weekStart!==void 0){var A=Number(t.weekStart)%7;isNaN(A)||(g=r.weekStart=A,r.weekEnd=bm(A)),delete t.weekStart}if(t.daysOfWeekDisabled&&(r.daysOfWeekDisabled=t.daysOfWeekDisabled.reduce(vm,[]),delete t.daysOfWeekDisabled),t.daysOfWeekHighlighted&&(r.daysOfWeekHighlighted=t.daysOfWeekHighlighted.reduce(vm,[]),delete t.daysOfWeekHighlighted),t.maxNumberOfDates!==void 0){var x=parseInt(t.maxNumberOfDates,10);x>=0&&(r.maxNumberOfDates=x,r.multidate=x!==1),delete t.maxNumberOfDates}t.dateDelimiter&&(r.dateDelimiter=String(t.dateDelimiter),delete t.dateDelimiter);var E=h;t.pickLevel!==void 0&&(E=Fd(t.pickLevel,2),delete t.pickLevel),E!==h&&(h=r.pickLevel=E);var D=d;t.maxView!==void 0&&(D=Fd(t.maxView,d),delete t.maxView),D=h>D?h:D,D!==d&&(d=r.maxView=D);var F=p;if(t.startView!==void 0&&(F=Fd(t.startView,F),delete t.startView),F<h?F=h:F>d&&(F=d),F!==p&&(r.startView=F),t.prevArrow){var R=Pr(t.prevArrow);R.childNodes.length>0&&(r.prevArrow=R.childNodes),delete t.prevArrow}if(t.nextArrow){var B=Pr(t.nextArrow);B.childNodes.length>0&&(r.nextArrow=B.childNodes),delete t.nextArrow}if(t.disableTouchKeyboard!==void 0&&(r.disableTouchKeyboard="ontouchstart"in document&&!!t.disableTouchKeyboard,delete t.disableTouchKeyboard),t.orientation){var I=t.orientation.toLowerCase().split(/\s+/g);r.orientation={x:I.find(function(V){return V==="left"||V==="right"})||"auto",y:I.find(function(V){return V==="top"||V==="bottom"})||"auto"},delete t.orientation}if(t.todayBtnMode!==void 0){switch(t.todayBtnMode){case 0:case 1:r.todayBtnMode=t.todayBtnMode}delete t.todayBtnMode}return Object.keys(t).forEach(function(V){t[V]!==void 0&&Dr(za,V)&&(r[V]=t[V])}),r}var UM=pf(`<div class="datepicker hidden">
  <div class="datepicker-picker inline-block rounded-lg bg-white dark:bg-gray-700 shadow-lg p-4">
    <div class="datepicker-header">
      <div class="datepicker-title bg-white dark:bg-gray-700 dark:text-white px-2 py-3 text-center font-semibold"></div>
      <div class="datepicker-controls flex justify-between mb-2">
        <button type="button" class="bg-white dark:bg-gray-700 rounded-lg text-gray-500 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-600 hover:text-gray-900 dark:hover:text-white text-lg p-2.5 focus:outline-none focus:ring-2 focus:ring-gray-200 prev-btn"></button>
        <button type="button" class="text-sm rounded-lg text-gray-900 dark:text-white bg-white dark:bg-gray-700 font-semibold py-2.5 px-5 hover:bg-gray-100 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-200 view-switch"></button>
        <button type="button" class="bg-white dark:bg-gray-700 rounded-lg text-gray-500 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-600 hover:text-gray-900 dark:hover:text-white text-lg p-2.5 focus:outline-none focus:ring-2 focus:ring-gray-200 next-btn"></button>
      </div>
    </div>
    <div class="datepicker-main p-1"></div>
    <div class="datepicker-footer">
      <div class="datepicker-controls flex space-x-2 rtl:space-x-reverse mt-2">
        <button type="button" class="%buttonClass% today-btn text-white bg-blue-700 !bg-primary-700 dark:bg-blue-600 dark:!bg-primary-600 hover:bg-blue-800 hover:!bg-primary-800 dark:hover:bg-blue-700 dark:hover:!bg-primary-700 focus:ring-4 focus:ring-blue-300 focus:!ring-primary-300 font-medium rounded-lg text-sm px-5 py-2 text-center w-1/2"></button>
        <button type="button" class="%buttonClass% clear-btn text-gray-900 dark:text-white bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-600 focus:ring-4 focus:ring-blue-300 focus:!ring-primary-300 font-medium rounded-lg text-sm px-5 py-2 text-center w-1/2"></button>
      </div>
    </div>
  </div>
</div>`),jM=pf(`<div class="days">
  <div class="days-of-week grid grid-cols-7 mb-1">`.concat(so("span",7,{class:"dow block flex-1 leading-9 border-0 rounded-lg cursor-default text-center text-gray-900 font-semibold text-sm"}),`</div>
  <div class="datepicker-grid w-64 grid grid-cols-7">`).concat(so("span",42,{class:"block flex-1 leading-9 border-0 rounded-lg cursor-default text-center text-gray-900 font-semibold text-sm h-6 leading-6 text-sm font-medium text-gray-500 dark:text-gray-400"}),`</div>
</div>`)),WM=pf(`<div class="calendar-weeks">
  <div class="days-of-week flex"><span class="dow h-6 leading-6 text-sm font-medium text-gray-500 dark:text-gray-400"></span></div>
  <div class="weeks">`.concat(so("span",6,{class:"week block flex-1 leading-9 border-0 rounded-lg cursor-default text-center text-gray-900 font-semibold text-sm"}),`</div>
</div>`)),gf=function(){function i(e,t){fs(this,i),Object.assign(this,t,{picker:e,element:Pr('<div class="datepicker-view flex"></div>').firstChild,selected:[]}),this.init(this.picker.datepicker.config)}return ps(i,[{key:"init",value:function(t){t.pickLevel!==void 0&&(this.isMinView=this.id===t.pickLevel),this.setOptions(t),this.updateFocus(),this.updateSelection()}},{key:"performBeforeHook",value:function(t,r,n){var s=this.beforeShow(new Date(n));switch(Ec(s)){case"boolean":s={enabled:s};break;case"string":s={classes:s}}if(s){if(s.enabled===!1&&(t.classList.add("disabled"),as(this.disabled,r)),s.classes){var o,a=s.classes.split(/\s+/);(o=t.classList).add.apply(o,Fa(a)),a.includes("disabled")&&as(this.disabled,r)}s.content&&BM(t,s.content)}}}])}(),GM=function(i){function e(t){return fs(this,e),df(this,e,[t,{id:0,name:"days",cellClass:"day"}])}return uf(e,i),ps(e,[{key:"init",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(n){var s=Pr(jM).firstChild;this.dow=s.firstChild,this.grid=s.lastChild,this.element.appendChild(s)}wa(xn(e.prototype),"init",this).call(this,r)}},{key:"setOptions",value:function(r){var n=this,s;if(Dr(r,"minDate")&&(this.minDate=r.minDate),Dr(r,"maxDate")&&(this.maxDate=r.maxDate),r.datesDisabled&&(this.datesDisabled=r.datesDisabled),r.daysOfWeekDisabled&&(this.daysOfWeekDisabled=r.daysOfWeekDisabled,s=!0),r.daysOfWeekHighlighted&&(this.daysOfWeekHighlighted=r.daysOfWeekHighlighted),r.todayHighlight!==void 0&&(this.todayHighlight=r.todayHighlight),r.weekStart!==void 0&&(this.weekStart=r.weekStart,this.weekEnd=r.weekEnd,s=!0),r.locale){var o=this.locale=r.locale;this.dayNames=o.daysMin,this.switchLabelFormat=o.titleFormat,s=!0}if(r.beforeShowDay!==void 0&&(this.beforeShow=typeof r.beforeShowDay=="function"?r.beforeShowDay:void 0),r.calendarWeeks!==void 0)if(r.calendarWeeks&&!this.calendarWeeks){var a=Pr(WM).firstChild;this.calendarWeeks={element:a,dow:a.firstChild,weeks:a.lastChild},this.element.insertBefore(a,this.element.firstChild)}else this.calendarWeeks&&!r.calendarWeeks&&(this.element.removeChild(this.calendarWeeks.element),this.calendarWeeks=null);r.showDaysOfWeek!==void 0&&(r.showDaysOfWeek?(ia(this.dow),this.calendarWeeks&&ia(this.calendarWeeks.dow)):(ta(this.dow),this.calendarWeeks&&ta(this.calendarWeeks.dow))),s&&Array.from(this.dow.children).forEach(function(l,c){var d=(n.weekStart+c)%7;l.textContent=n.dayNames[d],l.className=n.daysOfWeekDisabled.includes(d)?"dow disabled text-center h-6 leading-6 text-sm font-medium text-gray-500 dark:text-gray-400 cursor-not-allowed":"dow text-center h-6 leading-6 text-sm font-medium text-gray-500 dark:text-gray-400"})}},{key:"updateFocus",value:function(){var r=new Date(this.picker.viewDate),n=r.getFullYear(),s=r.getMonth(),o=mn(n,s,1),a=Cc(o,this.weekStart,this.weekStart);this.first=o,this.last=mn(n,s+1,0),this.start=a,this.focused=this.picker.viewDate}},{key:"updateSelection",value:function(){var r=this.picker.datepicker,n=r.dates,s=r.rangepicker;this.selected=n,s&&(this.range=s.dates)}},{key:"render",value:function(){var r=this;this.today=this.todayHighlight?ms():void 0,this.disabled=Fa(this.datesDisabled);var n=Sa(this.focused,this.switchLabelFormat,this.locale);if(this.picker.setViewSwitchLabel(n),this.picker.setPrevBtnDisabled(this.first<=this.minDate),this.picker.setNextBtnDisabled(this.last>=this.maxDate),this.calendarWeeks){var s=Cc(this.first,1,1);Array.from(this.calendarWeeks.weeks.children).forEach(function(o,a){o.textContent=OM(IM(s,a))})}Array.from(this.grid.children).forEach(function(o,a){var l=o.classList,c=Gs(r.start,a),d=new Date(c),u=d.getDay();if(o.className="datepicker-cell hover:bg-gray-100 dark:hover:bg-gray-600 block flex-1 leading-9 border-0 rounded-lg cursor-pointer text-center text-gray-900 dark:text-white font-semibold text-sm ".concat(r.cellClass),o.dataset.date=c,o.textContent=d.getDate(),c<r.first?l.add("prev","text-gray-500","dark:text-white"):c>r.last&&l.add("next","text-gray-500","dark:text-white"),r.today===c&&l.add("today","bg-gray-100","dark:bg-gray-600"),(c<r.minDate||c>r.maxDate||r.disabled.includes(c))&&(l.add("disabled","cursor-not-allowed","text-gray-400","dark:text-gray-500"),l.remove("hover:bg-gray-100","dark:hover:bg-gray-600","text-gray-900","dark:text-white","cursor-pointer")),r.daysOfWeekDisabled.includes(u)&&(l.add("disabled","cursor-not-allowed","text-gray-400","dark:text-gray-500"),l.remove("hover:bg-gray-100","dark:hover:bg-gray-600","text-gray-900","dark:text-white","cursor-pointer"),as(r.disabled,c)),r.daysOfWeekHighlighted.includes(u)&&l.add("highlighted"),r.range){var h=pi(r.range,2),p=h[0],g=h[1];c>p&&c<g&&(l.add("range","bg-gray-200","dark:bg-gray-600"),l.remove("rounded-lg","rounded-l-lg","rounded-r-lg")),c===p&&(l.add("range-start","bg-gray-100","dark:bg-gray-600","rounded-l-lg"),l.remove("rounded-lg","rounded-r-lg")),c===g&&(l.add("range-end","bg-gray-100","dark:bg-gray-600","rounded-r-lg"),l.remove("rounded-lg","rounded-l-lg"))}r.selected.includes(c)&&(l.add("selected","bg-blue-700","!bg-primary-700","text-white","dark:bg-blue-600","dark:!bg-primary-600","dark:text-white"),l.remove("text-gray-900","text-gray-500","hover:bg-gray-100","dark:text-white","dark:hover:bg-gray-600","dark:bg-gray-600","bg-gray-100","bg-gray-200")),c===r.focused&&l.add("focused"),r.beforeShow&&r.performBeforeHook(o,c,c)})}},{key:"refresh",value:function(){var r=this,n=this.range||[],s=pi(n,2),o=s[0],a=s[1];this.grid.querySelectorAll(".range, .range-start, .range-end, .selected, .focused").forEach(function(l){l.classList.remove("range","range-start","range-end","selected","bg-blue-700","!bg-primary-700","text-white","dark:bg-blue-600","dark:!bg-primary-600","dark:text-white","focused"),l.classList.add("text-gray-900","rounded-lg","dark:text-white")}),Array.from(this.grid.children).forEach(function(l){var c=Number(l.dataset.date),d=l.classList;d.remove("bg-gray-200","dark:bg-gray-600","rounded-l-lg","rounded-r-lg"),c>o&&c<a&&(d.add("range","bg-gray-200","dark:bg-gray-600"),d.remove("rounded-lg")),c===o&&(d.add("range-start","bg-gray-200","dark:bg-gray-600","rounded-l-lg"),d.remove("rounded-lg")),c===a&&(d.add("range-end","bg-gray-200","dark:bg-gray-600","rounded-r-lg"),d.remove("rounded-lg")),r.selected.includes(c)&&(d.add("selected","bg-blue-700","!bg-primary-700","text-white","dark:bg-blue-600","dark:!bg-primary-600","dark:text-white"),d.remove("text-gray-900","hover:bg-gray-100","dark:text-white","dark:hover:bg-gray-600","bg-gray-100","bg-gray-200","dark:bg-gray-600")),c===r.focused&&d.add("focused")})}},{key:"refreshFocus",value:function(){var r=Math.round((this.focused-this.start)/864e5);this.grid.querySelectorAll(".focused").forEach(function(n){n.classList.remove("focused")}),this.grid.children[r].classList.add("focused")}}])}(gf);function _m(i,e){if(!(!i||!i[0]||!i[1])){var t=pi(i,2),r=pi(t[0],2),n=r[0],s=r[1],o=pi(t[1],2),a=o[0],l=o[1];if(!(n>e||a<e))return[n===e?s:-1,a===e?l:12]}}var qM=function(i){function e(t){return fs(this,e),df(this,e,[t,{id:1,name:"months",cellClass:"month"}])}return uf(e,i),ps(e,[{key:"init",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;n&&(this.grid=this.element,this.element.classList.add("months","datepicker-grid","w-64","grid","grid-cols-4"),this.grid.appendChild(Pr(so("span",12,{"data-month":function(o){return o}})))),wa(xn(e.prototype),"init",this).call(this,r)}},{key:"setOptions",value:function(r){if(r.locale&&(this.monthNames=r.locale.monthsShort),Dr(r,"minDate"))if(r.minDate===void 0)this.minYear=this.minMonth=this.minDate=void 0;else{var n=new Date(r.minDate);this.minYear=n.getFullYear(),this.minMonth=n.getMonth(),this.minDate=n.setDate(1)}if(Dr(r,"maxDate"))if(r.maxDate===void 0)this.maxYear=this.maxMonth=this.maxDate=void 0;else{var s=new Date(r.maxDate);this.maxYear=s.getFullYear(),this.maxMonth=s.getMonth(),this.maxDate=mn(this.maxYear,this.maxMonth+1,0)}r.beforeShowMonth!==void 0&&(this.beforeShow=typeof r.beforeShowMonth=="function"?r.beforeShowMonth:void 0)}},{key:"updateFocus",value:function(){var r=new Date(this.picker.viewDate);this.year=r.getFullYear(),this.focused=r.getMonth()}},{key:"updateSelection",value:function(){var r=this.picker.datepicker,n=r.dates,s=r.rangepicker;this.selected=n.reduce(function(o,a){var l=new Date(a),c=l.getFullYear(),d=l.getMonth();return o[c]===void 0?o[c]=[d]:as(o[c],d),o},{}),s&&s.dates&&(this.range=s.dates.map(function(o){var a=new Date(o);return isNaN(a)?void 0:[a.getFullYear(),a.getMonth()]}))}},{key:"render",value:function(){var r=this;this.disabled=[],this.picker.setViewSwitchLabel(this.year),this.picker.setPrevBtnDisabled(this.year<=this.minYear),this.picker.setNextBtnDisabled(this.year>=this.maxYear);var n=this.selected[this.year]||[],s=this.year<this.minYear||this.year>this.maxYear,o=this.year===this.minYear,a=this.year===this.maxYear,l=_m(this.range,this.year);Array.from(this.grid.children).forEach(function(c,d){var u=c.classList,h=mn(r.year,d,1);if(c.className="datepicker-cell hover:bg-gray-100 dark:hover:bg-gray-600 block flex-1 leading-9 border-0 rounded-lg cursor-pointer text-center text-gray-900 dark:text-white font-semibold text-sm ".concat(r.cellClass),r.isMinView&&(c.dataset.date=h),c.textContent=r.monthNames[d],(s||o&&d<r.minMonth||a&&d>r.maxMonth)&&u.add("disabled"),l){var p=pi(l,2),g=p[0],f=p[1];d>g&&d<f&&u.add("range"),d===g&&u.add("range-start"),d===f&&u.add("range-end")}n.includes(d)&&(u.add("selected","bg-blue-700","!bg-primary-700","text-white","dark:bg-blue-600","dark:!bg-primary-600","dark:text-white"),u.remove("text-gray-900","hover:bg-gray-100","dark:text-white","dark:hover:bg-gray-600")),d===r.focused&&u.add("focused"),r.beforeShow&&r.performBeforeHook(c,d,h)})}},{key:"refresh",value:function(){var r=this,n=this.selected[this.year]||[],s=_m(this.range,this.year)||[],o=pi(s,2),a=o[0],l=o[1];this.grid.querySelectorAll(".range, .range-start, .range-end, .selected, .focused").forEach(function(c){c.classList.remove("range","range-start","range-end","selected","bg-blue-700","!bg-primary-700","dark:bg-blue-600","dark:!bg-primary-700","dark:text-white","text-white","focused"),c.classList.add("text-gray-900","hover:bg-gray-100","dark:text-white","dark:hover:bg-gray-600")}),Array.from(this.grid.children).forEach(function(c,d){var u=c.classList;d>a&&d<l&&u.add("range"),d===a&&u.add("range-start"),d===l&&u.add("range-end"),n.includes(d)&&(u.add("selected","bg-blue-700","!bg-primary-700","text-white","dark:bg-blue-600","dark:!bg-primary-600","dark:text-white"),u.remove("text-gray-900","hover:bg-gray-100","dark:text-white","dark:hover:bg-gray-600")),d===r.focused&&u.add("focused")})}},{key:"refreshFocus",value:function(){this.grid.querySelectorAll(".focused").forEach(function(r){r.classList.remove("focused")}),this.grid.children[this.focused].classList.add("focused")}}])}(gf);function YM(i){return Fa(i).reduce(function(e,t,r){return e+=r?t:t.toUpperCase()},"")}var wm=function(i){function e(t,r){return fs(this,e),df(this,e,[t,r])}return uf(e,i),ps(e,[{key:"init",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;n&&(this.navStep=this.step*10,this.beforeShowOption="beforeShow".concat(YM(this.cellClass)),this.grid=this.element,this.element.classList.add(this.name,"datepicker-grid","w-64","grid","grid-cols-4"),this.grid.appendChild(Pr(so("span",12)))),wa(xn(e.prototype),"init",this).call(this,r)}},{key:"setOptions",value:function(r){if(Dr(r,"minDate")&&(r.minDate===void 0?this.minYear=this.minDate=void 0:(this.minYear=Nn(r.minDate,this.step),this.minDate=mn(this.minYear,0,1))),Dr(r,"maxDate")&&(r.maxDate===void 0?this.maxYear=this.maxDate=void 0:(this.maxYear=Nn(r.maxDate,this.step),this.maxDate=mn(this.maxYear,11,31))),r[this.beforeShowOption]!==void 0){var n=r[this.beforeShowOption];this.beforeShow=typeof n=="function"?n:void 0}}},{key:"updateFocus",value:function(){var r=new Date(this.picker.viewDate),n=Nn(r,this.navStep),s=n+9*this.step;this.first=n,this.last=s,this.start=n-this.step,this.focused=Nn(r,this.step)}},{key:"updateSelection",value:function(){var r=this,n=this.picker.datepicker,s=n.dates,o=n.rangepicker;this.selected=s.reduce(function(a,l){return as(a,Nn(l,r.step))},[]),o&&o.dates&&(this.range=o.dates.map(function(a){if(a!==void 0)return Nn(a,r.step)}))}},{key:"render",value:function(){var r=this;this.disabled=[],this.picker.setViewSwitchLabel("".concat(this.first,"-").concat(this.last)),this.picker.setPrevBtnDisabled(this.first<=this.minYear),this.picker.setNextBtnDisabled(this.last>=this.maxYear),Array.from(this.grid.children).forEach(function(n,s){var o=n.classList,a=r.start+s*r.step,l=mn(a,0,1);if(n.className="datepicker-cell hover:bg-gray-100 dark:hover:bg-gray-600 block flex-1 leading-9 border-0 rounded-lg cursor-pointer text-center text-gray-900 dark:text-white font-semibold text-sm ".concat(r.cellClass),r.isMinView&&(n.dataset.date=l),n.textContent=n.dataset.year=a,s===0?o.add("prev"):s===11&&o.add("next"),(a<r.minYear||a>r.maxYear)&&o.add("disabled"),r.range){var c=pi(r.range,2),d=c[0],u=c[1];a>d&&a<u&&o.add("range"),a===d&&o.add("range-start"),a===u&&o.add("range-end")}r.selected.includes(a)&&(o.add("selected","bg-blue-700","!bg-primary-700","text-white","dark:bg-blue-600","dark:!bg-primary-600","dark:text-white"),o.remove("text-gray-900","hover:bg-gray-100","dark:text-white","dark:hover:bg-gray-600")),a===r.focused&&o.add("focused"),r.beforeShow&&r.performBeforeHook(n,a,l)})}},{key:"refresh",value:function(){var r=this,n=this.range||[],s=pi(n,2),o=s[0],a=s[1];this.grid.querySelectorAll(".range, .range-start, .range-end, .selected, .focused").forEach(function(l){l.classList.remove("range","range-start","range-end","selected","bg-blue-700","!bg-primary-700","text-white","dark:bg-blue-600","dark!bg-primary-600","dark:text-white","focused")}),Array.from(this.grid.children).forEach(function(l){var c=Number(l.textContent),d=l.classList;c>o&&c<a&&d.add("range"),c===o&&d.add("range-start"),c===a&&d.add("range-end"),r.selected.includes(c)&&(d.add("selected","bg-blue-700","!bg-primary-700","text-white","dark:bg-blue-600","dark:!bg-primary-600","dark:text-white"),d.remove("text-gray-900","hover:bg-gray-100","dark:text-white","dark:hover:bg-gray-600")),c===r.focused&&d.add("focused")})}},{key:"refreshFocus",value:function(){var r=Math.round((this.focused-this.start)/this.step);this.grid.querySelectorAll(".focused").forEach(function(n){n.classList.remove("focused")}),this.grid.children[r].classList.add("focused")}}])}(gf);function Ys(i,e){var t={date:i.getDate(),viewDate:new Date(i.picker.viewDate),viewId:i.picker.currentView.id,datepicker:i};i.element.dispatchEvent(new CustomEvent(e,{detail:t}))}function Lc(i,e){var t=i.config,r=t.minDate,n=t.maxDate,s=i.picker,o=s.currentView,a=s.viewDate,l;switch(o.id){case 0:l=kc(a,e);break;case 1:l=qs(a,e);break;default:l=qs(a,e*o.navStep)}l=Lb(l,r,n),i.picker.changeFocus(l).render()}function zb(i){var e=i.picker.currentView.id;e!==i.config.maxView&&i.picker.changeView(e+1).render()}function Nb(i){i.config.updateOnBlur?i.update({autohide:!0}):(i.refresh("input"),i.hide())}function xm(i,e){var t=i.picker,r=new Date(t.viewDate),n=t.currentView.id,s=n===1?kc(r,e-r.getMonth()):qs(r,e-r.getFullYear());t.changeFocus(s).changeView(n-1).render()}function XM(i){var e=i.picker,t=ms();if(i.config.todayBtnMode===1){if(i.config.autohide){i.setDate(t);return}i.setDate(t,{render:!1}),e.update()}e.viewDate!==t&&e.changeFocus(t),e.changeView(0).render()}function KM(i){i.setDate({clear:!0})}function JM(i){zb(i)}function ZM(i){Lc(i,-1)}function QM(i){Lc(i,1)}function e2(i,e){var t=Fb(e,".datepicker-cell");if(!(!t||t.classList.contains("disabled"))){var r=i.picker.currentView,n=r.id,s=r.isMinView;s?i.setDate(Number(t.dataset.date)):n===1?xm(i,Number(t.dataset.month)):xm(i,Number(t.dataset.year))}}function t2(i){!i.inline&&!i.config.disableTouchKeyboard&&i.inputField.focus()}function Sm(i,e){if(e.title!==void 0&&(e.title?(i.controls.title.textContent=e.title,ia(i.controls.title)):(i.controls.title.textContent="",ta(i.controls.title))),e.prevArrow){var t=i.controls.prevBtn;Ac(t),e.prevArrow.forEach(function(a){t.appendChild(a.cloneNode(!0))})}if(e.nextArrow){var r=i.controls.nextBtn;Ac(r),e.nextArrow.forEach(function(a){r.appendChild(a.cloneNode(!0))})}if(e.locale&&(i.controls.todayBtn.textContent=e.locale.today,i.controls.clearBtn.textContent=e.locale.clear),e.todayBtn!==void 0&&(e.todayBtn?ia(i.controls.todayBtn):ta(i.controls.todayBtn)),Dr(e,"minDate")||Dr(e,"maxDate")){var n=i.datepicker.config,s=n.minDate,o=n.maxDate;i.controls.todayBtn.disabled=!ff(ms(),s,o)}e.clearBtn!==void 0&&(e.clearBtn?ia(i.controls.clearBtn):ta(i.controls.clearBtn))}function Mm(i){var e=i.dates,t=i.config,r=e.length>0?hf(e):t.defaultViewDate;return Lb(r,t.minDate,t.maxDate)}function Em(i,e){var t=new Date(i.viewDate),r=new Date(e),n=i.currentView,s=n.id,o=n.year,a=n.first,l=n.last,c=r.getFullYear();switch(i.viewDate=e,c!==t.getFullYear()&&Ys(i.datepicker,"changeYear"),r.getMonth()!==t.getMonth()&&Ys(i.datepicker,"changeMonth"),s){case 0:return e<a||e>l;case 1:return c!==o;default:return c<a||c>l}}function Nd(i){return window.getComputedStyle(i).direction}var i2=function(){function i(e){fs(this,i),this.datepicker=e;var t=UM.replace(/%buttonClass%/g,e.config.buttonClass),r=this.element=Pr(t).firstChild,n=pi(r.firstChild.children,3),s=n[0],o=n[1],a=n[2],l=s.firstElementChild,c=pi(s.lastElementChild.children,3),d=c[0],u=c[1],h=c[2],p=pi(a.firstChild.children,2),g=p[0],f=p[1],m={title:l,prevBtn:d,viewSwitch:u,nextBtn:h,todayBtn:g,clearBtn:f};this.main=o,this.controls=m;var b=e.inline?"inline":"dropdown";r.classList.add("datepicker-".concat(b)),b==="dropdown"&&r.classList.add("dropdown","absolute","top-0","left-0","z-50","pt-2"),Sm(this,e.config),this.viewDate=Mm(e),mf(e,[[r,"click",t2.bind(null,e),{capture:!0}],[o,"click",e2.bind(null,e)],[m.viewSwitch,"click",JM.bind(null,e)],[m.prevBtn,"click",ZM.bind(null,e)],[m.nextBtn,"click",QM.bind(null,e)],[m.todayBtn,"click",XM.bind(null,e)],[m.clearBtn,"click",KM.bind(null,e)]]),this.views=[new GM(this),new qM(this),new wm(this,{id:2,name:"years",cellClass:"year",step:1}),new wm(this,{id:3,name:"decades",cellClass:"decade",step:10})],this.currentView=this.views[e.config.startView],this.currentView.render(),this.main.appendChild(this.currentView.element),e.config.container.appendChild(this.element)}return ps(i,[{key:"setOptions",value:function(t){Sm(this,t),this.views.forEach(function(r){r.init(t,!1)}),this.currentView.render()}},{key:"detach",value:function(){this.datepicker.config.container.removeChild(this.element)}},{key:"show",value:function(){if(!this.active){this.element.classList.add("active","block"),this.element.classList.remove("hidden"),this.active=!0;var t=this.datepicker;if(!t.inline){var r=Nd(t.inputField);r!==Nd(t.config.container)?this.element.dir=r:this.element.dir&&this.element.removeAttribute("dir"),this.place(),t.config.disableTouchKeyboard&&t.inputField.blur()}Ys(t,"show")}}},{key:"hide",value:function(){this.active&&(this.datepicker.exitEditMode(),this.element.classList.remove("active","block"),this.element.classList.add("active","block","hidden"),this.active=!1,Ys(this.datepicker,"hide"))}},{key:"place",value:function(){var t=this.element,r=t.classList,n=t.style,s=this.datepicker,o=s.config,a=s.inputField,l=o.container,c=this.element.getBoundingClientRect(),d=c.width,u=c.height,h=l.getBoundingClientRect(),p=h.left,g=h.top,f=h.width,m=a.getBoundingClientRect(),b=m.left,y=m.top,w=m.width,_=m.height,M=o.orientation,S=M.x,A=M.y,x,E,D;l===document.body?(x=window.scrollY,E=b+window.scrollX,D=y+x):(x=l.scrollTop,E=b-p,D=y-g+x),S==="auto"&&(E<0?(S="left",E=10):E+d>f?S="right":S=Nd(a)==="rtl"?"right":"left"),S==="right"&&(E-=d-w),A==="auto"&&(A=D-u<x?"bottom":"top"),A==="top"?D-=u:D+=_,r.remove("datepicker-orient-top","datepicker-orient-bottom","datepicker-orient-right","datepicker-orient-left"),r.add("datepicker-orient-".concat(A),"datepicker-orient-".concat(S)),n.top=D&&"".concat(D,"px"),n.left=E&&"".concat(E,"px")}},{key:"setViewSwitchLabel",value:function(t){this.controls.viewSwitch.textContent=t}},{key:"setPrevBtnDisabled",value:function(t){this.controls.prevBtn.disabled=t}},{key:"setNextBtnDisabled",value:function(t){this.controls.nextBtn.disabled=t}},{key:"changeView",value:function(t){var r=this.currentView,n=this.views[t];return n.id!==r.id&&(this.currentView=n,this._renderMethod="render",Ys(this.datepicker,"changeView"),this.main.replaceChild(n.element,r.element)),this}},{key:"changeFocus",value:function(t){return this._renderMethod=Em(this,t)?"render":"refreshFocus",this.views.forEach(function(r){r.updateFocus()}),this}},{key:"update",value:function(){var t=Mm(this.datepicker);return this._renderMethod=Em(this,t)?"render":"refresh",this.views.forEach(function(r){r.updateFocus(),r.updateSelection()}),this}},{key:"render",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,r=t&&this._renderMethod||"render";delete this._renderMethod,this.currentView[r]()}}])}();function $b(i,e,t,r,n,s){if(ff(i,n,s)){if(r(i)){var o=e(i,t);return $b(o,e,t,r,n,s)}return i}}function ol(i,e,t,r){var n=i.picker,s=n.currentView,o=s.step||1,a=n.viewDate,l,c;switch(s.id){case 0:r?a=Gs(a,t*7):e.ctrlKey||e.metaKey?a=qs(a,t):a=Gs(a,t),l=Gs,c=function(u){return s.disabled.includes(u)};break;case 1:a=kc(a,r?t*4:t),l=kc,c=function(u){var h=new Date(u),p=s.year,g=s.disabled;return h.getFullYear()===p&&g.includes(h.getMonth())};break;default:a=qs(a,t*(r?4:1)*o),l=qs,c=function(u){return s.disabled.includes(Nn(u,o))}}a=$b(a,l,t<0?-o:o,c,s.minDate,s.maxDate),a!==void 0&&n.changeFocus(a).render()}function r2(i,e){if(e.key==="Tab"){Nb(i);return}var t=i.picker,r=t.currentView,n=r.id,s=r.isMinView;if(t.active)if(i.editMode)switch(e.key){case"Escape":t.hide();break;case"Enter":i.exitEditMode({update:!0,autohide:i.config.autohide});break;default:return}else switch(e.key){case"Escape":t.hide();break;case"ArrowLeft":if(e.ctrlKey||e.metaKey)Lc(i,-1);else if(e.shiftKey){i.enterEditMode();return}else ol(i,e,-1,!1);break;case"ArrowRight":if(e.ctrlKey||e.metaKey)Lc(i,1);else if(e.shiftKey){i.enterEditMode();return}else ol(i,e,1,!1);break;case"ArrowUp":if(e.ctrlKey||e.metaKey)zb(i);else if(e.shiftKey){i.enterEditMode();return}else ol(i,e,-1,!0);break;case"ArrowDown":if(e.shiftKey&&!e.ctrlKey&&!e.metaKey){i.enterEditMode();return}ol(i,e,1,!0);break;case"Enter":s?i.setDate(t.viewDate):t.changeView(n-1).render();break;case"Backspace":case"Delete":i.enterEditMode();return;default:e.key.length===1&&!e.ctrlKey&&!e.metaKey&&i.enterEditMode();return}else switch(e.key){case"ArrowDown":case"Escape":t.show();break;case"Enter":i.update();break;default:return}e.preventDefault(),e.stopPropagation()}function n2(i){i.config.showOnFocus&&!i._showing&&i.show()}function s2(i,e){var t=e.target;(i.picker.active||i.config.showOnClick)&&(t._active=t===document.activeElement,t._clicking=setTimeout(function(){delete t._active,delete t._clicking},2e3))}function o2(i,e){var t=e.target;t._clicking&&(clearTimeout(t._clicking),delete t._clicking,t._active&&i.enterEditMode(),delete t._active,i.config.showOnClick&&i.show())}function a2(i,e){e.clipboardData.types.includes("text/plain")&&i.enterEditMode()}function l2(i,e){var t=i.element;if(t===document.activeElement){var r=i.picker.element;Fb(e,function(n){return n===t||n===r})||Nb(i)}}function Bb(i,e){return i.map(function(t){return Sa(t,e.format,e.locale)}).join(e.dateDelimiter)}function Vb(i,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=i.config,n=i.dates,s=i.rangepicker;if(e.length===0)return t?[]:void 0;var o=s&&i===s.datepickers[1],a=e.reduce(function(l,c){var d=xa(c,r.format,r.locale);if(d===void 0)return l;if(r.pickLevel>0){var u=new Date(d);r.pickLevel===1?d=o?u.setMonth(u.getMonth()+1,0):u.setDate(1):d=o?u.setFullYear(u.getFullYear()+1,0,0):u.setMonth(0,1)}return ff(d,r.minDate,r.maxDate)&&!l.includes(d)&&!r.datesDisabled.includes(d)&&!r.daysOfWeekDisabled.includes(new Date(d).getDay())&&l.push(d),l},[]);if(a.length!==0)return r.multidate&&!t&&(a=a.reduce(function(l,c){return n.includes(c)||l.push(c),l},n.filter(function(l){return!a.includes(l)}))),r.maxNumberOfDates&&a.length>r.maxNumberOfDates?a.slice(r.maxNumberOfDates*-1):a}function Dc(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,r=i.config,n=i.picker,s=i.inputField;if(e&2){var o=n.active?r.pickLevel:r.startView;n.update().changeView(o).render(t)}e&1&&s&&(s.value=Bb(i.dates,r))}function km(i,e,t){var r=t.clear,n=t.render,s=t.autohide;n===void 0&&(n=!0),n?s===void 0&&(s=i.config.autohide):s=!1;var o=Vb(i,e,r);o&&(o.toString()!==i.dates.toString()?(i.dates=o,Dc(i,n?3:1),Ys(i,"changeDate")):Dc(i,1),s&&i.hide())}var Gl=function(){function i(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;fs(this,i),e.datepicker=this,this.element=e;var n=this.config=Object.assign({buttonClass:t.buttonClass&&String(t.buttonClass)||"button",container:document.body,defaultViewDate:ms(),maxDate:void 0,minDate:void 0},zd(za,this));this._options=t,Object.assign(n,zd(t,this));var s=this.inline=e.tagName!=="INPUT",o,a;if(s)n.container=e,a=Rd(e.dataset.date,n.dateDelimiter),delete e.dataset.date;else{var l=t.container?document.querySelector(t.container):null;l&&(n.container=l),o=this.inputField=e,o.classList.add("datepicker-input"),a=Rd(o.value,n.dateDelimiter)}if(r){var c=r.inputs.indexOf(o),d=r.datepickers;if(c<0||c>1||!Array.isArray(d))throw Error("Invalid rangepicker object.");d[c]=this,Object.defineProperty(this,"rangepicker",{get:function(){return r}})}this.dates=[];var u=Vb(this,a);u&&u.length>0&&(this.dates=u),o&&(o.value=Bb(this.dates,n));var h=this.picker=new i2(this);if(s)this.show();else{var p=l2.bind(null,this),g=[[o,"keydown",r2.bind(null,this)],[o,"focus",n2.bind(null,this)],[o,"mousedown",s2.bind(null,this)],[o,"click",o2.bind(null,this)],[o,"paste",a2.bind(null,this)],[document,"mousedown",p],[document,"touchstart",p],[window,"resize",h.place.bind(h)]];mf(this,g)}}return ps(i,[{key:"active",get:function(){return!!(this.picker&&this.picker.active)}},{key:"pickerElement",get:function(){return this.picker?this.picker.element:void 0}},{key:"setOptions",value:function(t){var r=this.picker,n=zd(t,this);Object.assign(this._options,t),Object.assign(this.config,n),r.setOptions(n),Dc(this,3)}},{key:"show",value:function(){if(this.inputField){if(this.inputField.disabled)return;this.inputField!==document.activeElement&&(this._showing=!0,this.inputField.focus(),delete this._showing)}this.picker.show()}},{key:"hide",value:function(){this.inline||(this.picker.hide(),this.picker.update().changeView(this.config.startView).render())}},{key:"destroy",value:function(){return this.hide(),Ib(this),this.picker.detach(),this.inline||this.inputField.classList.remove("datepicker-input"),delete this.element.datepicker,this}},{key:"getDate",value:function(){var t=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0,n=r?function(s){return Sa(s,r,t.config.locale)}:function(s){return new Date(s)};if(this.config.multidate)return this.dates.map(n);if(this.dates.length>0)return n(this.dates[0])}},{key:"setDate",value:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var s=[].concat(r),o={},a=hf(r);Ec(a)==="object"&&!Array.isArray(a)&&!(a instanceof Date)&&a&&Object.assign(o,s.pop());var l=Array.isArray(s[0])?s[0]:s;km(this,l,o)}},{key:"update",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0;if(!this.inline){var r={clear:!0,autohide:!!(t&&t.autohide)},n=Rd(this.inputField.value,this.config.dateDelimiter);km(this,n,r)}}},{key:"refresh",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;t&&typeof t!="string"&&(r=t,t=void 0);var n;t==="picker"?n=2:t==="input"?n=1:n=3,Dc(this,n,!r)}},{key:"enterEditMode",value:function(){this.inline||!this.picker.active||this.editMode||(this.editMode=!0,this.inputField.classList.add("in-edit","border-blue-700","!border-primary-700"))}},{key:"exitEditMode",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0;if(!(this.inline||!this.editMode)){var r=Object.assign({update:!1},t);delete this.editMode,this.inputField.classList.remove("in-edit","border-blue-700","!border-primary-700"),r.update&&this.update(r)}}}],[{key:"formatDate",value:function(t,r,n){return Sa(t,r,n&&Mo[n]||Mo.en)}},{key:"parseDate",value:function(t,r,n){return xa(t,r,n&&Mo[n]||Mo.en)}},{key:"locales",get:function(){return Mo}}])}();function Cm(i){var e=Object.assign({},i);return delete e.inputs,delete e.allowOneSidedRange,delete e.maxNumberOfDates,e}function Tm(i,e,t,r){mf(i,[[t,"changeDate",e]]),new Gl(t,r,i)}function Eo(i,e){if(!i._updating){i._updating=!0;var t=e.target;if(t.datepicker!==void 0){var r=i.datepickers,n={render:!1},s=i.inputs.indexOf(t),o=s===0?1:0,a=r[s].dates[0],l=r[o].dates[0];a!==void 0&&l!==void 0?s===0&&a>l?(r[0].setDate(l,n),r[1].setDate(a,n)):s===1&&a<l&&(r[0].setDate(a,n),r[1].setDate(l,n)):i.allowOneSidedRange||(a!==void 0||l!==void 0)&&(n.clear=!0,r[o].setDate(r[s].dates,n)),r[0].picker.update().render(),r[1].picker.update().render(),delete i._updating}}}var $d=function(){function i(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};fs(this,i);var r=Array.isArray(t.inputs)?t.inputs:Array.from(e.querySelectorAll("input"));if(!(r.length<2)){e.rangepicker=this,this.element=e,this.inputs=r.slice(0,2),this.allowOneSidedRange=!!t.allowOneSidedRange;var n=Eo.bind(null,this),s=Cm(t),o=[];Object.defineProperty(this,"datepickers",{get:function(){return o}}),Tm(this,n,this.inputs[0],s),Tm(this,n,this.inputs[1],s),Object.freeze(o),o[0].dates.length>0?Eo(this,{target:this.inputs[0]}):o[1].dates.length>0&&Eo(this,{target:this.inputs[1]})}}return ps(i,[{key:"dates",get:function(){return this.datepickers.length===2?[this.datepickers[0].dates[0],this.datepickers[1].dates[0]]:void 0}},{key:"setOptions",value:function(t){this.allowOneSidedRange=!!t.allowOneSidedRange;var r=Cm(t);this.datepickers[0].setOptions(r),this.datepickers[1].setOptions(r)}},{key:"destroy",value:function(){this.datepickers[0].destroy(),this.datepickers[1].destroy(),Ib(this),delete this.element.rangepicker}},{key:"getDates",value:function(){var t=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0,n=r?function(s){return Sa(s,r,t.datepickers[0].config.locale)}:function(s){return new Date(s)};return this.dates.map(function(s){return s===void 0?s:n(s)})}},{key:"setDates",value:function(t,r){var n=pi(this.datepickers,2),s=n[0],o=n[1],a=this.dates;this._updating=!0,s.setDate(t),o.setDate(r),delete this._updating,o.dates[0]!==a[1]?Eo(this,{target:this.inputs[1]}):s.dates[0]!==a[0]&&Eo(this,{target:this.inputs[0]})}}])}(),Pc=function(){return Pc=Object.assign||function(i){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n])}return i},Pc.apply(this,arguments)},Mi={defaultDatepickerId:null,autohide:!1,format:"mm/dd/yyyy",maxDate:null,minDate:null,orientation:"bottom",buttons:!1,autoSelectToday:0,title:null,language:"en",rangePicker:!1,onShow:function(){},onHide:function(){}},c2={id:null,override:!0},Hb=function(){function i(e,t,r){e===void 0&&(e=null),t===void 0&&(t=Mi),r===void 0&&(r=c2),this._instanceId=r.id?r.id:e.id,this._datepickerEl=e,this._datepickerInstance=null,this._options=Pc(Pc({},Mi),t),this._initialized=!1,this.init(),Qe.addInstance("Datepicker",this,this._instanceId,r.override)}return i.prototype.init=function(){this._datepickerEl&&!this._initialized&&(this._options.rangePicker?this._datepickerInstance=new $d(this._datepickerEl,this._getDatepickerOptions(this._options)):this._datepickerInstance=new Gl(this._datepickerEl,this._getDatepickerOptions(this._options)),this._initialized=!0)},i.prototype.destroy=function(){this._initialized&&(this._initialized=!1,this._datepickerInstance.destroy())},i.prototype.removeInstance=function(){this.destroy(),Qe.removeInstance("Datepicker",this._instanceId)},i.prototype.destroyAndRemoveInstance=function(){this.destroy(),this.removeInstance()},i.prototype.getDatepickerInstance=function(){return this._datepickerInstance},i.prototype.getDate=function(){if(this._options.rangePicker&&this._datepickerInstance instanceof $d)return this._datepickerInstance.getDates();if(!this._options.rangePicker&&this._datepickerInstance instanceof Gl)return this._datepickerInstance.getDate()},i.prototype.setDate=function(e){if(this._options.rangePicker&&this._datepickerInstance instanceof $d)return this._datepickerInstance.setDates(e);if(!this._options.rangePicker&&this._datepickerInstance instanceof Gl)return this._datepickerInstance.setDate(e)},i.prototype.show=function(){this._datepickerInstance.show(),this._options.onShow(this)},i.prototype.hide=function(){this._datepickerInstance.hide(),this._options.onHide(this)},i.prototype._getDatepickerOptions=function(e){var t={};return e.buttons&&(t.todayBtn=!0,t.clearBtn=!0,e.autoSelectToday&&(t.todayBtnMode=1)),e.autohide&&(t.autohide=!0),e.format&&(t.format=e.format),e.maxDate&&(t.maxDate=e.maxDate),e.minDate&&(t.minDate=e.minDate),e.orientation&&(t.orientation=e.orientation),e.title&&(t.title=e.title),e.language&&(t.language=e.language),t},i.prototype.updateOnShow=function(e){this._options.onShow=e},i.prototype.updateOnHide=function(e){this._options.onHide=e},i}();function vf(){document.querySelectorAll("[datepicker], [inline-datepicker], [date-rangepicker]").forEach(function(i){if(i){var e=i.hasAttribute("datepicker-buttons"),t=i.hasAttribute("datepicker-autoselect-today"),r=i.hasAttribute("datepicker-autohide"),n=i.getAttribute("datepicker-format"),s=i.getAttribute("datepicker-max-date"),o=i.getAttribute("datepicker-min-date"),a=i.getAttribute("datepicker-orientation"),l=i.getAttribute("datepicker-title"),c=i.getAttribute("datepicker-language"),d=i.hasAttribute("date-rangepicker");new Hb(i,{buttons:e||Mi.buttons,autoSelectToday:t||Mi.autoSelectToday,autohide:r||Mi.autohide,format:n||Mi.format,maxDate:s||Mi.maxDate,minDate:o||Mi.minDate,orientation:a||Mi.orientation,title:l||Mi.title,language:c||Mi.language,rangePicker:d||Mi.rangePicker})}else console.error("The datepicker element does not exist. Please check the datepicker attribute.")})}typeof window<"u"&&(window.Datepicker=Hb,window.initDatepickers=vf);function Ub(){Hh(),Uh(),jh(),Wh(),ef(),tf(),rf(),nf(),sf(),of(),af(),lf(),cf(),vf()}typeof window<"u"&&(window.initFlowbite=Ub);var d2=new rS("load",[Hh,Uh,jh,Wh,ef,tf,rf,nf,sf,of,af,lf,cf,vf]);d2.init();const u2={block:"",flex:"","justify-between":"","bg-gray-900":"","p-1":"",class:"z-50 top-0 left-0 right-0 fixed h-16"},h2={flex:"","gap-3":""},f2=v("img",{src:Qw,class:"max-h-9"},null,-1),p2=v("tip",null," Панель ",-1),m2=v("tip",null," Вики ",-1),g2=v("tip",null," Создать ",-1),v2={class:"rounded-md text-black"},b2={class:"wrapper bg-sky-200 min-w-full min-h-screen"},y2={key:0,"px-10":""},_2=v("h1",{"mx-1":""}," Редактировать персонажа ",-1),w2={"my-3":"","mx-1":"",block:""},x2={class:"relative w-full min-w-[200px] h-10","mb-3":""},S2=v("label",{class:"flex w-full h-full select-none pointer-events-none absolute left-0 font-normal !overflow-visible truncate peer-placeholder-shown:text-blue-500 leading-tight peer-focus:leading-tight peer-disabled:text-transparent peer-disabled:peer-placeholder-shown:text-blue-500 transition-all -top-1.5 peer-placeholder-shown:text-sm text-[11px] peer-focus:text-[11px] before:content[' '] before:block before:box-border before:w-2.5 before:h-1.5 before:mt-[6.5px] before:mr-1 peer-placeholder-shown:before:border-transparent before:rounded-tl-md before:border-t peer-focus:before:border-t-1 before:border-l peer-focus:before:border-l-1 before:pointer-events-none before:transition-all peer-disabled:before:border-transparent after:content[' '] after:block after:flex-grow after:box-border after:w-2.5 after:h-1.5 after:mt-[6.5px] after:ml-1 peer-placeholder-shown:after:border-transparent after:rounded-tr-md after:border-t peer-focus:after:border-t-1 after:border-r peer-focus:after:border-r-1 after:pointer-events-none after:transition-all peer-disabled:after:border-transparent peer-placeholder-shown:leading-[3.75] text-gray-500 peer-focus:text-gray-700 before:border-blue-200 peer-focus:before:!border-blue-600 after:border-gray-400 peer-focus:after:!border-gray-800"},"Имя персонажа ",-1),M2={flex:"","gap-1":"","justify-between":"","items-center":"","px-1":""},E2={class:"relative w-1/3 h-10"},k2=v("label",{class:"flex w-full h-full select-none pointer-events-none absolute left-0 font-normal !overflow-visible truncate peer-placeholder-shown:text-blue-500 leading-tight peer-focus:leading-tight peer-disabled:text-transparent peer-disabled:peer-placeholder-shown:text-blue-500 transition-all -top-1.5 peer-placeholder-shown:text-sm text-[11px] peer-focus:text-[11px] before:content[' '] before:block before:box-border before:w-2.5 before:h-1.5 before:mt-[6.5px] before:mr-1 peer-placeholder-shown:before:border-transparent before:rounded-tl-md before:border-t peer-focus:before:border-t-1 before:border-l peer-focus:before:border-l-1 before:pointer-events-none before:transition-all peer-disabled:before:border-transparent after:content[' '] after:block after:flex-grow after:box-border after:w-2.5 after:h-1.5 after:mt-[6.5px] after:ml-1 peer-placeholder-shown:after:border-transparent after:rounded-tr-md after:border-t peer-focus:after:border-t-1 after:border-r peer-focus:after:border-r-1 after:pointer-events-none after:transition-all peer-disabled:after:border-transparent peer-placeholder-shown:leading-[3.75] text-gray-500 peer-focus:text-gray-700 before:border-blue-200 peer-focus:before:!border-blue-600 after:border-gray-400 peer-focus:after:!border-gray-800"},"Уровень ",-1),C2={"font-bold":"","text-xl":""},T2={"font-bold":"","text-blue-600":""},A2=v("h2",{"px-1":""}," Характеристики: ",-1),L2={flex:"","px-2":""},D2={flex:"","flex-col":"",class:"w-1/2"},P2={flex:"","justify-between":"","items-center":"","mb-1":""},R2={"text-lg":""},I2={flex:"","flex-col":"",class:"w-1/2"},O2={"mb-1":"",flex:"","justify-between":"","px-4":""},F2={"text-lg":""},z2={"text-lg":"","font-bold":""},N2=v("h2",{"px-2":"","mt-2":"","mb-1":""},"Доспехи: ",-1),$2={flex:"","mx-2":"","gap-7":""},B2={flex:"","items-center":"","gap-1":""},V2={class:"relative w-full h-10"},H2=v("label",{class:"flex w-full h-full select-none pointer-events-none absolute left-0 font-normal !overflow-visible truncate peer-placeholder-shown:text-blue-500 leading-tight peer-focus:leading-tight peer-disabled:text-transparent peer-disabled:peer-placeholder-shown:text-blue-500 transition-all -top-1.5 peer-placeholder-shown:text-sm text-[11px] peer-focus:text-[11px] before:content[' '] before:block before:box-border before:w-2.5 before:h-1.5 before:mt-[6.5px] before:mr-1 peer-placeholder-shown:before:border-transparent before:rounded-tl-md before:border-t peer-focus:before:border-t-1 before:border-l peer-focus:before:border-l-1 before:pointer-events-none before:transition-all peer-disabled:before:border-transparent after:content[' '] after:block after:flex-grow after:box-border after:w-2.5 after:h-1.5 after:mt-[6.5px] after:ml-1 peer-placeholder-shown:after:border-transparent after:rounded-tr-md after:border-t peer-focus:after:border-t-1 after:border-r peer-focus:after:border-r-1 after:pointer-events-none after:transition-all peer-disabled:after:border-transparent peer-placeholder-shown:leading-[3.75] text-gray-500 peer-focus:text-gray-700 before:border-blue-200 peer-focus:before:!border-blue-600 after:border-gray-400 peer-focus:after:!border-gray-800"}," Защита ",-1),U2={flex:"","items-center":"","gap-1":""},j2={class:"relative w-full h-10"},W2=v("label",{class:"flex w-full h-full select-none pointer-events-none absolute left-0 font-normal !overflow-visible truncate peer-placeholder-shown:text-blue-500 leading-tight peer-focus:leading-tight peer-disabled:text-transparent peer-disabled:peer-placeholder-shown:text-blue-500 transition-all -top-1.5 peer-placeholder-shown:text-sm text-[11px] peer-focus:text-[11px] before:content[' '] before:block before:box-border before:w-2.5 before:h-1.5 before:mt-[6.5px] before:mr-1 peer-placeholder-shown:before:border-transparent before:rounded-tl-md before:border-t peer-focus:before:border-t-1 before:border-l peer-focus:before:border-l-1 before:pointer-events-none before:transition-all peer-disabled:before:border-transparent after:content[' '] after:block after:flex-grow after:box-border after:w-2.5 after:h-1.5 after:mt-[6.5px] after:ml-1 peer-placeholder-shown:after:border-transparent after:rounded-tr-md after:border-t peer-focus:after:border-t-1 after:border-r peer-focus:after:border-r-1 after:pointer-events-none after:transition-all peer-disabled:after:border-transparent peer-placeholder-shown:leading-[3.75] text-gray-500 peer-focus:text-gray-700 before:border-blue-200 peer-focus:before:!border-blue-600 after:border-gray-400 peer-focus:after:!border-gray-800"}," Снижение урона ",-1),G2={flex:"","items-center":"","gap-1":""},q2={class:"relative w-full h-10"},Y2=v("label",{class:"flex w-full h-full select-none pointer-events-none absolute left-0 font-normal !overflow-visible truncate peer-placeholder-shown:text-blue-500 leading-tight peer-focus:leading-tight peer-disabled:text-transparent peer-disabled:peer-placeholder-shown:text-blue-500 transition-all -top-1.5 peer-placeholder-shown:text-sm text-[11px] peer-focus:text-[11px] before:content[' '] before:block before:box-border before:w-2.5 before:h-1.5 before:mt-[6.5px] before:mr-1 peer-placeholder-shown:before:border-transparent before:rounded-tl-md before:border-t peer-focus:before:border-t-1 before:border-l peer-focus:before:border-l-1 before:pointer-events-none before:transition-all peer-disabled:before:border-transparent after:content[' '] after:block after:flex-grow after:box-border after:w-2.5 after:h-1.5 after:mt-[6.5px] after:ml-1 peer-placeholder-shown:after:border-transparent after:rounded-tr-md after:border-t peer-focus:after:border-t-1 after:border-r peer-focus:after:border-r-1 after:pointer-events-none after:transition-all peer-disabled:after:border-transparent peer-placeholder-shown:leading-[3.75] text-gray-500 peer-focus:text-gray-700 before:border-blue-200 peer-focus:before:!border-blue-600 after:border-gray-400 peer-focus:after:!border-gray-800"}," Скорость ",-1),X2=v("h2",{"mx-2":""}," Изучить умения: ",-1),K2=v("traits-block",{"mx-2":""},null,-1),J2={flex:"","justify-between":"","gap-3":"","mx-2":""},Z2={key:1,"px-2":"","text-center":""},Q2=v("h1",{"text-3xl":"","font-bold":""}," Ваши персонажи: ",-1),eE={class:"relative w-[100px]"},tE=v("svg",{height:"100",width:"50"},null,-1),iE=["onClick","src"],rE={"flex-grow":"",flex:"","flex-col":"","justify-between":""},nE={"w-full":"","pl-1":"",flex:"","flex-col":"","justify-between":"",class:"h-[100%]","py-1":""},sE={flex:"","justify-between":""},oE={"text-3xl":"","font-bold":"","text-white":""},aE={flex:"","items-center":""},lE={key:0,flex:"","justify-between":""},cE={flex:"","justify-between":"","items-center":""},dE={flex:"","text-xl":"","text-white":"","items-center":""},uE={flex:"","items-center":"","mr-2":""},hE={flex:"","items-center":""},fE=v("character-control",{flex:"",class:"items-end","py-2":""},null,-1),pE={"text-center":""},mE={key:2,block:"","px-2":""},gE={key:0},vE=v("h1",null," Выберите расу персонажа ",-1),bE={flex:"",class:"flex-wrap justify-between p-2"},yE=["onClick"],_E=["src"],wE={flex:"","justify-center":""},xE={key:1},SE={block:"","mb-4":""},ME=v("b",null,"Связанные аспекты:",-1),EE=v("br",null,null,-1),kE={flex:"","my-5":""},CE=["src"],TE={flex:"","justify-between":"","ml-2":"","flex-wrap":"",class:"items-center"},AE={flex:"","flex-col":"","text-center":"","text-blue-700":"","my-1":"",class:"w-2/5"},LE=v("stat-hint",{"text-xs":""}," очков передвижения ",-1),DE={"text-3xl":"",flex:"",class:"justify-center items-center"},PE={"inline-block":""},RE={flex:"","flex-col":"","text-center":"","text-yellow-600":"","my-1":"",class:"w-2/5"},IE=v("stat-hint",{"text-xs":""}," порывов на старте ",-1),OE={"text-3xl":"",flex:"",class:"justify-center items-center"},FE={"inline-block":""},zE={flex:"","flex-col":"","text-center":"","text-red-700":"","my-1":"",class:"w-2/5"},NE=v("stat-hint",{"text-xs":""}," очков здоровья ",-1),$E={"text-3xl":"",flex:"",class:"justify-center items-center"},BE={"inline-block":""},VE={flex:"","flex-col":"","text-center":"","text-green-800":"","my-1":"",class:"w-2/5"},HE=v("stat-hint",{"text-xs":""}," сопротивление урону ",-1),UE={"text-3xl":"",flex:"",class:"justify-center items-center"},jE={"inline-block":""},WE={flex:"","justify-between":""},GE={key:2},qE=v("h1",null," Выберите стартовый класс: ",-1),YE={flex:"",class:"justify-between","p-2":""},XE={class:"inline-flex items-center"},KE=v("span",{"mr-2":""}," Ж ",-1),JE={class:"relative inline-block w-8 h-4 rounded-full cursor-pointer"},ZE=v("label",{htmlFor:"switch-1",class:"before:content[''] absolute top-2/4 -left-1 h-5 w-5 -translate-y-2/4 cursor-pointer rounded-full border-2 border-blue-100 bg-red-400 shadow-md transition-all duration-300 before:absolute before:top-2/4 before:left-2/4 before:block before:h-10 before:w-10 before:-translate-y-2/4 before:-translate-x-2/4 before:rounded-full before:bg-blue-500 border-red-500 before:opacity-0 before:transition-opacity hover:before:opacity-10 peer-checked:translate-x-full peer-checked:border-blue-600 peer-checked:before:bg-blue-500 peer-checked:bg-blue-400"},[v("div",{class:"inline-block p-5 rounded-full top-2/4 left-2/4 -translate-x-2/4 -translate-y-2/4","data-ripple-dark":"true"})],-1),QE=v("span",{"ml-1":""}," М ",-1),ek={flex:"",class:"flex-wrap justify-between p-2"},tk=["onClick"],ik=["src"],rk={flex:"","justify-center":""},nk={key:3,class:"p-2 block"},sk={flex:"","justify-between":""},ok=v("b",null,"Краткое описание:",-1),ak=v("br",null,null,-1),lk=v("b",null,"Связанные аспекты:",-1),ck=v("br",null,null,-1),dk=v("b",null,"Сильные характеристики:",-1),uk={"mr-1":""},hk=v("br",null,null,-1),fk=v("b",null,"Сильные проверки:",-1),pk={"mr-1":""},mk=v("br",null,null,-1),gk=v("b",null,"Умения:",-1),vk={block:""},bk={class:"list-decimal ml-4"},yk={flex:"","justify-between":""},_k={key:4},wk=v("h1",null,"Введите имя Вашего персонажа:",-1),xk={class:"w-1/2","my-3":""},Sk={class:"relative w-full min-w-[200px] h-10","mb-3":""},Mk=v("label",{class:"flex w-full h-full select-none pointer-events-none absolute left-0 font-normal !overflow-visible truncate peer-placeholder-shown:text-blue-500 leading-tight peer-focus:leading-tight peer-disabled:text-transparent peer-disabled:peer-placeholder-shown:text-blue-500 transition-all -top-1.5 peer-placeholder-shown:text-sm text-[11px] peer-focus:text-[11px] before:content[' '] before:block before:box-border before:w-2.5 before:h-1.5 before:mt-[6.5px] before:mr-1 peer-placeholder-shown:before:border-transparent before:rounded-tl-md before:border-t peer-focus:before:border-t-1 before:border-l peer-focus:before:border-l-1 before:pointer-events-none before:transition-all peer-disabled:before:border-transparent after:content[' '] after:block after:flex-grow after:box-border after:w-2.5 after:h-1.5 after:mt-[6.5px] after:ml-1 peer-placeholder-shown:after:border-transparent after:rounded-tr-md after:border-t peer-focus:after:border-t-1 after:border-r peer-focus:after:border-r-1 after:pointer-events-none after:transition-all peer-disabled:after:border-transparent peer-placeholder-shown:leading-[3.75] text-gray-500 peer-focus:text-gray-700 before:border-blue-200 peer-focus:before:!border-blue-600 after:border-gray-400 peer-focus:after:!border-gray-800"},"Имя персонажа ",-1),Ek={flex:"","justify-between":""},kk=["disabled"],Ck={key:5},Tk=v("h1",null,"Распределите Характеристики: ",-1),Ak=v("p",null," Когда Вы совершаете какое-то сложное действие в игре (будь то атака, попытка создать механизм, убедить кого-то помочь или любое другое), Ваш успех или провал определяется результатом Проверки.",-1),Lk=v("p",null," При Проверке Вы бросаете куб d12 и сравниваете выпавшее число с необходимым для того, чтобы пройти. Конечно же, вероятность Вашего успеха зависит от Ваших характеристик, которые сейчас и нужно распределить. ",-1),Dk=v("p",null," В этих двух характеристиках Вы получаете значения 6 и 4, но можете самостоятельно выбрать, в какой 6, в какой 4 ",-1),Pk={flex:"","flex-col":"","my-3":""},Rk={flex:"","justify-center":""},Ik={flex:"","justify-center":"","mt-3":""},Ok=v("p",null," В характеристиках, противоположных Вашим Аспектам, Вы получаете ноль. Ещё четыре очка распределяются по оставшимся характеристикам. Итого Ваши значения Характеристик и бонусов Проверок: ",-1),Fk={flex:"","justify-around":""},zk={flex:"","flex-col":""},Nk={flex:"","flex-col":""},$k=v("p",null,"Почти готово! Осталось только выбрать, какие умения будут у Вашего персонажа. Нужно выбрать по одному от класса и каждого Аспекта, суммарно три.",-1),Bk=["onClick"],Vk=["onClick"],Hk=["onClick"],Uk={flex:"","justify-between":""},jk={key:3},Wk={flex:"","justify-start":"",class:"items-center"},Gk=["onClick"],qk=["src"],Yk={flex:"","mt-3":"","mx-2":"","pr-2":"","bg-slate-800":"","rounded-lg":"","overflow-hidden":""},Xk=["src"],Kk={"w-full":"","pl-2":"",flex:"","flex-col":"","justify-between":""},Jk={flex:"","justify-between":""},Zk={"text-3xl":"","font-bold":"","text-white":""},Qk={key:0,flex:"","justify-between":""},e3={flex:"","justify-between":"",class:"items-center"},t3={flex:"","justify-between":"","p-2":""},i3={"mx-2":"","my-1":"","p-2":"","bg-white":"",flex:"","justify-between":""},r3=v("defence-col",{flex:"","flex-col":"",class:"basis-1/4","text-left":""},[v("defence-desc",null," Защита "),v("defence-val",null," Удары "),v("defence-val",null," Снаряды ")],-1),n3={flex:"","flex-col":"","text-center":"",class:"basis-1/4"},s3=v("defence-desc",null," Фронт ",-1),o3={flex:"","flex-col":"",class:"basis-1/4"},a3=v("defence-desc",null," Фланг ",-1),l3={flex:"","flex-col":"",class:"basis-1/4"},c3=v("defence-desc",null," Тыл ",-1),d3={flex:"","mx-2":"","my-1":"","p-2":"","bg-sky-100":""},u3={flex:"","flex-col":"",class:"basis-96"},h3=v("dif-name",null,null,-1),f3=v("dif-name",null,null,-1),p3=v("check-divider",null,null,-1),m3=v("check-name",null," Конфликт ",-1),g3=v("check-name",null," Порядок ",-1),v3=v("check-name",null," Влияние ",-1),b3=v("check-name",null," Коварство ",-1),y3=v("check-name",null," Диверсия ",-1),_3=v("check-name",null," Поиск ",-1),w3={block:"","overflow-x-auto":"",class:"no-scrollbar-1"},x3={flex:"","flex-row":""},S3={flex:""},M3=v("check-divider",null,null,-1),E3={flex:"",class:"justify-between"},k3=["onClick"],C3={"text-center":""},T3=["onUpdate:modelValue"],A3={flex:"","justify-between":""},L3={flex:"","justify-center":"","items-center":""},D3=["onUpdate:modelValue"],P3={flex:"","justify-center":"","items-center":""},R3=["onUpdate:modelValue"],I3={flex:"","justify-center":"","items-center":""},O3=["onUpdate:modelValue"],F3={block:""},z3=["onUpdate:modelValue"],N3=["onUpdate:modelValue"],$3={flex:"","flex-col":"","m-2":""},B3={block:""},V3={data:()=>({detail_levels:[{id:"more_details",text:"Подробно",icon:"mdi:text-long"},{id:"med_details",text:"Средне",icon:"mdi:text"},{id:"no_details",text:"Коротко",icon:"mdi:text-short"}],detail_level:1,dicebox_shown:!0,isRed:!1,my_characters:lo([]),char_chosen:0,state:"overview",editor_step:0,male_gender:!0,editor_char_name:"",classSelected:{},classSelectedKey:"",raceSelected:{},raceSelectedKey:"",character_selected:null,editor_traits_chosen:{first:{},second:{},third:{}},chosenClass:{},editorAttrs:{might:0,reason:0,charisma:0,trickery:0,intuition:0,perception:0},race:null,aspects:[],attrs:{might:0,reason:0,charisma:0,trickery:0,intuition:0,perception:0},skillpoints:10,hp_type:"simple",max_hp:8,max_steps:4,curr_hp:8,editorActive:!0,equips:{first:{name:"Ближний бой",attack:0,defence_melee:0,defence_ranged:0,attacks:[{score:3,text:"лёгкий урон"},{score:6,text:"точный удар"},{score:9,text:"тяжёлый урон"},{score:12,text:"мощный точный удар"},{score:18,text:"сокрушительный удар"}],notes:["Пробивает броню","Красиво выглядит"]},second:{name:"Дальний бой",attack:0,defence_melee:0,defence_ranged:0,attacks:[{score:3,text:"лёгкий урон"},{score:6,text:"точный удар"},{score:9,text:"тяжёлый урон"},{score:12,text:"мощный точный удар"},{score:18,text:"сокрушительный удар"}],notes:["Пробивает броню","Полное действие на перезарядку"]}},equip_chosen:"first",characterToEdit:{},characterToEditIndex:null}),computed:{gender(){return this.male_gender?"m":"f"},checks(){let i={};return this.character_selected==null?{}:(i.attack=this.currentChar.attrs.might+Math.floor((this.currentChar.attrs.reason+this.currentChar.attrs.perception)/2),i.order=this.currentChar.attrs.reason+Math.floor((this.currentChar.attrs.might+this.currentChar.attrs.charisma)/2),i.impact=this.currentChar.attrs.charisma+Math.floor((this.currentChar.attrs.reason+this.currentChar.attrs.trickery)/2),i.defence=this.currentChar.attrs.trickery+Math.floor((this.currentChar.attrs.charisma+this.currentChar.attrs.intuition)/2),i.sabotage=this.currentChar.attrs.intuition+Math.floor((this.currentChar.attrs.trickery+this.currentChar.attrs.perception)/2),i.research=this.currentChar.attrs.perception+Math.floor((this.currentChar.attrs.intuition+this.currentChar.attrs.might)/2),i)},editorChecks(){let i={};return i.attack=this.editorAttrs.might+Math.floor((this.editorAttrs.reason+this.editorAttrs.perception)/2),i.order=this.editorAttrs.reason+Math.floor((this.editorAttrs.might+this.editorAttrs.charisma)/2),i.impact=this.editorAttrs.charisma+Math.floor((this.editorAttrs.reason+this.editorAttrs.trickery)/2),i.defence=this.editorAttrs.trickery+Math.floor((this.editorAttrs.charisma+this.editorAttrs.intuition)/2),i.sabotage=this.editorAttrs.intuition+Math.floor((this.editorAttrs.trickery+this.editorAttrs.perception)/2),i.research=this.editorAttrs.perception+Math.floor((this.editorAttrs.intuition+this.editorAttrs.might)/2),i},defence(){let i={};return i.melee_front=ur[Math.floor((this.currentChar.checks.defence+this.currentChar.armor_defence+this.currentChar.equips[this.currentChar.equip_chosen].defence_melee)/3)*3+6],i.ranged_front=ur[Math.floor((this.currentChar.checks.defence+this.currentChar.armor_defence+this.currentChar.equips[this.currentChar.equip_chosen].defence_ranged)/3)*3+6],i.melee_side=ur[Math.floor((this.currentChar.checks.defence+this.currentChar.armor_defence+this.currentChar.equips[this.currentChar.equip_chosen].defence_melee/2)/3)*3+3],i.ranged_side=ur[Math.floor((this.currentChar.checks.defence+this.currentChar.armor_defence+this.currentChar.equips[this.currentChar.equip_chosen].defence_ranged/2)/3)*3+3],i.melee_back=ur[Math.floor((this.currentChar.checks.defence/2+this.currentChar.armor_defence)/3)*3],i.ranged_back=ur[Math.floor((this.currentChar.checks.defence/2+this.currentChar.armor_defence)/3)*3],i},check_diffs_structured(){let i=[];return iS.forEach(e=>{let t=e;t.subcat=[];let r="";Object.entries(e.sub).forEach(([n,s])=>{let o={label:n,number:s,name:ur[s].name,short:ur[s].short,class:ur[s].class};t.subcat.push(o),n==""&&(r=o.class)}),t.class=r,i.push(t)}),i},currentChar(){return this.character_selected==null?{}:this.my_characters[this.character_selected]},skillpointsTotal(){return(this.characterToEdit.level-1)*4},skillpointsFree(){return this.skillpointsTotal-this.characterToEdit.skillpointsUsed},traitsAvailable(){let i=[];return Object.entries(gt).forEach(([e,t])=>{this.characterToEdit.aspects.includes(e)&&i.push(t.traits)}),i}},methods:{modifyAttr(i,e){this.editorActive&&(this.attrs[i]+=e,this.skillpoints-=e*2)},scrollToTop(){window.scrollTo(0,0)},chooseEquip(i){this.my_characters[this.character_selected].equip_chosen=i},nextEditorStep(){this.editor_step+=1,this.scrollToTop()},prevEditorStep(){this.editor_step-1>0&&(this.editor_step-=1),this.scrollToTop()},classSelect(i,e){this.editor_step=4,this.classSelected=i,this.classSelectedKey=e,this.scrollToTop()},raceSelect(i,e){this.editor_step=2,this.raceSelected=i,this.raceSelectedKey=e,this.scrollToTop()},chooseClass(){this.nextEditorStep(),this.chosenClass=this.classSelected,this.aspects=this.classSelected.aspects,this.editorAttrs={might:0,reason:0,charisma:0,trickery:0,intuition:0,perception:0},this.editorAttrs[gt[this.aspects[0]].attr]=6,this.editorAttrs[gt[this.aspects[1]].attr]=4;let i=[];Object.entries(gt).forEach(([t,r])=>{t!=gt[this.aspects[0]].opposite&&t!=gt[this.aspects[1]].opposite&&t!=gt[this.aspects[0]].id&&t!=gt[this.aspects[1]].id&&i.push(r.attr)});let e=4/i.length;i.forEach(t=>{this.editorAttrs[t]=e})},chooseRace(i,e,t){this.race=i,this.max_hp=e,this.max_steps=t,this.curr_hp=e},swapStrongestAttributes(){let i=this.editorAttrs[gt[this.aspects[0]].attr];this.editorAttrs[gt[this.aspects[0]].attr]=this.editorAttrs[gt[this.aspects[1]].attr],this.editorAttrs[gt[this.aspects[1]].attr]=i},wound(i){this.my_characters[this.character_selected].curr_hp-=i,this.my_characters[this.character_selected].curr_hp<0&&(this.my_characters[this.character_selected].curr_hp=0)},heal(i){this.my_characters[this.character_selected].curr_hp+=i,this.my_characters[this.character_selected].curr_hp>this.my_characters[this.character_selected].max_hp&&(this.my_characters[this.character_selected].curr_hp=this.my_characters[this.character_selected].max_hp)},startCharCreation(){this.state="char_creation",this.editor_step=1},finishCharCreation(){let i={name:this.editor_char_name,class:this.classSelected.id,classes:[this.classSelected.id],aspects:this.aspects,gender:this.gender,attrs:JSON.parse(JSON.stringify(this.editorAttrs)),checks:JSON.parse(JSON.stringify(this.editorChecks)),max_hp:this.raceSelected.max_hp,curr_hp:this.raceSelected.max_hp,equips:JSON.parse(JSON.stringify(this.equips)),equip_chosen:this.equip_chosen,armor_defence:0,bursts:this.raceSelected.bursts,max_bursts:this.raceSelected.bursts,armor:this.raceSelected.armor,movement:this.raceSelected.movement,movement_result:this.raceSelected.movement,traits:[this.editor_traits_chosen.first,this.editor_traits_chosen.second,this.editor_traits_chosen.third]};this.state="overview",this.my_characters.push(i),localStorage.setItem("my_characters",JSON.stringify(this.my_characters))},deleteCharacter(i){this.my_characters.splice(i,1),this.state="overview"},editCharacter(i){this.characterToEdit=JSON.parse(JSON.stringify(this.my_characters[i])),typeof this.characterToEdit.level>"u"&&(this.characterToEdit.level=1),typeof this.characterToEdit.skillpointsUsed>"u"&&(this.characterToEdit.skillpointsUsed=0),this.characterToEdit.startingAttrs=JSON.parse(JSON.stringify(this.characterToEdit.attrs)),typeof this.characterToEdit.checks>"u"&&(this.characterToEdit.checks=this.getCheckValues(this.characterToEdit.attrs)),typeof this.characterToEdit.movement_result>"u"&&(this.characterToEdit.movement_result=this.characterToEdit.movement),this.characterToEditIndex=i,this.state="character-edit"},saveEditedCharacter(i){this.characterToEdit.checks=this.getCheckValues(this.characterToEdit.attrs),this.my_characters[i]=JSON.parse(JSON.stringify(this.characterToEdit)),this.state="overview"},selectCharacter(i){this.state="character_screen",this.character_selected=i},turnStarts(){},turnEnds(){this.my_characters[this.character_selected].bursts=this.my_characters[this.character_selected].max_bursts},useBurst(){this.my_characters[this.character_selected].bursts-=1,this.my_characters[this.character_selected].bursts<0&&(this.my_characters[this.character_selected].bursts=0)},setTraitChosen(i,e){this.editor_traits_chosen[e]=i},increaseAttr(i){let e=4,t=[];this.characterToEdit.aspects.forEach(r=>{t.push(gt[r].attr)}),t.includes(i)&&(e=2),this.skillpointsFree>=e&&(this.characterToEdit.skillpointsUsed+=e,this.characterToEdit.attrs[i]+=1),this.characterToEdit.checks=this.getCheckValues(this.characterToEdit.attrs)},decreaseAttr(i){let e=4,t=[];this.characterToEdit.aspects.forEach(r=>{t.push(gt[r].attr)}),t.includes(i)&&(e=2),this.characterToEdit.attrs[i]>this.characterToEdit.startingAttrs[i]&&(this.characterToEdit.skillpointsUsed-=e,this.characterToEdit.attrs[i]-=1),this.characterToEdit.checks=this.getCheckValues(this.characterToEdit.attrs)},getCheckValues(i){let e={};return e.attack=Math.max(i.might+Math.floor((i.reason+i.perception)/2),Math.floor(i.trickery/2)),e.order=Math.max(i.reason+Math.floor((i.might+i.charisma)/2),Math.floor(i.intuition/2)),e.impact=Math.max(i.charisma+Math.floor((i.reason+i.trickery)/2),Math.floor(i.perception/2)),e.defence=Math.max(i.trickery+Math.floor((i.charisma+i.intuition)/2),Math.floor(i.might/2)),e.sabotage=Math.max(i.intuition+Math.floor((i.trickery+i.perception)/2),Math.floor(i.reason/2)),e.research=Math.max(i.perception+Math.floor((i.might+i.intuition)/2),Math.floor(i.charisma/2)),e}},mounted(){Ub();let i=localStorage.getItem("CHARS");i=="undefined"?this.$CHARS.value={}:(i=JSON.parse(i),i==null?this.$CHARS.value={}:this.$CHARS.value=i);let e=JSON.parse(localStorage.getItem("detail_level"));e!==null&&(this.detail_level=e)},watch:{"$CHARS.value":{handler:(i,e)=>{localStorage.setItem("CHARS",JSON.stringify(i))},deep:!0},my_characters:{handler:(i,e)=>{localStorage.setItem("my_characters",JSON.stringify(i))},deep:!0},detail_level:{handler:(i,e)=>{localStorage.setItem("detail_level",JSON.stringify(i))}}}},H3=Object.assign(V3,{__name:"App",setup(i){return(e,t)=>{const r=st("Icon");return P(),z(be,null,[v("header",u2,[v("nav-links",h2,[H(Ee(Ul),{to:"/"},{default:K(()=>[f2,p2]),_:1}),H(Ee(Ul),{to:"/wiki"},{default:K(()=>[H(r,{icon:"game-icons:bookmarklet"}),m2]),_:1}),H(Ee(Ul),{to:"/new-character"},{default:K(()=>[H(r,{icon:"game-icons:invisible"}),g2]),_:1})]),v("head-controls",null,[v("a",{onClick:t[0]||(t[0]=n=>e.detail_level=(e.detail_level+1)%e.detail_levels.length),"min-w-16":""},[H(r,{icon:e.detail_levels[e.detail_level].icon},null,8,["icon"]),v("tip",null,U(e.detail_levels[e.detail_level].text),1)])])]),v("main-content",{"w-full":"",flex:"","flex-col":"","pt-16":"",class:Se(e.detail_levels[e.detail_level].id)},[H(Ee(ob))],2),Le("",!0),At(v("header",null,[v("div",v2,[v("div",b2,[e.state=="character-edit"?(P(),z("character-edit",y2,[_2,v("name-select",w2,[v("div",x2,[At(v("input",{class:"peer w-full h-full bg-transparent text-blue-900 font-sans font-normal outline outline-0 focus:outline-0 disabled:bg-gray-50 disabled:border-0 transition-all placeholder-shown:border placeholder-shown:border-blue-400 placeholder-shown:border-t-blue-00 border-2 focus:border-2 border-t-transparent focus:border-t-transparent text-sm px-3 py-2.5 rounded-[7px] border-blue-400 focus:border-sky-600",placeholder:" ","onUpdate:modelValue":t[1]||(t[1]=n=>e.characterToEdit.name=n)},null,512),[[qt,e.characterToEdit.name]]),S2])]),v("experience-block",M2,[v("level-editor",E2,[At(v("input",{type:"number",class:"peer w-full h-full bg-transparent text-blue-900 font-sans font-normal outline outline-0 focus:outline-0 disabled:bg-gray-50 disabled:border-0 transition-all placeholder-shown:border placeholder-shown:border-blue-400 placeholder-shown:border-t-blue-500 border-2 focus:border-2 border-t-transparent focus:border-t-transparent text-sm px-3 py-2.5 rounded-[7px] border-blue-400 focus:border-sky-600",placeholder:" ","onUpdate:modelValue":t[2]||(t[2]=n=>e.characterToEdit.level=n)},null,512),[[qt,e.characterToEdit.level]]),k2]),v("skillpoints-info",C2,[he(" Очков развития: "),v("span",T2,U(e.skillpointsFree),1)])]),A2,v("attr-block",L2,[v("attrs-col",D2,[(P(!0),z(be,null,Fe(gt,n=>(P(),z("single-attr",P2,[H(r,{icon:"ph:minus-square-fill","text-2xl":"","color-slate-400":"",onClick:s=>e.decreaseAttr(n.attr)},null,8,["onClick"]),v("spec-span",R2,U(Br[n.attr])+": "+U(e.characterToEdit.attrs[n.attr]),1),H(r,{icon:"ph:plus-square-fill","text-2xl":"","color-slate-400":"",onClick:s=>e.increaseAttr(n.attr)},null,8,["onClick"])]))),256))]),v("checks-col",I2,[(P(!0),z(be,null,Fe(gt,n=>(P(),z("single-check",O2,[v("spec-span",F2,U(Br[n.checks])+": ",1),he(),v("span",z2,U(e.characterToEdit.checks[n.checks]),1)]))),256))])]),N2,v("armor-block",$2,[v("defence-block",B2,[H(r,{icon:"grommet-icons:shield","text-3xl":"","text-black":""}),v("defence-editor",V2,[At(v("input",{type:"number",class:"peer w-full h-full bg-transparent text-blue-900 font-sans font-normal outline outline-0 focus:outline-0 disabled:bg-gray-50 disabled:border-0 transition-all placeholder-shown:border placeholder-shown:border-blue-400 placeholder-shown:border-t-blue-500 border-2 focus:border-2 border-t-transparent focus:border-t-transparent text-sm px-3 py-2.5 rounded-[7px] border-blue-400 focus:border-sky-600",placeholder:" ","onUpdate:modelValue":t[3]||(t[3]=n=>e.characterToEdit.armor_defence=n)},null,512),[[qt,e.characterToEdit.armor_defence]]),H2])]),v("resist-block",U2,[H(r,{icon:"game-icons:shoulder-armor","text-3xl":"","text-black":""}),v("resist-editor",j2,[At(v("input",{type:"number",class:"peer w-full h-full bg-transparent text-blue-900 font-sans font-normal outline outline-0 focus:outline-0 disabled:bg-gray-50 disabled:border-0 transition-all placeholder-shown:border placeholder-shown:border-blue-400 placeholder-shown:border-t-blue-500 border-2 focus:border-2 border-t-transparent focus:border-t-transparent text-sm px-3 py-2.5 rounded-[7px] border-blue-400 focus:border-sky-600",placeholder:" ","onUpdate:modelValue":t[4]||(t[4]=n=>e.characterToEdit.armor=n)},null,512),[[qt,e.characterToEdit.armor]]),W2])]),v("slow-block",G2,[H(r,{icon:"fluent:hexagon-three-16-regular","text-3xl":"","text-black":""}),v("slow-editor",q2,[At(v("input",{type:"number",class:"peer w-full h-full bg-transparent text-blue-900 font-sans font-normal outline outline-0 focus:outline-0 disabled:bg-gray-50 disabled:border-0 transition-all placeholder-shown:border placeholder-shown:border-blue-400 placeholder-shown:border-t-blue-500 border-2 focus:border-2 border-t-transparent focus:border-t-transparent text-sm px-3 py-2.5 rounded-[7px] border-blue-400 focus:border-sky-600",placeholder:" ","onUpdate:modelValue":t[5]||(t[5]=n=>e.characterToEdit.movement=n)},null,512),[[qt,e.characterToEdit.movement]]),Y2])])]),X2,K2,v("button-block",J2,[v("button",{onClick:t[6]||(t[6]=n=>e.saveEditedCharacter(e.characterToEditIndex)),"bg-green-500":"","border-green-700":"","shadow-none":""},"Сохранить персонажа"),v("button",{onClick:t[7]||(t[7]=n=>e.deleteCharacter(e.characterToEditIndex)),"bg-red-700":"","border-red-800":"","text-black":""}," Удалить персонажа ")])])):Le("",!0),e.state=="overview"?(P(),z("character-list",Z2,[Q2,(P(!0),z(be,null,Fe(e.my_characters,(n,s)=>(P(),z("character-block",{"justify-between":"","mt-3":"","mx-2":"","pr-2":"","bg-slate-800":"","rounded-lg":"","overflow-hidden":"",flex:"",key:s},[v("portrait-scheme",eE,[tE,v("img",{onClick:o=>e.selectCharacter(s),src:"img/portraits/"+n.class+"_"+n.gender+".jpg","inline-block":"",class:"w-[80px] h-[80px] hexagon absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"},null,8,iE)]),v("character-meta",rE,[v("div",nE,[v("div",sE,[v("h1",oE,U(n.name),1),v("bursts-block",aE,[(P(!0),z(be,null,Fe(n.bursts,o=>(P(),Ge(r,{class:"text-yellow-400","text-3xl":"",icon:"game-icons:fire-dash"}))),256))])]),v("health-block",null,[e.hp_type=="simple"?(P(),z("simple-hp",lE,[(P(!0),z(be,null,Fe(n.max_hp,o=>(P(),z("hp-point",{class:Se({filled:o<=n.curr_hp,small:n.max_hp>10})},null,2))),256))])):Le("",!0)]),v("additional-block",cE,[v("div",dE,[v("armor-info-block",uE,[H(r,{icon:"game-icons:shoulder-armor","text-xl":"","text-white":""}),he(" "+U(n.armor),1)]),v("movement-info-block",hE,[H(r,{icon:"fluent:hexagon-three-16-regular","text-xl":"","text-white":""}),he(" "+U(n.movement),1)])]),v("div",null,[H(r,{icon:"icon-park-outline:edit","text-blue-500":"","text-xl":"",onClick:o=>e.editCharacter(s)},null,8,["onClick"])])])])]),fE]))),128)),v("div",pE,[v("button",{"inline-block":"","m-2":"",onClick:t[8]||(t[8]=n=>e.startCharCreation())},"Новый персонаж")])])):Le("",!0),e.state=="char_creation"?(P(),z("character-edit",mE,[e.editor_step==1?(P(),z("editor-step",gE,[vE,v("races-list",bE,[(P(!0),z(be,null,Fe(void 0,(n,s)=>(P(),z("race-block",{class:"inline-block w-[32%] rounded-md overflow-hidden bg-sky-100 border-2 border-blue-400 mb-2 cursor-pointer",onClick:o=>e.raceSelect(n,s)},[v("img",{src:"img/races/"+s+".webp",class:"w-full inline-block"},null,8,_E),v("class-short-desc",wE,[v("class-name",null,U(n.name),1)])],8,yE))),256))])])):Le("",!0),e.editor_step==2?(P(),z("editor-step",xE,[v("h1",null,U(e.raceSelected.name),1),v("race-description",SE,U(e.raceSelected.desc),1),ME,he(),(P(!0),z(be,null,Fe(e.raceSelected.aspects,n=>(P(),z("spec-span",{"mr-1":"",class:Se(n)},U(gt[n].name),3))),256)),EE,v("race-info-block",kE,[v("img",{"aspect-square":"",class:"w-2/5","rounded-lg":"",src:"img/races/"+e.raceSelectedKey+".webp"},null,8,CE),v("race-stats",TE,[v("race-stat",AE,[LE,v("stat-value",DE,[H(r,{icon:"mdi:arrow-right-bold-hexagon-outline","text-4xl":"","mr-1":"","inline-block":""}),v("div",PE,U(e.raceSelected.movement),1)])]),v("race-stat",RE,[IE,v("stat-value",OE,[H(r,{icon:"game-icons:fire-dash","text-4xl":"","mr-1":"","inline-block":""}),v("div",FE,U(e.raceSelected.bursts),1)])]),v("race-stat",zE,[NE,v("stat-value",$E,[H(r,{icon:"healthicons:health","text-4xl":"","mr-1":"","inline-block":""}),v("div",BE,U(e.raceSelected.max_hp),1)])]),v("race-stat",VE,[HE,v("stat-value",UE,[H(r,{icon:"game-icons:shoulder-armor","text-4xl":"","mr-1":"","inline-block":""}),v("div",jE,U(e.raceSelected.armor),1)])])])]),v("button-block",WE,[v("button",{onClick:t[9]||(t[9]=n=>e.prevEditorStep()),back:""},"Назад"),v("button",{onClick:t[10]||(t[10]=n=>e.nextEditorStep())}," Подтвердить ")])])):Le("",!0),e.editor_step==3?(P(),z("editor-step",GE,[qE,v("char-meta",YE,[v("button",{onClick:t[11]||(t[11]=n=>e.prevEditorStep()),back:""},"Назад"),v("gender-select",XE,[KE,v("div",JE,[At(v("input",{defaultChecked:"",id:"switch-1",type:"checkbox","onUpdate:modelValue":t[12]||(t[12]=n=>e.male_gender=n),class:"absolute w-8 h-4 transition-colors duration-300 rounded-full appearance-none border-red-400 border-2 cursor-pointer peer bg-red-300 checked:bg-blue-300 checked:border-blue-400 peer-checked:before:bg-blue-500"},null,512),[[$h,e.male_gender]]),ZE]),QE])]),v("classes-list",ek,[(P(!0),z(be,null,Fe(Qp,(n,s)=>(P(),z("class-block",{class:"inline-block w-[32%] rounded-md overflow-hidden bg-sky-100 border-2 border-blue-400 mb-2 cursor-pointer",onClick:o=>e.classSelect(n,s)},[v("img",{src:"img/portraits/"+n.id+"_"+e.gender+".jpg",class:"w-full inline-block"},null,8,ik),v("class-short-desc",rk,[v("class-name",null,U(n.name),1)])],8,tk))),256))])])):e.editor_step==4?(P(),z("editor-step",nk,[v("button-block",sk,[v("button",{onClick:t[13]||(t[13]=n=>e.prevEditorStep()),back:""},"Назад"),v("button",{onClick:t[14]||(t[14]=n=>e.chooseClass())}," Выбрать этот класс! ")]),v("h1",null,U(e.classSelected.name),1),ok,he(U(e.classSelected.desc)+" ",1),ak,lk,he(),(P(!0),z(be,null,Fe(e.classSelected.aspects,n=>(P(),z("spec-span",{"mr-1":"",class:Se(n)},U(gt[n].name),3))),256)),ck,dk,he(),(P(!0),z(be,null,Fe(e.classSelected.aspects,n=>(P(),z("spec-span",uk,U(Br[gt[n].attr]),1))),256)),hk,fk,he(),(P(!0),z(be,null,Fe(e.classSelected.aspects,n=>(P(),z("spec-span",pk,U(Br[gt[n].checks]),1))),256)),mk,gk,(P(!0),z(be,null,Fe(e.classSelected.traits,n=>(P(),z("trait-block",vk,[v("trait-name",null,U(n.name),1),v("ol",bk,[(P(!0),z(be,null,Fe(n.levels,s=>(P(),z("li",null,U(s),1))),256))])]))),256)),v("button-block",yk,[v("button",{onClick:t[15]||(t[15]=n=>e.prevEditorStep()),back:""},"Назад"),v("button",{onClick:t[16]||(t[16]=n=>e.chooseClass())}," Выбрать этот класс! ")])])):e.editor_step==5?(P(),z("editor-step",_k,[wk,v("name-select",xk,[v("div",Sk,[At(v("input",{class:"peer w-full h-full bg-transparent text-blue-900 font-sans font-normal outline outline-0 focus:outline-0 disabled:bg-gray-50 disabled:border-0 transition-all placeholder-shown:border placeholder-shown:border-blue-400 placeholder-shown:border-t-blue-00 border-2 focus:border-2 border-t-transparent focus:border-t-transparent text-sm px-3 py-2.5 rounded-[7px] border-blue-400 focus:border-sky-600",placeholder:" ","onUpdate:modelValue":t[17]||(t[17]=n=>e.editor_char_name=n)},null,512),[[qt,e.editor_char_name]]),Mk])]),v("button-block",Ek,[v("button",{onClick:t[18]||(t[18]=n=>e.prevEditorStep()),back:""},"Назад"),v("button",{disabled:e.editor_char_name.length<2,onClick:t[19]||(t[19]=n=>e.chooseClass())}," Подтвердить ",8,kk)])])):e.editor_step==6?(P(),z("editor-step",Ck,[Tk,Ak,Lk,v("p",null,[he("Выбранный Вами класс силён в двух аспектах: "),(P(!0),z(be,null,Fe(e.classSelected.aspects,n=>(P(),z("spec-span",{inline:"","mr-1":"",class:Se(n)},U(gt[n].name),3))),256)),he(", а значит и в связанных с ними характеристиках: "),(P(!0),z(be,null,Fe(e.classSelected.aspects,n=>(P(),z("spec-span",{"mr-1":"",class:Se(n)},U(Br[gt[n].attr]),3))),256))]),Dk,v("div",Pk,[v("attr-block",Rk,[(P(!0),z(be,null,Fe(e.classSelected.aspects,n=>(P(),z("spec-span",{"mr-1":"","text-2xl":"",class:Se(n)},U(Br[gt[n].attr])+" = "+U(e.editorAttrs[gt[n].attr]),3))),256))]),v("button-block",Ik,[v("button",{onClick:t[20]||(t[20]=n=>e.swapStrongestAttributes()),"bg-blue-500":"","shadow-none":""}," Сменить ")]),Ok,v("attr-result",Fk,[v("attr-result-block",zk,[(P(!0),z(be,null,Fe(gt,(n,s)=>(P(),z("spec-span",{"mr-1":"","mt-1":"","text-xl":"",class:Se(s)},U(Br[n.attr])+" = "+U(e.editorAttrs[n.attr]),3))),256))]),v("check-result-block",Nk,[(P(!0),z(be,null,Fe(gt,(n,s)=>(P(),z("spec-span",{"mr-1":"","mt-1":"","text-xl":"",class:Se(s)},U(Br[n.checks])+" = "+U(e.editorChecks[n.checks]),3))),256))])])]),$k,v("h2",null," От класса "+U(e.classSelected.name)+": ",1),(P(!0),z(be,null,Fe(Qp[e.classSelectedKey].traits,n=>(P(),z("trait-to-select",{block:"","cursor-pointer":"",onClick:s=>e.setTraitChosen(n,"first"),class:Se({active:e.editor_traits_chosen.first.name==n.name})},[v("b",null,U(n.name),1),he(": "+U(n.levels[0]),1)],10,Bk))),256)),v("h2",null," От Аспекта "+U(gt[e.classSelected.aspects[0]].name)+": ",1),(P(!0),z(be,null,Fe(gt[e.classSelected.aspects[0]].traits,n=>(P(),z("trait-to-select",{block:"","cursor-pointer":"",onClick:s=>e.setTraitChosen(n,"second"),class:Se({active:e.editor_traits_chosen.second.name==n.name})},[v("b",null,U(n.name),1),he(": "+U(n.levels[0]),1)],10,Vk))),256)),v("h2",null," От Аспекта "+U(gt[e.classSelected.aspects[1]].name)+": ",1),(P(!0),z(be,null,Fe(gt[e.classSelected.aspects[1]].traits,n=>(P(),z("trait-to-select",{block:"","cursor-pointer":"",onClick:s=>e.setTraitChosen(n,"third"),class:Se({active:e.editor_traits_chosen.third.name==n.name})},[v("b",null,U(n.name),1),he(": "+U(n.levels[0]),1)],10,Hk))),256)),v("button-block",Uk,[v("button",{onClick:t[21]||(t[21]=n=>e.prevEditorStep()),back:""},"Назад"),v("button",{onClick:t[22]||(t[22]=n=>e.finishCharCreation())}," Готово!")])])):Le("",!0)])):e.state=="character_screen"?(P(),z("character-screen",jk,[v("characters-overview",Wk,[H(r,{icon:"fa6-solid:list",class:"w-1/5","text-4xl":"",onClick:t[23]||(t[23]=n=>e.state="overview")}),(P(!0),z(be,null,Fe(e.my_characters,(n,s)=>(P(),z("character-icon",{class:"w-1/5",onClick:o=>e.character_selected=s},[v("img",{src:"img/portraits/"+n.class+"_"+n.gender+".jpg","inline-block":"",class:"w-full"},null,8,qk)],8,Gk))),256))]),v("div",Yk,[v("img",{"aspect-square":"",src:"img/portraits/"+e.currentChar.class+"_"+e.currentChar.gender+".jpg","inline-block":"",class:"w-1/5"},null,8,Xk),v("div",Kk,[v("div",Jk,[v("h1",Zk,U(e.currentChar.name),1),v("bursts-block",{onClick:t[24]||(t[24]=n=>e.useBurst()),flex:"","items-center":""},[(P(!0),z(be,null,Fe(e.currentChar.bursts,n=>(P(),Ge(r,{class:"text-yellow-400","text-3xl":"",icon:"game-icons:fire-dash"}))),256))])]),v("health-block",null,[e.hp_type=="simple"?(P(),z("simple-hp",Qk,[(P(!0),z(be,null,Fe(e.currentChar.max_hp,n=>(P(),z("hp-point",{class:Se({filled:n<=e.currentChar.curr_hp,small:e.max_hp>10})},null,2))),256))])):Le("",!0)]),v("button-block",e3,[H(r,{icon:"game-icons:cross-mark",onClick:t[25]||(t[25]=n=>e.wound(9)),"text-red-800":"","text-3xl":""}),H(r,{icon:"game-icons:open-wound",onClick:t[26]||(t[26]=n=>e.wound(3)),"text-red-600":"","text-3xl":""}),H(r,{icon:"game-icons:rough-wound",onClick:t[27]||(t[27]=n=>e.wound(1)),"text-red-500":"","text-3xl":""}),H(r,{icon:"material-symbols:more-time",onClick:t[28]||(t[28]=n=>e.heal(3)),"text-blue-600":"","text-3xl":""})])])]),v("button-block",t3,[v("button",{"bg-green-600":"","border-green-800":"","text-xl":"","shadow-none":"",onClick:t[29]||(t[29]=n=>e.turnStarts())},"Начало хода"),v("button",{"bg-blue-400":"","border-blue-600":"","text-xl":"","shadow-none":"",onClick:t[30]||(t[30]=n=>e.turnEnds())},"Конец хода")]),v("defence-block",i3,[r3,v("defence-col",n3,[s3,v("defence-val",{class:Se(e.defence.melee_front.class)},U(e.defence.melee_front.name),3),v("defence-val",{class:Se(e.defence.ranged_front.class)},U(e.defence.ranged_front.name),3)]),v("defence-col",o3,[a3,v("defence-val",{class:Se(e.defence.melee_side.class)},U(e.defence.melee_side.name),3),v("defence-val",{class:Se(e.defence.ranged_side.class)},U(e.defence.ranged_side.name),3)]),v("defence-col",l3,[c3,v("defence-val",{class:Se(e.defence.melee_back.class)},U(e.defence.melee_back.name),3),v("defence-val",{class:Se(e.defence.ranged_back.class)},U(e.defence.ranged_back.name),3)])]),v("checks-table",d3,[v("check-labels",u3,[h3,f3,v("check-name",null,U(e.currentChar.equips.first.name),1),v("check-name",null,U(e.currentChar.equips.second.name),1),p3,m3,g3,v3,b3,y3,_3]),v("check-values-wrap",w3,[v("check-values",x3,[(P(!0),z(be,null,Fe(e.check_diffs_structured,(n,s)=>(P(),z(be,null,[n.label!=="Нулевая"&&n.label!=="Плохая"?(P(),z("check-cat",{key:0,flex:"","flex-col":"",class:Se(n.class)},[v("cat-name",null,U(n.label),1),v("cat-cols",S3,[(P(!0),z(be,null,Fe(n.subcat,o=>(P(),z("check-column",{flex:"","flex-col":"",class:Se(o.class)},[v("dif-name",null,U(o.label),1),v("check-value",null,U(e.currentChar.equips.first.attack+e.checks.attack-o.number),1),v("check-value",null,U(e.currentChar.equips.second.attack+e.checks.attack-o.number),1),M3,(P(!0),z(be,null,Fe(e.currentChar.checks,(a,l)=>(P(),z("check-value",null,[o.number-a>12?(P(),Ge(r,{key:0,icon:"icomoon-free:cross"})):o.number-a<2?(P(),Ge(r,{key:1,icon:"fa:check"})):(P(),z(be,{key:2},[he(U(o.number-a),1)],64))]))),256))],2))),256))])],2)):Le("",!0)],64))),256))])])]),v("equips-table",E3,[(P(!0),z(be,null,Fe(e.my_characters[e.character_selected].equips,(n,s)=>(P(),z("equip-table",{flex:"","flex-col":"",class:Se(["flex-1 w-1/2",{active:s==e.currentChar.equip_chosen}]),"bg-white":"","mx-2":"","my-1":"","p-2":"",onClick:o=>e.chooseEquip(s)},[v("equip-name",C3,[At(v("input",{type:"text","onUpdate:modelValue":o=>n.name=o,"px-2":"","text-center":"","outline-none":"",class:"w-3/4"},null,8,T3),[[qt,n.name]])]),v("equip-stats",A3,[v("equip-attack",L3,[H(r,{icon:"ph:sword-fill"}),At(v("input",{type:"number","onUpdate:modelValue":o=>n.attack=o,"ml-1":"","mr-2":"",class:"w-1/2"},null,8,D3),[[qt,n.attack]])]),v("equip-melee-defence",P3,[H(r,{icon:"mdi:shield-sword"}),At(v("input",{type:"number","onUpdate:modelValue":o=>n.defence_melee=o,"ml-1":"","mr-2":"",class:"w-1/2"},null,8,R3),[[qt,n.defence_melee]])]),v("equip-ranged-defence",I3,[H(r,{icon:"game-icons:arrows-shield"}),At(v("input",{type:"number","onUpdate:modelValue":o=>n.defence_ranged=o,"ml-1":"",class:"w-1/2"},null,8,O3),[[qt,n.defence_ranged]])])]),v("equip-attacks",null,[(P(!0),z(be,null,Fe(n.attacks,(o,a)=>(P(),z("equip-attack",F3,[At(v("input",{type:"number",class:"w-1/6","onUpdate:modelValue":l=>e.my_characters[e.character_selected].equips[s].attacks[a].score=l},null,8,z3),[[qt,e.my_characters[e.character_selected].equips[s].attacks[a].score]]),he("- "),At(v("input",{class:"w-3/4",type:"text","onUpdate:modelValue":l=>e.my_characters[e.character_selected].equips[s].attacks[a].text=l},null,8,N3),[[qt,e.my_characters[e.character_selected].equips[s].attacks[a].text]])]))),256))])],10,k3))),256))]),v("traits-table",$3,[(P(!0),z(be,null,Fe(e.my_characters[e.character_selected].traits,n=>(P(),z("trait-block",null,[v("b",B3,U(n.name)+":",1),v("p",null,U(n.levels[0]),1)]))),256))])])):Le("",!0)])])],512),[[jv,!1]])],64)}}}),U3="modulepreload",j3=function(i){return"/trip/"+i},Am={},W3=function(e,t,r){let n=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),o=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));n=Promise.all(t.map(a=>{if(a=j3(a),a in Am)return;Am[a]=!0;const l=a.endsWith(".css"),c=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${c}`))return;const d=document.createElement("link");if(d.rel=l?"stylesheet":U3,l||(d.as="script",d.crossOrigin=""),d.href=a,o&&d.setAttribute("nonce",o),document.head.appendChild(d),l)return new Promise((u,h)=>{d.addEventListener("load",u),d.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${a}`)))})}))}return n.then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})},Jr={human:{name:"Человек",aspects:["war","knowledge"],desc:"Люди живут достаточно долго, чтобы плоды их жизней сохранялись между поколениями, но недостаточно - чтобы ценить свою жизнь превыше всего. Они строят величественные города и развивают науки и ремёсла, так же охотно ведут разрушительные войны и уничтожают природу. Быстро плодящиеся и быстро прожигающие свои жизни, люди, увы - будущее почти каждого мира, в котором их не истребили сразу же.",movement:4,bursts:2,armor:0,max_hp:10,subrace_text:"Люди - самая гибкая из существующих рас, если говорить о мировоззрениях и убеждениях. Подвиды в их случае обусловлены не биологией, а скорее культурой и средой, в которых им довелось вырасти:",subraces:{barbaric:{aspect:"war",name:"Варвары"},clever:{aspect:"knowledge",name:"Мастера"},wild:{aspect:"nature",name:"Странники"},city:{aspect:"society",name:"Граждане"},criminal:{aspect:"shadow",name:"Преступные"},esoteric:{aspect:"mystics",name:"Возвышенные"}}},elf:{name:"Эльф",aspects:["nature","knowledge"],desc:"Если какой-то мир сравнивать со стрелой, летящей из прошлого в будущее, то эльфы - его оперение. Живущие невероятно долго, они лучше других помнят ошибки прошлых эпох и стремятся сделать так, чтобы они не повторялись. К сожалению, одновременно с этим эльфы часто выступают противниками прогресса. Их тела довольно слабы, но зато за многие десятилетия они учатся управлять ими лучше других.",movement:5,bursts:2,armor:0,max_hp:8,subrace_text:"Не всегда легко определить подвид эльфа, который стоит перед тобой, а ошибка может нанести ему смертельное оскобление. Никто не знает, как давно этот народ разделился на разные ветви, но даже спустя многие тысячелетия они ревностно чтут своё наследие:",subraces:{blood:{aspect:"war",name:"Кровавые"},high:{aspect:"knowledge",name:"Высшие"},wood:{aspect:"nature",name:"Лесные"},sun:{aspect:"society",name:"Солнечные"},night:{aspect:"shadow",name:"Ночные"},moon:{aspect:"mystics",name:"Лунные"}}},dwarf:{name:"Дворф",aspects:["war","society"],desc:"Дворфов очень удобно сравнивать с камнем, возле которого они проводят всю свою жизнь. Крепкие как камень, долговечные, и... увы, такие же твердолобые. Традиции и законы для них значат чуть ли не больше чем для эльфов. Подгорный народ прекрасно умеет воевать, но редко ведёт боевые действия на поверхности. В узких пещерах их медлительность не угрожает успеху кампаний, а вот в чистом поле...",movement:3,bursts:2,armor:0,max_hp:12},gnome:{name:"Гном",aspects:["knowledge","society"],desc:"Зачастую живущие в одних и тех же поселениях с дворфами, гномы обладают совершенно другим нравом. Да и их руки и головы гораздо больше подходят для мастерских, библиотек и лабораторий, а не для полей сражений. Их гораздо меньше, чем их крепких соседей, но говорят что больше трёх четвертей всех изобретений коротышек совершили именно они.",movement:4,bursts:2,armor:0,max_hp:10},orc:{name:"Орк",aspects:["war","nature"],desc:"Большие и сильные, крепкие и воинственные... но не очень то умные. Конечно, отдельные представители народа орков бывают так же талантливы, как лучшие из людей или эльфов, но очень редко они успевают реализовать свой талант за короткую жизнь. Умные орки чаще всего становятся военачальниками, а не учёными. История запоминает их как тех, кто нёс великое горе другим народам, а не великое счастье - своему.",movement:3,bursts:2,armor:0,max_hp:12},hobbit:{name:"Полурослик",aspects:["knowledge","shadow"],desc:"Настолько маленькие, что никто не воспринимает их всерьёз... и совершенно напрасно. Хоббиты, полурослики, хафлинги - как их не называй, каких не придумай обидных прозвищ, приходится признавать, что эти существа чертовски хорошо умеют выживать. Умелые земледельцы, ремесленники и торговцы, они ещё и прекрасно плетут интриги всех сортов. В воровских гильдиях уже давно перестали удивляться тому, что главой над грозыми орками может оказаться кроха-полурослик.",movement:5,bursts:2,armor:0,max_hp:8},tiefling:{name:"Тифлинг",aspects:["society","shadow"],desc:"Ведущие свою родословную то ли от демонов-искусителей, то ли от какой-то другой не менее мистической сущности, тифлинги чертовски хороши в обольщении. Учёные мужи так и не сумели найти никакой магии в их талантах, похоже они просто такие же милые и приятные как... щенки или котята. Быть сладкоречивым и улыбчивым для них - часть природы. С их рогами, клыками и хвостами - иные просто не выжили в более дикую эпоху.",movement:4,bursts:2,armor:0,max_hp:10},drow:{name:"Дроу",aspects:["mystics","shadow"],desc:"Дроу, или как их ещё называют, тёмные эльфы, вероятно и вправду приходятся родственниками обычным, надземным эльфам. Но если так, то очень далёкими. Их тела совсем не так долговечны, а тягу к наукам и ремёслам в их головах заменило влечение к потустороннему и непознанному. В их собственной культуре почти отстутствует понятие закона, потому преступная деятельность даётся им лучше многих других.",movement:4,bursts:2,armor:0,max_hp:10},goblin:{name:"Гоблин",aspects:["nature","shadow"],desc:"Гоблины - крайне хрупкие существа, которые, тем не менее, умудряются выгрызать себе место под солнцем. Их общество очень жестоко, но выживают в нём не самые сильные, а самые хитрые и коварные. Ничуть не удивительно, что большинство выбирает своей стезёй путь воровства и разбоя. А если прибавить к этому умелые руки и врождённую смекалку - получим поистинне взрывоопасную смесь.",movement:3,bursts:3,armor:0,max_hp:6},duergar:{name:"Дуэргар",aspects:["mystics","society"],desc:"Таинственная раса серых дворфов или дуэргаров отличается жутковатым внешним видом и таким же нравом. Они живут много ниже других подземных собратьев и не терпят гостей на своей территории. На поверхности, соответственно, появляются ещё реже, но когда это всё же происходит, нередко несут с собой свою странную веру.",movement:3,bursts:2,armor:0,max_hp:12},animal:{name:"Зверораса",aspects:["nature","mystics"],desc:"Зверорасы - общее название для довольно большого количества разных видов, все из которых можно описать как смесь чего-то гуманоидного с каким-то животным. У разных из них разные особенности, но почти всегда они достаточно быстры и стремительны, но при этом не особенно крепки телом.",movement:5,bursts:2,armor:0,max_hp:8},magical:{name:"Магические",aspects:["war","mystics"],desc:"Некоторые из магических существ - наследники боевых химер, выведенных учёными прошлого. Другие - потомки тех, кому повезло выжить в аномалии и оставить потомство. Так или иначе, сейчас мало кто из них может похвастаться особыми волшебными способностями... кроме одной. Пока все остальные состоят из плоти и крови, они - из плоти, крови и магии. Ранить такого - значительно сложнее.",movement:4,bursts:2,armor:1,max_hp:8}},Sr={youth:{name:{m:"Юный",f:"Юная"},bursts:1,movement:1,max_hp:2,bonus_xp:0,xp:3,steps:0},young:{name:{m:"Молодой",f:"Молодая"},bursts:0,movement:1,max_hp:0,bonus_xp:0,xp:4,steps:1},mature:{name:{m:"Средний",f:"Средняя"},bursts:0,movement:0,max_hp:0,bonus_xp:4,xp:4,steps:3},senior:{name:{m:"Пожилой",f:"Пожилая"},bursts:0,movement:-1,max_hp:-2,bonus_xp:6,xp:4,steps:4},elder:{name:{m:"Древний",f:"Древняя"},bursts:0,movement:-2,max_hp:-4,bonus_xp:12,xp:4,steps:6}},yt={knowledge:{id:"knowledge",icon:"game-icons:open-book",name:"Знания",attr:"reason",opposite:"mystics",checks:"order",check_icon:"game-icons:materials-science",attr_icon:"game-icons:inspiration",traits:[{name:"Образование",desc:"",levels:["Получив хорошую обучающую книгу о каком-то навыке, Вы можете научиться его первому уровню, затратив на это не менее месяца времени. Обучение обойдётся Вам в одно очко повышения, если у Вас нет необходимого класса или бесплатно, если он есть. Вы не можете таким образом изучать навыки противоположных аспектов (или их смежные)","Найдя хорошего мастера навыка (владеющего его третьей ступенью), Вы можете научиться второму уровню. На это Вам и Вашему учителю придётся потратить как минимум месяц времени. Это обойдётся Вам в два очка повышения, если у Вас нет необходимого класса или бесплатно, если он есть. ","Вы можете обучать других тем навыкам, которыми владеете сами. Вам и Вашему ученику потребуется не менее месяца, а обучаемый так же потратит одно очко повышения за уровень навыка, если у него нет необходимого класса. Вашему ученику не обязательно иметь навык “Образование”. На этом уровне Вы можете обучаться навыкам противоположных аспектов. "]},{name:"Живой ум",desc:"",levels:["Ваш пытливый ум позволяет Вам быстрее разбираться в любых сферах знаний, которыми владеют разумные. Поиск информации в книгах и библиотеках для Вас на две категории проще. Вы хорошо читаете карты, Вам на одну категорию проще планировать маршрут так, чтобы избежать опасностей или выйти на желаемую точку боевой карты.","Вы постоянно подмечаете и запоминаете, Ваш разум анализирует и раскладывает по полочкам. Если Вы видите за работой специалиста гражданского профиля на протяжении хотя бы нескольких часов, все Ваши проверки по его профессии впоследствии на одну категорию проще. Если он взялся обучать Вас и на это был затрачен хотя бы один день, проверки на две категории проще. Кроме того, Вы хорошо разбираетесь в общеизвестной истории, в курсе новейших открытий и изобретений."," Вы знаете и понимаете так много, что зачастую можете дать полезную подсказку даже хорошему специалисту. Если он готов принять Вашу помощь и делится своими планами или соображениями, Вы можете снизить сложность проверки на одну категорию или даже на две, если область знания принадлежит Вашему классу или смежному."]},{name:"В руках мастера",desc:"",levels:["Пока для других механизмы - просто инструмент достижения целей, для Вас это ещё и загадка, которую хочется разгадать. Починка механических устройств и обезвреживание механических ловушек с Вашей помощью легче на две категории. Кроме того, Вы можете потратить некоторое время на то, чтобы аккуратно разобрать устройство и понять, как создавать подобные в будущем. Для этого Вам нужно будет пройти проверку, тем более сложную, чем более сложное оборудование Вы разбираете. Это умение не распространяется на магические предметы и артефакты.","Большой опыт в работе с различными механизмами дал свои плоды - затратив достаточно времени Вы можете сами изобрести некое механическое устройство. Придуманный Вами предмет должен быть принципиально возможным в этом мире и должен опережать технический уровень общества не слишком сильно. Сложность проверки для попытки изобрести нечто определяется мастером. Теперь Вы можете разбирать чтобы изучить и магические предметы, а также Ваш бонус на починку и обезвреживание теперь распространяется и на магические устройства и ловушки. Вы можете создавать простые механические ловушки.","Теперь Вы можете изобретать и магические устройства и ловушки. Ваше глубокое понимание магии также даёт Вам значительный бонус к заклинаниям - теперь вызов заклинания основным действием всегда работает так, как будто Вы так же затратили один порыв."]}]},society:{id:"society",icon:"game-icons:human-pyramid",name:"Общество",opposite:"nature",attr:"charisma",checks:"impact",check_icon:"game-icons:caesar",attr_icon:"game-icons:cheerful",traits:[{name:"Всё продаётся",desc:"",levels:["Вы тонко чувствуете потребности окружающих и что они готовы отдать за желаемое. Если Вы пытаетесь выяснить мотивацию персонажа или распознать ложь, Ваши проверки на две категории проще (6). Занимаясь любой работой, Вы можете подняться на одну ступень Богатства выше, чем остальные. Скорость набора Богатства, впрочем, остаётся прежней. Если Вы живёте в городе, Ваш уровень Богатства никогда не опускается ниже Среднего (5)","Продавая добычу после боевого похода Вы можете выручить на две категории больше. Занимаясь любой работой, Вы набираете Богатство вдвое быстрее других.","Один раз в месяц Вы можете покупать предмет выше своего уровня Богатства на 1 без затрат, либо на 2 уровня, потеряв при этом только один уровень Богатства"]},{name:"Прочные связи",desc:"",levels:["Большинство окружающих, которым Вы не чинили явного зла, считают Вас как минимум приятелем (Симпатия, 1). Вы знаете как найти выходы на всех влиятельных людей Вашего поселения, а также можете за несколько дней найти общих знакомых с специалистом какой-то профессии, если он есть в Вашем поселении. Вы можете давать взятки на одну категорию меньшие, чтобы добиться того же эффекта.","Проведя хотя бы три месяца в поселении, Вы обретаете влияние, с которым приходится считаться. Ваши просьбы и угрозы звучат гораздо весомее. Вам также значительно проще искать что-то в обществе - будь это скрывающийся человек или особый товар. Проверки проще на две категории (6). Даже если Вам не удаётся найти искомое, велика вероятность что Вам дадут хотя бы наводку на того, кто может знать ответ. Помогать Вам будут только те силы и фракции, с которыми Вы как минимум не враждуете. Затраты Влияния на значительные услуги снижены на одну категорию.","Если Вы проводите в поселении хотя бы полгода, Вам удаётся наладить контакт со всеми лидерами фракций (Значительное Влияние, 3) кроме тех что к Вам враждебны. Ваше Влияние на фракции растёт с удвоенной скоростью и никогда не опускается ниже Значительного (3). Когда Вы впервые посещаете поселения, которые активно контактируют с Вашим, Вы сразу получаете преимущества второго уровня этого умения. Преимущества третьего Вы можете получить, проведя в нём месяц. Вам легче внедрять свои задумки в другие фракции, ведь во всех (даже во враждебных) у Вас есть свои люди. Эти проверки проще на две категории."]},{name:"Друг моего друга",desc:"",levels:["Имея как минимум Высокое (5) влияние на фракцию, Вы можете попросить их порекомендовать Вас кому-то. При этом Вы потратите два уровня Репутации, но приобретёте один у цели. Для этого Ваша цель должна быть в хороших отношениях с фракцией.","Вам удаётся поддерживать связь даже со знакомыми в других поселениях и государствах. Вы можете найти знакомого или знакомого знакомого почти в любом крупном поселении. В результате Ваши проверки на Поиск в других поселениях проще на две категории. Кроме того, Вы получаете информацию и новости из далёких земель значительно раньше других.","Ваш круг знакомых и друзей превращается в настоящую паутину. Ваша Репутация у невраждебных фракций в других поселениях как минимум Неплохая (2), проверки на Порядок и Диверсию проще на категорию. Если Ваш уровень Богатства как минимум Зажиточный (7), проверки становятся проще ещё на одну категорию."]}]},shadow:{id:"shadow",icon:"game-icons:cowled",name:"Тень",attr:"trickery",opposite:"war",checks:"defence",check_icon:"game-icons:hooded-figure",attr_icon:"game-icons:domino-mask",traits:[{name:"Хитрый план",desc:"",levels:["Один раз в месяц Вы можете добавить облегчить свою проверку социального Влияния, используя свою Хитрость. Сложность снижается на одну категорию за каждые три полные единицы в параметре Хитрость. Есть некая верятность, что местные власти сочтут Ваши действия незаконными.","Вы можете использовать эту способность два раза в месяц.","Теперь Вы можете использовать эту способность на проверках Диверсии"]},{name:"Военная хитрость",desc:"",levels:["Проводя первую атаку по противнику за свой ход, Вы добавляете к броску кость порыва, не затрачивая порыв, если сразу после этого разрываете дистанцию (ближний бой) или скрываетесь из виду (дальний бой).","Вы учитесь использовать быстрый отскок - затратив один порыв, Вы можете отскочить назад на две клетки. Такое действие не вызывает срабатывания реакций. ","В бою Вы можете двигаться боком с полной скоростью. Кроме того, если Вы видите как противник пытается атаковать Вас, Вы можете отреагировать за мгновение до этой атаки, если Ваша Защита превосходит его Атаку. Это распространяется даже на дистанционные атаки."]},{name:"Порхай как бабочка",desc:"",levels:["Вы научились наносить невероятно точные удары. Максимальное количество костей порыва, которые Вы можете использовать в броске атаки увеличивается до двух.","Ваша скорость передвижения увеличивается на единицу. Доступное Вам максимальное количество порывов также увеличивается на единицу.","Идеальный способ обезопасить себя - закончить бой одним невероятно точным ударом. Максимальное количество костей порыва, которые Вы можете использовать в броске атаки увеличивается до трёх."]}]},mystics:{id:"mystics",icon:"game-icons:pentacle",name:"Мистика",attr:"intuition",opposite:"knowledge",checks:"chaos",check_icon:"game-icons:small-fire",attr_icon:"game-icons:coiling-curl",traits:[{name:"Духовные практики",desc:"",levels:["Вы чувствуете мир иначе чем другие и можете находить связь там где другие её не увидят. Вы можете повысить любую характеристику на 1, пока следуете некоторой духовной практике. Это может быть аскеза, обет, небольшой ежедневный ритуал. Объясните, как эта практика мистически связана с пользой, которую Вы получаете. Вы начинаете получать преимущества когда использовали практику как минимум месяц.","Вы можете одновременно получать пользу от двух духовных практик направленных на две разные характеристики, или от одной более сложной, повышающей характеристику на 2. В обоих случаях это уже не может быть чем-то небольшим, никак не влияющим на Ваш уровень комфорта.","Погружаясь в практики всё дальше, Вы можете использовать 3 очков повышения, распределив их как угодно по трём характеристикам, выбирая значения 1, 2 или 3. Такой уровень погружения требует значительных затрат времени и ресурсов, может вызывать непонимание в обществе и иногда создавать значительные проблемы."]},{name:"Невозможные знания",desc:"",levels:["Иногда Вы просто знаете то, чего никак не могли знать. В боевых ситуациях один раз в день Вы можете задать вопрос, в ответ на который Вам явится подсказка. Вопрос должен касаться того, с чем Вы взаимодействуете или как минимум находитесь на расстоянии нескольких минут движения пешком. Подсказка должна быть правдивой, но не всегда будет точно отвечать на Ваш вопрос, иногда лишь касаться его косвенно.","Вы научились взывать к таинственному источнику знаний вселенной и вне напряжённых боевых ситуаций. Затратив месяц на поиск и обучение, Вы можете получить навык чужого аспекта или класса по обычной цене, а своего аспекта или класса - на одно очко дешевле. Вы всё ещё не можете изучать противоположные аспекты и их классы.","Направляя свой взор всё глубже внутрь себя Вы получаете всё больше знаний из таинственного источника. Любая местность для Вас - как минимум Знакомая (3). Теперь Вы можете задавать вопрос мирозданию до трёх раз в боевую сцену или за месяц другой деятельности. Вы можете потратить использование такого вопроса чтобы получить информацию о слабых местах противника, снижая его защиту от Ваших будущих атак на две категории или о слабых местах фракции или организации чтобы облегчить проверки Порядка или Диверсии на две категории"]},{name:"Капли одного моря",desc:"",levels:["Вы чувствуете необъяснимое родство с другими разумными, даже если Ваши взгляды и цели расходятся. Иногда Вы ощущаете небольшие отблески их мыслей и чувств, и умеете воспользоваться этим себе на пользу. Окружающие оценивают это как удачу, но Вы точно знаете что это навык, доступный немногим. Если на Вашем кубе д12 выпадает 3 или меньше в вопросах связанных с разумными, один раз за боевую сцену или за месяц другой деятельности Вы можете его перебросить.","Теперь Вы ощущаете подобное родство даже с дикими животными. Количество использований навыка увеличено до двух, а помимо разумных он теперь распространяется на любых живых существ."," Вы чувствуете мир вокруг как своё продолжение. Всё вокруг - лишь разные узоры на волнах единого моря реальности. Количество использований навыка увеличено до трёх, теперь Вы можете использовать его в любых проверках, в том числе связанных с магией, стихиями, духами и прочим."]}]},nature:{id:"nature",icon:"game-icons:curled-leaf",name:"Природа",attr:"perception",opposite:"society",checks:"research",check_icon:"game-icons:spyglass",attr_icon:"game-icons:semi-closed-eye",traits:[{name:"Законы бытия",desc:"",levels:["Вы принимаете природу вокруг себя - и она отвечает Вам тем же. Вы можете комфортно жить и выживать в диких условиях, если там вообще могут выживать разумные Вашего вида. На это Вам нужно тратить всё своё время, но вы не нуждаетесь в припасах, добывая их самостоятельно, а Ваше снаряжение почти не ветшает. При этом Вы изучаете данную местность с удвоенной скоростью.","Вы можете комфортно выживать даже в агрессивных средах, где разумные Вашего вида не живут (пустыни, пещеры и прочее подобное), но не в тех, которые обусловлены магическими эффектами. В обычной дикой местности (такой как лес или степь) Вы теперь можете выживать, практически не тратя на это времени. Скорость освоения местности так же удвоена.","Глубоко понимая порядки каждой экосистемы, Вы мастерски находите в них место для себя. Вы можете комфортно выживать даже в магических аномалиях, если это вообще возможно для существа с Вашими способностями. Вы должны тратить всё своё время на это только до уровня Изученная (5). Магические аномалии Вы изучаете с обычной скоростью."]},{name:"Сбор ингредиентов",desc:"",levels:["Если Ваш уровень знания местности хотя бы 5, Вы можете каждый ход выращивать или собирать одну меру качественных немагических ингредиентов, характерных для этой местности, потратив на это всё своё время.","Вы можете собирать ингредиенты, не затрачивая на это времени, если живёте в этой местности.","Вы можете собирать качественные магические ингредиенты, в количестве двух мер за один ход, если живёте в этой местности."]},{name:"Как рыба в воде",desc:"",levels:["Если Ваш уровень знания местности как минимум 3, Вы получаете дополнительную скорость передвижения в 1 клетку.","Если Ваш уровень знания местности как минимум 5, Вы можете проходить через сложную местность без дополнительных трат передвижения. Подходящие объекты Вы также можете использовать как укрытия или подспорье в бою","Если Ваш уровень знания местности как минимум 7, вы получаете дополнительный порыв, а обнаружить Вас сложнее на три категории (9)"]}]},war:{id:"war",icon:"game-icons:crossed-swords",name:"Война",attr:"might",checks:"attack",opposite:"shadow",check_icon:"game-icons:arrow-scope",attr_icon:"game-icons:embrassed-energy",traits:[{name:"Первый удар",desc:"",levels:["Противник не может отреагировать на Ваше передвижение, если Вы атакуете сразу после сближения. Тем не менее, он может отреагировать после.","Противник, по которому Вы попали после сближения, теряет один порыв прямо перед атакой. Если у него не оставалось порывов, его защита ниже на одну категорию до конца Вашей атаки.","Противник, которого Вы атакуете сразу после сближения, теряет два порыва и не может отреагировать даже после атаки. Если у него не хватает порывов, он теряет по одной категории защиты за каждый, эффект длится до начала Вашего следующего хода"]},{name:"Шквал ударов",desc:"",levels:["Потратив два порыва, Вы можете провести одну атаку.","Потратив два порыва, Вы можете провести одну атаку, при этом Вы добавляете к броску кость порыва.","В свой ход Вы можете проводить дополнительную атаку, затратив всего одну кость порыва. Кость порыва к броску при этом не добавляется."]},{name:"Подавление",desc:"",levels:["Ваши атаки мешают противнику действовать, даже если они не попадают по цели. Тот, кого Вы атаковали в свой ход с порывом считается подавленным до конца Вашего следующего хода. Он получает штраф к передвижению в одну клетку, атаке и защите - в одну категорию. Эти штрафы не складываются.","Противнику приходится тратить всё больше времени и внимания, чтобы бороться с Вашим напором. Каждая атака с порывом по уже подавленному противнику забирает у него один порыв (если он есть), или понижает защиту на две категории вместо одной (если порывы закончились)","Вы достигли мастерства в подавлении противника. Вам больше не обязательно вкладывать порывы в свои атаки, чтобы подавление сработало."]}]}},Bs={scholar:{id:"scholar",name:{m:"Учёный",f:"Учёная"},desc:"",professions:[],aspects:["knowledge","nature"],traits:[{name:"Знание природы",id:"know_nature",icon:"game-icons:camping-tent",desc:"",levels:[`:check:nature 1:easier
 Все проверки Поиска для Вас на одну категорию проще.`,`2:check:nature в :turn
Вы можете выполнить две проверки Поиска вместо одной за каждый ход.`,`2:check в :turn, :check:nature 2:easier
Вы можете выполнить любые две проверки одного типа вместо одной за каждый ход. Проверки Поиска проще на две категории`]},{name:"Знание врага",desc:"",levels:[`:attack 1:easier если Вы ранили
Любые атаки по противникам, которых Вам уже удалось ранить - на одну категорию проще.`,`:defence 1:easier если уже отражали
Если Вы успешно отбили удар противника, Ваша защита против него повышается на одну категорию, пока вы дееспособны`,`:attack :defence 1:easier, если видели как ранят или защищаются от атак противника
Вам достаточно видеть как другие ранят противника или успешно отражают его удары, чтобы адаптироваться к ним и получить преимущества.`]},{name:"Конструктор",desc:"",levels:["Вы получаете преимущество в две категории на создание предметов с помощью немагических ремёсел. В этот список входят самодельное оружие и доспехи, эликсиры и яды, особые боеприпасы, но не ловушки. Для создания Вам всё ещё нужен рецепт достаточного качества.","Вы можете подбирать рецепты самостоятельно, ориентируясь на найденные слухи и общеизвестную информацию. Для этого Вам нужно провести проверку Поиска или Влияния, если это уместно в данной ситуации","Вы можете сами создавать рецепты, изучая природные материалы. Проведя успешную проверку Поиска Вы можете узнать о свойствах того или иного материала и придумать ему применение. Проверка на первое создание предмета тем проще, чем более реалистичный у вас план. На усмотрение мастера"]}]},mastermind:{id:"mastermind",name:{m:"Комбинатор",f:"Комбинатор"},desc:"",professions:[],aspects:["shadow","society"],traits:[{name:"Засадный мастер",desc:"",levels:["Вы можете подготовить хорошее место для засады, если потратите на это некоторое время. Противнику будет сложнее Вас обнаружить на две категории, а в случае успеха в первый ход все Ваши герои атакуют и защищаются на две категории эффективнее.","Если вы отражаете атаку, Вы можете пройти проверку Влияния (против разумных) или  Поиска (против зверей и монстров), чтобы симулировать тяжёлое ранение или даже смерть. Если Ваш обман не раскрыт, Вы можете получить преимущество в две категории на атаку, если наносите неожиданный удар в полную мощь.","Вы можете провести проверку Влияния (против разумных) или Поиска (против зверей и монстров), чтобы инициировать ложное отступление. Сложность её будет тем больше, чем меньше у Вас понятных врагу причин для отступления, на усмотрение мастера. В случае успеха Вы должны отходить назад один ход, увлекая противника за собой, а затем обрушиться на него снова, получая преимущества как от засады."]},{name:"Преступные схемы",desc:"",levels:["Потратив не менее месяца на подготовку, Вы можете организовать серьёзное преступление в поселении. Это может быть кража, похищение или убийство влиятельного лица. Сложность проверки определяет мастер исходя из степени реалистичности Вашего плана. Вы можете отказаться от реализации плана, когда мастер объявил сложность. Выполнить задуманное нелегко, ещё сложнее - не попасться после.  Вероятность того, что кто-то выйдет на Ваш след, зависит от превышения проверки.","Потратив не менее месяца на подготовку, Вы можете инициировать войну между разными фракциями в пределах одного поселения. Потратив не менее трёх месяцев - глобальную вражду между глобальными фракциями, не менее шести - войну. Формат войны или вражды может быть разным, в зависимости от сути фракций, например, купеческие гильдии будут враждовать совсем не так, как гильдии воров. Ваши преступные планы на две категории эффективнее, если затрагивают интересы воюющих.","Проведя полгода в поселении, вы можете подчинить себе все его преступные организации, при этом оставаясь в тени. Они не знают Вас в лицо и не будут подчиняться напрямую, но дёргая за правильные ниточки Вы можете заставлять их делать то, что нужно Вам. Все проверки Влияния удаются Вам проще на три категории, а уровень Вашего влияния на эти организации не может опускаться ниже Крепкой Дружбы"]},{name:"Без особых примет",desc:"",levels:["Вы умеете затеряться в толпе, знаете толк в маскировке в поселениях разумных. Искать Вас сложнее на две категории, если Вы только не хотите быть найденным. Иначе - на две категории проще.","Ваше умение скрываться с глаз оказывается полезным и на поле боя. Вы умеете быть неприметным и не угрожающим. Если противник собирается атаковать Вас, когда имеет возможность бить по Вашему союзнику, Вы можете пройти проверку Влияния, чтобы переключить его внимание. На это не требуется никаких действий, Вы можете сделать это сколько угодно раз за ход, но каждая следующая проверка будет сложнее.","Если Вам удаётся переключить внимание противника на своего союзника - вы можете нанести неожиданную атаку по нему в самый неподходящий момент. Такая атака стоит один порыв, и может быть усилена, но выполняется только один раз за ход."]}]},weaponmaster:{id:"weaponmaster",name:{m:"Оружейник",f:"Оружейник"},desc:"",professions:[],aspects:["war","knowledge"],traits:[{name:"И сталь блестит",desc:"",levels:["Вы знаете толк в боевом снаряжении и со всей скурпулёзностью подходите к его выбору. Ваша броня или один из наборов вооружения качественнее на целую категорию.","Прежде чем стать популярным, более эффективное оружие появляется на рынке в малом количестве. Используя свои связи (не менее 4 уровня) и деньги (не менее 7 уровня), Вы можете найти такие редкие образцы и пополнить свою коллекцию. Теперь более высоким качеством могут отличаться два набора вооружения, или один набор и броня.","Если вы привыкаете к оружию не менее месяца, необходимое превышение защиты за каждый вид травмы сокращается на единицу (мин 1). Кроме того, Вы можете использовать особые удары экзотического оружия без штрафов. Одновременно вы можете таким образом привыкнуть только к трём наборам снаряжения. "]},{name:"Таких мечей много, но этот - мой",desc:"",levels:["Если Вы организуете что-то, связанное с оружием или вооружёнными людьми, Ваши проверки Порядка легче на две категории (6). Нанимать и вооружать отряд наёмников для Вас дешевле на одну категорию.","Вооружённые с Вашей помощью отряды защищаются и атакуют эффективнее на одну категорию.","Если Ваши товарищи по команде прислушиваются к Вашим советам, каждый может сделать один набор оружия или свою броню более эффективными (на одну категорию). На этом уровне Вы также получаете такое преимущество."]},{name:"Дороже золота",desc:"",levels:["Оружие даёт силу, а сила - власть. Попадая в новые сообщества Вы сразу получаете как минимум Небольшое Влияние на воинское и дворянское сословие, если готовы демонстрировать своё превосходное снаряжение.","Внешний вид Вашего снаряжения заставляет нанимателей задуматься о цене за Ваши услуги. Если Вашему заказчику это по карману, он предложит на одну категорию более высокую оплату. Если нет - он и вовсе не станет предлагать Вам работу.","Раз в три месяца Вы можете купить действительно очень редкое оружие, совершив покупку не менее чем 7 уровня богатства. Такую редкость с удовольствием купят любые коллекционеры, вполне вероятно - даже короли и императоры."]}]},tactician:{id:"tactician",name:{m:"Тактик",f:"Тактик"},desc:"",professions:[],aspects:["war","knowledge"],traits:[{name:"Держись!",desc:"",levels:["За один ход Вы можете помочь союзнику советом два раза, а не один. Кроме того, Ваши советы могут увеличить не только защиту, но и нападение. Ваши советы должны быть реалистичны, иначе мастер может решить, что они не принесут пользу.","Стоящие плечом к плечу с Вами товарищи атакуют и защищаются на одну категорию эффективнее, но это преимущество не складывается с эффектом от вербальной помощи.","Вы можете помочь союзнику трижды за один ход, эффект суммируется с преимуществом от второго уровня этого умения."]},{name:"Офицерские курсы",desc:"",levels:["Вы можете невзначай демонстрировать свои познания в тактике в разговоре, если хотите этого. Все Ваши проверки Влияния на невраждебных разумных-воинов эффективнее на две категории.","Вам проще находить грамотных командиров, все нанятые Вами воины атакуют и защищаются эффективнее на одну категорию.","Ваша слава идёт впереди Вас, больше хороших бойцов хотят служить под Вашим началом, меньше дураков готовы на Вас напасть. Проверки Влияния на поиск бойцов легче на две категории, проверки организации диверсий и нападений на Вас на две категории сложнее"]},{name:"Искусство войны",desc:"",levels:["Война требует денег, денег и ещё раз денег. А ещё, бизнес здорово похож на войну. Ваши проверки Порядка и Диверсии на одну категории проще, если они касаются организации прибыльной компании или борьбы с конкурентами.","Какой бы важной не была тактика, она не может обойтись без стратегии. Проверки Поиска и Влияния на одну категорию проще, если касаются исследования рынков или стратегических позиций противника.","Проверки Порядка, Диверсии, Поиска и Влияния первых двух уровней умения становятся проще не на одну, а на три категории."]}]},monk:{id:"monk",name:{m:"Монах",f:"Монашка"},desc:"",professions:[],aspects:["war","mystics"],traits:[{name:"Боевые искусства",desc:"",levels:["Ваша скорость передвижения увеличивается на 2, а рукопашные атаки без оружия становятся эффективнее на одну категорию. Кроме того, Ваша защита в ближнем бою повышается на одну категорию, а в дальнем - на две. Эти бонусы работают только в том случае, если Вы носите броню не тяжелее лёгкой. ","Вы больше не получаете штрафов к защите сбоку. Ваши сокрушительные удары без оружия - всегда точные. ","Бой для вас - особая форма транса, вы умудряетесь замечать всё происходящее вокруг. Вы больше не получаете штрафов к защите сзади, а также можете реагировать на происходящее за своей спиной. Ваши безоружные атаки становятся эффективнее ещё на одну категорию, а ваши тяжёлые удары оружием ближнего боя становятся всегда точными."]},{name:"Бастион духа",desc:"",levels:["Боевые искусства - не просто способ убрать врага со своей дороги. Для Вас - это способ обратиться к себе, познать мир через себя, а себя - через мир вокруг. Вы должны проводить не менее 10 часов в неделю в изнуряющих тренировках, но в результате Вы чувствуете происходящее вокруг невероятно тонко. Любые проверки Диверсии на две категории проще, если Вы участвуете в них лично.","Вы должны тратить на тренировки не менее 20 часов в неделю, но Ваша потребность в сне значительно сократилась. Теперь Вы высыпаетесь всего за 6 часов в сутки. Проверки Порядка проще на одну категорию, если Вы участвуете в них лично.","Ваше тело - всего лишь продолжение Вашей несгибаемой воли. Вам больше не нужно спать, но Вы должны проводить не меньше 4х часов в сутки в медитациях, поддерживающих Ваш дух. Пока Вам удаётся выполнять это условие, Вам нужно вдвое меньше припасов для выживания, Ваши раны кровоточат вдвое меньше, а ранить Ваше тело значительно сложнее. Ваш класс брони увеличивается на 1."]},{name:"Внутреннее спокойствие",desc:"",levels:["Вам одинаково просто выживать в дикой природе, в суетливом городе или горном додзё. Однако внешний мир Вам не особенно интересен. Ваш уровень знания немагической местности не может быть ниже 4х, но выше этого значения растёт вдвое медленнее обычного.","Ваш путь боевых искусств провёл Вас через множество стран и регионов - Ваши проверки Влияния на впервые встреченных незнакомцев на две категории легче.","Ваше паранормальное предчувствие опасности позволяет точно знать, когда Вас держат на прицеле, а иногда и заранее знать, что кто-то замыслил недоброе. Это предчувствие иногда может давать ложноположительный результат."]}]},commander:{id:"commander",name:{m:"Командир",f:"Командир"},desc:"",professions:[],aspects:["war","society"],traits:[{name:"За мной!",desc:"",levels:["Перед боем командир может повысить мораль союзных бойцов ниже или равных по рангу на 3 единицы, если успешно пройдёт проверку Влияния или на 1, если провалит её.","Вербальная команда командира во время боя поднимает мораль бойца на единицу, а так же позволяет один ход игнорировать негативные последствия тяжёлой травмы.","Потратив основное действие во время боя, командир может повысить мораль всех способных его слышать бойцов на 2 единицы, снизить мораль всех разумных бойцов противника на 2 единицы. "]},{name:"Всё по порядку",desc:"",levels:["Составить хороший план - половина успеха. Ваши проверки Порядка на одну категорию легче.","Мало составить план - нужно ещё и ему следовать. Ваши проверки Порядка на две категории проще, если Вы выполняете работу самостоятельно или с проверенными исполнителями, с которыми Вам уже доводилось работать раньше.","Вы умеете составлять чёткие исчерпывающие инструкции, такие, чтобы по ним выполнить работу смогла и обезьяна. Ваши проверки Порядка легче на две категории, если исполнителями на месте руководит выбранный Вами смышлёный человек. Этот бонус работает и если вы руководите лично."]},{name:"Вместе сильнее",desc:"",levels:["Если несколько персонажей думают над решением одной проблемы и готовы доверить Вам руководство, Вы можете сделать так, чтобы проверку проходил персонаж с самой высокой характеристикой, а бонусы учитывались от персонажа с самыми высокими бонусами.","Если это проверка Войны, Порядка или Влияния, Вы так же можете облегчить её ещё на одну категорию.","Для любых проверок Вы можете сложить все бонусы всех участников, однако полученное преимущество не должно быть больше чем в два раза большим, чем самый большой бонус."]}]},ranger:{id:"ranger",name:{m:"Следопыт",f:"Следопыт"},desc:"",professions:[],aspects:["war","nature"],traits:[{name:"По кровавому следу",desc:"",levels:["Вы не уличный задира, Вы - профессиональный убийца. Вы выслеживаете свою цель и наносите удар издалека. Проверки Поиска на категорию легче, если вы ищете живое существо. Первый удар по не подозревающей о Вас цели эффективнее дополнительно на две категории, но это не должен быть удар с соседней клетки.","Ваши атаки по не подозревающему о Вашем присутствии противнику - всегда считаются точными, если Вы успели изучить его по следам или наблюдая в течении хотя бы одной минуты.","Ваши дальние атаки (даже через одну клетку) эффективнее на одну категорию даже по обнаружившим Вас противникам, если Вы успели изучить их по следам. Ваша защита в ближнем и дальнем бою против них так же выше на категорию."]},{name:"Как у себя дома",desc:"",levels:["Если Ваше знание местности хотя бы 5, обнаружить Вас сложнее на одну категорию.","Если Ваше знание местности хотя бы 5, обнаружить весь Ваш отряд сложнее на одну категорию. Это касается как попыток спрятаться в засаде, так и передвижения по глобальной карте.","Ваше мастерство скрытности достигло своего апогея. Если Вы знаете местность хотя бы до уровня 3, Вы можете скрыть себя с дополнительной сложностью в три категории, или весь отряд - со сложностью в две. Кроме того, Ваш первый удар по не подозревающему о Вашем присутствии врагу получает дополнительный бонус в одну категорию"]},{name:"Тайные тропы",desc:"",levels:["Вы знаете, как выбирать дорогу, чтобы меньше уставать и больше успевать. Ваша скорость передвижения по глобальной карте увеличена на два. Вы значительно эффективнее обнаруживаете другие отряды неподалёку, на две категории. ","С Вашей помощью весь отряд может двигаться по глобальной карте быстрее на единицу. Если Вы прокладываете маршрут движения какого-нибудь отряда, он оказывается на одну категорию безопаснее.","Ваши проверки Диверсии против отрядов, движущихся по дикой местности, эффективнее на две категории. Маршруты, проложенные Вами на две категории безопаснее."]}]},hunter:{id:"hunter",name:{m:"Охотник",f:"Охотница"},desc:"",professions:[],aspects:["war","nature"],traits:[{name:"На ловца",desc:"",levels:["Вопреки расхожему мифу, рыцарь в латах и на коне не сумеет одолеть дракона. А вот хорошо подготовленный охотник - сможет. Вы очень хороши в бою против зверей и монстров из крови и плоти - атака и защита эффективнее на одну категорию.","Кое-что из Ваших навыков прекрасно работает и на разумных. Ваши ловушки на одну категорию эффективнее, а кровотечение спровоцированное Вашими атаками, вдвое тяжелее.","В бою против зверей и монстров, с которыми Вы уже сталкивались раньше, Ваша атака и защита эффективнее на две категории."]},{name:"Боевые трофеи",desc:"",levels:["Если Ваш уровень знания местности хотя бы 4, Вы можете собирать одну меру немагических полезных ингредиентов из тел живущих в ней животных в месяц. Для этого Вам нужно найти подходящее место и остановиться в нём. Вы также можете извлекать обычные ингредиенты из поверженных в бою монстров","Вы можете собирать редкие ингредиенты, тратя на это всё своё время или обычные - прямо на ходу. Из побеждённых в бою Вы можете извлекать обычные или редкие ингредиенты","Вы можете собирать даже магические материалы из монстров, которых победили в бою или на которых охотились."]},{name:"Начинаем год назад",desc:"",levels:["Хорошая подготовка - ключ к успешной охоте. Имея большой опыт в вещах такого рода, Вы можете неплохо организовывать и другие дела. Проверки Порядка проще на одну категорию, если они хоть как-то связаны с пребыванием в дикой местности.","Что будет, если Ваши конкуретны забудут палатку? Проверки Диверсии так же проще на одну категорию, если связаны с пребыванием Вашей цели в дикой местности.","Ваше снаряжениие подобрано так хорошо, что Вы можете использовать его исключительно быстро. Полным действием в бою Вы можете подготовить ловушку, это может быть заранее подготовленный капкан на медведя или некая импровизация на месте. В случае импровизации, вы будете проходить проверку Порядка, сложность которой зависит от реалистичности Вашей задумки."]}]},druid:{id:"druid",name:{m:"Друид",f:"Друидка"},desc:"",professions:[],aspects:["nature","mystics"],traits:[{name:"Свой среди зверей",desc:"",levels:["Вы умеете вести себя так, чтобы не провоцировать диких животных. Они нападут на Вас только по исключительной причине, например, умирая от голода или защищая своё потомство. Проверки Поиска связанные со зверьми для вас на одну категорию проще.","Звери рассматривают Вас как доброго приятеля. Драться на Вашей стороне они, конечно, не станут, но могут предупредить о приближающейся опасности. Ваш отряд на одну категорию сложнее обнаружить, а Вы обнаруживаете другие на одну проще","Вы учитесь гораздо лучше понимать, что пытаются Вам сказать наши братья меньшие. Ваши проверки Поиска в местности, где есть звери на две категории эффективнее. Сообщения от зверей мастер теперь передаёт Вам как короткие предложения из двух-трёх простых слов."]},{name:"Духи леса",desc:"",levels:["Ежедневно жертвуя духам местности, в которой Вы находитесь, нечто ценное (обычно подходят съестные припасы) за одну неделю Вы можете наладить с ними контакт. Если духи благоволят Вам, один раз за боевую сцену (или один раз в месяц вне боя), Вы можете пройти проверку автоматически, если это возможно хотя бы при каком-то значении на кубике.","Регулярно жертвуя духам местности нечто ценное (отлично подойдут ценные материалы) Вы можете расположить их к себе ещё больше. Проверка, которую Вы видите, может получить максимум или минимум на кубиках по Вашему желанию. Это умение можно применить один раз за бой или раз в месяц в небоевых сценах.","Регулярно жертвуя духам местности магические ингредиенты или артефакты (не менее месяца), Вы достигаете максимального расположения с их стороны. Они могут самостоятельно помогать Вам как посчитают нужным, будь это подсказки или помощь в бою."]},{name:"Как рыба в воде",desc:"",levels:["Вы чувствуете присутствие крупных зверей на расстоянии в сотню метров. Ваши проверки Поиска в отношении зверей проще на три категории.","Монстры - совершенно чуждые природе существа. Земля стонет и плачет там, где они ходят по ней. Вы слышите этот плач издалека, за несколько километров определяя направление до ближайшего монстра. Проверки Поиска в отношении монстров на две категории проще.","Магия вплетена в природу, но всё же выделяется на фоне всего остального ярким пятном. Вы чувствуете магические артефакты и ингредиенты, находящиеся в дикой природе за несколько километров. Поиск таких предметов проще на три категории, но имейте ввиду - духи местности могут разозлиться на Вас, если Вы заберёте что-то ценное."]}]},outlaw:{id:"outlaw",name:{m:"Беглец",f:"Беглянка"},desc:"",professions:[],aspects:["shadow","nature"],traits:[{name:"Пастух паршивых овец",desc:"",levels:["В любом обществе есть те, кто промышляет тёмными делишками. Вы легко определяете таких, сложность проверки ниже на две категории.","Вы можете не только успешно определять криминальные элементы, но ещё и ловить их на горячем. Чтобы затем шантажировать. Ваши проверки Влияния на них на две категории эффективнее.","Вы безошибочно определяете тёмных дельцов, воров, взяточников в любом обществе, проведя с ними в разговоре хотя бы несколько минут. Размеры взяток для Вас снижены на две категории. Пройдя дополнительную проверку, Вы можете разгадать схему, в которой кто-то замешан."]},{name:"Постоянно оглядываясь",desc:"",levels:["Вы так долго скрывались от властей, что теперь чувствуете себя гораздо лучше вне поселений. Скорость изучения местности удвоена вплоть до уровня 4, если это не магическая местность.","Уходить от погони - сильнейший из Ваших талантов. Если Вас преследуют, (в бою или на стратегической карте) Ваша скорость передвижения увеличивается на два.","Проведя в поселении хотя бы месяц, Вы узнаёте обо всех тайных ходах, не закрытых от простых людей или криминальных элементов. Если это поселение около границы другого государства, Вы также узнаёте как проникнуть туда незамеченным."]},{name:"Не останавливаясь",desc:"",levels:["Вы учитесь атаковать на бегу, не разворачиваясь. Для Вас возможны атаки вбок с штрафом эффективности в одну категорию.","От привычки не так легко избавиться. Если Ваши атаки наносят хотя бы лёгкую травму, они снижают скорость передвижения противника на одну клетку длительностью на два хода. Если только Вы явно не захотите обратного.","Вы можете атаковать назад не разворачиваясь со штрафом в одну категорию, или вбок - без штрафа. Кроме того, Ваша защита с тыла становится сильнее на одну категорию."]}]},witch:{id:"witch",name:{m:"Ведун",f:"Ведьма"},desc:"",professions:[],aspects:["mystics","shadow"],traits:[{name:"Магия крови",desc:"",levels:["Вы получаете связь первого уровня с Концептом Жизнь, если ещё не имели её. Ваше особое умение - направлять магическую энергию по крови, которую Вы сумели получить от цели. Касты, направленные таким образом, слабее на два уровня, но не слабее Быстрого. Кровь, изьятая из организма, имеет связь с телом несколько часов.","Вы можете жертвовать собственную кровь для усиления магического эффекта - это наносит царапину при результате на кубике 10-12, лёгкую травму в иных случаях. Сила каста вырастает на один уровень.","Вы учитесь лучше чувствовать связь Крови, теперь магические эффекты, передаваемые через неё, слабее всего на один уровень, а если Вы прикладываете небольшие усилия, образец крови может оставаться связанным с целью сколь угодно долго. Одновременно Вы можете держать у себя не больше трёх таких образцов, но если не сумеете укрепить связь в какой-нибудь день, она будет разрушена."]},{name:"Половинка меня",desc:"",levels:["Вам удаётся сделать невероятное - оторвать от своей души небольшой кусок, да ещё так, чтобы он не развалился при этом. Получилось нечто живое, отдельное от Вас и в то же время являющееся Вами. Вы вселили это в животное, получив, таким образом, фамильяра. Небольшой зверёк на Ваш выбор подчиняется Вашей воле, но главное - Вы можете направлять любые касты из той точки, где находится он. Помните, что любые энергии Порядка изгоняют духа, а чтобы вселить его в новое тело, Вам нужно потратить как минимум один день. В случае полного разрушения духовной сущности, Вы получаете травму уровня смертельного ранения и должны потратить не менее недели, чтобы повторить свой опыт.","Ваш дух-фамильяр становится значительно сильнее. Животное-носитель больше не является живым - скорее немёртвым. Остановить его физическим оружием можно, но убить - нельзя. Теперь Вы можете проводить энергии Порядка через фамильяра, но эффекты будут на один уровень слабее. Кроме того, теперь духа нельзя изгнать энергией порядка ниже уровнем, чем Средний каст. Вы можете общаться телепатически с фамильяром, когда он меньше чем в 1000 метров от Вас.","Дух становится всё сильнее, как и Ваша с ним связь. Вы можете общаться с ним телепатически на любом расстоянии (в пределах одного мира), а в пределах 1000 метров - ещё и ощущать мир его органами чувств. Вселение духа в животное больше не занимает у Вас много времени - достаточно нескольких минут. Любые энергии каста теперь передаются без потерь. В случае полного разрушения духовной сущности фамильяра, вы больше не получите урона."]},{name:"Мёртвая вода",desc:"",levels:["Вы учитесь заключать некоторые магические эффекты в специальных отварах. Потратив час времени и немного как минимум редких ингредиентов, Вы можете выполнить каст и при успехе, заключить его действие в магическом отваре. Энергия сохранится в нём ещё одни сутки, а затем развеется. Ваш отвар - всегда яд, производить что-то кроме яда Вы ещё не научились. Чтобы он подействовал в полной мере, цель должна его проглотить - а внесённый в кровь вместе с ударом оружия яд подействует на уровень слабее. Сила эффектов, которые может вместить Ваш отвар ограничена уровнем Малого каста.",'Вы можете заключать более мощные магические эффекты в отварах, теперь они ограничены уровнем до Среднего каста. Кроме того, теперь Вы можете добавлять дополнительные эффекты, кроме урона, но они должны быть слабее основного, а сделать зелье с "умным" эффектом любого рода не получится - оно не привязано к разуму применяющего, потому всегда имеет нулевой контроль и нулевую самостоятельность.',"Ваши зелья теперь могут вмещать эффект вплоть до уровня Большого каста, гораздо более долговечны - могут прожить до недели, а периодически подновляя магию в них, Вы можете держать их рабочими сколь угодно долго (до 9 зелий, 3 шт каждого из 3х типов).Теперь дополнительные эффекты могут оказываться сильнее вредоносного, но как минимум царапину Ваш яд всегда должен наносить."]}]},specialist:{id:"specialist",name:{m:"Специалист",f:"Специалист"},desc:"",professions:[],aspects:["society","knowledge"],traits:[{name:"Быстрее и выше",desc:"",levels:["Вы копаете глубоко и не останавливаетесь на достигнутом. И это даёт свои плоды - в любом ремесле, распространённом в обществе, Вы преуспеваете больше других. Работая по любой профессии, не связанной с Мистикой, Вы можете заработать на один уровень богатства больше. Кроме того, все проверки Порядка для Вас на одну категорию проще.","Хороших профессионалов ценят. Ваши проверки Влияния на категорию проще, а искать специалистов в какой-то области - проще на две.","Занимаясь своим ремеслом, Вы можете заработать на две категории больше богатства больше, чем другие. Ваши проверки Влияния на две категории эффективнее, если Вы проработали по профессии в этом поселении хотя бы месяц."]},{name:"Всё по полочкам",desc:"",levels:["Вы бы не смогли достичь таких высот в своих ремёслах, если бы не анализировали и не систематизировали всё. Все проверки Порядка на одну категорию проще, если они связаны с освоенным Вами ремеслом - на две.","Вы можете осваивать новые профессии и ремёсла гораздо быстрее остальных - всего за месяц обучения Вы достигаете уровня среднего специалиста. Ремесло в таком случае считается усвоенным. Вам всё ещё не доступны профессии, связанные с мистикой.","Даже мистические профессии теперь доступны Вам, однако Вы должны потратить втрое больше времени, чтобы разобраться в них. Освоив совершенно новую для себя профессию, Вы получите одно очко развития."]},{name:"Почти шахматы",desc:"",levels:["Потратив основное действие в бою, Вы можете попробовать разгадать тактический замысел противника, если он есть. Это проверка Порядка или Диверсии, на Ваш выбор. Если проверка пройдена успешно, мастер раскрывает Вам суть задумки, а Вы и Ваши товарищи получают преимущество в атаке и защите в одну категорию на следующий раунд боя.","Проанализировав как минимум три взаимодействия с враждебными силами, Вы можете попробовать разгадать стратегический замысел противника. Это проверка Порядка или Диверсии на Ваш выбор, сложность тем больше, чем меньше Ваш персонаж узнал предварительно. В случае успеха Вы получаете преимущество в две категории на все проверки (кроме боя) в отношении этой фракции на месяц","Преимущество, которое Вы получаете от первых двух уровней этого умения, длится вдвое дольше. Кроме того, если Вы прошли изначальную проверку (Порядка или Диверсии), Вы можете предложить план, как помешать врагу и пройти другую (Диверсии для Порядка или наоборот), чтобы удвоить и силу Вашего преимущества. Сложность проверки выставляет мастер ориентируясь на реалистичность Вашего плана."]}]},skald:{id:"skald",name:{m:"Скальд",f:"Скальд"},desc:"",professions:[],aspects:["society","knowledge"],traits:[{name:"Знаю сказ, который начинался...",desc:"",levels:["Ничто не ново в этом мире, и Вы, как хранитель легенд ушедших эпох, знаете это лучше других. В любой ситуации Вы можете попробовать пройти проверку Порядка, чтобы вспомнить, не было ли уже на свете подобной ситуации. Проверка тем сложнее, чем более необычный пример Вы пытаетесь вспомнить, но если она пройдена, Вы можете поделиться поучительной историей из прошлого с другими, облегчая следующую проверку (свою или чужую) на две категории. Вы можете упрощать подобным образом только проверки Конфликта, Порядка или Влияния.","Многие баллады сложены о героизме или о любви, но не стоит забывать и тёмные сказки, которые народ тоже исправно хранит в своей памяти. Теперь Вы можете усиливать этим умением и проверки Диверсии, Защиты и Поиска. Кроме того, раз в месяц Вы можете усилить свою проверку, не затрачивая хода.","Вам не составляет труда вывернуть любую историю так, чтобы она выставляла Вас в выгодном свете. Ваши собственные проверки Влияния всегда проще на две категории, а Репутация Вашей группы с любыми невраждебными фракциями всегда как минимум 2 (Небольшое Влияние)"]},{name:"Наш последний и решительный",desc:"",levels:["Жизнь жестока и вопрос не в том, выживешь ли ты. Только в том, каким тебя запомнят. Те, кто дерётся с Вами плечом к плечу понимают, что каждый бой - их шанс занять своё место в героической легенде. Боевой дух всех бойцов ниже рангом чем Вы выше на единицу.","Когда Вы успешно побеждаете противника в бою, Вы можете сопровождать свои действия вдохновляющими союзников репликами. Все увидевшие и услышавшие это в бою бойцы ниже Вас рангом получат преимущество в одну категорию при атаке на один раунд.","Преимущества двух предыдущих уровней теперь действуют даже на бойцов Вашего ранга, включая товарищей по команде и даже Вас."]},{name:"Золотые страницы",desc:"",levels:["Не только простые бойцы хотят остаться в легендах, выдающимся людям своей эпохи тоже не чужда жажда славы. Вам на две категории проще находить выход на тех, кто не стремится общаться с простым людом, а Ваши проверки Влияния против них на одну категорию проще.","Вам на две категории проще убеждать нейтральные стороны оказать Вам какую-то помощь - подкрепления, припасы, деньги или снаряжение. Это работает только в том случае, если по мнению люда Вам противостоит серьёный враг.","Здорово казаться всем храбрым... но и сойти богатым и щедрым - тоже неплохо. Вы можете рассчитывать на награду на одну категорию выше, если заказчик способен её себе позволить."]}]},cutthroat:{id:"cutthroat",name:{m:"Головорез",f:"Головорезка"},desc:"",professions:[],aspects:["war","shadow"],traits:[{name:"Гроза всему живому",desc:"",levels:["Вы славитесь своей безпринципностью и безжалостностью. Проверки Влияния на одну категорию эффективнее, если Вы предпочитаете действовать через угрозы. Однако, вероятность того, что Ваша деятельность привлечёт внимание властей ничуть не меньше.","Враждебные фракции подумают дважды, прежде чем чинить Вам какие-то неудобства. Но уж если они решатся - бросят в бой всё, что имеют. Враждебные фракции решаются на активные действия только при репутации Ненависть (-4) или Лютая Ненависть (-5)","Ваши проверки Влияния эффективнее на одну категорию при попытках договориться или на две, если Вы используете угрозы. Любые предприятия и организации связанные с Вашим именем на одну категорию больше защищены от нападок разумных."]},{name:"Умопомрачительная жестокость",desc:"",levels:["Пришедшие за Вашей головой морально готовы умереть, но никто не готов умереть ТАК. Если противник уже не может эффективно сопротивляться, Вы можете устроить показательную жестокую казнь, подрывая мораль всех, кто это увидел и услышал. Противники получают -2 морали, союзники и нейтральные бойцы -1. На это нужно затратить основное действие, но в следующий ход противники будут защищаться и нападать на одну категорию хуже. Этот эффект не проймёт бойцов более высокого ранга, чем убитый.","Захватив в бою пленного, Вы можете жестоко казнить его позже прилюдно. Такое действие снизит вероятность нападок на Вас со стороны враждебных фракций на две категории на следующий месяц.","Вы можете проводить казнь в бою, затрачивая всего один порыв. Это действие больше не подрывает мораль Ваших союзников, а кроме того может пронять бойцов даже более опытных, чем убитый."]},{name:"Честь - для идиотов и мертвецов",desc:"",levels:["Ваши атаки во фланг и тыл получают преимущество в одну категорию.","Ваши атаки во фланг и тыл - всегда точные.","Ваши атаки во фланг и тыл не вызывают срабатывания реакции, а кроме того забирают у цели один порыв даже в случае промаха."]}]},heretic:{id:"heretic",name:{m:"Еретик",f:"Еретичка"},desc:"",professions:[],aspects:["mystics","knowledge"],traits:[{name:"Постигая непостижимое",desc:"",levels:["Парадокс - Ваше второе имя. Проходя любую проверку, Вы можете выбрать противоположную ей и преуспеть необъяснимым образом. Такая проверка, правда, будет на одну категорию сложнее заявленной. Вы должны объяснить, каким образом применяете свои навыки для того, чтобы пройти проверку.","Странно для других, естественно - для Вас. Вы можете выбрать соседнюю проверку вместо противоположной, но она будет на две категории сложнее.","Гениальность или безумие? Главное, чтобы это работало. Противоположные проверки больше не получают штрафа, а штраф при использовании соседних проверок снижен до одной категории."]},{name:"Вербальная магия",desc:"",levels:["Посвятив месяц изучению и анализу необъяснимых мистических сущностей, вы всё же находите кое-какие закономерности. Вы способны создавать заклинания - нелепые высказывания, которые нужно громко пропевать странно пританцовывая, чтобы они сработали. Каждое использование заклинания - парная проверка Порядка и Диверсии, требующая основного действия в бою или полного хода в небоевой сцене. Сложность определяется мастером по степени реалистичности задумки. Эти проверки нельзя заменить на другие, к ним не применяются никакие бонусы. Если обе пройдены - заклинание срабатывает как и планировалось, если провалена одна - не происходит ничего, если провалены обе - срабатывает наоборот. Одновременно Вы можете помнить только три заклинания.","Вы учитесь записывать свои заклинания и лучше запоминать, как именно их следует выполнять. Проверки сложности теперь проще на одну категорию, а если Вам нужно выбросить на кубике 6 или меньше, Вы проходите проверку автоматически. Теперь Вы можете хранить в своей памяти три заклинания и ещё три - в своих записях. Заклинания из памяти используются основным действием, заклинания из записей - основным действием и двумя порывами.","Вы научились так хорошо записывать свои заклинания, что даже другие могут их повторять. Потратив не менее двух недель и одного очка развития на изучение, Ваш товарищ может научиться использовать заклинание. В вашей собственной памяти теперь может храниться до шести заклинаний, ещё три - в записях."]},{name:"Дорисовать картину",desc:"",levels:["Высокие аналитические способности и хорошая интуиция - невероятно редкое сочетание, но благодаря этой связке Вы можете понимать то, что для других - недоступно. Например, разгадывать самые запутанные истории по обрывкам информации. Раз в месяц Вы можете сделать невероятную догадку - точно узнать причину какого-то события, которое Вы подробно изучали.","Будущее не может быть секретом для того, кто так хорошо понимает прошлое. Раз в месяц Вы можете сделать невероятную догадку - точно узнать последствия какого-то события, которое Вы подробно изучали или действия, которое собираетесь совершить.","Остальные видят только разрозренные кусочки, а Вы - полную картину. Жаль, что такие озарения посещают Вас лишь иногда. Раз в месяц Вы можете точно узнать самый лучший, простой и надёжный способ добиться каких-то результатов."]}]},seeker:{id:"seeker",name:{m:"Искатель",f:"Искательница"},desc:"",professions:[],aspects:["nature","society"],traits:[{name:"Волк волку человек",desc:"",levels:["Дух первооткрывателя толкает Вас почти всё время проводить в экспедициях по неизведанным землям. Вы здорово научились находить общий язык с местными дикими сообществами, Ваша Репутация с ними начинается с Небольшого Влияния (2), а все проверки Поиска и Влияния с их помощью на две категории проще.","Вы легко можете затеряться в дикой местности, поселившись в диком сообществе. За месяц проживания с ними, Вы можете хорошо выучить их язык, подняв попутно уровень Репутации до Дружбы (5). Ваши проверки Поиска в этой местности с помощью дружественных аборигенов проще на три категории.","Затратив достаточно времени, Вы способны, кажется, подружиться с кем угодно. Теперь Вы можете вжиться в сообщество любых животных или монстров, если им свойственна хотя бы какая-то стайность или социальность. На это придётся потратить не менее трёх месяцев, но в результате вы получите полное знание местности Как Свои Пять Пальцев (10), и одно очко развития."]},{name:"Чутьё артефактора",desc:"",levels:["Пока другие покупают безделушки по цене магических артефактов, Вы делаете обратное. Паранормальное чутьё позволяет Вам находить действительно магические предметы даже в куче хлама, если они там есть. Проверки Поиска и Влияния проще на две категории при попытке найти артефакты.","Продажа магических материалов, ингредиентов и артефактов позволяет Вам выручить на одну категорию больше богатства.","Собирая вместе все знания о местной природе, слухи и легенды местного населения и своё таинственное чутьё, Вы гораздо легче находите древние руины, гробницы, затерянные города, магические места силы и прочее подобное. Проверки такого рода легче на три категории."]},{name:"До победного",desc:"",levels:["Простая неудача не может остановить Вашу несгибаемую волю Искателя. Раз в месяц Вы можете попробовать пройти проверку ещё два раза, если провалили первую попытку. Если вы пройдёте хотя бы одну из трёх - это зачитывается как успех. Мастер может наложить на Вас какой-нибудь штраф за приложение чрезмерных усилий.","Если Вы преуспели со второй попытки, третью можете использовать на другой проверке в этом же месяце.","Если Вы проваливаете проверку все три раза, при следующей попытке Ваша проверка будет на одну категорию проще."]}]},dervish:{id:"dervish",name:{m:"Дервиш",f:"Дервиш"},desc:"",professions:[],aspects:["society","mystics"],traits:[{name:"Танец блаженства",desc:"",levels:["Потратив действие в свой ход, Вы можете войти в особый боевой танец, в процессе которого не можете использовать атаки дальнего боя, но получаете преимущество в атаке в одну категорию.","Ваши движения иррациональны и непредсказуемы. Если Ваше передвижение или атака вызывает реакцию, пройдите проверку Влияния против Поиска противника. В случае успеха ему не удаётся отреагировать на Ваше действие, но затраченный порыв всё равно тратится.","Во время танца вы не получаете штрафов из-за ранений и морали (кроме смертельных), в к Вашей проверке Влияния на реакцию противника прибавляется две категории сложности."]},{name:"Зажигающий сердца",desc:"",levels:["Свет вашей безграничной веры зажигает сердца и увлекает за собой. Ваши проверки Влияния вне боя легче на две категории, если цель не настроена враждебно по отношению к Вам.","Вы учитесь входить в особый транс в танце, который позволяет Вам лучше настроиться на следующую проверку. Проведя особый ритуал, Вы можете снизить сложность следующей проверки на категорию.","Ваш фанатизм сияет настолько ярко, что способен заворожить даже врага в бою. Теперь Ваши проверки Влияния легче на две категории даже в бою, даже в отношении врагов."]},{name:"Как будто никто не видит",desc:"",levels:["Дервиш - это юродивый, которого никто не замечает, если он только сам того не хочет. Найти Вас в поселении с помощью Влияния на категорию сложнее.","Паранормальное чувство опасности ведёт Вас, позволяя избегать недоброжелателей. Найти Вас с помощью Влияния или Поиска становится сложнее на две категории. Этот бонус работает как в поселениях, так и в дикой природе.","Если Вас никто не видит, Вы можете делать что захотите. Проверки Диверсии становятся проще на две категории, если Вы лично участвуете в деле."]}]},bard:{id:"bard",name:{m:"Бард",f:"Бард"},desc:"",professions:[],aspects:["society","shadow"],traits:[{name:"А без музыки…",desc:"",levels:["Хотя бардам и не часто приходится участвовать в сражениях, в кабацких драках они бывают чаще прочих. Те, кто не научился защищать себя - попросту не выжили. Потратив два порыва Вы можете провести проверку Влияния против Влияния противника, чтобы отвлечь его и заставить потерять оставшиеся действия и порывы.","Пока Ваша собственная мораль высока и у Вас нет тяжёлых ранений, Вы можете петь в бою, не затрачивая никаких ресурсов. Это укрепляет мораль окружающих, добавляя единицу.","Ваше пение теперь повышает мораль на две единицы, а затратив в свой ход полное действие Вы можете подключить к нему игру на инструменте, попробовав, таким образом, отвлечь внимание сразу всей противников, которые способны Вас видеть и слышать. С высокой долей вероятности они вскоре захотят атаковать Вас."]},{name:"Желанный гость",desc:"",levels:["Любое застолье проходит приятнее под хорошую музыку. Мало кто откажется от присутствия барда на светском рауте. Вы в курсе всех слухов поселения, в котором провели хотя бы один месяц, это упрощает Ваши проверки Влияния в поселении на три категории. ","Если Вы проводите в поселении хотя бы месяц, все фракции кроме враждебных, начинают относиться к Вам как минимум с Симпатией (1).","Если Вы проводите в поселении хотя бы месяц, все фракции кроме враждебных начинают относиться к Вам как к доброму приятелю (Сопереживание, 4), а жители окрестных селений - с Симпатией (1)"]},{name:"Свет клином",desc:"",levels:["Любое тёмное дело гораздо проще провернуть, если в нём участвует яркий фанфарон, привлекающий всё внимание. Вы не можете действовать в одиночку, но облегчаете проверки Диверсии для своих друзей на одну категорию. Этот бонус складывается с другими, которыми они обладают.","Как же не помочь хорошим ребятам! Вы облегчаете проверки Влияния на одну категорию для своих друзей, этот бонус складывается с другими. Размер бонуса к Диверсии увеличивается до двух категорий."," Как складно говорит! Проверки Порядка для Ваших друзей становятся легче на одну, Влияния - на две, Порядка - на три категории. Все эти бонусы складываются с другими, которые есть у этих персонажей."]}]},assassin:{id:"assassin",name:{m:"Убийца",f:"Убийца"},desc:"",professions:[],aspects:["mystics","shadow"],traits:[{name:"Скользящий в тени",desc:"",levels:["Договариваться и подкупать стражу - не для Вас. Вам больше по душе верёвка с крюком и немного акробатики. А ещё Вы тонко чувствуете опасности, потому знаете, куда и когда лучше не соваться. Проверки Диверсии на проникновение на защищаемые объекты легче на две категории. Вы гарантированно успешно проникаете на объект, если его охраняют только Бойцы или ниже.","Затратив полный ход (включая порывы и передвижения) Вы можете попробовать настроиться на своё сверхъестественное чувство и узнать, какие опасности есть поблизости. Этот талант работает нестабильно, но всё же много раз спасал Вам жизнь.","Тени вокруг Вас неестественно темны, а под Вашими шагами не хрустят ветки и не скрипят половицы. Вне боя противник может заметить Вас, только если вы попадёте в его фронтальное поле зрения без укрытия. Противник не может протрубить тревогу в тот же ход, когда обнаружил Вас, если Вы нанесли ему хотя бы лёгкую травму. Проверки Диверсии теперь легче на три категории, если Вы можете обосновать, как будете использовать своё мастерство проникновения. "]},{name:"Летящая смерть",desc:"",levels:["Вопреки расхожим мифам, убийца - вовсе не лучший воин на свете. Ваше лучшее оружие - неожиданность и удары в спину. Затрачивая порыв на передвижение, Вы можете сделать один шаг и метнуть небольшой металлический шип через одну клетку. При попадании, он нанесёт травму категории “царапина”.","Вы можете метать своё оружие через две клетки, а при попадании вы можете выбрать “точный удар” категории царапина или “лёгкая травма”.","Ваши метательные ножи отравлены. Если Вы наносите хотя бы “лёгкую травму” своим метательным шипом, противник подвергается воздействию сильного яда, который удвоит этот урон на следующий ход. Теперь Вы можете метать ножи порывом, не затормаживая своего движения, в Вашем распоряжении остаются все два очка передвижения."]},{name:"Помни о смерти",desc:"",levels:["Хотя вы не афишируете свои умения, многие знают, что Ваши недоброжелатели долго не живут. Кто-то захлебнулся чаем, кто-то накормил в лесу стаю волков, а кто-то упал на собственный кухонный нож 18 раз. Проверки Влияния на две категории (6) проще, если Вы пытаетесь запугать кого-то.","Доказательств нет, но слухи… Преступные сообщества поселения, в котором Вы живёте не менее месяца, относятся к Вам с опаской. Быть безразличными им не удаётся - либо ненависть, либо уважение. Уровни влияния с -2 до +2 недоступны, все сообщества должны выбрать свою сторону. Те, кому Вы не чинили явного зла, будут склонны выбрать дружбу. Переходить из -3 до +3 для Вас вдвое проще, чем в обратную сторону..","Кроме тех, кто Вас боится, есть ещё и те, кто Вам должен. Все проверки Влияния на категорию проще, если Вы провели в этом поселении не менее месяца. Этот бонус складывается с бонусом при угрозах."]}]},shaman:{id:"shaman",name:{m:"Шаман",f:"Шаманка"},desc:"",professions:[],aspects:["mystics","nature"],traits:[{name:"Медвежья шкура",desc:"",levels:["В бою Вы способны впадать в кровавую ярость - за каждую степень этого эффекта Ваши защита и атака повышаются на одну категорию, но Вы не можете сопротивляться соблазну рвать на части зубами и когтями тело поверженного врага, если оказываетесь вплотную к нему. Активация ярости происходит мгновенно, сразу на второй степени. Вы можете потратить действие, чтобы снизить уровень эффекта на единицу, проведя проверку категории Простая + степень эффекта. В случае провала, Вы не можете контролировать своего персонажа следующий ход. Расправа над поверженным занимает целое действие.","За каждого разодранного противника Вы получаете дополнительную степень эффекта, вплоть до пяти. Начиная с третьей, расправа над противником требует только один порыв.","Максимальная степень эффекта теперь шестая. Начиная с третьей Вы мгновенно раздираете противника на части, если добиваете своей атакой. Если же он уже был повержен к тому моменту, Вам требуется один порыв."]},{name:"Я вижу",desc:"",levels:["Духи говорят с Вами, позволяют видеть своими глазами. Вы получаете дополнительную информацию о том, что происходит в пределах километра от Вас. Проверки Поиска легче на одну категорию.","Духи видят прошлое и будущее. Вы можете узнать прошлое и будущее места, которое посетили, если свяжетесь с духами, которые здесь живут. Доступна особая проверка Интуиции, сложность на усмотрение мастера.","Духи помнят, помнят всё. Вы можете ограниченно получать информацию от мёртвых. Доступна особая проверка интуиции, сложность на усмотрение мастера."]},{name:"Видения",desc:"",levels:["Знать - недостаточно, нужно ещё суметь применить эти знания на пользу делу. Вы учитесь использовать полученную информацию для шпионажа и диверсий, таким образом можете облегчить любую проверку Диверсии на одну категорию.","Предупреждён - значит вооружён. Позволяет усложнить вражеские проверки Диверсии против какого-то предприятия на одну категорию.","Удваивает бонусы двух предыдущих уровней этого умения."]}]},shady:{id:"shady",name:{m:"Делец",f:"Делец"},desc:"",professions:[],aspects:["knowledge","shadow"],traits:[{name:"Подлый удар",desc:"",levels:["Вы не рыцарь в сверкающих доспехах, а всего лишь деловой человек, который не хочет проблем. Но иногда проблемы приходят сами… Потратив один порыв Вы можете нанести точный лёгкий удар рукой по противнику. Если Вы держите в руках оружие, считается что Вы ударили рукоятью, гардой, древком. Этот удар гарантировано сработает против противника, который ещё не знает что Вы так умеете. Но только один раз, и всех увидевших Вы уже не сможете удивить повторно.","Ваша точная неожиданная атага теперь наносит лёгкую травму, а не царапину. После такой атаки защита противника снижена на две категории.","Разнообразие. Вы знаете столько приёмов, что можете удивить каждого. Если Вы используете подлый удар, в течении этого хода Вы можете применить его несколько раз до полного исчерпания порывов."]},{name:"Пока никто не видит",desc:"",levels:["Ваша специализация - тёмные дела, чаще всего торговые. Вы проводите теневые сделки проще, зарабатываете с них больше. Проверки проще на одну категорию, прибыль также больше на одну.","Ваши шансы найти что-то действительно ценное значительно повышаются, если Вы занимаетесь торговлей. Поиск через Влияние работает на две категории проще, если Вы знаете, что именно ищете.","Торговля удаётся Вам всё лучше - теперь проверки и прибыль лучше сразу на две категории. Раз в месяц Вы можете провести особенно крупную сделку, с повышенными шансами на провал и на то, что Вас поймают."]},{name:"Повязанные кровью",desc:"",levels:["У Вас обширная сеть контактов в криминальном мире, преимущественно - среди гильдий воров. Ваши отношения с ними изначально на уровне 4, Сопереживание, но могут и меняться со временем.","В любом поселении цивилизованного мира Вы легко можете найти своих. За звонкую монету они готовы выполнить любой заказ. Доступен особый тип наёмников - разъярённые бедняки. Они способны устроить беспорядки в своём селении, но не покинут его пределов.","Вам доступен особый тип наёмников - городские бандиты. Могут наниматься только в крупных городах, их дисциплина хромает, как и мораль. Зато они обходятся крайне дёшево и с такими потерями можно не считаться."]}]},warlock:{id:"warlock",name:{m:"Колдун",f:"Колдунья"},desc:"",professions:[],aspects:["mystics","knowledge"],traits:[{name:"Отражение внутреннего",desc:"",levels:["Вы понимаете, что происходящее во внешнем мире имеет некую таинственную связь с тем, что творится внутри Вашей души. А это значит - расстояния и пространство зыбки, есть нечто более важное. Вы получаете связь с Концептом Пространства, если не имели её раньше. Кроме того, освоение Хаотических Концептов теперь для Вас вдвое дешевле.","Освоение Хаотических и Универсальных Концептов, а так же улучшение связи с ними до второго уровня для Вас вдвое дешевле. ","Освоение и развитие связи с любым концептом для Вас вдвое дешевле. Использование кастов, не содержащих в себе Концептов Порядка удаётся на три категории проще."]},{name:"Огонёк твоей души",desc:"",levels:["Вы получаете связь с Концептом Огня, если не имели её раньше. Кроме того, Вы можете производить касты значительно быстрее, если в них присутствует Огонь. Касты, требовавшие использование порывов, требуют на один меньше, Малый и Быстрый касты могут совершаться одним порывом.","Вы получаете связь с Концептом Безумия, если не имели её раньше. Кроме того, если Вы атакуете плетением из нескольких Концептов (включая Безумие), можете сами выбрать, каким спасброском можно будет защищаться от Вашего каста (из имеющихся в плетении)","Вы получаете связь с Концептом Духа, если не имели её раньше. Ваши касты работают на целый уровень сильнее, когда Вы пытаетесь взаимодействовать с могущественными сущностями."]},{name:"Чистая мощь",desc:"",levels:["Вы можете пожертвовать двумя уровнями контроля каста, чтобы повысить прямой урон на один уровень (но только до уровня Большого каста), вкладывая дополнительный порыв.","Вы можете пожертвовать одним уровнем области воздействия, чтобы сконценрировать эффект на меньшую площать. Прямой урон вырастает на целый уровень. Для этого нужно вложить дополнительный порыв.","Вы можете увеливать прямой урон на один уровень, ничем не жертвуя, лишь вкладывая дополнительный порыв. Кроме того, Вы получаете связь с Концептом Разрушение, если не имели его раньше."]}]},mage:{id:"mage",name:{m:"Маг",f:"Магичка"},desc:"",professions:[],aspects:["mystics","knowledge"],traits:[{name:"Ученье - свет",desc:"",levels:["Изучение науки магии дало свои результаты - теперь Ваш разум достаточно силён, чтобы двигать предметы без помощи тела. Вы получаете связь с Концептом Движения, если не имели её раньше. Кроме того, освоение всех Концептов Порядка для Вас теперь вдвое дешевле.","Вы получаете связь с Концептом Света, если не имели её ранее. Кроме того, изучение Универсальных или Концептов Порядка и укрепление связи до второго уровня теперь вдвое дешевле для Вас.","Мало узнать, нужно ещё и осознать. Вы получаете связь с Концептом Мышление, если не имели её раньше. Кроме того, освоение и укрепление связей с любыми Концептами теперь вдвое дешевле для Вас."]},{name:"Не книгами едиными",desc:"",levels:["Вы практикуетесь в магических воздействиях почти постоянно, и теперь базовая сложность любой проверки для Вас на категорию ниже.","Вы получаете связь с Концептом Времени, и учитесь производить касты значительно быстрее. Даже если Вы не включили его в плетение, каст происходит на категорию быстрее (порыв для Быстрого, основное действие для Малого, на один порыв меньше для остальных)","Постоянно комбинируя разные Концепты в плетениях, вы учитесь лучше связывать их друг с другом. При добавлении дополнительного концепта в каст, сложность для Вас увеличивается не на две категории, а на одну. "]},{name:"Холодный разум",desc:"",levels:["Самое главное в применении магии - не сделать хуже. Вы учитесь сдерживать негативные последствия проваленных кастов. Если провален каст уровнем ниже Среднего, ничего не происходит. Кроме того, затратив дополнительный порыв, Вы можете увеличить уровень контроля каста на один.","Безопасность - на первом месте. Вы можете сдержать негативные эффекты даже Великого каста. Затратив дополнительный порыв, Вы можете увеличить продолжительность магических эффектов на один уровень или уровень контроля - на два.","Вы получаете связь с Концептом Холода, если не имели его раньше. Затратив один порыв, Вы можете один раз в ход попробовать перехватить контроль над проваленным кастом источник которого (в том числе перенесённый особыми эффектами) находится в пределах пяти метров от Вас. Чтобы преуспеть, Вам нужно выбросить на кубике d12 больше, чем кастер."]}]}},ko={noble_child:{name:"Благородный",text:"Вы происходите из богатого и влиятельного рода, хоть и пытаетесь действовать без их опеки. Возможно Вы чем-то разочаровали своих родителей или хотите что-то им доказать? Живы ли они вообще? Так или иначе, Вам значительно проще найти общий язык с другими благородными, а вот простой люд обычно считает Вас зарвавшимся и высокомерным",trait:"Проверки Влияния проще на категорию при общении с благородными, тяжелее на категорию с остальными"},street_urchin:{name:"Городской сорванец",text:"Пока другие учились ремёслам или помогали родителям, срывая спины на тяжёлой работе, Вы убегали от стражников по узким городским улочкам. В Вашу память врезалось главное правило: всё что ты нашёл - может быть твоим. Если достаточно быстро бегать, конечно.",trait:"Все проверки Поиска проще на категорию, все проверки Порядка - сложнее на категорию."},apprentice:{name:"Подмастерье",text:"В чём разница между сложным и тяжёлым? Сложная работа достаётся мастеру, а вот тяжёлая - подмастерью. Ваш учитель брался только за самые сложные заказы, а остальное время почти всегда отдыхал, пока Вы горбатились. Дураку бы стало понятно, что чтобы жить хорошо, нужно стать мастером. А Вы - совсем не дурак.",trait:"Проверки Порядка проще на категорию, проверки Влияния - сложнее на категорию."},farmer_child:{name:"Сельский",text:"Ваша семья - не самые умные или богатые, зато таких называют солью земли. Простые крестьяне живут своим трудом, кормят со своей земли всех тех, кто её топчет. Включая всех этих вояк и лордов. ",trait:"Проверки Поиска на одну категорию проще, проверки Влияния на категорию прощее при общении с простыми людьми, на категорию сложнее - при общении с благородными."},trader_child:{name:"Серебряная ложка",text:"Вы родились в семье успешного купца, и до самой юности ни в чём не знали нужды. Однако всё хорошее когда-нибудь заканчивается, и теперь Вам нужно самому искать своё место в жизни. Наверное, впитанные Вами знания сумеют в этом как-то помочь.",trait:"При попытках купить нечто дешевле или продать дороже, Ваши проверки Влияния на категорию проще. Однако, Вы расточительны и Вам нужен доход на один уровень выше, чтобы иметь какой-то уровень Богатства"},warrior_child:{name:"Наследник",text:"Ваш отец был воином, причём далеко не из последних. Учить Вас своему ремеслу он не хотел, зато об ужасах войны рассказывал очень много. Думал, что хотя бы так Вы не пойдёте по его стопам. Но теперь он Вам больше не указ и Вы можете сами выбирать свою судьбу.",trait:"При выборе начального снаряжения Вы можете выбрать одно воинское оружие, даже не имея достаточного Богатства. Каждый бой Вы начинаете с единицей положительной морали, но все проверки Хаоса и Порядка для Вас сложнее на категорию"},knight_child:{name:"Рыцарёнок",text:"Мелкие феодалы не любимы никем - лорды не считаются с ними как с равными, крестьяне ненавидят из-за налогообложения... даже для других рыцарей ты скорее соперник, чем соратник. Вы росли в условиях, когда все кто не семья - враги. А теперь ещё и покинули родовое гнездо.",trait:"При выборе начального снаряжения Вы можете выбрать два воинских оружия и доспех, даже не имея достаточного Богатства. Все проверки Поиска и Влияния тяжелее на категорию."},cult_child:{name:"Послушник",text:"Ваше детство прошло в служении сверхъестественному. Ритуалы и аскеза для Вас гораздо понятнее, чем каждодневный труд или, тем более, военные сражения.",trait:"Проверки Хаоса проще на категорию, как и проверки Влияния при общении со служителями любых культов. Защита и нападение в бою сложнее на одну категорию."}},ql={1:{name:"Крайняя бедность"},2:{name:"Бедность"},3:{name:"Умеренная бедность"},4:{name:"Ниже среднего"},5:{name:"Среднее благополучие"},6:{name:"Выше среднего"},7:{name:"Небольшое богатство"},8:{name:"Богатство"},9:{name:"Огромное богатство"},10:{name:"Умопомрачительное богатство"}},jb={1:{name:"Каменный век"},2:{name:"Железный век"},3:{name:"Тёмные века"},4:{name:"Античность"},5:{name:"Раннее средневековье"},6:{name:"Средние века"},7:{name:"Ренессанс"},8:{name:"Век пара"},9:{name:"Век дизеля"},10:{name:"Современность"},11:{name:"Кибер век"}},un={clothes:{category:"armor",subcat:"light",name:"Обычная одежда",desc:"Надевать такую в бой - довольно сомнительная затея. Однако на полях сражений нередко оказывались те, кто не смог себе позволить вовсе никакую броню. А иногда и серьёзных воинов нападение заставало не готовыми, погружёнными в обычные бытовые проблемы.",price:1,epoch:1,defence:0,resist:0,movement:0,bursts:0},makeshift_light_armor:{category:"armor",subcat:"light",name:"Крепкая одежда",desc:"Некоторые виды одежды лучше других держат удар, что позволяет использовать их в качестве импровизированной брони. Это может быть куртка из толстой кожи, шкура зверя или вовсе обычные одеяния, на которые нашили твёрдые элементы.",price:3,epoch:2,defence:3,resist:0,movement:0,bursts:0},makeshift_heavy_armor:{category:"armor",subcat:"heavy",name:"Кустарная тяжёлая броня",desc:"Хорошенько потрудившись, можно сделать из обычной одежды некое подобие брони. Обилие нашитых элементов здорово сковывает движение, зато такой доспех снижает входящий урон и (главное), очень дёшев в производстве.",price:3,epoch:2,defence:0,resist:1,movement:-1,bursts:-1},light_armor:{category:"armor",subcat:"light",name:"Лёгкая броня",desc:"Лёгкая броня не сковывает движений и даёт кое-какую защиту - попасть в уязвимое место противнику становится значительно сложнее.",price:5,epoch:4,defence:6,resist:0,movement:0,bursts:0},heavy_armor:{category:"armor",subcat:"heavy",name:"Тяжёлая броня",desc:"Хорошая тяжёлая броня лишь немного сковывает движения, но уворачиваться в ней уже гораздо сложнее. Зато, если по Вам всё же попали, урона Вы получите значительно меньше.",price:5,epoch:4,defence:0,resist:1,movement:-1,bursts:0},late_light_armor:{category:"armor",subcat:"light",name:"Поздняя лёгкая броня",desc:"Позволить себе такой шедевр мастерства бронников могут не многие, зато живут на поле боя эти счастливчики гораздо дольше других. Защищённых областей на теле больше, а маневренность при этом никак не страдает.",price:7,epoch:6,defence:12,resist:0,movement:0,bursts:0},late_medium_armor:{category:"armor",subcat:"middle",name:"Поздняя средняя броня",desc:"Хороший компромисс между подвижностью и защищённостью, но по совершенно бескомпромиссной цене. ",price:7,epoch:6,defence:3,resist:1,movement:0,bursts:0},late_heavy_armor:{category:"armor",subcat:"light",name:"Поздняя тяжёлая броня",desc:"Для тех, кто хочет почувствовать себя настоящим танком на поле боя - беспрецедентный уровень защищённости при минимальной подвижности. Несмотря на огромную цену этих доспехов, вряд ли найдётся идиот, который захочет сразиться с Вами ради такого трофея.",price:7,epoch:6,defence:0,resist:2,movement:-1,bursts:0},simple_spear:{category:"weapon",subcat:"spears",name:"Простое копьё",desc:"",length:2,hands:1,price:2,epoch:1,attack:4,defence:3,damage_type:"Колющий",armor_pen:0,damage:{0:"Царапина",3:"Лёгкий урон",6:"Точный удар"}},iron_spear:{category:"weapon",subcat:"spears",name:"Боевое копьё",desc:"",length:2,hands:1,price:4,epoch:4,attack:4,defence:3,damage_type:"Колющий",armor_pen:0,damage:{0:"Царапина",3:"Лёгкий урон",6:"Точный удар",9:"Тяжёлый урон",12:"Застревание"}},steel_spear:{category:"weapon",subcat:"spears",name:"Стальное копьё",desc:"",length:2,hands:1,price:6,epoch:6,attack:6,defence:4,damage_type:"Колющий",armor_pen:0,damage:{0:"Царапина",2:"Лёгкий урон",4:"Точный удар",6:"Тяжёлый урон",9:"Огромный урон"}},iron_glaive:{category:"weapon",subcat:"spears",name:"Глефа",desc:"",length:2,hands:2,price:5,epoch:5,attack:6,defence:2,damage_type:"Рубящий",armor_pen:0,damage:{0:"Лёгкий урон",3:"Тяжёлый урон",6:"Точный удар",9:"Огромный урон"}},steel_glaive:{category:"weapon",subcat:"spears",name:"Стальная глефа",desc:"",length:2,hands:2,price:7,epoch:7,attack:8,defence:4,damage_type:"Рубящий",armor_pen:0,damage:{0:"Лёгкий урон",2:"Тяжёлый урон",4:"Точный удар",8:"Огромный урон"}},iron_halberd:{category:"weapon",subcat:"spears",name:"Алебарда",desc:"",length:2,hands:2,price:5,epoch:5,attack:4,defence:3,damage_type:"Рубящий",armor_pen:0,damage:{0:"Лёгкий урон",2:"Тяжёлый урон",6:"Огромный урон"}},steel_halberd:{category:"weapon",subcat:"spears",name:"Стальная алебарда",desc:"",length:2,hands:2,price:7,epoch:7,attack:5,defence:4,damage_type:"Рубящий",armor_pen:0,damage:{0:"Лёгкий урон",2:"Тяжёлый урон",6:"Огромный урон"}},simple_bow:{category:"weapon",subcat:"bows",name:"Короткий лук",desc:"",spec:"Нельзя стрелять с порывом",length:2,hands:2,price:3,epoch:2,attack:6,defence:0,damage_type:"Колющий",armor_pen:0,damage:{0:"Царапина",3:"Лёгкий урон",6:"Точный удар"}},strong_bow:{category:"weapon",subcat:"bows",name:"Боевой лук",desc:"",spec:"",length:2,hands:2,price:4,epoch:4,attack:6,defence:0,damage_type:"Колющий",armor_pen:0,damage:{0:"Царапина",3:"Лёгкий урон",6:"Точный удар",9:"Тяжёлый урон"}},longbow:{category:"weapon",subcat:"bows",name:"Длинный лук",desc:"",spec:"Нельзя стрелять без порыва. Можно вкладывать в выстрел второй порыв, тогда игнорирует единицу брони.",length:2,hands:2,price:5,epoch:4,attack:6,defence:0,damage_type:"Колющий",armor_pen:0,damage:{0:"Лёгкий урон",3:"Точный удар",6:"Тяжёлый урон",12:"Огромный урон"}},stone_knife:{category:"weapon",subcat:"daggers",name:"Простой нож",desc:"",length:1,hands:.5,price:1,epoch:1,attack:2,defence:0,damage_type:"Колющий",armor_pen:0,damage:{0:"Царапина",3:"Лёгкий урон",5:"Точный удар"}},knife:{category:"weapon",subcat:"daggers",name:"Добротный нож",desc:"",length:1,hands:.5,price:2,epoch:2,attack:2,defence:1,damage_type:"Колющий",armor_pen:0,damage:{0:"Царапина",2:"Лёгкий урон",3:"Точный удар"}},steel_dagger:{category:"weapon",subcat:"daggers",name:"Cтальной кинжал",desc:"",length:1,hands:.5,price:5,epoch:4,attack:3,defence:1,damage_type:"Колющий",armor_pen:0,damage:{0:"Царапина",2:"Лёгкий урон",3:"Точный удар",4:"Тяжёлый урон"}},stiletto:{category:"weapon",subcat:"daggers",name:"Стилет",desc:"Стилет не особенно то удобен в бою, зато замечательно пронзает многие виды доспехов.",length:1,hands:.5,price:6,epoch:5,attack:2,defence:0,damage_type:"Колющий",armor_pen:2,damage:{0:"Царапина",2:"Лёгкий урон",3:"Точный удар",6:"Тяжёлый урон"}},main_gauche:{category:"weapon",subcat:"daggers",name:"Дага",desc:"Дага - преимущественно защитный кинжал во вторую руку, тем не менее может применяться и для нанесения серьёзных ударов. Особенно, если вражеская защита пробита. Атаки дагой во второй руке могут наносить ту же категорию ранения, что и атаки основным оружием, а не на категорию ниже, как обычно.",length:1,hands:1,price:6,epoch:5,attack:2,defence:4,damage_type:"Колющий",armor_pen:0,damage:{0:"Царапина",2:"Лёгкий урон",3:"Точный удар",6:"Тяжёлый урон"}},wooden_flail:{category:"weapon",subcat:"flails",name:"Цеп",desc:"",length:1,hands:1,price:1,epoch:2,attack:6,defence:0,damage_type:"Дробящий",armor_pen:1,damage:{0:"Царапина",3:"Лёгкий урон"}},iron_flail:{category:"weapon",subcat:"flails",name:"Железный цеп",desc:"",length:2,hands:1,price:5,epoch:4,attack:8,defence:0,damage_type:"Дробящий",armor_pen:1,damage:{0:"Царапина",6:"Лёгкий урон",12:"Тяжёлый урон",15:"Точный удар"}},steel_flail:{category:"weapon",subcat:"flails",name:"Железный цеп",desc:"",length:2,hands:1,price:6,epoch:6,attack:9,defence:0,damage_type:"Дробящий",armor_pen:1,damage:{0:"Царапина",6:"Лёгкий урон",9:"Тяжёлый урон",12:"Точный удар"}},wooden_club:{category:"weapon",subcat:"maces",name:"Дубинка",desc:"",length:1,hands:1,price:1,epoch:1,attack:2,defence:2,damage_type:"Дробящий",armor_pen:1,damage:{0:"Царапина",6:"Лёгкий урон"}},simple_staff:{category:"weapon",subcat:"maces",name:"Простой посох",desc:"",length:2,hands:2,price:1,epoch:1,attack:2,defence:2,damage_type:"Дробящий",armor_pen:0,damage:{0:"Царапина",6:"Лёгкий урон"}},battle_staff:{category:"weapon",subcat:"maces",name:"Простой посох",desc:"",length:2,hands:2,price:1,epoch:1,attack:4,defence:2,damage_type:"Дробящий",armor_pen:0,damage:{0:"Царапина",5:"Лёгкий урон",10:"Тяжёлый урон"}},steel_staff:{category:"weapon",subcat:"maces",name:"Простой посох",desc:"",length:2,hands:2,price:1,epoch:1,attack:4,defence:4,damage_type:"Дробящий",armor_pen:1,damage:{0:"Царапина",5:"Лёгкий урон",10:"Тяжёлый урон"}},iron_mace:{category:"weapon",subcat:"maces",name:"Булава",desc:"",length:1,hands:1,price:5,epoch:4,attack:4,defence:2,damage_type:"Дробящий",armor_pen:1,damage:{0:"Царапина",6:"Тяжёлый урон",12:"Точный удар"}},steel_mace:{category:"weapon",subcat:"maces",name:"Булава",desc:"",length:1,hands:1,price:7,epoch:6,attack:5,defence:3,damage_type:"Дробящий",armor_pen:1,damage:{0:"Царапина",2:"Лёгкий урон",4:"Тяжёлый урон",6:"Точный удар"}},simple_axe:{category:"weapon",subcat:"axes",name:"Плотницкий топор",desc:"",length:1,hands:1,price:2,epoch:1,attack:4,defence:2,damage_type:"Режущий",armor_pen:0,damage:{0:"Царапина",8:"Тяжёлый урон",9:"Точный удар"}},battle_axe:{category:"weapon",subcat:"axes",name:"Боевой топорик",desc:"",length:1,hands:1,price:5,epoch:4,attack:6,defence:3,damage_type:"Режущий",armor_pen:0,damage:{0:"Царапина",3:"Лёгкий урон",6:"Точный удар",9:"Тяжёлый урон"}},steel_axe:{category:"weapon",subcat:"axes",name:"Стальной топор",desc:"",length:1,hands:1,price:6,epoch:7,attack:8,defence:3,damage_type:"Режущий",armor_pen:0,damage:{0:"Царапина",2:"Лёгкий урон",4:"Точный удар",6:"Тяжёлый урон"}},battle_greataxe:{category:"weapon",subcat:"axes",name:"Двуручный топор",desc:"",length:2,hands:2,price:6,epoch:5,attack:6,defence:3,damage_type:"Режущий",armor_pen:0,damage:{0:"Лёгкий урон",3:"Тяжёлый урон",9:"Огромный урон",12:"Точный удар"}},steel_greataxe:{category:"weapon",subcat:"axes",name:"Стальной двуручный топор",desc:"",length:2,hands:2,price:7,epoch:7,attack:8,defence:3,damage_type:"Режущий",armor_pen:0,damage:{0:"Лёгкий урон",2:"Тяжёлый урон",8:"Огромный урон",10:"Точный удар"}},stone_hammer:{category:"weapon",subcat:"maces",name:"Каменный молоток",desc:"",length:1,hands:1,price:2,epoch:2,attack:2,defence:0,damage_type:"Дробящий",armor_pen:1,damage:{0:"Лёгкий урон",6:"Тяжёлый урон",12:"Точный удар"}},stone_greathammer:{category:"weapon",subcat:"maces",name:"Каменная кувалда",desc:"",length:2,hands:2,price:2,epoch:2,attack:0,defence:0,damage_type:"Дробящий",armor_pen:1,damage:{0:"Тяжёлый урон",6:"Огромный урон"}},iron_hammer:{category:"weapon",subcat:"maces",name:"Железный молот",desc:"",length:1,hands:1,price:3,epoch:3,attack:3,defence:0,damage_type:"Дробящий",armor_pen:1,damage:{0:"Лёгкий урон",5:"Тяжёлый урон",10:"Точный удар"}},iron_greathammer:{category:"weapon",subcat:"maces",name:"Железная кувалда",desc:"",length:2,hands:2,price:5,epoch:4,attack:0,defence:0,damage_type:"Режущий",armor_pen:1,damage:{0:"Тяжёлый урон",5:"Огромный урон"}},iron_warhammer:{category:"weapon",subcat:"maces",name:"Железный боевой молот",desc:"",length:1,hands:1,price:4,epoch:4,attack:4,defence:0,damage_type:"Дробящий",armor_pen:2,damage:{0:"Лёгкий урон",6:"Тяжёлый урон",12:"Точный удар"}},iron_greatwarhammer:{category:"weapon",subcat:"maces",name:"Двуручный боевой молот",desc:"",length:2,hands:2,price:6,epoch:5,attack:2,defence:0,damage_type:"Дробящий",armor_pen:2,damage:{0:"Тяжёлый урон",6:"Огромный урон",12:"Точный удар"}},steel_warhammer:{category:"weapon",subcat:"maces",name:"Стальной боевой молот",desc:"",length:1,hands:1,price:6,epoch:7,attack:5,defence:2,damage_type:"Дробящий",armor_pen:2,damage:{0:"Лёгкий урон",4:"Тяжёлый урон",8:"Точный удар"}},steel_greatwarhammer:{category:"weapon",subcat:"maces",name:"Длинный стальной боевой молот",desc:"",length:2,hands:2,price:7,epoch:7,attack:3,defence:2,damage_type:"Дробящий",armor_pen:2,damage:{0:"Тяжёлый урон",4:"Огромный урон",8:"Точный удар"}},wooden_buckler:{category:"shield",subcat:"shields",name:"Деревянный баклер",desc:"",spec:"Баклер может использоваться для атак, как второе оружие.",length:0,hands:.5,price:5,epoch:4,attack:1,defence:{front:{melee:3,ranged:3},side:{melee:3,ranged:0}}},wooden_shield:{category:"shield",subcat:"shields",name:"Деревянный щит",desc:"",spec:"Небольшим щитом можно толкать противника, затратив один порыв.",length:0,hands:1,price:4,epoch:3,attack:1,defence:{front:{melee:6,ranged:6}}},large_wooden_shield:{category:"shield",subcat:"shields",name:"Большой деревянный щит",desc:"",length:0,hands:1,price:5,epoch:3,defence:{front:{melee:6,ranged:9}}},wooden_tower_shield:{category:"shield",subcat:"shields",name:"Деревянный башенный щит",desc:"",length:0,hands:1,price:5,epoch:3,movement:-1,attack:-3,defence:{front:{melee:9,ranged:12}}},metal_buckler:{category:"shield",subcat:"shields",name:"Стальной баклер",desc:"",spec:"Баклер может использоваться для атак, как второе оружие.",length:0,hands:.5,price:6,epoch:6,attack:3,defence:{front:{melee:6,ranged:3},side:{melee:6,ranged:0}}},metal_shield:{category:"shield",subcat:"shields",name:"Стальной щит",desc:"",spec:"Небольшим щитом можно толкать противника, затратив один порыв.",length:0,hands:1,price:7,epoch:6,attack:3,defence:{front:{melee:6,ranged:6}}},large_metal_shield:{category:"shield",subcat:"shields",name:"Большой стальной щит",desc:"",length:0,hands:1,price:5,epoch:7,attack:1,defence:{front:{melee:9,ranged:9}}},metal_tower_shield:{category:"shield",subcat:"shields",name:"Cтальной башенный щит",desc:"",length:0,hands:1,price:7,epoch:7,defence:{front:{melee:12,ranged:12}}},iron_shortsword:{category:"weapon",subcat:"swords",name:"Короткий меч",desc:"",length:1,hands:1,price:4,epoch:3,attack:3,defence:5,damage_type:"Режущий",armor_pen:0,damage:{0:"Царапина",4:"Лёгкий урон",8:"Точный удар",12:"Тяжёлый урон"}},iron_sword:{category:"weapon",subcat:"swords",name:"Меч пехотинца",desc:"",length:2,hands:1,price:4,epoch:4,attack:5,defence:5,damage_type:"Режущий",armor_pen:0,damage:{0:"Царапина",3:"Лёгкий урон",6:"Точный удар",10:"Тяжёлый урон"}},iron_falchion:{category:"weapon",subcat:"swords",name:"Фальшион",desc:"",length:1,hands:1,price:4,epoch:4,attack:7,defence:4,damage_type:"Режущий",armor_pen:0,damage:{0:"Царапина",3:"Лёгкий урон",6:"Точный удар",10:"Тяжёлый урон"}},iron_greatsword:{category:"weapon",subcat:"swords",name:"Двуручный меч",desc:"",length:2,hands:2,price:5,epoch:4,attack:6,defence:3,damage_type:"Режущий",armor_pen:0,damage:{0:"Лёгкий урон",4:"Тяжёлый урон",8:"Огромный урон"}},steel_shortsword:{category:"weapon",subcat:"swords",name:"Стальной короткий меч",desc:"",length:1,hands:1,price:6,epoch:6,attack:4,defence:5,damage_type:"Режущий",armor_pen:0,damage:{0:"Царапина",3:"Лёгкий урон",6:"Точный удар",9:"Тяжёлый урон"}},steel_sword:{category:"weapon",subcat:"swords",name:"Стальной меч",desc:"",length:2,hands:1,price:7,epoch:6,attack:6,defence:6,damage_type:"Режущий",armor_pen:0,damage:{0:"Царапина",2:"Лёгкий урон",4:"Точный удар",8:"Тяжёлый урон"}},steel_saber:{category:"weapon",subcat:"swords",name:"Сабля",desc:"",length:2,hands:1,price:7,epoch:7,attack:8,defence:3,damage_type:"Режущий",armor_pen:0,damage:{0:"Царапина",3:"Лёгкий урон",6:"Тяжёлый урон",8:"Точный удар"}},steel_scimitar:{category:"weapon",subcat:"swords",name:"Скимитар",desc:"",length:2,hands:1,price:7,epoch:7,attack:9,defence:2,damage_type:"Режущий",armor_pen:0,damage:{0:"Царапина",3:"Лёгкий урон",6:"Тяжёлый урон",9:"Точный удар"}},steel_greatsword:{category:"weapon",subcat:"swords",name:"Качественный двуручный меч",desc:"",length:2,hands:2,price:5,epoch:4,attack:7,defence:4,damage_type:"Режущий",armor_pen:0,damage:{0:"Лёгкий урон",4:"Тяжёлый урон",6:"Огромный урон"}},rapier:{category:"weapon",subcat:"swords",name:"Рапира",desc:"",length:2,hands:1.5,price:6,epoch:7,attack:7,defence:3,damage_type:"Колющий",armor_pen:0,damage:{0:"Царапина",2:"Лёгкий урон",6:"Точный удар",8:"Тяжёлый урон"}},hand_crossbow:{category:"weapon",subcat:"crossbows",name:"Ручной арбалет",desc:"Требует порыва на перезарядку",length:2,hands:1.5,price:5,epoch:5,attack:4,defence:0,damage_type:"Колющий",armor_pen:0,damage:{0:"Царапина",5:"Лёгкий урон"}},crossbow:{category:"weapon",subcat:"crossbows",name:"Арбалет",desc:"Требуется два порыва или полное основное действие на перезарядку",length:2,hands:2,price:6,epoch:5,attack:6,defence:0,damage_type:"Колющий",armor_pen:0,damage:{0:"Царапина",4:"Лёгкий урон",6:"Точный удар",8:"Тяжёлый урон"}},heavy_crossbow:{category:"weapon",subcat:"crossbows",name:"Арбалет",desc:"Требуется полное действие и один порыв на перезарядку, в процессе нельзя передвигаться.",length:2,hands:2,price:6,epoch:5,attack:8,defence:0,damage_type:"Колющий",armor_pen:1,damage:{0:"Царапина",4:"Лёгкий урон",6:"Точный удар",8:"Тяжёлый урон"}},sling:{category:"weapon",subcat:"slings",name:"Простая праща",desc:"",spec:"Нельзя стрелять с порывом",length:2,hands:2,price:2,epoch:2,attack:3,defence:0,damage_type:"Дробящий",armor_pen:0,damage:{0:"Царапина",3:"Лёгкий урон"}},heavy_sling:{category:"weapon",subcat:"slings",name:"Боевая праща",desc:"",spec:"Нельзя стрелять без порыва",length:2,hands:2,price:4,epoch:3,attack:4,defence:0,damage_type:"Дробящий",armor_pen:0,damage:{0:"Царапина",3:"Лёгкий урон",9:"Тяжёлый урон"}}},ra={spears:{icon:"game-icons:broadhead-arrow"},swords:{icon:"game-icons:croc-sword"},daggers:{icon:"game-icons:plain-dagger"},bows:{icon:"game-icons:bow-arrow"},crossbows:{icon:"game-icons:crossbow"},slings:{icon:"game-icons:sling"},axes:{icon:"game-icons:battered-axe"},maces:{icon:"game-icons:flanged-mace"},flails:{icon:"game-icons:flail"},shields:{icon:"game-icons:round-shield"}},Ei={war:"Война",knowledge:"Знание",society:"Общество",shadow:"Тень",mystics:"Мистика",nature:"Природа",might:"Мощь",reason:"Разум",charisma:"Харизма",trickery:"Хитрость",intuition:"Интуиция",perception:"Восприятие",attack:"Конфликт",order:"Порядок",impact:"Влияние",defence:"Коварство",chaos:"Хаос",research:"Поиск"},G3={flex:"","flex-col":""},q3={flex:"","justify-between":"","bg-zinc-700":"","p-2":"","pb-1":"","border-t-2":"","border-zinc-500":"",fixed:"","bottom-0":"","right-0":"","left-0":"","h-16":"","z-20":""},Y3={key:0},X3={key:1},K3=v("h1",null,"Вид",-1),J3=v("p",{med:""},' Биологический вид Вашего персонажа, также известный как "раса", влияет на некоторые стартовые характеристики и склонность к тому или иному Аспекту. ',-1),Z3=v("p",{det:""}," На первом уровне представители разных рас мало чем отличаются, иначе мир бы уже давно завоевала какая-то одна. Но по мере развития (на 3, 6, 9 и далее каждом третьем уровне) они получают бонусы к связанному Аспекту. ",-1),Q3=v("p",{det:""},[he(" Например, для эльфов это "),v("span",{nature:""},"Природа"),he(" и "),v("span",{knowledge:""},"Знание"),he(", а для людей - "),v("span",{knowledge:""},"Знание"),he(" и "),v("span",{war:""},"Война"),he(". Значит, что на каждом третьем уровне персонажи этих видов будут получать бонусы к Аспекту, даже если их класс этого не позволяет. ")],-1),eC=["onClick"],tC=["src"],iC={key:1,flex:"","flex-col":""},rC={class:"grid grid-cols-1 md:grid-cols-[_1fr_3fr] gap-3"},nC=["src"],sC={block:""},oC=v("div",{bold:"","mt-0":"","pt-0":"","text-center":"","self-center":""},"Стартовые значения:",-1),aC={class:"grid grid-cols-4"},lC={flex:"","flex-col":"","text-center":"","text-blue-500":"","my-1":"","col-span-1":""},cC=v("stat-hint",{"text-xs":""}," скорость ",-1),dC={"text-3xl":"",flex:"",class:"justify-center items-center"},uC={"inline-block":""},hC={flex:"","flex-col":"","text-center":"","text-amber-300":"","my-1":""},fC=v("stat-hint",{"text-xs":""}," порывов ",-1),pC={"text-3xl":"",flex:"",class:"justify-center items-center"},mC={"inline-block":""},gC={flex:"","flex-col":"","text-center":"","text-red-400":"","my-1":""},vC=v("stat-hint",{"text-xs":""}," здоровья ",-1),bC={"text-3xl":"",flex:"",class:"justify-center items-center"},yC={"inline-block":""},_C={flex:"","flex-col":"","text-center":"","text-green-300":"","my-1":""},wC=v("stat-hint",{"text-xs":""}," брони ",-1),xC={"text-3xl":"",flex:"",class:"justify-center items-center"},SC={"inline-block":""},MC={"font-bold":"","color-gray-300":""},EC=v("span",null,"Связанные Аспекты",-1),kC={"font-bold":"","color-gray-300":""},CC={key:0},TC={key:1,"justify-center":""},AC={key:2},LC={key:0},DC=v("h1",null,"Выберите класс",-1),PC=v("p",{med:""}," Класс - нечто вроде профессии Вашего персонажа. Он определяет его способности и приверженность каким-то Аспектам. ",-1),RC=v("p",{det:""},"Наёмный убийца - совсем не то же самое, что бравый воин или умелый ремесленник.",-1),IC=v("p",{det:""}," Колдун, призывающий духов и демонические сущности, верит совсем не в то же самое, во что учёный-естествознатель. Скальд хорошо разбирается в героических сагах, которыми он зажигает сердца людей, но гораздо хуже - в тонкостях жизни диких животных. ",-1),OC=v("p",{det:""}," Выбирая стартовый класс, Вы получаете также два связанных с ним Аспекта, а ваши значения связанных с ними характеристик будут максимальными. ",-1),FC=v("p",{med:""}," При получении новых уровней, Вы сможете получать новые классы и Аспекты, характеристики и умения, но Аспекты противоположные взятым будут для Вас закрыты. ",-1),zC={flex:"","flex-col":"","my-2":"","border-1":"","border-slate-900":"","rounded-md":"","bg-slate-900":"","py-2":""},NC={flex:"","items-center":"","py-1":""},$C=v("h2",{class:"basis-1/2 text-xl uppercase font-normal","m-0":"","p-0":"","self-center":"","text-center":"","basis-0":""}," Фильтр: ",-1),BC=["onClick"],VC=["onClick"],HC=["src"],UC={key:1},jC={flex:"","gap-2":""},WC={"rounded-md":"","overflow-hidden":"","border-2":"","border-slate-600":""},GC=["src"],qC={"rounded-md":"","overflow-hidden":"","border-2":"","border-slate-600":""},YC=["src"],XC=v("b",null,"Краткое описание:",-1),KC={"font-bold":"","color-gray-300":""},JC=v("span",null,"Связанные Аспекты",-1),ZC={"font-bold":"","color-gray-300":""},QC=v("b",null,"Сильные характеристики:",-1),eT=v("b",null,"Сильные проверки:",-1),tT={"mr-1":""},iT=v("p",null,[v("b",null," Умения: ")],-1),rT={block:""},nT={class:"list-decimal ml-4"},sT=["innerHTML"],oT={key:3},aT=v("h1",null,"Профиль",-1),lT={flex:"","gap-2":""},cT=["src"],dT={flex:"","flex-col":"","justify-between":"","basis-1":"","grow-1":""},uT=v("h2",null,"Происхождение:",-1),hT={class:"rounded-md flex flex-col border px-2 pb-1 border-slate-600 my-2 align-middle"},fT=v("b",null,"Эффект: ",-1),pT=v("h2",null,"Возраст персонажа:",-1),mT=v("p",{det:""},"В отличие от пола, возраст влияет на многое.",-1),gT=v("p",{det:""}," Совсем юные персонажи полны энергии и имеют целый дополнительный порыв, но ещё не научились изучать действительно полезные вещи, потому получают меньше опыта за каждый новый уровень. Они двигаются быстрее, легче переживают травмы. ",-1),vT=v("p",{det:""}," Самые же старые, наоборот, имеют большой запас жизненного опыта, но тело уже начинает их подводить. Они начинают игру с дополнительными очками опыта, но сниженной скоростью и здоровьем. ",-1),bT=v("p",{det:""}," Немаловажно так же количество предысторий (жизненных вех) - у юнцов ещё всё впереди, а вот те, кто старше, могли успеть побывать солдатами или мастеровыми, путешествовать по далёким землям или обзавестись полезными связами. Каждая предыстория даёт небольшое ситуативное преимущество, которое может сыграть свою роль в партии. ",-1),yT=["onClick"],_T={flex:"","justify-between":"","flex-wrap":""},wT={class:"basis-1/2 text-xl uppercase font-normal","m-0":"","p-0":"","self-center":"","text-center":""},xT={"text-red-400":""},ST={"inline-block":""},MT=v("stat-hint",null," здоровья ",-1),ET={"text-blue-500":""},kT={"inline-block":""},CT=v("stat-hint",null," скорость ",-1),TT={"text-amber-300":""},AT={"inline-block":""},LT=v("stat-hint",null," порывов ",-1),DT={"text-zinc-400":""},PT={"inline-block":""},RT=v("stat-hint",null," опыта на старте ",-1),IT={"text-teal-300":""},OT={"inline-block":""},FT=v("stat-hint",null," за уровень ",-1),zT={"text-purple-300":""},NT={"inline-block":""},$T=v("stat-hint",null," предысторий ",-1),BT=v("div",{class:"flex items-center text-xl"},"Выберите подходящий портрет",-1),VT={flex:"","flex-wrap":"","gap-2":""},HT=["onClick"],UT=["src"],jT={key:1,"text-red-400":"","text-center":""},WT={key:2,"text-red-400":"","text-center":""},GT={key:4},qT=v("h1",null,"Характеристики и умения",-1),YT=v("p",{med:""}," У всех персонажей в игре есть 6 характеристик, по одной связанной с каждым Аспектом. ",-1),XT=v("p",{med:""}," Когда персонаж хочет сделать что-то сложное, то в чём можно как преуспеть, так и провалиться, мастер просит его пройти Проверку, бросив кубик d12. Есть так же 6 видов этих Проверок, по одной на каждый Аспект (и на каждую Характеристику). ",-1),KT=v("p",{med:""},"Проходить Проверки проще, если Ваши связанные характеристики выше",-1),JT=v("ul",{det:""},[v("li",null,[he(" Проверки "),v("span",{war:""},"Конфликта"),he(" отвечают за атаку в бою, планирование нападений на глобальной карте, открытый физический конфликт в социальных взаимодействиях. Зависит от характеристики Мощь, и в меньшей степени от Разума и Восприятия. Если Ваш показатель Хитрости значительно выше их, то и от Хитрости. ")]),v("li",null,[v("span",{knowledge:""},"Порядок"),he(" отвечает за все попытки организации, ремёсла и науку, включая магические искусства. Зависит от Разума, в меньшей степени от Мощи и Харизмы. Если Ваш показатель Интуиции значительно выше их, то и от него. ")]),v("li",null,[v("span",{society:""},"Влиение"),he(" помогает лучше распознавать эмоции разумных и влиять на них. Зависит от характеристики Харизма, и в меньшей степени от Разума и Хитрости. Если Ваш показатель Восприятия значительно выше их, то и него. ")]),v("li",null,[he(" Проверки "),v("span",{shadow:""},"Тени"),he(" отвечают за защиту в бою, планирование обороны и засад на глобальной карте, хитрые манипуляции и преступные действия. Зависит от характеристики Хитрость, и в меньшей степени от Харизмы и Интуиции. Если Ваш показатель Конфликта значительно выше их, то и от него. ")]),v("li",null,[v("span",{mystics:""},"Хаос"),he(" отвечает за религии и культы, включая тёмное колдовство и необъяснимые магические искусства. Зависит от характеристики Интуиция, и в меньшей степени от Хитрости и Восприятия. Если Ваш показатель Порядка значительно выше их, то и от него. ")]),v("li",null,[he(" Хороший "),v("span",{nature:""},"Поиск"),he(" помогает лучше разбираться в дикой местности, естественных науках с ней связанных, передвижение по глобальной карте и способность искать на ней то, что Вам нужно. Зависит от характеристики Восприятие, и в меньшей степени от Интуиции и Конфликта. Если Ваш показатель Харизмы значительно выше их, то и от него. ")])],-1),ZT=v("p",{med:""}," Самые большие значения, 6 и 4 Вы получаете в характеристиках, связанных с Вашим классом. Но можете сами решить, какая из них будет выше: ",-1),QT={flex:"","flex-col":"","mt-2":""},eA={flex:"","justify-center":""},tA={flex:"","justify-center":"","mt-0":""},iA=v("p",{med:""}," В характеристиках, противоположных Вашим Аспектам, Вы получаете ноль. Ещё четыре очка распределяются по оставшимся характеристикам. ",-1),rA=v("h2",null,"Выберите умения:",-1),nA=v("p",{det:""}," Умения - основное что отличает персонажей в TriP. Они дают значительные бонусы или просто позволяют делать некоторые вещи, недоступные другим. ",-1),sA=v("p",{med:""}," Сейчас Вы можете выбрать по одному первоуровневому умению от своего стартового класса и двух связанных с ним Аспектов. ",-1),oA={class:"rounded-md flex flex-col border px-2 pb-1 border-slate-600 my-2 align-middle"},aA=["innerHTML"],lA={key:5},cA=v("h1",null,"Снаряжение",-1),dA=v("p",{med:""},"Теперь Вам нужно выбрать стартовое снаряжение Вашего персонажа.",-1),uA=v("p",{det:""}," Вместо точного подсчёта количества золотых-серебряных и прочих монет, в TriP используются абстрактные уровни благополучия, или Богатства. Имея уровень Богатства 5, Вы можете свободно в больших (в разумных пределах) покупать предметы 4 и ниже уровня стоимости, либо купить 1-2 предмета в месяц из своего, пятого уровня. ",-1),hA=v("p",{det:""}," Раз в месяц Вы можете купить нечто, что Вам не по карману (на один уровень выше), но после этого будете вынуждены жить на хлебе и воде (опуститесь на один уровень ниже). ",-1),fA=v("p",{det:""}," К счастью, имея постоянный доход какого-то уровня, Вы за 3 месяца подниметесь на соответствующий уровень Богатства ",-1),pA=v("p",null," Посоветуйтесь с Вашим мастером о том, какой стартовый уровень Богатства допустим для Вашего персонажа. ",-1),mA=v("p",null," В большинстве случаев, он может определяться с помощью броска кубика d6. Для этого прибавьте половину выпавшего значения к трём и округлите результат в меньшую сторону. ",-1),gA=v("p",{det:""}," Например, если на кубике выпало 5, формула получается следующей: 5/2 + 3 = 5.5, после округления в меньшую сторону получается уровень Богатства 5. ",-1),vA={id:"wealth",class:"text-center rounded-md flex flex-col border px-2 pb-0 border-slate-600 my-2 align-middle"},bA={"pt-0":"","mt-0":"","mb-1":""},yA=v("p",null,"От Вашего кошелька зависит выбор снаряжения.",-1),_A=v("p",{med:""}," Простое оружие и кое-какая броня доступны на третьем уровне Богатства, а вот предметы изготовленные специально для войны - только на пятом. ",-1),wA=v("p",{det:""}," Главное отличие этих категорий предметов - простое оружие не может наносить травмы тяжелее лёгких. Это совсем не значит, что с его помощью не получится кого-то убить! Убить можно и голыми руками, вот только с воинским оружием для этого потребуется значительно меньше ударов. ",-1),xA=v("p",{det:""}," Однако, воинское оружие всё ещё не гарантия победы над противником, чтобы нанести более тяжёлые травмы врагу Ваша атака должна значительно превзойти его защиту. Разве что простое оружие даже при большом превышении не сможет нанести серьёзную рану, а воинское - сможет. ",-1),SA=v("p",{med:""}," Не беспокойтесь о покупке ножа для нарезки хлеба или иных бытовых принадлежностей. По умолчанию считается что у все предметы такого рода у Вас уже есть. ",-1),MA=v("h2",null,"Доспех",-1),EA=v("p",{med:""}," В бой Вы сможете брать только два набора снаряжения и один доспех. Например, лук со стрелами для дальнего боя и меч с щитом для ближнего. ",-1),kA={class:"text-center rounded-md flex flex-col border px-2 pb-0 border-slate-600 my-2 mt-4 align-middle"},CA={"items-center":""},TA={key:0,flex:"","gap-3":"","my-2":""},AA=["src"],LA={class:"w-1/2 md:w-2/3 flex-shrink grid grid-cols-2"},DA=v("tip",null,"Защита",-1),PA=v("tip",null,"Снижение",-1),RA=v("tip",null,"Скорость",-1),IA=v("tip",null,"Порывы",-1),OA=v("tip",null,"Цена",-1),FA=v("tip",null,"Эпоха",-1),zA={key:1,"text-left":""},NA={key:2,flex:"",border:"","border-slate-600":"","rounded-md":"","my-2":"","p-2":"","justify-between":""},$A=v("div",null,"Цена для Вас:",-1),BA=v("h2",null,"Оружие",-1),VA=v("p",{med:""}," Теперь Вам нужно выбрать несколько предметов оружия, которые Вы возьмёте с собой. Даже если Вы совсем не планируете участвовать в битвах, небольшая предосторожность не будет лишней. ",-1),HA=v("p",{med:""}," Бой в TriP смертоносен и скоротечен, если Вы хотите сохранить жизнь своего персонажа - задумайтесь о защите. Исторически главным атрибутом воина был не меч или топор, а щит. Любой воин хочет в первую очередь выжить, и лишь затем - нанести потери врагу. ",-1),UA=v("p",{det:""}," Вы можете взять два оружия в две руки, хотя и есть некоторые ограничения на этот счёт. Так, оружие делится на длинное и короткое, не получится использовать два длинных одновременно. ",-1),jA=v("p",{det:""}," Конечно же, оружие делится на одноручное и двуручное, а кроме того в системе TriP есть условные 0.5 и 1.5-ручное оружие. Хорошим примером может послужить лёгкий одноручный арбалет, который нужно перезаряжать второй рукой. При этом, вполне допустимо, чтобы во второй руке оказывался небольшой предмет, не сильно сковывающий движение (например кинжал или баклер) ",-1),WA={flex:"","flex-col":"","px-2":"","py-1":"","rounded-md":"","my-2":"",border:"","border-slate-600":"",class:"bg-slate-700/30"},GA={flex:"","flex-col":"","items-center":""},qA={"items-center":"","justify-between":"","w-full":""},YA={flex:"","flex-col":"","items-center":""},XA=v("tip",null,"Максимальная цена:",-1),KA={"text-sm":""},JA={"items-center":"","justify-between":"","w-full":""},ZA={flex:"","flex-col":"","items-center":""},QA=v("tip",null,"Максимальная эпоха:",-1),eL={"text-sm":""},tL={flex:"","justify-between":"","my-1":""},iL={class:"grid grid-cols-3 gap-2 items-stretch md:grid-cols-6 lg:grid-cols-9"},rL=["onClick"],nL={"top-0":"","left-0":"","rounded-tl-md":"","rounded-br-md":""},sL={flex:"","items-center":""},oL={"top-0":"","right-0":"","rounded-bl-md":"","rounded-tr-md":""},aL={flex:"","items-center":""},lL={absolute:"","bottom-0":"","left-0":"","right-0":"",flex:"","justify-between":"","rounded-bl-md":"","rounded-br-md":"",class:"bg-slate-600/50 z-0"},cL={key:0},dL={flex:"","items-center":""},uL={flex:"","items-center":""},hL={flex:"","items-center":""},fL={key:2},pL={flex:"","items-center":""},mL={"text-center":""},gL=v("h2",null,"Подсчёт финансов:",-1),vL=["href"],bL={class:"flex items-center text-xl"},yL={flex:""},_L={grid:"","grid-cols-3":"","w-full":""},wL={key:0},xL={flex:"","flex-col":"","items-center":""},SL=v("tip",null,"Атака",-1),ML={flex:"","items-center":""},EL={flex:"","flex-col":"","items-center":""},kL=v("tip",null,"Удары",-1),CL={flex:"","items-center":""},TL={flex:"","flex-col":"","items-center":""},AL=v("tip",null,"Снаряды",-1),LL={flex:"","items-center":""},DL={key:2},PL={flex:"","flex-col":"","items-center":""},RL=v("tip",null,"Защита",-1),IL={flex:"","items-center":""},OL={key:3},FL={flex:"","flex-col":"","items-center":""},zL=v("tip",null,"Пробитие",-1),NL={flex:"","items-center":""},$L={key:4,style:{"grid-column-start":"1"}},BL={flex:"","flex-col":"","items-center":""},VL=v("tip",null,"Дальность",-1),HL={flex:"","items-center":""},UL={flex:"","flex-col":"","items-center":""},jL=v("tip",null,"Руки",-1),WL={flex:"","items-center":""},GL={style:{"grid-column-start":"1"}},qL={flex:"","flex-col":"","items-center":""},YL=v("tip",null,"Цена",-1),XL={flex:"","items-center":""},KL={flex:"","flex-col":"","items-center":""},JL=v("tip",null,"Эпоха",-1),ZL={flex:"","items-center":""},QL=v("b",null," Особенности: ",-1),eD={"justify-center":"","gap-3":""},tD={data:()=>({char_data:{},gen_options:{syl_mod:{cvc:1,cv:1,vc:1,v:1},group_mod:{hard:1,soft:1,voiced:1,voiceless:1,sonorant:1},syl_number:1},tabs:{race:{icon:"mdi:dna",tip:"Вид",show:!0,done:!1},class:{icon:"game-icons:burning-passion",tip:"Класс",show:!0,done:!1},profile:{icon:"hugeicons:passport",tip:"Профиль",show:!0,done:!1},stats:{icon:"game-icons:stars-stack",tip:"Умения",show:!0,done:!1},equip:{icon:"game-icons:battle-gear",tip:"Предметы",show:!0,done:!1}},type_filter:[],active_tab:"race",modal_shown:!1,weapon_modal_shown:!1,modal_weapon:{},tip_text:"",male:!0,origin:0,price_filter:6,epoch_filter:5,trait_scroller:[0,0,0],armor_chosen:0,filter_and:!1,class_filter:["war","knowledge","society","shadow","mystics","nature"]}),computed:{money_estimation(){if(this.char_data.wealth<10)return{correct:!1,tip:"Не определён Ваш уровень благополучия. Пожалуйста, вернитесь и переопределите его.",link:"#wealth"};if(this.current_armor.key=="none")return{correct:!1,tip:"Не выбран никакой тип брони. Пожалуйста, выберите хотя бы простую одежду.",link:"#armor"};let i={small_price:0,ok_price:0,big_price:0,huge_price:0};return i[this.countPrice(this.current_armor.price).type]+=1,this.char_data.items_taken.forEach(e=>{let t=this.countPrice(un[e].price).type;i[t]+=1}),i.huge_price>0?{correct:!1,tip:"Вы выбрали вещь, которая Вам не по карману. Пожалуйста, обратите внимание на предмет, отмеченный красным"}:i.big_price>1?{correct:!1,tip:"Вы можете позволить себе только один предмет уровнем выше Вашего, и даже притом уровень Вашего благополучия упадёт на единицу из-за такой крупной покупки. Обратите, пожалуйста, внимание на предметы помеченные оранжевым цветом."}:i.big_price==1&&i.ok_price>0?{correct:!1,tip:"Вы покупаете крайне дорогой для Вас предмет (помечен оранжевым), Ваш уровень благосостояния падает на единицу. Из-за этого Вы не можете покупать предметы по значительной цене (жёлтые), только по совсем небольшой (зелёные)."}:i.ok_price>2?{correct:!1,tip:"Вы не можете одновременно купить более двух предметов по значительной (подсвечены жёлтым) цене."}:i.ok_price+i.huge_price+i.small_price+i.big_price>6?{correct:!0,tip:"Вы можете продолжить, но вряд ли Вам понадобится так много предметов!"}:{correct:!0,tip:"Всё подобрано отлично!"}},current_race(){return Jr[this.char_data.race]},current_class(){return Bs[this.char_data.class]},current_origin(){let i=Object.keys(ko)[this.origin];return ko[i]},current_wealth(){if(this.char_data.wealth<10)return"Не определено";let i=Math.floor(this.char_data.wealth/10);return i+" - "+ql[i].name},trait_list(){let i=[];return i.push({tip:"От класса "+this.current_class.name[this.gender]+":",traits:this.current_class.traits}),i.push({tip:"От Аспекта "+yt[this.char_data.aspects[0]].name+":",traits:yt[this.char_data.aspects[0]].traits}),i.push({tip:"От Аспекта "+yt[this.char_data.aspects[1]].name+":",traits:yt[this.char_data.aspects[1]].traits}),i},age_name(){return this.char_data.age==null?"---":Sr[this.char_data.age].name[this.gender]},gender(){return this.male?"m":"f"},current_armor(){if(this.armor_chosen==null)return{key:"none",name:"Не выбрано"};let i=this.armor_variants[this.armor_chosen];return i.price_type=this.countPrice(i.price),i},classes_filtered(){let i={};return this.filter_and?Object.entries(Bs).forEach(([e,t])=>{this.class_filter.includes(t.aspects[0])&&this.class_filter.includes(t.aspects[1])&&(i[e]=t)}):Object.entries(Bs).forEach(([e,t])=>{(this.class_filter.includes(t.aspects[0])||this.class_filter.includes(t.aspects[1]))&&(i[e]=t)}),i},armor_variants(){let i=[];return Object.entries(un).forEach(([e,t])=>{if(t.category=="armor"){let r=t;r.key=e,i.push(r)}}),i},hand_items(){let i=[];return Object.entries(un).forEach(([e,t])=>{if((t.category=="weapon"||t.category=="shield")&&t.price<=this.price_filter&&t.epoch<=this.epoch_filter&&this.type_filter.includes(t.subcat)){let r=t;r.key=e,i.push(r)}}),i}},methods:{init(){this.resetChar(),this.active_tab="race",this.type_filter=[],Object.entries(ra).forEach(([i,e])=>{this.type_filter.push(i)})},resetChar(){this.char_data={race:null,name:"",picture:null,gender:"male",age:"young",class:null,attrs:{might:0,reason:0,charisma:0,trickery:0,intuition:0,perception:0},aspects:[],wealth:32,armor:{},items_taken:[]}},takeItem(i){this.char_data.items_taken.push(i),this.closeWeaponModal()},dropItem(i){this.char_data.items_taken=this.char_data.items_taken.filter((e,t,r)=>e!=i),this.closeWeaponModal()},openTab(i){this.active_tab=i,window.scrollTo(0,0)},tabBack(){let i=Object.keys(this.tabs),e=i.indexOf(this.active_tab);this.tabs[i[e]].done=!1,e--,e<0&&(e=0),this.openTab(i[e])},tabForward(){let i=Object.keys(this.tabs),e=i.indexOf(this.active_tab);this.tabs[i[e]].done=!0,e++,e>i.length-1&&(e=i.length-1),this.openTab(i[e])},showModal(i){this.modal_shown=!0},closeModal(i){this.modal_shown=!1},showWeaponModal(i){this.modal_weapon=i,this.weapon_modal_shown=!0},closeWeaponModal(){this.weapon_modal_shown=!1},toggleAspectFilter(i){this.class_filter.includes(i)?this.class_filter=this.class_filter.filter((e,t,r)=>e!=i):this.class_filter.push(i)},toggleWeaponTypeFilter(i){this.type_filter.includes(i)?this.type_filter=this.type_filter.filter((e,t,r)=>e!=i):this.type_filter.push(i)},resetRace(){this.char_data.race=null,window.scrollTo(0,0)},resetClass(){this.char_data.class=null,window.scrollTo(0,0)},setClass(i){this.char_data.class=i,this.char_data.aspects=this.current_class.aspects,this.char_data.attrs[yt[this.char_data.aspects[0]].attr]=6,this.char_data.attrs[yt[this.char_data.aspects[1]].attr]=4;let e=[];Object.entries(yt).forEach(([r,n])=>{r!=yt[this.char_data.aspects[0]].opposite&&r!=yt[this.char_data.aspects[1]].opposite&&r!=yt[this.char_data.aspects[0]].id&&r!=yt[this.char_data.aspects[1]].id&&e.push(n.attr)});let t=4/e.length;e.forEach(r=>{this.char_data.attrs[r]=t})},swapStrongestAttributes(){let i=this.char_data.attrs[yt[this.current_class.aspects[0]].attr];this.char_data.attrs[yt[this.current_class.aspects[0]].attr]=this.char_data.attrs[yt[this.current_class.aspects[1]].attr],this.char_data.attrs[yt[this.current_class.aspects[1]].attr]=i},originModify(i){i=Math.floor(Object.keys(ko).length+i),this.origin=(this.origin+i)%Object.keys(ko).length},originRand(){this.originModify(this.$randomInt(1,Object.keys(ko).length))},traitModify(i,e){e=Math.floor(3+e),this.trait_scroller[i]=(this.trait_scroller[i]+e)%3},traitModifyRand(i){let e=this.$randomInt(1,2);this.traitModify(i,e)},wealthModify(i){let e=this.char_data.wealth,t=Object.keys(ql).length;e+=i-10,e=(e+10*t)%(t*10),e+=10,this.char_data.wealth=e},priceFilterModify(i){let e=this.price_filter,t=Object.keys(ql).length;e+=i-1,e=(e+t)%t,e+=1,this.price_filter=e},epochFilterModify(i){let e=this.epoch_filter,t=Object.keys(jb).length;e+=i-1,e=(e+t)%t,e+=1,this.epoch_filter=e},wealthRand(){let i=Math.floor(this.$randomInt(1,6)/2);this.char_data.wealth=32+i*10},armorModify(i){this.armor_chosen==null?this.armor_chosen=0:(i=Math.floor(this.armor_variants.length+i),this.armor_chosen=(this.armor_chosen+i)%this.armor_variants.length)},countPrice(i){let e=Math.floor(this.char_data.wealth/10);return e>i?{name:"Незначительная",value:0,type:"small_price",tip:"Покупка никак не ударит по Вашему кошельку"}:e==i?{name:"Ощутимая",value:1,type:"ok_price",tip:"Вы сможете купить только два таких предмета, не теряя уровня благосостояния"}:e+1==i?{name:"Огромная",value:10,type:"big_price",tip:"Покупка этого предмета опустит Ваш уровень благосостояния на 1, Вы не сможете покупать другие вещи своего прежнего уровня благосостояния"}:{name:"Не по карману",value:100,type:"huge_price",tip:"Вы никак не можете себе этого позволить."}},helpModal(i){},finishCharCreation(){this.char_data.armor=this.armor_variants[this.armor_chosen],this.$CHARS.value[this.char_data.name]=this.compileChar(),this.$updateChars(this.$CHARS.value),this.resetChar(),this.$router.push("/")},compileChar(){let i=Jr[this.char_data.race].max_hp+Sr[this.char_data.age].max_hp,e=Jr[this.char_data.race].bursts+Sr[this.char_data.age].bursts,t=Jr[this.char_data.race].movement+Sr[this.char_data.age].movement,r=Sr[this.char_data.age].name[this.char_data.gender[0]],n={max_hp:i,current_hp:i,max_moves:t,cur_moves:t,max_bursts:e,cur_bursts:e,base_armor:Jr[this.char_data.race].armor,race_aspects:Jr[this.char_data.race].aspects,race_name:Jr[this.char_data.race].name,classes:[this.char_data.class],aspects:Bs[this.char_data.class].aspects,picture:this.char_data.picture,name:this.char_data.name,gender:this.char_data.gender,age_steps:Sr[this.char_data.age].steps,age_name:r,bonus_xp:Sr[this.char_data.age].bonus_xp,levelup_xp:Sr[this.char_data.age].xp,attrs:this.char_data.attrs,checks:this.$attrToChecks(this.char_data.attrs),equips:{current:[],secondary:[]}},s={};s[`class_${this.char_data.class}_${this.trait_scroller[0]}`]=1,s[`aspect_${this.char_data.aspects[0]}_${this.trait_scroller[1]}`]=1,s[`aspect_${this.char_data.aspects[1]}_${this.trait_scroller[2]}`]=1,n.traits=s;let o=[];this.char_data.items_taken.forEach(l=>{let c=JSON.parse(JSON.stringify(un[l]));c.picture=`img/items/${l}.png`,o.push(c)}),n.items=o;let a=this.armor_variants[this.armor_chosen].key;return n.armor_equipped=JSON.parse(JSON.stringify(un[a])),n.armor_equipped.picture=`img/items/${a}.png`,n}},mounted(){let i=JSON.parse(localStorage.getItem("new_char"));i!==null&&(this.char_data=i),this.init()},watch:{$CHARS:{handler:(i,e)=>{},deep:!0},char_data:{handler:(i,e)=>{localStorage.setItem("new_char",JSON.stringify(i))},deep:!0}}},iD=Object.assign(tD,{__name:"NewCharacterGuideView",setup(i){return(e,t)=>{const r=st("Icon"),n=st("fwb-button"),s=st("fwb-toggle"),o=st("fwb-input"),a=st("fwb-modal"),l=st("fwb-tooltip"),c=st("fwb-table-head-cell"),d=st("fwb-table-head"),u=st("fwb-table-cell"),h=st("fwb-table-row"),p=st("fwb-table-body"),g=st("fwb-table");return P(),z("new-char-guide",G3,[v("new-char-tabs",q3,[(P(!0),z(be,null,Fe(e.tabs,(f,m)=>(P(),z(be,null,[f.show?(P(),z("tab-control",{key:0,class:Se({done:f.done,active:e.active_tab==m})},[H(r,{icon:f.icon},null,8,["icon"]),v("tip",null,U(f.tip),1)],2)):Le("",!0)],64))),256))]),e.active_tab=="overview"?(P(),z("guide-tab",Y3)):e.active_tab=="race"?(P(),z("guide-tab",X3,[v("div",null,[e.char_data.race==null?(P(),z(be,{key:0},[K3,J3,Z3,Q3,v("races-list",null,[(P(!0),z(be,null,Fe(Ee(Jr),(f,m)=>(P(),z("race-block",{onClick:b=>e.char_data.race=m},[v("img",{src:"img/races/"+m+".webp",class:"w-full inline-block"},null,8,tC),v("race-short-desc",{flex:"","justify-center":"",class:Se(["bg-subtle-gradient from-10% to-90%",["from-"+f.aspects[0]+"-dark","to-"+f.aspects[1]+"-dark"]])},[v("race-name",null,U(f.name),1)],2)],8,eC))),256))])],64)):Le("",!0),e.char_data.race!=null?(P(),z("race-info-block",iC,[v("h1",null,U(e.current_race.name),1),v("race-info-block",rC,[v("img",{src:"img/races/"+e.char_data.race+".webp",class:"w-full inline-block rounded-lg aspect-square self-center","flex-1":"","row-span-4":""},null,8,nC),v("race-description",sC,U(e.current_race.desc),1),oC,v("stat-container",aC,[v("race-stat",lC,[cC,v("stat-value",dC,[H(r,{icon:"mdi:arrow-right-bold-hexagon-outline","text-4xl":"","mr-1":"","inline-block":""}),v("div",uC,U(e.current_race.movement),1)])]),v("race-stat",hC,[fC,v("stat-value",pC,[H(r,{icon:"game-icons:fire-dash","text-3xl":"","mr-1":"","inline-block":""}),v("div",mC,U(e.current_race.bursts),1)])]),v("race-stat",gC,[vC,v("stat-value",bC,[H(r,{icon:"healthicons:health","text-4xl":"","mr-1":"","inline-block":""}),v("div",yC,U(e.current_race.max_hp),1)])]),v("race-stat",_C,[wC,v("stat-value",xC,[H(r,{icon:"game-icons:shoulder-armor","text-4xl":"","mr-1":"","inline-block":""}),v("div",SC,U(e.current_race.armor),1)])])]),v("aspects-info",{"p-2":"","rounded-lg":"","border-1":"","border-slate-600":"",flex:"","justify-between":"",class:Se(["bg-subtle-gradient from-10% to-90% self-end",["from-"+e.current_race.aspects[0]+"-dark","to-"+e.current_race.aspects[1]+"-dark"]])},[v("span",MC,U(Ee(Ei)[e.current_race.aspects[0]]),1),EC,v("span",kC,U(Ee(Ei)[e.current_race.aspects[1]]),1)],2)])])):Le("",!0)]),e.char_data.race!=null?(P(),z("button-block",CC,[H(n,{color:"alternative",square:"",onClick:t[0]||(t[0]=f=>e.resetRace())},{prefix:K(()=>[H(r,{icon:"mdi:arrow-up-left","text-xl":""})]),default:K(()=>[he(" Назад ")]),_:1}),H(n,{color:"yellow",outline:"",square:"",onClick:t[1]||(t[1]=f=>e.tabForward())},{prefix:K(()=>[H(r,{icon:"mdi:arrow-right","text-xl":""})]),default:K(()=>[he(" Выбрать эту расу ")]),_:1})])):(P(),z("button-block",TC,[H(n,{color:"yellow",disabled:"",outline:"",square:""},{prefix:K(()=>[H(r,{icon:"lucide:mouse-pointer-click","text-xl":""})]),default:K(()=>[he(" Выберите расу ")]),_:1})]))])):e.active_tab=="class"?(P(),z("guide-tab",AC,[e.char_data.class==null?(P(),z("div",LC,[DC,PC,RC,IC,OC,FC,v("class-filter",zC,[v("filter-type",NC,[$C,H(s,{class:"basis-1/3",size:"sm",modelValue:e.filter_and,"onUpdate:modelValue":t[2]||(t[2]=f=>e.filter_and=f),label:"Тип"},null,8,["modelValue"]),H(s,{class:"gender-toggle basis-1/6",size:"sm",modelValue:e.male,"onUpdate:modelValue":t[3]||(t[3]=f=>e.male=f),label:"Пол"},null,8,["modelValue"])]),v("aspect-filter",null,[(P(!0),z(be,null,Fe(Ee(yt),(f,m)=>(P(),z("aspect-item",{class:Se([e.class_filter.includes(m)?["text-"+m+"-light"]:[""]]),onClick:b=>e.toggleAspectFilter(m)},[v("tip",null,U(Ee(Ei)[m]),1),H(r,{icon:f.icon},null,8,["icon"]),v("tip",null,U(Ee(Ei)[f.attr]),1)],10,BC))),256))])]),v("classes-list",null,[(P(!0),z(be,null,Fe(e.classes_filtered,(f,m)=>(P(),z("class-block",{onClick:b=>e.setClass(m)},[v("img",{src:"img/portraits/classes/"+m+"_"+(e.male?"m":"f")+".jpg",class:"w-full inline-block"},null,8,HC),v("race-short-desc",{flex:"","justify-center":"",class:Se(["bg-subtle-gradient from-10% to-90%",["from-"+f.aspects[0]+"-dark","to-"+f.aspects[1]+"-dark"]])},[v("race-name",null,U(f.name[e.gender]),1)],2)],8,VC))),256))])])):(P(),z("div",UC,[v("h1",null,U(e.current_class.name[e.gender]),1),v("class-pics",jC,[v("class-pic",WC,[v("img",{src:"img/portraits/classes/"+e.current_class.id+"_m.jpg"},null,8,GC)]),v("class-pic",qC,[v("img",{src:"img/portraits/classes/"+e.current_class.id+"_f.jpg"},null,8,YC)])]),v("p",null,[XC,he(" пока не написал..."+U(e.current_class.desc),1)]),v("aspects-info",{"p-2":"","my-2":"","rounded-lg":"","border-1":"","border-slate-600":"",flex:"","justify-between":"",class:Se(["bg-subtle-gradient from-10% to-90%",["from-"+e.current_class.aspects[0]+"-dark","to-"+e.current_class.aspects[1]+"-dark"]])},[v("span",KC,U(Ee(Ei)[e.current_class.aspects[0]]),1),JC,v("span",ZC,U(Ee(Ei)[e.current_class.aspects[1]]),1)],2),v("p",null,[QC,(P(!0),z(be,null,Fe(e.current_class.aspects,f=>(P(),z("spec-span",{"mr-1":"",class:Se(f)},U(Ee(Ei)[Ee(yt)[f].attr]),3))),256))]),v("p",null,[eT,(P(!0),z(be,null,Fe(e.current_class.aspects,f=>(P(),z("spec-span",tT,U(Ee(Ei)[Ee(yt)[f].checks]),1))),256))]),iT,(P(!0),z(be,null,Fe(e.current_class.traits,f=>(P(),z("trait-block",rT,[v("trait-name",null,U(f.name),1),v("ol",nT,[(P(!0),z(be,null,Fe(f.levels,m=>(P(),z("li",{innerHTML:e.$expandText(m)},null,8,sT))),256))])]))),256))])),v("button-block",null,[e.char_data.class==null?(P(),Ge(n,{key:0,color:"alternative",square:"",onClick:t[4]||(t[4]=f=>e.tabBack())},{prefix:K(()=>[H(r,{icon:"mdi:arrow-left","text-xl":""})]),default:K(()=>[he(" К виду ")]),_:1})):Le("",!0),e.char_data.class?(P(),Ge(n,{key:1,color:"alternative",square:"",onClick:t[5]||(t[5]=f=>e.resetClass())},{prefix:K(()=>[H(r,{icon:"mdi:arrow-up-left","text-xl":""})]),default:K(()=>[he(" Назад ")]),_:1})):Le("",!0),e.char_data.class?(P(),Ge(n,{key:2,color:"yellow",outline:"",square:"",onClick:t[6]||(t[6]=f=>e.tabForward())},{prefix:K(()=>[H(r,{icon:"mdi:arrow-right","text-xl":""})]),default:K(()=>[he(" Выбрать этот класс ")]),_:1})):Le("",!0)])])):e.active_tab=="profile"?(P(),z("guide-tab",oT,[v("div",null,[aT,v("profile-block",lT,[v("profile-picture",{"aspect-square":"",border:"","border-slate-600":"","basis-1":"","grow-1":"","rounded-md":"",flex:"","items-center":"","justify-center":"","bg-slate-700":"","overflow-hidden":"",onClick:t[7]||(t[7]=f=>e.showModal())},[e.char_data.picture?(P(),z("img",{key:0,src:"img/portraits/"+e.char_data.picture},null,8,cT)):(P(),Ge(n,{key:1,color:"yellow",outline:"",square:""},{default:K(()=>[he(" Выбрать портрет ")]),_:1}))]),v("info-block",dT,[H(o,{modelValue:e.char_data.name,"onUpdate:modelValue":t[8]||(t[8]=f=>e.char_data.name=f),placeholder:"Имя персонажа","rounded-md":""},null,8,["modelValue"]),H(s,{class:"gender-toggle",size:"sm",modelValue:e.male,"onUpdate:modelValue":t[9]||(t[9]=f=>e.male=f),label:e.male?"Мужчина":"Женщина"},null,8,["modelValue","label"]),v("div",null,"Вид: "+U(e.current_race.name),1),v("div",null,"Возраст: "+U(e.age_name),1)])]),uT,v("origin-block",hT,[v("button-block",null,[H(n,{color:"alternative",square:"",onClick:t[10]||(t[10]=f=>e.originModify(-1))},{default:K(()=>[H(r,{icon:"mdi:chevron-left","text-xl":""})]),_:1}),H(n,{color:"alternative",square:"",onClick:t[11]||(t[11]=f=>e.originRand())},{default:K(()=>[H(r,{icon:"mdi:dice-5","text-xl":""})]),_:1}),H(n,{color:"alternative",square:"",onClick:t[12]||(t[12]=f=>e.originModify(1))},{default:K(()=>[H(r,{icon:"mdi:chevron-right","text-xl":""})]),_:1})]),v("p",null,[v("b",null,U(e.current_origin.name)+":",1),he(" "+U(e.current_origin.text),1)]),v("p",null,[fT,he(" "+U(e.current_origin.trait),1)])]),pT,mT,gT,vT,bT,v("ages-block",null,[(P(!0),z(be,null,Fe(Ee(Sr),(f,m)=>(P(),z("age-block",{class:Se(["flex rounded-md border py-2 border-slate-600 my-2 align-middle",{"border-yellow-300 bg-yellow-700/5":e.char_data.age==m}]),onClick:b=>e.char_data.age=m},[v("age-stats",_T,[v("h2",wT,U(f.name[e.gender]),1),v("age-stat",xT,[v("stat-value",null,[H(r,{icon:"healthicons:health"}),v("div",ST,U(f.max_hp>0?"+":"")+U(f.max_hp),1)]),MT]),v("age-stat",ET,[v("stat-value",null,[H(r,{icon:"mdi:arrow-right-bold-hexagon-outline"}),v("div",kT,U(f.movement>0?"+":"")+U(f.movement),1)]),CT]),v("age-stat",TT,[v("stat-value",null,[H(r,{icon:"game-icons:fire-dash"}),v("div",AT,U(f.bursts>0?"+":"")+U(f.bursts),1)]),LT]),v("age-stat",DT,[v("stat-value",null,[H(r,{icon:"game-icons:upgrade"}),v("div",PT,U(f.bonus_xp),1)]),RT]),v("age-stat",IT,[v("stat-value",null,[H(r,{icon:"game-icons:burning-passion"}),v("div",OT,U(f.xp),1)]),FT]),v("age-stat",zT,[v("stat-value",null,[H(r,{icon:"game-icons:conqueror"}),v("div",NT,U(f.steps),1)]),$T])])],10,yT))),256))]),e.modal_shown?(P(),Ge(a,{key:0,"onClick:outside":e.closeModal,onClose:e.closeModal,class:"modal"},{header:K(()=>[BT]),body:K(()=>[v("div",VT,[(P(),z(be,null,Fe(96,f=>v("portrait-preset",{class:"flex-grow basis-1/4 rounded-xl overflow-hidden bg-slate-600/50 cursor-pointer",onClick:m=>(e.char_data.picture="presets/"+f+".png",e.closeModal())},[v("img",{src:"img/portraits/presets/"+f+".png"},null,8,UT)],8,HT)),64))])]),_:1},8,["onClick:outside","onClose"])):Le("",!0),e.char_data.picture==null?(P(),z("div",jT," Вы не выбрали портрет персонажа. ")):Le("",!0),e.char_data.name.length<1?(P(),z("div",WT," Имя персонажа не может быть меньше одного символа. ")):Le("",!0)]),v("button-block",null,[H(n,{color:"alternative",square:"",onClick:t[13]||(t[13]=f=>e.tabBack())},{prefix:K(()=>[H(r,{icon:"mdi:arrow-up-left","text-xl":""})]),default:K(()=>[he(" Назад ")]),_:1}),e.char_data.picture!=null&&e.char_data.name.length>=1?(P(),Ge(n,{key:0,color:"yellow",outline:"",square:"",onClick:t[14]||(t[14]=f=>e.tabForward())},{prefix:K(()=>[H(r,{icon:"mdi:arrow-right","text-xl":""})]),default:K(()=>[he(" Продолжить ")]),_:1})):(P(),Ge(n,{key:1,color:"red",disabled:"",outline:"",square:"",onClick:t[15]||(t[15]=f=>e.tabForward())},{prefix:K(()=>[H(r,{icon:"icon-park-outline:check-correct","text-xl":""})]),default:K(()=>[he(" Нужно исправить ")]),_:1}))])])):Le("",!0),e.active_tab=="stats"?(P(),z("guide-tab",GT,[v("div",null,[qT,YT,XT,KT,JT,ZT,v("attr-block",QT,[v("div",eA,[(P(!0),z(be,null,Fe(e.current_class.aspects,f=>(P(),z("span",{"mr-1":"","text-xl":"",class:Se(f)},U(Ee(Ei)[Ee(yt)[f].attr])+" = "+U(e.char_data.attrs[Ee(yt)[f].attr]),3))),256))]),v("button-block",tA,[H(n,{outline:"",color:"dark",onClick:e.swapStrongestAttributes},{default:K(()=>[he(" Поменять местами ")]),_:1},8,["onClick"])])]),iA,rA,nA,sA,v("traits-block",null,[(P(!0),z(be,null,Fe(e.trait_list,(f,m)=>(P(),z(be,null,[v("b",null,U(f.tip),1),v("trait-block",oA,[v("button-block",null,[H(n,{color:"alternative",square:"",onClick:b=>e.traitModify(m,-1)},{default:K(()=>[H(r,{icon:"mdi:chevron-left","text-xl":""})]),_:2},1032,["onClick"]),H(n,{color:"alternative",square:"",onClick:b=>e.traitModifyRand(m)},{default:K(()=>[H(r,{icon:"mdi:dice-5","text-xl":""})]),_:2},1032,["onClick"]),H(n,{color:"alternative",square:"",onClick:b=>e.traitModify(m,1)},{default:K(()=>[H(r,{icon:"mdi:chevron-right","text-xl":""})]),_:2},1032,["onClick"])]),v("b",null,U(f.traits[e.trait_scroller[m]].name)+":",1),v("trait-info",{innerHTML:e.$expandText(f.traits[e.trait_scroller[m]].levels[0])},null,8,aA)])],64))),256))])]),v("button-block",null,[H(n,{color:"alternative",square:"",onClick:t[16]||(t[16]=f=>e.tabBack())},{prefix:K(()=>[H(r,{icon:"mdi:arrow-up-left","text-xl":""})]),default:K(()=>[he(" Назад ")]),_:1}),H(n,{color:"yellow",outline:"",square:"",onClick:t[17]||(t[17]=f=>e.tabForward())},{prefix:K(()=>[H(r,{icon:"mdi:arrow-right","text-xl":""})]),default:K(()=>[he(" Продолжить ")]),_:1})])])):Le("",!0),e.active_tab=="equip"?(P(),z("guide-tab",lA,[v("div",null,[cA,dA,uA,hA,fA,pA,mA,gA,v("wealth-block",vA,[v("button-block",null,[H(n,{color:"alternative",square:"",onClick:t[18]||(t[18]=f=>e.wealthModify(-10))},{default:K(()=>[H(r,{icon:"mdi:chevron-left","text-xl":""})]),_:1}),H(n,{color:"alternative",square:"",onClick:t[19]||(t[19]=f=>e.wealthRand())},{default:K(()=>[H(r,{icon:"mdi:dice-5","text-xl":""})]),_:1}),H(n,{color:"alternative",square:"",onClick:t[20]||(t[20]=f=>e.wealthModify(10))},{default:K(()=>[H(r,{icon:"mdi:chevron-right","text-xl":""})]),_:1})]),v("h2",bA,U(e.current_wealth),1)]),yA,_A,wA,xA,SA,MA,EA,v("armor-block",kA,[v("button-block",CA,[H(n,{color:"alternative",square:"",onClick:t[21]||(t[21]=f=>e.armorModify(-1))},{default:K(()=>[H(r,{icon:"mdi:chevron-left","text-xl":""})]),_:1}),v("b",null,U(e.current_armor.name),1),H(n,{color:"alternative",square:"",onClick:t[22]||(t[22]=f=>e.armorModify(1))},{default:K(()=>[H(r,{icon:"mdi:chevron-right","text-xl":""})]),_:1})]),e.current_armor.key!="none"?(P(),z("div",TA,[v("img",{src:"img/items/"+e.current_armor.key+".png","aspect-square":"",class:"w-1/2 md:w-1/3 flex-shrink border-1 rounded-md border-slate-600 bg-slate-700/50"},null,8,AA),v("armor-stats",LA,[v("armor-stat-block",null,[DA,v("div",null,[H(r,{icon:"grommet-icons:shield"}),v("armor-stat",null,U(e.current_armor.defence),1)])]),v("armor-stat-block",null,[PA,v("div",null,[H(r,{icon:"game-icons:shoulder-armor"}),v("armor-stat",null,U(e.current_armor.resist),1)])]),v("armor-stat-block",null,[RA,v("div",null,[H(r,{icon:"mdi:arrow-right-bold-hexagon-outline"}),v("armor-stat",null,U(e.current_armor.movement),1)])]),v("armor-stat-block",null,[IA,v("div",null,[H(r,{icon:"game-icons:fire-dash"}),v("armor-stat",null,U(e.current_armor.bursts),1)])]),v("armor-stat-block",null,[OA,v("div",null,[H(r,{icon:"iconoir:coins"}),v("armor-stat",null,U(e.current_armor.price),1)])]),v("armor-stat-block",null,[FA,v("div",null,[H(r,{icon:"icon-park-outline:level"}),v("armor-stat",null,U(e.current_armor.epoch),1)])])])])):Le("",!0),e.current_armor.key!="none"?(P(),z("armor-desc",zA,U(e.current_armor.desc),1)):Le("",!0),e.current_armor.key!="none"?(P(),z("armor-price",NA,[$A,H(l,null,{trigger:K(()=>[v("div",{flex:"","items-center":"",class:Se(e.countPrice(e.current_armor.price).type)},[he(U(e.current_armor.price_type.name)+" ",1),H(r,{icon:"mdi:question-box-multiple-outline","ml-3":"","text-base":""})],2)]),content:K(()=>[he(U(e.current_armor.price_type.tip),1)]),_:1})])):Le("",!0)]),BA,VA,HA,UA,jA,v("hand-items-filter",WA,[v("price-filter",GA,[v("button-block",qA,[H(n,{color:"alternative",square:"",onClick:t[23]||(t[23]=f=>e.priceFilterModify(-1))},{default:K(()=>[H(r,{icon:"mdi:chevron-left","text-xl":""})]),_:1}),v("div",YA,[XA,v("b",KA,U(e.price_filter)+" - "+U(Ee(ql)[e.price_filter].name),1)]),H(n,{color:"alternative",square:"",onClick:t[24]||(t[24]=f=>e.priceFilterModify(1))},{default:K(()=>[H(r,{icon:"mdi:chevron-right","text-xl":""})]),_:1})])]),v("epoch-filter",null,[v("button-block",JA,[H(n,{color:"alternative",square:"",onClick:t[25]||(t[25]=f=>e.epochFilterModify(-1))},{default:K(()=>[H(r,{icon:"mdi:chevron-left","text-xl":""})]),_:1}),v("div",ZA,[QA,v("b",eL,U(e.epoch_filter)+" - "+U(Ee(jb)[e.epoch_filter].name),1)]),H(n,{color:"alternative",square:"",onClick:t[26]||(t[26]=f=>e.epochFilterModify(1))},{default:K(()=>[H(r,{icon:"mdi:chevron-right","text-xl":""})]),_:1})])]),v("weapon-type-filter",tL,[(P(!0),z(be,null,Fe(Ee(ra),(f,m)=>(P(),Ge(r,{icon:f.icon,class:Se(["text-gray-200/30",e.type_filter.includes(m)?"text-gray-200/80":""]),onClick:b=>e.toggleWeaponTypeFilter(m),"text-3xl":""},null,8,["icon","class","onClick"]))),256))])]),v("hand-items",iL,[(P(!0),z(be,null,Fe(e.hand_items,f=>(P(),z("hand-item-block",{relative:"",class:Se(["w-full flex-grow aspect-1/2 border border-slate-600 rounded-md bg-slate-700/50 z-10",[f.small!=null?f.small:"p-2",e.char_data.items_taken.includes(f.key)?e.countPrice(f.price).type:""]]),"pb-8":"",onClick:m=>e.showWeaponModal(f)},[v("hand-item-img",{"inline-block":"","w-full":"","h-full":"",class:"place-self-center self-center",style:Ut("background: url('img/items/"+f.key+".png'); background-size: contain; background-position: center center; background-repeat: no-repeat;")},null,4),v("hand-item-stat",nL,[H(l,null,{trigger:K(()=>[v("div",sL,[H(r,{icon:"iconoir:coins"}),v("hand-item-stat-value",null,U(f.price),1)])]),content:K(()=>[he(" Цена: "+U(f.price)+", для Вас ",1),v("span",{class:Se(e.countPrice(f.price).type)},U(e.countPrice(f.price).name),3)]),_:2},1024)]),v("hand-item-stat",oL,[H(l,null,{trigger:K(()=>[v("div",aL,[H(r,{icon:"icon-park-outline:level"}),v("hand-item-stat-value",null,U(f.epoch),1)])]),content:K(()=>[he(" Появляется в эпохе "+U(f.epoch),1)]),_:2},1024)]),v("hand-item-statblock",lL,[f.attack!=null?(P(),z("hand-item-stat",cL,[H(l,null,{trigger:K(()=>[v("div",dL,[H(r,{icon:"game-icons:arrow-scope"}),v("hand-item-stat-value",null,U(f.attack),1)])]),content:K(()=>[he(" Модификатор атаки: "+U(f.attack),1)]),_:2},1024)])):Le("",!0),typeof f.defence=="object"?(P(),z(be,{key:1},[v("hand-item-stat",null,[H(l,null,{trigger:K(()=>[v("div",uL,[H(r,{icon:"grommet-icons:shield"}),v("hand-item-stat-value",null,U(f.defence.front.melee),1)])]),content:K(()=>[he(" Модификатор защиты от ударов в ближнем бою: "+U(f.defence.front.melee),1)]),_:2},1024)]),v("hand-item-stat",null,[H(l,null,{trigger:K(()=>[v("div",hL,[H(r,{icon:"game-icons:arrows-shield"}),v("hand-item-stat-value",null,U(f.defence.front.ranged),1)])]),content:K(()=>[he(" Модификатор защиты от ударов в ближнем бою: "+U(f.defence.front.ranged),1)]),_:2},1024)])],64)):f.defence!=null?(P(),z("hand-item-stat",fL,[H(l,null,{trigger:K(()=>[v("div",pL,[H(r,{icon:"grommet-icons:shield"}),v("hand-item-stat-value",null,U(f.defence),1)])]),content:K(()=>[he(" Модификатор атаки: "+U(f.attack),1)]),_:2},1024)])):Le("",!0)])],10,rL))),256))]),v("money-estimation",mL,[gL,v("a",{"ml-0":"","pl-0":"",block:"",href:e.money_estimation.link,class:Se(e.money_estimation.correct?"text-green-400":"text-red-400")},U(e.money_estimation.tip),11,vL)])]),v("button-block",null,[H(n,{color:"alternative",square:"",onClick:t[27]||(t[27]=f=>e.tabBack())},{prefix:K(()=>[H(r,{icon:"mdi:arrow-left","text-xl":""})]),default:K(()=>[he(" Умения ")]),_:1}),e.money_estimation.correct?(P(),Ge(n,{key:0,color:"yellow",outline:"",square:"",onClick:t[28]||(t[28]=f=>e.finishCharCreation())},{prefix:K(()=>[H(r,{icon:"ic:outline-celebration","text-xl":""})]),default:K(()=>[he(" Создать персонажа! ")]),_:1})):(P(),Ge(n,{key:1,disabled:"",color:"red",outline:"",square:""},{prefix:K(()=>[H(r,{icon:"icon-park-outline:check-correct","text-xl":""})]),default:K(()=>[he(" Нужны исправления ")]),_:1}))])])):Le("",!0),e.weapon_modal_shown?(P(),Ge(a,{key:6,"onClick:outside":e.closeWeaponModal,onClose:e.closeWeaponModal,class:"modal"},{header:K(()=>[v("div",bL,U(e.modal_weapon.name),1)]),body:K(()=>[v("div",yL,[v("weapon-item-block",{"inline-block":"","w-24":"","h-48":"",class:Se(["border-slate-600 rounded-md bg-slate-800/50",e.modal_weapon.small!=null?e.modal_weapon.small:"p-1"])},[v("hand-item-img",{"inline-block":"","w-full":"","h-full":"",style:Ut("background: url('img/items/"+e.modal_weapon.key+".png'); background-size: contain; background-position: center center; background-repeat: no-repeat;")},null,4)],2),v("weapon-stats",_L,[e.modal_weapon.attack!=null?(P(),z("hand-item-stat",wL,[H(l,{class:"justify-center"},{trigger:K(()=>[v("div",xL,[SL,v("div",ML,[H(r,{icon:"game-icons:arrow-scope"}),v("hand-item-stat-value",null,U(e.modal_weapon.attack),1)])])]),content:K(()=>[he(" Модификатор атаки: "+U(e.modal_weapon.attack),1)]),_:1})])):Le("",!0),typeof e.modal_weapon.defence=="object"?(P(),z(be,{key:1},[v("hand-item-stat",null,[H(l,{class:"justify-center"},{trigger:K(()=>[v("div",EL,[kL,v("div",CL,[H(r,{icon:"grommet-icons:shield"}),v("hand-item-stat-value",null,U(e.modal_weapon.defence.front.melee),1)])])]),content:K(()=>[he(" Защита от атак в ближнем бою "+U(e.modal_weapon.defence.front.melee),1)]),_:1})]),v("hand-item-stat",null,[H(l,{class:"justify-center"},{trigger:K(()=>[v("div",TL,[AL,v("div",LL,[H(r,{icon:"game-icons:arrows-shield"}),v("hand-item-stat-value",null,U(e.modal_weapon.defence.front.ranged),1)])])]),content:K(()=>[he(" Защита дистанционных атак "+U(e.modal_weapon.defence.front.ranged),1)]),_:1})])],64)):(P(),z("hand-item-stat",DL,[H(l,{class:"justify-center"},{trigger:K(()=>[v("div",PL,[RL,v("div",IL,[H(r,{icon:"grommet-icons:shield"}),v("hand-item-stat-value",null,U(e.modal_weapon.defence),1)])])]),content:K(()=>[he(" Защита от атак в ближнем бою "+U(e.modal_weapon.defence),1)]),_:1})])),e.modal_weapon.armor_pen?(P(),z("hand-item-stat",OL,[H(l,{class:"justify-center"},{trigger:K(()=>[v("div",FL,[zL,v("div",NL,[H(r,{icon:"game-icons:cracked-helm"}),v("hand-item-stat-value",null,U(e.modal_weapon.armor_pen),1)])])]),content:K(()=>[he(" Некоторые виды оружия игнорируют один или несколько уровней брони")]),_:1})])):Le("",!0),e.modal_weapon.length!=null?(P(),z("hand-item-stat",$L,[H(l,{class:"justify-center"},{trigger:K(()=>[v("div",BL,[VL,v("div",HL,[H(r,{icon:"mdi:hexagon-multiple-outline"}),v("hand-item-stat-value",null,U(e.modal_weapon.length),1)])])]),content:K(()=>[he(" Длинные виды оружия без штрафа бьют через клетку и со штрафом в две категории - по целям вплотную к себе. Короткие - наоборот.")]),_:1})])):Le("",!0),v("hand-item-stat",null,[H(l,{class:"justify-center"},{trigger:K(()=>[v("div",UL,[jL,v("div",WL,[H(r,{icon:"game-icons:hand"}),v("hand-item-stat-value",null,U(e.modal_weapon.hands),1)])])]),content:K(()=>[he(" Чтобы пользоваться одним оружием достаточно одной руки, другому нужны две, в редких случаях нужно чтобы вторая рука не была занята чем-то тяжёлым (например, при перезарядке ручного арбалета)")]),_:1})]),v("hand-item-stat",GL,[H(l,{class:"justify-center"},{trigger:K(()=>[v("div",qL,[YL,v("div",XL,[H(r,{icon:"iconoir:coins"}),v("hand-item-stat-value",null,U(e.modal_weapon.price),1)])])]),content:K(()=>[he(" Цена: "+U(e.modal_weapon.price)+", для Вас ",1),v("span",{class:Se(e.countPrice(e.modal_weapon.price).type)},U(e.countPrice(e.modal_weapon.price).name),3)]),_:1})]),v("hand-item-stat",null,[H(l,{class:"justify-center"},{trigger:K(()=>[v("div",KL,[JL,v("div",ZL,[H(r,{icon:"icon-park-outline:level"}),v("hand-item-stat-value",null,U(e.modal_weapon.epoch),1)])])]),content:K(()=>[he(" Появляется в эпохе "+U(e.modal_weapon.epoch),1)]),_:1})])])]),he(" "+U(e.modal_weapon.desc)+" ",1),e.modal_weapon.spec&&e.modal_weapon.spec.length>0?(P(),z(be,{key:0},[QL,he(" "+U(e.modal_weapon.spec),1)],64)):Le("",!0),e.modal_weapon.damage!=null?(P(),Ge(g,{key:1,striped:"",class:"overflow-hidden rounded-lg mt-2 border border-slate-700"},{default:K(()=>[H(d,{class:""},{default:K(()=>[H(c,{width:"20%",class:"bg-slate-800/30"},{default:K(()=>[he("Превышение защиты")]),_:1}),H(c,{width:"80%",class:"bg-slate-800/30 text-right"},{default:K(()=>[he("Эффект")]),_:1})]),_:1}),H(p,null,{default:K(()=>[(P(!0),z(be,null,Fe(e.modal_weapon.damage,(f,m)=>(P(),Ge(h,{class:"dark:even:bg-slate-700/50 dark:odd:bg-slate-700/20"},{default:K(()=>[H(u,{class:"py-2"},{default:K(()=>[he(U(m),1)]),_:2},1024),H(u,{class:"py-2"},{default:K(()=>[he(U(f),1)]),_:2},1024)]),_:2},1024))),256))]),_:1})]),_:1})):Le("",!0),v("button-block",eD,[e.char_data.items_taken.includes(e.modal_weapon.key)?(P(),Ge(n,{key:0,color:"alternative",square:"",onClick:t[29]||(t[29]=f=>e.dropItem(e.modal_weapon.key))},{default:K(()=>[he(" Выбросить ")]),_:1})):(P(),Ge(n,{key:1,color:"yellow",outline:"",square:"",onClick:t[30]||(t[30]=f=>e.takeItem(e.modal_weapon.key))},{default:K(()=>[he(" Взять ")]),_:1})),H(n,{color:"alternative",square:"",onClick:e.closeWeaponModal},{default:K(()=>[he(" Закрыть ")]),_:1},8,["onClick"])])]),_:1},8,["onClick:outside","onClose"])):Le("",!0)])}}}),Xs={0:{name:"Ниже простой",class:"text-sky-200",short:"НП",linecolor:"#40a0d0",linetype:"dashed"},3:{name:"Простая",class:"text-sky-300",short:"П",linecolor:"#40a0d0",linetype:"single"},6:{name:"Выше простой",class:"text-sky-400",short:"ВП",linecolor:"#40a0d0",linetype:"double"},9:{name:"Ниже лёгкой",class:"text-lime-200",short:"НЛ",linecolor:"lime",linetype:"dashed"},12:{name:"Лёгкая",class:"text-lime-300",short:"Л",linecolor:"lime",linetype:"single"},15:{name:"Выше лёгкой",class:"text-lime-400",short:"ВЛ",linecolor:"lime",linetype:"double"},18:{name:"Ниже средней",class:"text-yellow-200",short:"НС",linecolor:"orange",linetype:"dashed"},21:{name:"Средняя",class:"text-yellow-300",short:"С",linecolor:"orange",linetype:"single"},24:{name:"Выше средней",class:"text-yellow-400",short:"ВС",linecolor:"orange",linetype:"double"},27:{name:"Ниже тяжёлой",class:"text-red-200",short:"НТ",linecolor:"red",linetype:"dashed"},30:{name:"Тяжёлая",class:"text-red-300",short:"Т",linecolor:"red",linetype:"single"},33:{name:"Выше тяжёлой",class:"text-red-400",short:"ВТ",linecolor:"red",linetype:"double"},36:{name:"Ниже чрезмерной",class:"text-purple-200",short:"НЧ",linecolor:"purple",linetype:"dashed"},39:{name:"Чрезмерная",class:"text-purple-300",short:"Ч",linecolor:"purple",linetype:"single"},42:{name:"Выше чрезмерной",class:"text-purple-400",short:"ВЧ",linecolor:"purple",linetype:"double"},45:{name:"Нереальная",class:"text-white",short:"Н",linecolor:"black",linetype:"double"}},rD={key:0,relative:""},nD=v("div",null,[v("h1",null,"Добро пожаловать в ролевую систему TriP!"),v("p",null," Где Вы можете стать кем угодно: отважными героями, тёмными культистами, исследователями далёких земель, владельцами торговой империи или собственного государства. "),v("img",{src:"img/trip_illust.png","w-full":"","rounded-md":"","my-2":""}),v("h2",{med:""},"Что за Система?"),v("p",{med:""},[v("b",null,"Первое отличие"),he(' от привычных НРИ - если в других системах "мультикласс" это скорее исключение, то в TriP - правило. ')]),v("p",{med:""},[he(" В настоящий момент в игре "),v("b",null,"39 классов, 21"),he(' из которых доступны со старта. В процессе своего развития Ваш персонаж будет обретать новые "профессии", новые умения, новые особенности. '),v("img",{src:"img/class_diagram.svg","w-full":"","rounded-md":"","my-2":""})]),v("p",{med:""},[v("b",null,"Второе большое отличие"),he(" - три основных направления деятельности для игроков, под каждое из которых есть свой модуль правил. Это бой, исследование и развитие. ")]),v("p",{med:""}," При желании игроки могут сфокусироваться на чём-то одном, а могут смешивать составляющие в любых пропорциях. "),v("p",{det:""}," Кому-то будет интересно играть исключительно в экономическую стратегию, кому-то в военную. Кто-то решит потратить богатства, найденные в логове монстра на покупку своего участка земли - или на найм крепкой наёмничьей группы. Строить и развивать в TriP так же интересно, как воевать и исследовать, а проработанные правила не позволят Вам заскучать в живом и меняющемся мире. "),v("p",{med:""},[he(" Наконец, "),v("b",null,"третье важное отличие"),he(" - модульность. Базовые правила очень просты, Вы потратите около 10 минут на то, чтобы изучить их и создать своего первого персонажа. Даже если раньше никогда не играли в НРИ. ")]),v("p",{med:""}," Но для тех, кто хочет конкретики и глубины, подготовлены дополнительные модули - боевой, экономический, исследовательский и так далее. Все их можно подключать (и отключать)прямо во время игры, например когда Вы впервые столкнулись с подходящей ситуацией. "),v("p",{det:""}," Конечно, на этом отличия не заканчиваются. Вместо множества бросков кубиков и арифметики, TriP использует систему, по которой вычислений либо и вовсе нет, либо с ними может справиться первоклассник с помощью пальцев одной руки. При этом реализм и тактическая гибкость остаются на высоте! "),v("p",{det:""}," Большой приоритет при создании TriP был в том, чтобы не перегружать игроков выбором, сохраняя возможность для творчества. Во многих ролевых системах при повышении уровня Вы либо выбираете из десятков вариантов (например, новое заклинание), либо не выбираете вовсе. "),v("p",{det:""}," TriP стремится сделать так, чтобы выбор был всегда, но не слишком перегружающий разум игрока. "),v("p",null,"Сейчас Вы пройдёте через все шаги, необходимые для создания персонажа:")],-1),sD={"justify-center":"",fixed:"","bottom-0":"","left-0":"","right-0":"","bg-slate-800":""},oD={key:1},aD=v("h1",null,"Ваши персонажи:",-1),lD={class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-3"},cD={key:0,height:"130px",width:"65px",viewBox:"0 0 500 1000",absolute:"",class:"-translate-y-1/2 top-1/2 z-30"},dD=["stroke","stroke-dasharray"],uD=["stroke"],hD=["stroke","stroke-dasharray"],fD=["stroke"],pD=["stroke","stroke-dasharray"],mD=["stroke"],gD=["stroke"],vD=["stroke","stroke-dasharray"],bD=["stroke"],yD=["stroke","stroke-dasharray"],_D=["stroke"],wD=["stroke","stroke-dasharray"],xD={absolute:"",class:"w-[100px] h-[100px] top-1/2 left-[65px] -translate-x-1/2 -translate-y-1/2 hexagon"},SD={flex:"","flex-grow":"","flex-col":"","bg-slate-900":"","rounded-r-lg":"","p-2":"","pl-0":"",class:"ml-[-8px]",relative:""},MD={flex:"","justify-between":"",class:"pt-0 ml-[-30px] mt-[-7px]"},ED={"text-2xl":"","font-bold":"","text-white":"",class:"uppercase pt-0"},kD={flex:"","items-center":""},CD={absolute:"",class:"top-1/2 -translate-y-1/2 left-0 right-1/4 h-[50px] p-0"},TD={flex:"",class:"gap-1 h-full"},AD=["onClick"],LD=["onClick"],DD=["onClick"],PD=["onClick"],RD={absolute:"",grid:"","grid-cols-2":"",class:"top-1/2 -translate-y-1/2 left-3/4 right-0 h-[50px] place-content-center place-items-center"},ID={absolute:"","bottom-0":"","left-0":"","overflow-x-auto":"","overflow-y-hidden":"",class:"no-scrollbar right-[60px]"},OD={block:""},FD={flex:"","flex-row":"","no-wrap":""},zD={"flex-grow":"",class:"text-nowrap text-xs flex flex-nowrap items-center"},ND=["onClick"],$D={det:"",class:"font-size-[0.6em]","mr-1":""},BD=["onClick"],VD={absolute:"","bottom-0":"",class:"right-[0px]","pr-1":"","pb-1":"",flex:""},HD={relative:"",block:"",class:"h-[25px] w-[25px]"},UD={class:"font-size-[12px] left-1/2 -translate-x-1/2 absolute top-1/2 -translate-y-1/2","text-white":""},jD={relative:"",block:"",class:"h-[25px] w-[25px]"},WD={class:"font-size-[12px] left-1/2 -translate-x-1/2 absolute top-1/2 -translate-y-1/2","text-white":""},GD={key:1,"mx-3":"",flex:"","flex-col":""},qD=v("death-message",{"font-bold":"","text-4xl":"",uppercase:""}," Помер ",-1),YD={class:"title flex items-center text-5xl font-bold"},XD={flex:"","justify-between":""},KD={flex:"","flex-col":"","items-center":""},JD=v("tip",null,"Бросок",-1),ZD={flex:"","items-center":"","text-4xl":""},QD={flex:"","flex-col":"","items-center":""},eP=v("tip",null,"Мод",-1),tP={flex:"","items-center":"","text-4xl":""},iP={flex:"","flex-col":"","items-center":""},rP=v("tip",null,"Результат",-1),nP={flex:"","items-center":"","text-4xl":""},sP={key:0},oP={key:1},aP={data:()=>({isShowModal:!1,attackResult:{},healthConv:{14:[3,4,1,1],12:[3,3,1,1],10:[3,2,1,1],8:[3,3,0,1],6:[2,3,0,1],4:[2,2,0,1],2:[1,1,0,1]}}),methods:{deleteChar(i){let e=localStorage.getItem("CORPSES");e=="undefined"?e=[]:(e=JSON.parse(e),e==null&&(e=[])),e.push(JSON.parse(JSON.stringify(this.$CHARS.value[i]))),localStorage.setItem("CORPSES",JSON.stringify(e)),delete this.$CHARS.value[i]},reviveChar(i){i.alive=!0,i.health_block.scratch.cur=0,i.health_block.light.cur=0,i.health_block.heavy.cur=0,i.health_block.fatal.cur=0,this.computeChar(i.name)},wound(i,e){i.health_block[e].cur+1<=i.health_block[e].max?i.health_block[e].cur++:(e=="scratch"&&(i.health_block.scratch.cur=0,this.wound(i,"light")),e=="light"&&this.wound(i,"heavy"),e=="heavy"&&this.wound(i,"fatal"),e=="fatal"&&(i.alive=!1)),this.computeChar(i.name)},openChar(i){this.$router.push(`/character-page/${i}`)},closeModal(){this.isShowModal=!1,this.attackResult={}},endCharTurn(i){i.cur_bursts=i.max_bursts},takeBurst(i){i.cur_bursts>0&&i.cur_bursts--},catItemAltEquip(i){let e=[],t=i.items[i.equips.secondary.left];typeof t<"u"&&e.push(ra[t.subcat].icon);let r=i.items[i.equips.secondary.right];return typeof r<"u"&&e.push(ra[r.subcat].icon),e},async attackRoll(i,e,t=0){let r=`1d12+${t}d6`;t>0&&(e.cur_bursts-=t),e.cur_bursts<0&&(e.cur_bursts=0),this.$initiateRoll({expr:r}).then(n=>{let s=n.total+i;if(this.attackResult.left=null,this.attackResult.right=null,s>-1){this.attackResult.success=!0;let o=e.items[e.equips.current.left],a=e.items[e.equips.current.right];typeof o<"u"&&(this.attackResult.left={name:o.name,attackVariants:{}},typeof o.damage=="object"&&Object.entries(o.damage).forEach(([l,c])=>{l<=s&&(this.attackResult.left.attackVariants[l]=c)})),typeof a<"u"&&(this.attackResult.right={name:a.name,attackVariants:{}},typeof a.damage=="object"&&Object.entries(a.damage).forEach(([l,c])=>{l<=s&&(this.attackResult.right.attackVariants[l]=c)}))}else this.attackResult.success=!1;this.attackResult.roll=n.total,this.attackResult.bonus=i,this.attackResult.total=s,this.isShowModal=!0})},currentEquipName(i){let e="",t=i.items[i.equips.current.left];typeof t<"u"&&(e+=t.name);let r=i.items[i.equips.current.right];return typeof r<"u"&&(e+=` и ${r.name}`),e},iconByItemKey(i){return ra[un[i].subcat].icon},getImageHeldStyles(i,e){let t=e=="left"?65:85,r=e=="left"?30:10,n=65,s=0;if(typeof i.equips.current[e]>"u"||typeof i.items[i.equips.current[e]]>"u")return"";let o=i.items[i.equips.current[e]].key;if(typeof un[o]>"u")return"";let a=un[o].img_meta??{},l=a.bg_size??"100%",c=t+(a.left??0)+"px",d=r+(a.right??0)+"px",u=n+(a.top??0)+"px",h=s+(a.bottom??0)+"px",p=a.bg_pos??"50% 0%";return`background-image: url('img/items/${o}.png');
      background-size: ${l};
      background-repeat: no-repeat;
      left: ${c};
      right: ${d};
      top: ${u};
      bottom: ${h};
      background-position: ${p};
      `},checkDiff(i){let e=Math.floor(i/3)*3;return typeof Xs[e]==null?Xs[36]:Xs[e]},conicBGbyAspects(i){let e="";for(let t=0;t<12;t++)e+=`var(--color-${i[t%i.length]}-DEFAULT) ${Math.round(100/12*t)}%, `;return e+=`var(--color-${i[0]}-DEFAULT) 100%`,e},computeChars(){Object.entries(this.$CHARS.value).forEach(([i,e])=>{this.computeChar(i)})},computeChar(i){let e=JSON.parse(JSON.stringify(this.$CHARS.value[i]));typeof e.level>"u"&&(e.level=1);let t=e.checks.defence;t+=e.armor_equipped.defence;let r=e.max_moves+e.armor_equipped.movement,n=e.max_bursts+e.armor_equipped.bursts,s=e.base_armor+e.armor_equipped.resist;typeof e.equips.current.name>"u"&&(e.equips.current={name:"",left:null,right:null}),typeof e.equips.secondary.name>"u"&&(e.equips.secondary={name:"",left:null,right:null});let o=e.equips.current.left,a=e.equips.current.right;o!==null?o=e.items[o]:o=null,a!==null?a=e.items[a]:a=null;let l=this.computeEquips(o,a);if(typeof e.health_block>"u"){let g=this.healthConv[e.max_hp],f={scratch:{max:g[0],cur:0},light:{max:g[1],cur:0},heavy:{max:g[2],cur:0},fatal:{max:g[3],cur:0}};e.health_block=f}typeof e.alive>"u"&&(e.alive=!0),typeof e.notes>"u"&&(e.notes="");let c=0;c+=e.health_block.light.cur*3,c+=e.health_block.heavy.cur*6;let d={front:{melee:Math.max(0,t+l.defence.front.melee-c),ranged:Math.max(0,t+l.defence.front.ranged-c)},side:{melee:Math.max(0,t+l.defence.side.melee/2-c),ranged:Math.max(0,t+l.defence.side.ranged/2-c)},back:{melee:Math.max(0,t-c),ranged:Math.max(0,t/2-c)}},u={front:{melee:this.checkDiff(d.front.melee),ranged:this.checkDiff(d.front.ranged)},side:{melee:this.checkDiff(d.side.melee),ranged:this.checkDiff(d.side.ranged)},back:{melee:this.checkDiff(d.back.melee),ranged:this.checkDiff(d.back.ranged)}},h=[];console.log(e.traits),Object.entries(e.traits).forEach(([g,f])=>{let m=g.split("_"),b={};m[0]=="class"&&(b=Bs[m[1]].traits[m[2]]),m[0]=="aspect"&&(b=yt[m[1]].traits[m[2]]),h.push({name:b.name+" ("+f+")",desc:b.levels[f]})});let p={moves:r,bursts:n,attack:l.attack+e.checks.attack-c,defence:d,defence_cats:u,resist:s,traits:h};e.computed=p,this.$CHARS.value[i]=e},computeEquips(i,e){(i===null||typeof i>"u")&&(i={attack:0,defence:0}),(e===null||typeof e>"u")&&(e={attack:0,defence:0});let t;i.attack>0&&e.attack>0?t=Math.max(i.attack,e.attack):t=i.attack+e.attack,typeof i.defence!="object"&&(i.defence={front:{melee:i.defence,ranged:0},side:{melee:0,ranged:0}}),typeof e.defence!="object"&&(e.defence={front:{melee:e.defence,ranged:0},side:{melee:0,ranged:0}}),typeof i.defence.side>"u"&&(i.defence.side={melee:0,ranged:0}),typeof e.defence.side>"u"&&(e.defence.side={melee:0,ranged:0});let r={front:{melee:Math.max(i.defence.front.melee,e.defence.front.melee),ranged:Math.max(i.defence.front.ranged,e.defence.front.ranged)},side:{melee:Math.max(i.defence.side.melee,e.defence.side.melee),ranged:Math.max(i.defence.side.ranged,e.defence.side.ranged)}};return{attack:t,defence:r}},switchWeapon(i){let e=JSON.parse(JSON.stringify(this.$CHARS.value[i].equips.secondary));this.$CHARS.value[i].equips.secondary=JSON.parse(JSON.stringify(this.$CHARS.value[i].equips.current)),this.$CHARS.value[i].equips.current=JSON.parse(JSON.stringify(e)),this.computeChar(i)},hpChange(i,e){this.$CHARS.value[i].current_hp+=e,this.$CHARS.value[i].current_hp<0&&(this.$CHARS.value[i].current_hp=0),this.$CHARS.value[i].current_hp>this.$CHARS.value[i].max_hp&&(this.$CHARS.value[i].current_hp=this.$CHARS.value[i].max_hp)}},computed:{attackResultColor(){return typeof this.attackResult.success>"u"?"":this.attackResult.success?"green":"red"}},mounted(){this.computeChars()}},lP=Object.assign(aP,{__name:"OverviewView",setup(i){return(e,t)=>{const r=st("Icon"),n=st("fwb-button"),s=st("fwb-tooltip"),o=st("fwb-table-head-cell"),a=st("fwb-table-head"),l=st("fwb-table-cell"),c=st("fwb-table-row"),d=st("fwb-table-body"),u=st("fwb-table"),h=st("fwb-modal");return P(),z(be,null,[v("main",null,[e.$CHARS!=null&&Object.keys(e.$CHARS._value).length<1?(P(),z("div",rD,[nD,v("button-block",sD,[H(n,{color:"yellow",outline:"",square:"",onClick:t[0]||(t[0]=p=>e.$router.push("new-character"))},{prefix:K(()=>[H(r,{icon:"mdi:arrow-right","text-xl":""})]),default:K(()=>[he(" Cоздать персонажа ")]),_:1})])])):(P(),z("div",oD,[aD,v("characters-block",lD,[(P(!0),z(be,null,Fe(e.$CHARS.value,(p,g)=>(P(),z("character-block",{flex:"","my-4":"",class:Se(p.alive?"":"dead")},[p.computed??!1?(P(),z(be,{key:0},[v("portrait-block",{class:"w-[120px] min-h-[130px] bg-slate-900 rounded-l-full",relative:"",onClick:t[1]||(t[1]=()=>{}),"overflow-hidden":""},[typeof p.computed<"u"?(P(),z("svg",cD,[v("path",{d:"M500,5 A495,495 1,0,0 71,253","stroke-width":"10",stroke:p.computed.defence_cats.front.ranged.linecolor,fill:"transparent","stroke-dasharray":p.computed.defence_cats.front.ranged.linetype=="dashed"?"40 20":"10000"},null,8,dD),p.computed.defence_cats.front.ranged.linetype=="double"?(P(),z("path",{key:0,d:"M500,30 A470,470 1,0,0 93,265","stroke-width":"10",stroke:p.computed.defence_cats.front.ranged.linecolor,fill:"transparent"},null,8,uD)):Le("",!0),v("path",{d:"M71,253 A495,495 1,0,0 71,748","stroke-width":"10",stroke:p.computed.defence_cats.side.ranged.linecolor,fill:"transparent","stroke-dasharray":p.computed.defence_cats.side.ranged.linetype=="dashed"?"40 20":"10000"},null,8,hD),p.computed.defence_cats.side.ranged.linetype=="double"?(P(),z("path",{key:1,d:"M93,265 A470,470 1,0,0 93,735","stroke-width":"10",stroke:p.computed.defence_cats.side.ranged.linecolor,fill:"transparent"},null,8,fD)):Le("",!0),v("path",{d:"M71,748 A495,495 1,0,0 500,990","stroke-width":"10",stroke:p.computed.defence_cats.back.ranged.linecolor,fill:"transparent","stroke-dasharray":p.computed.defence_cats.back.ranged.linetype=="dashed"?"40 20":"10000"},null,8,pD),p.computed.defence_cats.back.ranged.linetype=="double"?(P(),z("path",{key:2,d:"M93,735 A470,470 1,0,0 500,970","stroke-width":"10",stroke:p.computed.defence_cats.back.ranged.linecolor,fill:"transparent","stroke-dasharray":"5000"},null,8,mD)):Le("",!0),p.computed.defence_cats.front.melee.linetype=="double"?(P(),z("path",{key:3,d:"M115,278 L500,55",stroke:p.computed.defence_cats.front.melee.linecolor,"stroke-width":"10"},null,8,gD)):Le("",!0),v("path",{d:"M136,290 L500,80","stroke-width":"10",stroke:p.computed.defence_cats.front.melee.linecolor,fill:"transparent","stroke-dasharray":p.computed.defence_cats.front.melee.linetype=="dashed"?"40 20":"10000"},null,8,vD),p.computed.defence_cats.side.melee.linetype=="double"?(P(),z("path",{key:4,d:"M115,278 L115,722","stroke-width":"10",stroke:p.computed.defence_cats.side.melee.linecolor},null,8,bD)):Le("",!0),v("path",{d:"M136,290 L136,710","stroke-width":"10",stroke:p.computed.defence_cats.side.melee.linecolor,fill:"transparent","stroke-dasharray":p.computed.defence_cats.side.melee.linetype=="dashed"?"40 20":"10000"},null,8,yD),p.computed.defence_cats.back.melee.linetype=="double"?(P(),z("path",{key:5,d:"M115,722 L500,945","stroke-width":"10",stroke:p.computed.defence_cats.back.melee.linecolor},null,8,_D)):Le("",!0),v("path",{d:"M136,710 L500,920","stroke-width":"10",stroke:p.computed.defence_cats.back.melee.linecolor,fill:"transparent","stroke-dasharray":p.computed.defence_cats.back.melee.linetype=="dashed"?"40 20":"10000"},null,8,wD)])):Le("",!0),v("div",xD,[v("div",{"w-full":"","h-full":"",absolute:"","z-10":"",style:Ut("background: url('img/portraits/"+p.picture+"'); background-position: bottom center; background-size: 90%; background-repeat: no-repeat;")},null,4),v("div",{absolute:"","bg-red-300":"",class:Se(["w-full h-full top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",p.alive?"rotating-animation":""]),style:Ut("background-image: conic-gradient("+e.conicBGbyAspects(p.aspects)+");")},null,6)]),v("hand-item",{class:"block absolute filter-outline",style:Ut(e.getImageHeldStyles(p,"left"))},null,4),v("hand-item",{class:"block absolute filter-outline",style:Ut(e.getImageHeldStyles(p,"right"))},null,4)]),v("char-data-block",SD,[v("div",MD,[v("h1",ED,U(p.name),1),v("bursts-block",kD,[p.cur_bursts>0?(P(!0),z(be,{key:0},Fe(p.cur_bursts,f=>(P(),Ge(r,{class:"text-yellow-400","text-2xl":"",icon:"game-icons:fire-dash",onClick:m=>e.takeBurst(p)},null,8,["onClick"]))),256)):(P(),Ge(r,{key:1,class:"text-blue-400","text-2xl":"",icon:"vaadin:time-forward",onClick:f=>e.endCharTurn(p)},null,8,["onClick"]))])]),p.alive?(P(),z(be,{key:0},[v("health-block",CD,[v("complex-hp",TD,[v("hp-scratch",{flex:"","flex-col":"","justify-end":"","flex-grow":"","justify-between":"",class:"basis-[10%]",onClick:f=>e.wound(p,"scratch")},[(P(!0),z(be,null,Fe(p.health_block.scratch.max,f=>(P(),z("hp-bar",{class:Se(f<=p.health_block.scratch.cur?"wounded":"")},null,2))),256))],8,AD),v("hp-light",{flex:"","flex-col":"","justify-end":"","flex-grow":"",class:"basis-[20%]",onClick:f=>e.wound(p,"light")},[(P(!0),z(be,null,Fe(p.health_block.light.max,f=>(P(),z("hp-bar",{class:Se(f<=p.health_block.light.cur?"wounded":"")},null,2))),256))],8,LD),v("hp-heavy",{flex:"","flex-col":"","justify-end":"","flex-grow":"",class:"basis-[30%]",onClick:f=>e.wound(p,"heavy")},[(P(!0),z(be,null,Fe(p.health_block.heavy.max,f=>(P(),z("hp-bar",{class:Se(f<=p.health_block.heavy.cur?"wounded":"")},null,2))),256))],8,DD),v("hp-fatal",{flex:"","flex-col":"","justify-end":"","flex-grow":"",class:"basis-[40%]",onClick:f=>e.wound(p,"fatal")},[(P(!0),z(be,null,Fe(p.health_block.fatal.max,f=>(P(),z("hp-bar",{class:Se(f<=p.health_block.fatal.cur?"wounded":"")},null,2))),256))],8,PD)])]),v("control-block",RD,[H(r,{icon:"game-icons:wolverine-claws","text-3xl":"","text-red-600":""}),H(r,{icon:"majesticons:open-line","text-3xl":"","text-green-600":"",onClick:f=>e.openChar(g)},null,8,["onClick"])]),v("wrapper-wrapper",ID,[v("attack-wrapper",OD,[v("attack-block",FD,[v("equip-name",zD,[v("swap-weapon",{flex:"",onClick:f=>e.switchWeapon(g)},[(P(!0),z(be,null,Fe(e.catItemAltEquip(p),f=>(P(),Ge(r,{icon:f,"text-sm":""},null,8,["icon"]))),256))],8,ND),he(" "+U(p.equips.current.name),1)]),(P(!0),z(be,null,Fe(Ee(Xs),(f,m)=>(P(),Ge(s,{class:Se(f.class),placement:"bottom"},{trigger:K(()=>[v("attack-count",{style:Ut([f.linetype=="dashed"?"border-style: dashed; border-top-width: 1px; margin-top: 2px; ":f.linetype=="double"?"border-style: double; border-top-width: 3px":"border-style: solid; border-top-width: 1px; margin-top: 2px;","border-color: "+f.linecolor]),class:"basis-0 flex-grow flex min-w-[50px] ml-0.5 place-content-center place-items-center"},[v("tip",$D,U(f.short)+": ",1),v("attack-value",null,U(p.computed.attack-m),1)],4)]),content:K(()=>[he(" Атака по защите "),v("span",{class:Se(f.class)},U(f.name),3),he(" набором "+U(e.currentEquipName(p))+", модификатор атаки: "+U(p.computed.attack-m)+" ",1),H(n,{block:"","w-full":"","my-2":"",color:"red",class:"spec-flex-button"},{default:K(()=>[v("div",{onClick:b=>e.attackRoll(p.computed.attack-m,p,0)},"Атаковать!",8,BD),(P(!0),z(be,null,Fe(p.cur_bursts,(b,y)=>(P(),Ge(r,{class:"text-yellow-400","text-2xl":"",icon:"game-icons:fire-dash",onClick:w=>e.attackRoll(p.computed.attack-m,p,y+1)},null,8,["onClick"]))),256))]),_:2},1024)]),_:2},1032,["class"]))),256))])])]),v("armor-movement-block",VD,[v("block-wrapper",HD,[H(r,{icon:"game-icons:shoulder-armor","text-2xl":"","text-blue-600":"",class:"left-1/2 -translate-x-1/2 absolute top-1/2 -translate-y-1/2"}),v("span",UD,U(p.computed.resist),1)]),v("block-wrapper",jD,[H(r,{absolute:"",icon:"mdi:arrow-right-bold-hexagon-outline","text-blue-600":"",class:"text-2xl left-1/2 -translate-x-1/2 absolute top-1/2 -translate-y-1/2"}),v("span",WD,U(p.computed.moves),1)])])],64)):(P(),z("death-screen",GD,[qD,v("button-block",null,[H(n,{color:"red",outline:"",size:"sm",class:"text-xs opacity-50 hover:opacity-100",onClick:f=>e.deleteChar(g)},{default:K(()=>[he(" Выбросить труп ")]),_:2},1032,["onClick"]),H(n,{color:"yellow",outline:"",size:"sm",class:"text-xs opacity-5 hover:opacity-100",onClick:f=>e.reviveChar(p)},{default:K(()=>[he(" Воскресить ")]),_:2},1032,["onClick"])])]))])],64)):Le("",!0)],2))),256))])]))]),e.isShowModal?(P(),Ge(h,{key:0,class:Se(["modal",e.attackResultColor]),position:"bottom-center",onClose:e.closeModal,onClick:e.closeModal},{header:K(()=>[v("div",YD,U(e.attackResult.success?"Успех!":"Промах..."),1)]),body:K(()=>[v("div",XD,[v("div",KD,[JD,v("div",ZD,[H(r,{icon:"game-icons:rolling-dices"}),v("hand-item-stat-value",null,U(e.attackResult.roll),1)])]),v("div",QD,[eP,v("div",tP,[H(r,{icon:"game-icons:cracked-shield"}),v("hand-item-stat-value",null,U(e.attackResult.bonus),1)])]),v("div",iP,[rP,v("div",nP,[H(r,{icon:"game-icons:skull-crack"}),v("hand-item-stat-value",null,U(e.attackResult.total),1)])])]),e.attackResult.success?(P(),z("p",sP," Вы успешно преодолели защиту врага и можете нанести ему урон:")):(P(),z("p",oP," Защита противника оказалась слишком крепкой, Вам не удалось через неё пробиться.")),e.attackResult.left!==null?(P(),z(be,{key:2},[v("h1",null,U(e.attackResult.left.name),1),H(u,{striped:"",class:"overflow-hidden rounded-lg mt-2 border border-slate-700"},{default:K(()=>[H(a,{class:""},{default:K(()=>[H(o,{width:"20%",class:"bg-slate-800/30"},{default:K(()=>[he("Превышение защиты")]),_:1}),H(o,{width:"80%",class:"bg-slate-800/30 text-right"},{default:K(()=>[he("Эффект")]),_:1})]),_:1}),H(d,null,{default:K(()=>[(P(!0),z(be,null,Fe(e.attackResult.left.attackVariants,(p,g)=>(P(),Ge(c,{class:"dark:even:bg-slate-700/50 dark:odd:bg-slate-700/20"},{default:K(()=>[H(l,{class:"py-2"},{default:K(()=>[he(U(g),1)]),_:2},1024),H(l,{class:"py-2"},{default:K(()=>[he(U(p),1)]),_:2},1024)]),_:2},1024))),256))]),_:1})]),_:1})],64)):Le("",!0),e.attackResult.right!==null?(P(),z(be,{key:3},[v("h1",null,U(e.attackResult.right.name),1),H(u,{striped:"",class:"overflow-hidden rounded-lg mt-2 border border-slate-700"},{default:K(()=>[H(a,{class:""},{default:K(()=>[H(o,{width:"20%",class:"bg-slate-800/30"},{default:K(()=>[he("Превышение защиты")]),_:1}),H(o,{width:"80%",class:"bg-slate-800/30 text-right"},{default:K(()=>[he("Эффект")]),_:1})]),_:1}),H(d,null,{default:K(()=>[(P(!0),z(be,null,Fe(e.attackResult.right.attackVariants,(p,g)=>(P(),Ge(c,{class:"dark:even:bg-slate-700/50 dark:odd:bg-slate-700/20"},{default:K(()=>[H(l,{class:"py-2"},{default:K(()=>[he(U(g),1)]),_:2},1024),H(l,{class:"py-2"},{default:K(()=>[he(U(p),1)]),_:2},1024)]),_:2},1024))),256))]),_:1})]),_:1})],64)):Le("",!0)]),_:1},8,["class","onClose","onClick"])):Le("",!0)],64)}}}),cP={key:0,"my-2":""},dP={flex:"","gap-3":"","mb-2":""},uP={class:"w-1/2"},hP=["src"],fP={flex:"","flex-col":"","flex-grow":"","items-center":"","justify-between":""},pP={"text-3xl":"",uppercase:"","font-bold":"","py-0":""},mP={grid:"","grid-cols-2":"","gap-1":"","place-items-center":"","w-full":""},gP={flex:"","items-center":""},vP={flex:"","items-center":""},bP={flex:"","items-center":""},yP={flex:"","items-center":""},_P={flex:"","w-full":"","my-1":"","border-2":"","rounded-md":"","border-slate-700":"","items-stretch":"",class:""},wP={class:"w-2/5 h-full","flex-grow":"",grid:"","grid-cols-1":"","text-xl":""},xP=v("check-header",{flex:"","justify-left":"","items-center":"",class:"h-[35px]","pl-2":""}," Навыки: ",-1),SP={"text-lg":""},MP={class:"w-3/5 no-scrollbar","flex-grow":"","overflow-x-auto":"","text-xl":""},EP={"h-full":"",grid:"",style:{"grid-template-columns":"repeat(16, minmax(0, 1fr))",width:"1200px"},"justify-end":""},kP=["onClick"],CP={grid:"",class:"grid-cols-[1fr_2fr_2fr]"},TP=v("def-corner",null,"Защита ",-1),AP=v("def-header",null,"Удары",-1),LP=v("def-header",null,"Снаряды",-1),DP=v("def-row-head",null,"Фронт ",-1),PP=v("def-row-head",null,"Фланг ",-1),RP=v("def-row-head",null,"Тыл ",-1),IP={det:""},OP={grid:"","grid-cols-7":"","place-items-center":"","place-content-middle":"","p-1":"","my-1":"","border-2":"","rounded-md":"","border-slate-700":"",class:"bg-slate-700/40"},FP=v("div",{flex:"","flex-col":"","items-center":"","justify-center":""}," Асп: ",-1),zP={flex:"","flex-col":"","items-center":"","justify-center":""},NP=v("div",{flex:"","flex-col":"","items-center":"","justify-center":""}," Хар: ",-1),$P=v("div",{flex:"","flex-col":"","items-center":"","justify-center":""}," Нав: ",-1),BP={med:"","text-lg":""},VP=v("b",null,"Классы персонажа:",-1),HP={det:""},UP={"border-2":"",flex:"","flex-col":"","border-slate-700":"",class:"bg-slate-700/50","rounded-md":"","my-2":"","p-2":""},jP={flex:"","justify-between":"","gap-3":""},WP={"border-2":"",flex:"","flex-col":"","border-slate-700":"",class:"bg-slate-700/50","rounded-md":"","my-2":"","p-2":""},GP={flex:"","justify-between":"","gap-3":""},qP=v("h2",null," Редактировать оружие ",-1),YP={key:0,"mb-4":""},XP={class:"grid grid-cols-2 md:grid-cols-5 gap-3"},KP={key:0,class:"grid grid-cols-[_1fr_6fr] gap-2 pt-4"},JP={flex:"","items-end":"","justify-center":"","pb-1":"","text-3xl":"","font-bold":""},ZP={"font-bold":""},QP={class:"title flex items-center text-5xl font-bold"},eR={key:0},tR={key:1},iR={data:()=>({char:null,isShowModal:!1,check_success:null,weapon_edit:null}),methods:{closeModal(){this.isShowModal=!1},checkSuccess(){this.isShowModal=!0,this.check_success=!0},checkFail(){this.isShowModal=!0,this.check_success=!1},async checkRoll(i){if(i<2)return this.checkSuccess();if(i>12)return this.checkFail();this.$initiateRoll({expr:"1d12"}).then(t=>t.total>=i?this.checkSuccess():this.checkFail())},selectAllItems(){let i=[{value:null,name:"Ничего"}];return this.char.items.forEach((e,t)=>{i.push({value:t,name:e.name})}),i},selectItems(i,e){let t=e=="left"?"right":"left",r=this.char.items[this.char.equips[i][t]],n=[{value:null,name:"Ничего"}];return typeof r>"u"?this.char.items.forEach((s,o)=>{s.subcat=="shields"&&e=="right"||n.push({value:o,name:s.name})}):this.char.items.forEach((s,o)=>{s.subcat=="shields"&&e=="right"||r.hands+s.hands>2||r.length>1&&s.length>1||n.push({value:o,name:s.name})}),n}},computed:{},mounted(){this.char=this.$CHARS.value[this.$route.params.charKey]}},rR=Object.assign(iR,{__name:"CharacterPageView",setup(i){return(e,t)=>{const r=st("Icon"),n=st("fwb-tooltip"),s=st("fwb-button"),o=st("fwb-input"),a=st("fwb-select"),l=st("fwb-textarea"),c=st("fwb-modal");return P(),z(be,null,[e.char!==null?(P(),z("main",cP,[v("character-block",dP,[v("portrait-block",uP,[v("img",{src:"../img/portraits/"+e.char.picture,"border-2":"","rounded-md":"","border-slate-600":"",class:"bg-slate-700/50"},null,8,hP)]),v("character-info",fP,[v("character-name",pP,U(e.char.name),1),v("character-data",mP,[H(n,{"text-3xl":"",placement:"bottom"},{trigger:K(()=>[v("div",gP,[H(r,{icon:"game-icons:shoulder-armor","mr-1":""}),v("hand-item-stat-value",null,U(e.char.computed.resist),1)])]),content:K(()=>[he(" Каждый уровень сопротивления урону снижает весь входящий урон по Вам на целую категорию. Тяжёлое ранение превращается в лёгкое, лёгкое - в царапину. ")]),_:1}),H(n,{"text-3xl":"",placement:"bottom"},{trigger:K(()=>[v("div",vP,[H(r,{icon:"mdi:arrow-right-bold-hexagon-outline","mr-1":""}),v("hand-item-stat-value",null,U(e.char.computed.moves),1)])]),content:K(()=>[he(" Столько клеток Ваш персонаж может пройти за один ход ")]),_:1}),H(n,{"text-3xl":"",placement:"bottom"},{trigger:K(()=>[v("div",bP,[H(r,{icon:"game-icons:fire-dash","mr-1":""}),v("hand-item-stat-value",null,U(e.char.max_bursts),1)])]),content:K(()=>[he(' Порывы - универсальная "валюта" действий Вашего персонажа в бою, их можно тратить на усиление атаки или защиты, на дополнительное движение. ')]),_:1}),H(n,{"text-3xl":"",placement:"bottom"},{trigger:K(()=>[v("div",yP,[H(r,{icon:"game-icons:rank-3","mr-1":""}),v("hand-item-stat-value",null,U(e.char.level),1)])]),content:K(()=>[he(" Уровень персонажа ")]),_:1})]),H(s,{color:"yellow",outline:"","w-full":""},{default:K(()=>[he("Поднять уровень")]),_:1})])]),v("checks-table",_P,[v("check-name-column",wP,[xP,(P(!0),z(be,null,Fe(Object.entries(Ee(yt)),([d,u],h)=>(P(),z("check-name",{flex:"","justify-left":"","items-center":"",class:Se(["h-[35px]",h%2==0?"bg-slate-600/30":""]),"pl-2":""},[H(r,{icon:u.check_icon,class:Se(`text-${u.id}-light`),"mr-2":""},null,8,["icon","class"]),v("span",SP,U(Ee(Ei)[u.checks]),1)],2))),256))]),v("check-diff-column",MP,[v("check-diff-table",EP,[(P(!0),z(be,null,Fe(Ee(Xs),(d,u)=>(P(),Ge(n,{"text-xl":"",placement:"bottom",flex:"","justify-center":"","items-center":"",style:Ut(["border: none; border-left: 2px solid; border-color:"+d.linecolor+"; border-left-style: "+d.linetype,d.linetype=="double"?"border-left-width:4px;":""]),class:"h-[35px]"},{trigger:K(()=>[v("div",{flex:"","flex-col":"","items-center":"","justify-center":"",class:Se(d.class)},U(d.short),3)]),content:K(()=>[he(U(d.name),1)]),_:2},1032,["style"]))),256)),(P(!0),z(be,null,Fe(Object.entries(Ee(yt)),([d,u],h)=>(P(),z(be,null,[(P(!0),z(be,null,Fe(Ee(Xs),(p,g)=>(P(),z("check-diff",{onClick:f=>e.checkRoll(g-e.char.checks[u.checks]),"text-right":"",flex:"","justify-center":"","items-center":"","font-semibold":"",style:Ut(["border: none; border-left: 2px solid; border-color:"+p.linecolor+"; border-left-style: "+p.linetype,p.linetype=="double"?"border-left-width:4px;":""]),class:Se([h%2==0?"bg-slate-600/20":"","h-[35px]"])},[g-e.char.checks[u.checks]>12?(P(),Ge(r,{key:0,icon:"icomoon-free:cross","text-base":"",class:"text-red-300/70"})):g-e.char.checks[u.checks]<2?(P(),Ge(r,{key:1,icon:"fa:check","text-base":"",class:"text-green-300/70"})):(P(),z(be,{key:2},[he(U(g-e.char.checks[u.checks]),1)],64))],14,kP))),256))],64))),256))])])]),v("defence-table",CP,[TP,AP,LP,DP,v("def-cat-value",{class:Se(e.char.computed.defence_cats.front.melee.class)},U(e.char.computed.defence_cats.front.melee.name),3),v("def-cat-value",{class:Se(e.char.computed.defence_cats.front.ranged.class)},U(e.char.computed.defence_cats.front.ranged.name),3),PP,v("def-cat-value",{class:Se(e.char.computed.defence_cats.side.melee.class)},U(e.char.computed.defence_cats.side.melee.name),3),v("def-cat-value",{class:Se(e.char.computed.defence_cats.side.ranged.class)},U(e.char.computed.defence_cats.side.ranged.name),3),RP,v("def-cat-value",{class:Se(e.char.computed.defence_cats.back.melee.class)},U(e.char.computed.defence_cats.back.melee.name),3),v("def-cat-value",{class:Se(e.char.computed.defence_cats.back.ranged.class)},U(e.char.computed.defence_cats.back.ranged.name),3)]),v("div",IP,[v("attrs-block",OP,[H(n,{"text-xl":"",placement:"bottom"},{trigger:K(()=>[FP]),content:K(()=>[he(" Аспект ")]),_:1}),(P(!0),z(be,null,Fe(Ee(yt),d=>(P(),Ge(n,{"text-3xl":"",placement:"bottom"},{trigger:K(()=>[v("div",zP,[H(r,{icon:d.icon,class:Se(`text-${d.id}-light`)},null,8,["icon","class"]),e.char.aspects.includes(d.id)?(P(),Ge(r,{key:0,icon:"lets-icons:check-fill","text-2xl":"","text-green-400":""})):(P(),Ge(r,{key:1,icon:"charm:cross","text-2xl":"","text-red-400":""}))])]),content:K(()=>[he(' Аспект "'+U(d.name)+'", у этого персонажа '+U(e.char.aspects.includes(d.id)?"есть":"нет"),1)]),_:2},1024))),256)),H(n,{"text-xl":"",placement:"bottom"},{trigger:K(()=>[NP]),content:K(()=>[he(" Характеристики ")]),_:1}),(P(!0),z(be,null,Fe(Ee(yt),d=>(P(),Ge(n,{"text-lg":"",placement:"bottom"},{trigger:K(()=>[v("div",{flex:"","items-center":"","justify-center":"",class:Se(`text-${d.id}-light`)},[H(r,{icon:d.attr_icon,"mr-2":""},null,8,["icon"]),he(" "+U(e.char.attrs[d.attr]),1)],2)]),content:K(()=>[he(" Значение характеристики "+U(Ee(Ei)[d.attr])+" этого персонажа - "+U(e.char.attrs[d.attr]),1)]),_:2},1024))),256)),H(n,{"text-xl":"",placement:"bottom"},{trigger:K(()=>[$P]),content:K(()=>[he(" Бонусы проверки Навыков ")]),_:1}),(P(!0),z(be,null,Fe(Ee(yt),d=>(P(),Ge(n,{"text-lg":"",placement:"bottom"},{trigger:K(()=>[v("div",{flex:"","items-center":"","justify-center":"",class:Se(`text-${d.id}-light`)},[H(r,{icon:d.check_icon,"mr-2":""},null,8,["icon"]),he(" "+U(e.char.checks[d.checks]),1)],2)]),content:K(()=>[he(" Бонус при проверке "+U(Ee(Ei)[d.checks])+" этого персонажа - "+U(e.char.checks[d.checks]),1)]),_:2},1024))),256))])]),v("classes-block",BP,[VP,he(),(P(!0),z(be,null,Fe(e.char.classes,d=>(P(),z("span",null,U(Ee(Bs)[d].name[e.char.gender[0]]),1))),256))]),v("div",HP,[v("equips-table",null,[v("equip-block",UP,[H(o,{modelValue:e.char.equips.current.name,"onUpdate:modelValue":t[0]||(t[0]=d=>e.char.equips.current.name=d),label:"Название набора",placeholder:"Щит и меч",size:"lg"},{suffix:K(()=>[H(s,{outline:""},{default:K(()=>[he("Авто")]),_:1})]),_:1},8,["modelValue"]),v("div",jP,[H(a,{modelValue:e.char.equips.current.left,"onUpdate:modelValue":t[1]||(t[1]=d=>e.char.equips.current.left=d),options:e.selectItems("current","left"),label:"Левая рука"},null,8,["modelValue","options"]),H(a,{modelValue:e.char.equips.current.right,"onUpdate:modelValue":t[2]||(t[2]=d=>e.char.equips.current.right=d),options:e.selectItems("current","right"),label:"Правая рука"},null,8,["modelValue","options"])])]),v("equip-block",WP,[H(o,{modelValue:e.char.equips.secondary.name,"onUpdate:modelValue":t[3]||(t[3]=d=>e.char.equips.secondary.name=d),label:"Название набора",placeholder:"Щит и меч",size:"lg"},{suffix:K(()=>[H(s,{outline:""},{default:K(()=>[he("Авто")]),_:1})]),_:1},8,["modelValue"]),v("div",GP,[H(a,{modelValue:e.char.equips.secondary.left,"onUpdate:modelValue":t[4]||(t[4]=d=>e.char.equips.secondary.left=d),options:e.selectItems("secondary","left"),label:"Левая рука"},null,8,["modelValue","options"]),H(a,{modelValue:e.char.equips.secondary.right,"onUpdate:modelValue":t[5]||(t[5]=d=>e.char.equips.secondary.right=d),options:e.selectItems("secondary","right"),label:"Правая рука"},null,8,["modelValue","options"])])])]),qP,H(a,{modelValue:e.weapon_edit,"onUpdate:modelValue":t[6]||(t[6]=d=>e.weapon_edit=d),options:e.selectAllItems(),label:"Выберите оружие"},null,8,["modelValue","options"]),e.weapon_edit!=null?(P(),z("edit-item-block",YP,[(P(!0),z(be,null,Fe([e.char.items[e.weapon_edit]],d=>(P(),z(be,null,[H(o,{modelValue:d.name,"onUpdate:modelValue":u=>d.name=u,label:"Название предмета",size:"sm"},null,8,["modelValue","onUpdate:modelValue"]),v("item-stats-edit",XP,[H(o,{modelValue:d.attack,"onUpdate:modelValue":u=>d.attack=u,label:"Мод атаки",size:"sm"},null,8,["modelValue","onUpdate:modelValue"]),typeof d.defence=="object"?(P(),z(be,{key:0},[typeof d.defence.front=="object"?(P(),z(be,{key:0},[H(o,{modelValue:d.defence.front.melee,"onUpdate:modelValue":u=>d.defence.front.melee=u,label:"Защита фронт удары",size:"sm"},null,8,["modelValue","onUpdate:modelValue"]),H(o,{modelValue:d.defence.front.ranged,"onUpdate:modelValue":u=>d.defence.front.ranged=u,label:"Защита фронт снаряды",size:"sm"},null,8,["modelValue","onUpdate:modelValue"])],64)):Le("",!0),typeof d.defence.side=="object"?(P(),z(be,{key:1},[H(o,{modelValue:d.defence.side.melee,"onUpdate:modelValue":u=>d.defence.side.melee=u,label:"Защита фланг удары",size:"sm"},null,8,["modelValue","onUpdate:modelValue"]),H(o,{modelValue:d.defence.side.ranged,"onUpdate:modelValue":u=>d.defence.side.ranged=u,label:"Защита фланг снаряды",size:"sm"},null,8,["modelValue","onUpdate:modelValue"])],64)):Le("",!0)],64)):(P(),Ge(o,{key:1,modelValue:d.defence,"onUpdate:modelValue":u=>d.defence=u,label:"Мод защиты",size:"sm"},null,8,["modelValue","onUpdate:modelValue"]))]),typeof d.damage=="object"?(P(),z("damage-block-edit",KP,[(P(!0),z(be,null,Fe(d.damage,(u,h)=>(P(),z(be,null,[v("div",JP,U(h),1),H(o,{modelValue:e.char.items[e.weapon_edit].damage[h],"onUpdate:modelValue":p=>e.char.items[e.weapon_edit].damage[h]=p,label:"Урон",size:"sm"},null,8,["modelValue","onUpdate:modelValue"])],64))),256))])):Le("",!0)],64))),256))])):Le("",!0),H(o,{modelValue:e.char.name,"onUpdate:modelValue":t[7]||(t[7]=d=>e.char.name=d),label:"Сменить имя персонажа"},null,8,["modelValue"])]),v("traits-block",null,[(P(!0),z(be,null,Fe(e.char.computed.traits,d=>(P(),z("trait-block",null,[v("h3",ZP,U(d.name),1),v("div",null,U(d.desc),1)]))),256))]),H(l,{modelValue:e.char.notes,"onUpdate:modelValue":t[8]||(t[8]=d=>e.char.notes=d),rows:16,label:"Заметки",placeholder:"Любая дополнительная информация"},null,8,["modelValue"]),H(s,{color:"green",size:"lg",onClick:t[9]||(t[9]=d=>e.$router.push("/")),"w-full":"","mt-4":""},{default:K(()=>[he(" Вернуться на панель персонажей ")]),_:1})])):Le("",!0),e.isShowModal?(P(),Ge(c,{key:1,class:Se(["modal",e.check_success?"green":"red"]),position:"bottom-center",onClose:e.closeModal,onClick:e.closeModal},{header:K(()=>[v("div",QP,U(e.check_success?"Успех!":"Провал..."),1)]),body:K(()=>[e.check_success?(P(),z("p",eR," Вам удалось пройти проверку!")):(P(),z("p",tR," Проверка оказалась слишком сложной для Вас."))]),_:1},8,["class","onClose","onClick"])):Le("",!0)],64)}}}),nR=eS({history:Lx("/trip/"),routes:[{path:"/",name:"overview",component:lP},{path:"/new-character",name:"new-character",component:iD},{path:"/character-page/:charKey",name:"character-page",component:rR},{path:"/wiki",name:"about",component:()=>W3(()=>import("./WikiView-olZNx_wq.js"),__vite__mapDeps([0,1]))}]}),na=/^[a-z0-9]+(-[a-z0-9]+)*$/,rd=(i,e,t,r="")=>{const n=i.split(":");if(i.slice(0,1)==="@"){if(n.length<2||n.length>3)return null;r=n.shift().slice(1)}if(n.length>3||!n.length)return null;if(n.length>1){const a=n.pop(),l=n.pop(),c={provider:n.length>0?n[0]:r,prefix:l,name:a};return e&&!Yl(c)?null:c}const s=n[0],o=s.split("-");if(o.length>1){const a={provider:r,prefix:o.shift(),name:o.join("-")};return e&&!Yl(a)?null:a}if(t&&r===""){const a={provider:r,prefix:"",name:s};return e&&!Yl(a,t)?null:a}return null},Yl=(i,e)=>i?!!((i.provider===""||i.provider.match(na))&&(e&&i.prefix===""||i.prefix.match(na))&&i.name.match(na)):!1,Wb=Object.freeze({left:0,top:0,width:16,height:16}),Rc=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),nd=Object.freeze({...Wb,...Rc}),Zu=Object.freeze({...nd,body:"",hidden:!1});function sR(i,e){const t={};!i.hFlip!=!e.hFlip&&(t.hFlip=!0),!i.vFlip!=!e.vFlip&&(t.vFlip=!0);const r=((i.rotate||0)+(e.rotate||0))%4;return r&&(t.rotate=r),t}function Lm(i,e){const t=sR(i,e);for(const r in Zu)r in Rc?r in i&&!(r in t)&&(t[r]=Rc[r]):r in e?t[r]=e[r]:r in i&&(t[r]=i[r]);return t}function oR(i,e){const t=i.icons,r=i.aliases||Object.create(null),n=Object.create(null);function s(o){if(t[o])return n[o]=[];if(!(o in n)){n[o]=null;const a=r[o]&&r[o].parent,l=a&&s(a);l&&(n[o]=[a].concat(l))}return n[o]}return Object.keys(t).concat(Object.keys(r)).forEach(s),n}function aR(i,e,t){const r=i.icons,n=i.aliases||Object.create(null);let s={};function o(a){s=Lm(r[a]||n[a],s)}return o(e),t.forEach(o),Lm(i,s)}function Gb(i,e){const t=[];if(typeof i!="object"||typeof i.icons!="object")return t;i.not_found instanceof Array&&i.not_found.forEach(n=>{e(n,null),t.push(n)});const r=oR(i);for(const n in r){const s=r[n];s&&(e(n,aR(i,n,s)),t.push(n))}return t}const lR={provider:"",aliases:{},not_found:{},...Wb};function Bd(i,e){for(const t in e)if(t in i&&typeof i[t]!=typeof e[t])return!1;return!0}function qb(i){if(typeof i!="object"||i===null)return null;const e=i;if(typeof e.prefix!="string"||!i.icons||typeof i.icons!="object"||!Bd(i,lR))return null;const t=e.icons;for(const n in t){const s=t[n];if(!n.match(na)||typeof s.body!="string"||!Bd(s,Zu))return null}const r=e.aliases||Object.create(null);for(const n in r){const s=r[n],o=s.parent;if(!n.match(na)||typeof o!="string"||!t[o]&&!r[o]||!Bd(s,Zu))return null}return e}const Dm=Object.create(null);function cR(i,e){return{provider:i,prefix:e,icons:Object.create(null),missing:new Set}}function ls(i,e){const t=Dm[i]||(Dm[i]=Object.create(null));return t[e]||(t[e]=cR(i,e))}function bf(i,e){return qb(e)?Gb(e,(t,r)=>{r?i.icons[t]=r:i.missing.add(t)}):[]}function dR(i,e,t){try{if(typeof t.body=="string")return i.icons[e]={...t},!0}catch{}return!1}let Ma=!1;function Yb(i){return typeof i=="boolean"&&(Ma=i),Ma}function uR(i){const e=typeof i=="string"?rd(i,!0,Ma):i;if(e){const t=ls(e.provider,e.prefix),r=e.name;return t.icons[r]||(t.missing.has(r)?null:void 0)}}function hR(i,e){const t=rd(i,!0,Ma);if(!t)return!1;const r=ls(t.provider,t.prefix);return dR(r,t.name,e)}function fR(i,e){if(typeof i!="object")return!1;if(typeof e!="string"&&(e=i.provider||""),Ma&&!e&&!i.prefix){let n=!1;return qb(i)&&(i.prefix="",Gb(i,(s,o)=>{o&&hR(s,o)&&(n=!0)})),n}const t=i.prefix;if(!Yl({provider:e,prefix:t,name:"a"}))return!1;const r=ls(e,t);return!!bf(r,i)}const Xb=Object.freeze({width:null,height:null}),Kb=Object.freeze({...Xb,...Rc}),pR=/(-?[0-9.]*[0-9]+[0-9.]*)/g,mR=/^-?[0-9.]*[0-9]+[0-9.]*$/g;function Pm(i,e,t){if(e===1)return i;if(t=t||100,typeof i=="number")return Math.ceil(i*e*t)/t;if(typeof i!="string")return i;const r=i.split(pR);if(r===null||!r.length)return i;const n=[];let s=r.shift(),o=mR.test(s);for(;;){if(o){const a=parseFloat(s);isNaN(a)?n.push(s):n.push(Math.ceil(a*e*t)/t)}else n.push(s);if(s=r.shift(),s===void 0)return n.join("");o=!o}}function gR(i,e="defs"){let t="";const r=i.indexOf("<"+e);for(;r>=0;){const n=i.indexOf(">",r),s=i.indexOf("</"+e);if(n===-1||s===-1)break;const o=i.indexOf(">",s);if(o===-1)break;t+=i.slice(n+1,s).trim(),i=i.slice(0,r).trim()+i.slice(o+1)}return{defs:t,content:i}}function vR(i,e){return i?"<defs>"+i+"</defs>"+e:e}function bR(i,e,t){const r=gR(i);return vR(r.defs,e+r.content+t)}const yR=i=>i==="unset"||i==="undefined"||i==="none";function _R(i,e){const t={...nd,...i},r={...Kb,...e},n={left:t.left,top:t.top,width:t.width,height:t.height};let s=t.body;[t,r].forEach(f=>{const m=[],b=f.hFlip,y=f.vFlip;let w=f.rotate;b?y?w+=2:(m.push("translate("+(n.width+n.left).toString()+" "+(0-n.top).toString()+")"),m.push("scale(-1 1)"),n.top=n.left=0):y&&(m.push("translate("+(0-n.left).toString()+" "+(n.height+n.top).toString()+")"),m.push("scale(1 -1)"),n.top=n.left=0);let _;switch(w<0&&(w-=Math.floor(w/4)*4),w=w%4,w){case 1:_=n.height/2+n.top,m.unshift("rotate(90 "+_.toString()+" "+_.toString()+")");break;case 2:m.unshift("rotate(180 "+(n.width/2+n.left).toString()+" "+(n.height/2+n.top).toString()+")");break;case 3:_=n.width/2+n.left,m.unshift("rotate(-90 "+_.toString()+" "+_.toString()+")");break}w%2===1&&(n.left!==n.top&&(_=n.left,n.left=n.top,n.top=_),n.width!==n.height&&(_=n.width,n.width=n.height,n.height=_)),m.length&&(s=bR(s,'<g transform="'+m.join(" ")+'">',"</g>"))});const o=r.width,a=r.height,l=n.width,c=n.height;let d,u;o===null?(u=a===null?"1em":a==="auto"?c:a,d=Pm(u,l/c)):(d=o==="auto"?l:o,u=a===null?Pm(d,c/l):a==="auto"?c:a);const h={},p=(f,m)=>{yR(m)||(h[f]=m.toString())};p("width",d),p("height",u);const g=[n.left,n.top,l,c];return h.viewBox=g.join(" "),{attributes:h,viewBox:g,body:s}}const wR=/\sid="(\S+)"/g,xR="IconifyId"+Date.now().toString(16)+(Math.random()*16777216|0).toString(16);let SR=0;function MR(i,e=xR){const t=[];let r;for(;r=wR.exec(i);)t.push(r[1]);if(!t.length)return i;const n="suffix"+(Math.random()*16777216|Date.now()).toString(16);return t.forEach(s=>{const o=typeof e=="function"?e(s):e+(SR++).toString(),a=s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");i=i.replace(new RegExp('([#;"])('+a+')([")]|\\.[a-z])',"g"),"$1"+o+n+"$3")}),i=i.replace(new RegExp(n,"g"),""),i}const Qu=Object.create(null);function ER(i,e){Qu[i]=e}function eh(i){return Qu[i]||Qu[""]}function yf(i){let e;if(typeof i.resources=="string")e=[i.resources];else if(e=i.resources,!(e instanceof Array)||!e.length)return null;return{resources:e,path:i.path||"/",maxURL:i.maxURL||500,rotate:i.rotate||750,timeout:i.timeout||5e3,random:i.random===!0,index:i.index||0,dataAfterTimeout:i.dataAfterTimeout!==!1}}const _f=Object.create(null),Co=["https://api.simplesvg.com","https://api.unisvg.com"],Xl=[];for(;Co.length>0;)Co.length===1||Math.random()>.5?Xl.push(Co.shift()):Xl.push(Co.pop());_f[""]=yf({resources:["https://api.iconify.design"].concat(Xl)});function kR(i,e){const t=yf(e);return t===null?!1:(_f[i]=t,!0)}function wf(i){return _f[i]}const CR=()=>{let i;try{if(i=fetch,typeof i=="function")return i}catch{}};let Rm=CR();function TR(i,e){const t=wf(i);if(!t)return 0;let r;if(!t.maxURL)r=0;else{let n=0;t.resources.forEach(o=>{n=Math.max(n,o.length)});const s=e+".json?icons=";r=t.maxURL-n-t.path.length-s.length}return r}function AR(i){return i===404}const LR=(i,e,t)=>{const r=[],n=TR(i,e),s="icons";let o={type:s,provider:i,prefix:e,icons:[]},a=0;return t.forEach((l,c)=>{a+=l.length+1,a>=n&&c>0&&(r.push(o),o={type:s,provider:i,prefix:e,icons:[]},a=l.length),o.icons.push(l)}),r.push(o),r};function DR(i){if(typeof i=="string"){const e=wf(i);if(e)return e.path}return"/"}const PR=(i,e,t)=>{if(!Rm){t("abort",424);return}let r=DR(e.provider);switch(e.type){case"icons":{const s=e.prefix,a=e.icons.join(","),l=new URLSearchParams({icons:a});r+=s+".json?"+l.toString();break}case"custom":{const s=e.uri;r+=s.slice(0,1)==="/"?s.slice(1):s;break}default:t("abort",400);return}let n=503;Rm(i+r).then(s=>{const o=s.status;if(o!==200){setTimeout(()=>{t(AR(o)?"abort":"next",o)});return}return n=501,s.json()}).then(s=>{if(typeof s!="object"||s===null){setTimeout(()=>{s===404?t("abort",s):t("next",n)});return}setTimeout(()=>{t("success",s)})}).catch(()=>{t("next",n)})},RR={prepare:LR,send:PR};function IR(i){const e={loaded:[],missing:[],pending:[]},t=Object.create(null);i.sort((n,s)=>n.provider!==s.provider?n.provider.localeCompare(s.provider):n.prefix!==s.prefix?n.prefix.localeCompare(s.prefix):n.name.localeCompare(s.name));let r={provider:"",prefix:"",name:""};return i.forEach(n=>{if(r.name===n.name&&r.prefix===n.prefix&&r.provider===n.provider)return;r=n;const s=n.provider,o=n.prefix,a=n.name,l=t[s]||(t[s]=Object.create(null)),c=l[o]||(l[o]=ls(s,o));let d;a in c.icons?d=e.loaded:o===""||c.missing.has(a)?d=e.missing:d=e.pending;const u={provider:s,prefix:o,name:a};d.push(u)}),e}function Jb(i,e){i.forEach(t=>{const r=t.loaderCallbacks;r&&(t.loaderCallbacks=r.filter(n=>n.id!==e))})}function OR(i){i.pendingCallbacksFlag||(i.pendingCallbacksFlag=!0,setTimeout(()=>{i.pendingCallbacksFlag=!1;const e=i.loaderCallbacks?i.loaderCallbacks.slice(0):[];if(!e.length)return;let t=!1;const r=i.provider,n=i.prefix;e.forEach(s=>{const o=s.icons,a=o.pending.length;o.pending=o.pending.filter(l=>{if(l.prefix!==n)return!0;const c=l.name;if(i.icons[c])o.loaded.push({provider:r,prefix:n,name:c});else if(i.missing.has(c))o.missing.push({provider:r,prefix:n,name:c});else return t=!0,!0;return!1}),o.pending.length!==a&&(t||Jb([i],s.id),s.callback(o.loaded.slice(0),o.missing.slice(0),o.pending.slice(0),s.abort))})}))}let FR=0;function zR(i,e,t){const r=FR++,n=Jb.bind(null,t,r);if(!e.pending.length)return n;const s={id:r,icons:e,callback:i,abort:n};return t.forEach(o=>{(o.loaderCallbacks||(o.loaderCallbacks=[])).push(s)}),n}function NR(i,e=!0,t=!1){const r=[];return i.forEach(n=>{const s=typeof n=="string"?rd(n,e,t):n;s&&r.push(s)}),r}var $R={resources:[],index:0,timeout:2e3,rotate:750,random:!1,dataAfterTimeout:!1};function BR(i,e,t,r){const n=i.resources.length,s=i.random?Math.floor(Math.random()*n):i.index;let o;if(i.random){let S=i.resources.slice(0);for(o=[];S.length>1;){const A=Math.floor(Math.random()*S.length);o.push(S[A]),S=S.slice(0,A).concat(S.slice(A+1))}o=o.concat(S)}else o=i.resources.slice(s).concat(i.resources.slice(0,s));const a=Date.now();let l="pending",c=0,d,u=null,h=[],p=[];typeof r=="function"&&p.push(r);function g(){u&&(clearTimeout(u),u=null)}function f(){l==="pending"&&(l="aborted"),g(),h.forEach(S=>{S.status==="pending"&&(S.status="aborted")}),h=[]}function m(S,A){A&&(p=[]),typeof S=="function"&&p.push(S)}function b(){return{startTime:a,payload:e,status:l,queriesSent:c,queriesPending:h.length,subscribe:m,abort:f}}function y(){l="failed",p.forEach(S=>{S(void 0,d)})}function w(){h.forEach(S=>{S.status==="pending"&&(S.status="aborted")}),h=[]}function _(S,A,x){const E=A!=="success";switch(h=h.filter(D=>D!==S),l){case"pending":break;case"failed":if(E||!i.dataAfterTimeout)return;break;default:return}if(A==="abort"){d=x,y();return}if(E){d=x,h.length||(o.length?M():y());return}if(g(),w(),!i.random){const D=i.resources.indexOf(S.resource);D!==-1&&D!==i.index&&(i.index=D)}l="completed",p.forEach(D=>{D(x)})}function M(){if(l!=="pending")return;g();const S=o.shift();if(S===void 0){if(h.length){u=setTimeout(()=>{g(),l==="pending"&&(w(),y())},i.timeout);return}y();return}const A={status:"pending",resource:S,callback:(x,E)=>{_(A,x,E)}};h.push(A),c++,u=setTimeout(M,i.rotate),t(S,e,A.callback)}return setTimeout(M),b}function Zb(i){const e={...$R,...i};let t=[];function r(){t=t.filter(a=>a().status==="pending")}function n(a,l,c){const d=BR(e,a,l,(u,h)=>{r(),c&&c(u,h)});return t.push(d),d}function s(a){return t.find(l=>a(l))||null}return{query:n,find:s,setIndex:a=>{e.index=a},getIndex:()=>e.index,cleanup:r}}function Im(){}const Vd=Object.create(null);function VR(i){if(!Vd[i]){const e=wf(i);if(!e)return;const t=Zb(e),r={config:e,redundancy:t};Vd[i]=r}return Vd[i]}function HR(i,e,t){let r,n;if(typeof i=="string"){const s=eh(i);if(!s)return t(void 0,424),Im;n=s.send;const o=VR(i);o&&(r=o.redundancy)}else{const s=yf(i);if(s){r=Zb(s);const o=i.resources?i.resources[0]:"",a=eh(o);a&&(n=a.send)}}return!r||!n?(t(void 0,424),Im):r.query(e,n,t)().abort}const Om="iconify2",Ea="iconify",Qb=Ea+"-count",Fm=Ea+"-version",ey=36e5,UR=168,jR=50;function th(i,e){try{return i.getItem(e)}catch{}}function xf(i,e,t){try{return i.setItem(e,t),!0}catch{}}function zm(i,e){try{i.removeItem(e)}catch{}}function ih(i,e){return xf(i,Qb,e.toString())}function rh(i){return parseInt(th(i,Qb))||0}const sd={local:!0,session:!0},ty={local:new Set,session:new Set};let Sf=!1;function WR(i){Sf=i}let al=typeof window>"u"?{}:window;function iy(i){const e=i+"Storage";try{if(al&&al[e]&&typeof al[e].length=="number")return al[e]}catch{}sd[i]=!1}function ry(i,e){const t=iy(i);if(!t)return;const r=th(t,Fm);if(r!==Om){if(r){const a=rh(t);for(let l=0;l<a;l++)zm(t,Ea+l.toString())}xf(t,Fm,Om),ih(t,0);return}const n=Math.floor(Date.now()/ey)-UR,s=a=>{const l=Ea+a.toString(),c=th(t,l);if(typeof c=="string"){try{const d=JSON.parse(c);if(typeof d=="object"&&typeof d.cached=="number"&&d.cached>n&&typeof d.provider=="string"&&typeof d.data=="object"&&typeof d.data.prefix=="string"&&e(d,a))return!0}catch{}zm(t,l)}};let o=rh(t);for(let a=o-1;a>=0;a--)s(a)||(a===o-1?(o--,ih(t,o)):ty[i].add(a))}function ny(){if(!Sf){WR(!0);for(const i in sd)ry(i,e=>{const t=e.data,r=e.provider,n=t.prefix,s=ls(r,n);if(!bf(s,t).length)return!1;const o=t.lastModified||-1;return s.lastModifiedCached=s.lastModifiedCached?Math.min(s.lastModifiedCached,o):o,!0})}}function GR(i,e){const t=i.lastModifiedCached;if(t&&t>=e)return t===e;if(i.lastModifiedCached=e,t)for(const r in sd)ry(r,n=>{const s=n.data;return n.provider!==i.provider||s.prefix!==i.prefix||s.lastModified===e});return!0}function qR(i,e){Sf||ny();function t(r){let n;if(!sd[r]||!(n=iy(r)))return;const s=ty[r];let o;if(s.size)s.delete(o=Array.from(s).shift());else if(o=rh(n),o>=jR||!ih(n,o+1))return;const a={cached:Math.floor(Date.now()/ey),provider:i.provider,data:e};return xf(n,Ea+o.toString(),JSON.stringify(a))}e.lastModified&&!GR(i,e.lastModified)||Object.keys(e.icons).length&&(e.not_found&&(e=Object.assign({},e),delete e.not_found),t("local")||t("session"))}function Nm(){}function YR(i){i.iconsLoaderFlag||(i.iconsLoaderFlag=!0,setTimeout(()=>{i.iconsLoaderFlag=!1,OR(i)}))}function XR(i,e){i.iconsToLoad?i.iconsToLoad=i.iconsToLoad.concat(e).sort():i.iconsToLoad=e,i.iconsQueueFlag||(i.iconsQueueFlag=!0,setTimeout(()=>{i.iconsQueueFlag=!1;const{provider:t,prefix:r}=i,n=i.iconsToLoad;delete i.iconsToLoad;let s;if(!n||!(s=eh(t)))return;s.prepare(t,r,n).forEach(a=>{HR(t,a,l=>{if(typeof l!="object")a.icons.forEach(c=>{i.missing.add(c)});else try{const c=bf(i,l);if(!c.length)return;const d=i.pendingIcons;d&&c.forEach(u=>{d.delete(u)}),qR(i,l)}catch(c){console.error(c)}YR(i)})})}))}const KR=(i,e)=>{const t=NR(i,!0,Yb()),r=IR(t);if(!r.pending.length){let l=!0;return e&&setTimeout(()=>{l&&e(r.loaded,r.missing,r.pending,Nm)}),()=>{l=!1}}const n=Object.create(null),s=[];let o,a;return r.pending.forEach(l=>{const{provider:c,prefix:d}=l;if(d===a&&c===o)return;o=c,a=d,s.push(ls(c,d));const u=n[c]||(n[c]=Object.create(null));u[d]||(u[d]=[])}),r.pending.forEach(l=>{const{provider:c,prefix:d,name:u}=l,h=ls(c,d),p=h.pendingIcons||(h.pendingIcons=new Set);p.has(u)||(p.add(u),n[c][d].push(u))}),s.forEach(l=>{const{provider:c,prefix:d}=l;n[c][d].length&&XR(l,n[c][d])}),e?zR(e,r,s):Nm};function JR(i,e){const t={...i};for(const r in e){const n=e[r],s=typeof n;r in Xb?(n===null||n&&(s==="string"||s==="number"))&&(t[r]=n):s===typeof t[r]&&(t[r]=r==="rotate"?n%4:n)}return t}const ZR=/[\s,]+/;function QR(i,e){e.split(ZR).forEach(t=>{switch(t.trim()){case"horizontal":i.hFlip=!0;break;case"vertical":i.vFlip=!0;break}})}function eI(i,e=0){const t=i.replace(/^-?[0-9.]*/,"");function r(n){for(;n<0;)n+=4;return n%4}if(t===""){const n=parseInt(i);return isNaN(n)?0:r(n)}else if(t!==i){let n=0;switch(t){case"%":n=25;break;case"deg":n=90}if(n){let s=parseFloat(i.slice(0,i.length-t.length));return isNaN(s)?0:(s=s/n,s%1===0?r(s):0)}}return e}function tI(i,e){let t=i.indexOf("xlink:")===-1?"":' xmlns:xlink="http://www.w3.org/1999/xlink"';for(const r in e)t+=" "+r+'="'+e[r]+'"';return'<svg xmlns="http://www.w3.org/2000/svg"'+t+">"+i+"</svg>"}function iI(i){return i.replace(/"/g,"'").replace(/%/g,"%25").replace(/#/g,"%23").replace(/</g,"%3C").replace(/>/g,"%3E").replace(/\s+/g," ")}function rI(i){return"data:image/svg+xml,"+iI(i)}function nI(i){return'url("'+rI(i)+'")'}const $m={...Kb,inline:!1},sI={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":!0,role:"img"},oI={display:"inline-block"},nh={backgroundColor:"currentColor"},sy={backgroundColor:"transparent"},Bm={Image:"var(--svg)",Repeat:"no-repeat",Size:"100% 100%"},Vm={webkitMask:nh,mask:nh,background:sy};for(const i in Vm){const e=Vm[i];for(const t in Bm)e[i+t]=Bm[t]}const Kl={};["horizontal","vertical"].forEach(i=>{const e=i.slice(0,1)+"Flip";Kl[i+"-flip"]=e,Kl[i.slice(0,1)+"-flip"]=e,Kl[i+"Flip"]=e});function Hm(i){return i+(i.match(/^[-0-9.]+$/)?"px":"")}const Um=(i,e)=>{const t=JR($m,e),r={...sI},n=e.mode||"svg",s={},o=e.style,a=typeof o=="object"&&!(o instanceof Array)?o:{};for(let f in e){const m=e[f];if(m!==void 0)switch(f){case"icon":case"style":case"onLoad":case"mode":break;case"inline":case"hFlip":case"vFlip":t[f]=m===!0||m==="true"||m===1;break;case"flip":typeof m=="string"&&QR(t,m);break;case"color":s.color=m;break;case"rotate":typeof m=="string"?t[f]=eI(m):typeof m=="number"&&(t[f]=m);break;case"ariaHidden":case"aria-hidden":m!==!0&&m!=="true"&&delete r["aria-hidden"];break;default:{const b=Kl[f];b?(m===!0||m==="true"||m===1)&&(t[b]=!0):$m[f]===void 0&&(r[f]=m)}}}const l=_R(i,t),c=l.attributes;if(t.inline&&(s.verticalAlign="-0.125em"),n==="svg"){r.style={...s,...a},Object.assign(r,c);let f=0,m=e.id;return typeof m=="string"&&(m=m.replace(/-/g,"_")),r.innerHTML=MR(l.body,m?()=>m+"ID"+f++:"iconifyVue"),ma("svg",r)}const{body:d,width:u,height:h}=i,p=n==="mask"||(n==="bg"?!1:d.indexOf("currentColor")!==-1),g=tI(d,{...c,width:u+"",height:h+""});return r.style={...s,"--svg":nI(g),width:Hm(c.width),height:Hm(c.height),...oI,...p?nh:sy,...a},ma("span",r)};Yb(!0);ER("",RR);if(typeof document<"u"&&typeof window<"u"){ny();const i=window;if(i.IconifyPreload!==void 0){const e=i.IconifyPreload,t="Invalid IconifyPreload syntax.";typeof e=="object"&&e!==null&&(e instanceof Array?e:[e]).forEach(r=>{try{(typeof r!="object"||r===null||r instanceof Array||typeof r.icons!="object"||typeof r.prefix!="string"||!fR(r))&&console.error(t)}catch{console.error(t)}})}if(i.IconifyProviders!==void 0){const e=i.IconifyProviders;if(typeof e=="object"&&e!==null)for(let t in e){const r="IconifyProviders["+t+"] is invalid.";try{const n=e[t];if(typeof n!="object"||!n||n.resources===void 0)continue;kR(t,n)||console.error(r)}catch{console.error(r)}}}}const aI={...nd,body:""},lI=ht({inheritAttrs:!1,data(){return{_name:"",_loadingIcon:null,iconMounted:!1,counter:0}},mounted(){this.iconMounted=!0},unmounted(){this.abortLoading()},methods:{abortLoading(){this._loadingIcon&&(this._loadingIcon.abort(),this._loadingIcon=null)},getIcon(i,e){if(typeof i=="object"&&i!==null&&typeof i.body=="string")return this._name="",this.abortLoading(),{data:i};let t;if(typeof i!="string"||(t=rd(i,!1,!0))===null)return this.abortLoading(),null;const r=uR(t);if(!r)return(!this._loadingIcon||this._loadingIcon.name!==i)&&(this.abortLoading(),this._name="",r!==null&&(this._loadingIcon={name:i,abort:KR([t],()=>{this.counter++})})),null;this.abortLoading(),this._name!==i&&(this._name=i,e&&e(i));const n=["iconify"];return t.prefix!==""&&n.push("iconify--"+t.prefix),t.provider!==""&&n.push("iconify--"+t.provider),{data:r,classes:n}}},render(){this.counter;const i=this.$attrs,e=this.iconMounted||i.ssr?this.getIcon(i.icon,i.onLoad):null;if(!e)return Um(aI,i);let t=i;return e.classes&&(t={...i,class:(typeof i.class=="string"?i.class+" ":"")+e.classes.join(" ")}),Um({...nd,...e.data},t)}}),cI="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let oy=(i=21)=>{let e="",t=crypto.getRandomValues(new Uint8Array(i));for(;i--;)e+=cI[t[i]&63];return e};const Hd=lo({});function Na(i,e){return pv(()=>{i&&(Hd[i]={id:i,flush:(e==null?void 0:e.flush)??!1,alwaysOpen:(e==null?void 0:e.alwaysOpen)??!1,openFirstItem:(e==null?void 0:e.openFirstItem)??!0,panels:{}})}),Dh(()=>{i&&delete Hd[i]}),{accordionsStates:Hd}}const dI=["data-accordion-id"],uI=ht({__name:"FwbAccordion",props:{alwaysOpen:{type:Boolean,default:!1},openFirstItem:{type:Boolean,default:!0},flush:{type:Boolean,default:!1}},setup(i){const e=i,t=oy();return Na(t,{...e}),(r,n)=>(P(),z("div",{"data-accordion-id":Ee(t)},[Xe(r.$slots,"default")],8,dI))}}),Mf="-";function hI(i){const e=pI(i),{conflictingClassGroups:t,conflictingClassGroupModifiers:r}=i;function n(o){const a=o.split(Mf);return a[0]===""&&a.length!==1&&a.shift(),ay(a,e)||fI(o)}function s(o,a){const l=t[o]||[];return a&&r[o]?[...l,...r[o]]:l}return{getClassGroupId:n,getConflictingClassGroupIds:s}}function ay(i,e){var o;if(i.length===0)return e.classGroupId;const t=i[0],r=e.nextPart.get(t),n=r?ay(i.slice(1),r):void 0;if(n)return n;if(e.validators.length===0)return;const s=i.join(Mf);return(o=e.validators.find(({validator:a})=>a(s)))==null?void 0:o.classGroupId}const jm=/^\[(.+)\]$/;function fI(i){if(jm.test(i)){const e=jm.exec(i)[1],t=e==null?void 0:e.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}}function pI(i){const{theme:e,prefix:t}=i,r={nextPart:new Map,validators:[]};return gI(Object.entries(i.classGroups),t).forEach(([n,s])=>{sh(s,r,n,e)}),r}function sh(i,e,t,r){i.forEach(n=>{if(typeof n=="string"){const s=n===""?e:Wm(e,n);s.classGroupId=t;return}if(typeof n=="function"){if(mI(n)){sh(n(r),e,t,r);return}e.validators.push({validator:n,classGroupId:t});return}Object.entries(n).forEach(([s,o])=>{sh(o,Wm(e,s),t,r)})})}function Wm(i,e){let t=i;return e.split(Mf).forEach(r=>{t.nextPart.has(r)||t.nextPart.set(r,{nextPart:new Map,validators:[]}),t=t.nextPart.get(r)}),t}function mI(i){return i.isThemeGetter}function gI(i,e){return e?i.map(([t,r])=>{const n=r.map(s=>typeof s=="string"?e+s:typeof s=="object"?Object.fromEntries(Object.entries(s).map(([o,a])=>[e+o,a])):s);return[t,n]}):i}function vI(i){if(i<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,r=new Map;function n(s,o){t.set(s,o),e++,e>i&&(e=0,r=t,t=new Map)}return{get(s){let o=t.get(s);if(o!==void 0)return o;if((o=r.get(s))!==void 0)return n(s,o),o},set(s,o){t.has(s)?t.set(s,o):n(s,o)}}}const ly="!";function bI(i){const e=i.separator,t=e.length===1,r=e[0],n=e.length;return function(s){const o=[];let a=0,l=0,c;for(let g=0;g<s.length;g++){let f=s[g];if(a===0){if(f===r&&(t||s.slice(g,g+n)===e)){o.push(s.slice(l,g)),l=g+n;continue}if(f==="/"){c=g;continue}}f==="["?a++:f==="]"&&a--}const d=o.length===0?s:s.substring(l),u=d.startsWith(ly),h=u?d.substring(1):d,p=c&&c>l?c-l:void 0;return{modifiers:o,hasImportantModifier:u,baseClassName:h,maybePostfixModifierPosition:p}}}function yI(i){if(i.length<=1)return i;const e=[];let t=[];return i.forEach(r=>{r[0]==="["?(e.push(...t.sort(),r),t=[]):t.push(r)}),e.push(...t.sort()),e}function _I(i){return{cache:vI(i.cacheSize),splitModifiers:bI(i),...hI(i)}}const wI=/\s+/;function xI(i,e){const{splitModifiers:t,getClassGroupId:r,getConflictingClassGroupIds:n}=e,s=new Set;return i.trim().split(wI).map(o=>{const{modifiers:a,hasImportantModifier:l,baseClassName:c,maybePostfixModifierPosition:d}=t(o);let u=r(d?c.substring(0,d):c),h=!!d;if(!u){if(!d)return{isTailwindClass:!1,originalClassName:o};if(u=r(c),!u)return{isTailwindClass:!1,originalClassName:o};h=!1}const p=yI(a).join(":");return{isTailwindClass:!0,modifierId:l?p+ly:p,classGroupId:u,originalClassName:o,hasPostfixModifier:h}}).reverse().filter(o=>{if(!o.isTailwindClass)return!0;const{modifierId:a,classGroupId:l,hasPostfixModifier:c}=o,d=a+l;return s.has(d)?!1:(s.add(d),n(l,c).forEach(u=>s.add(a+u)),!0)}).reverse().map(o=>o.originalClassName).join(" ")}function SI(){let i=0,e,t,r="";for(;i<arguments.length;)(e=arguments[i++])&&(t=cy(e))&&(r&&(r+=" "),r+=t);return r}function cy(i){if(typeof i=="string")return i;let e,t="";for(let r=0;r<i.length;r++)i[r]&&(e=cy(i[r]))&&(t&&(t+=" "),t+=e);return t}function MI(i,...e){let t,r,n,s=o;function o(l){const c=e.reduce((d,u)=>u(d),i());return t=_I(c),r=t.cache.get,n=t.cache.set,s=a,a(l)}function a(l){const c=r(l);if(c)return c;const d=xI(l,t);return n(l,d),d}return function(){return s(SI.apply(null,arguments))}}function wt(i){const e=t=>t[i]||[];return e.isThemeGetter=!0,e}const dy=/^\[(?:([a-z-]+):)?(.+)\]$/i,EI=/^\d+\/\d+$/,kI=new Set(["px","full","screen"]),CI=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,TI=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,AI=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,LI=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,DI=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/;function hr(i){return Yn(i)||kI.has(i)||EI.test(i)}function Vr(i){return ho(i,"length",$I)}function Yn(i){return!!i&&!Number.isNaN(Number(i))}function ll(i){return ho(i,"number",Yn)}function To(i){return!!i&&Number.isInteger(Number(i))}function PI(i){return i.endsWith("%")&&Yn(i.slice(0,-1))}function Ze(i){return dy.test(i)}function Hr(i){return CI.test(i)}const RI=new Set(["length","size","percentage"]);function II(i){return ho(i,RI,uy)}function OI(i){return ho(i,"position",uy)}const FI=new Set(["image","url"]);function zI(i){return ho(i,FI,VI)}function NI(i){return ho(i,"",BI)}function Ao(){return!0}function ho(i,e,t){const r=dy.exec(i);return r?r[1]?typeof e=="string"?r[1]===e:e.has(r[1]):t(r[2]):!1}function $I(i){return TI.test(i)&&!AI.test(i)}function uy(){return!1}function BI(i){return LI.test(i)}function VI(i){return DI.test(i)}function HI(){const i=wt("colors"),e=wt("spacing"),t=wt("blur"),r=wt("brightness"),n=wt("borderColor"),s=wt("borderRadius"),o=wt("borderSpacing"),a=wt("borderWidth"),l=wt("contrast"),c=wt("grayscale"),d=wt("hueRotate"),u=wt("invert"),h=wt("gap"),p=wt("gradientColorStops"),g=wt("gradientColorStopPositions"),f=wt("inset"),m=wt("margin"),b=wt("opacity"),y=wt("padding"),w=wt("saturate"),_=wt("scale"),M=wt("sepia"),S=wt("skew"),A=wt("space"),x=wt("translate"),E=()=>["auto","contain","none"],D=()=>["auto","hidden","clip","visible","scroll"],F=()=>["auto",Ze,e],R=()=>[Ze,e],B=()=>["",hr,Vr],I=()=>["auto",Yn,Ze],V=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],N=()=>["solid","dashed","dotted","double","none"],j=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Y=()=>["start","end","center","between","around","evenly","stretch"],W=()=>["","0",Ze],ee=()=>["auto","avoid","all","avoid-page","page","left","right","column"],me=()=>[Yn,ll],X=()=>[Yn,Ze];return{cacheSize:500,separator:":",theme:{colors:[Ao],spacing:[hr,Vr],blur:["none","",Hr,Ze],brightness:me(),borderColor:[i],borderRadius:["none","","full",Hr,Ze],borderSpacing:R(),borderWidth:B(),contrast:me(),grayscale:W(),hueRotate:X(),invert:W(),gap:R(),gradientColorStops:[i],gradientColorStopPositions:[PI,Vr],inset:F(),margin:F(),opacity:me(),padding:R(),saturate:me(),scale:me(),sepia:W(),skew:X(),space:R(),translate:R()},classGroups:{aspect:[{aspect:["auto","square","video",Ze]}],container:["container"],columns:[{columns:[Hr]}],"break-after":[{"break-after":ee()}],"break-before":[{"break-before":ee()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...V(),Ze]}],overflow:[{overflow:D()}],"overflow-x":[{"overflow-x":D()}],"overflow-y":[{"overflow-y":D()}],overscroll:[{overscroll:E()}],"overscroll-x":[{"overscroll-x":E()}],"overscroll-y":[{"overscroll-y":E()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[f]}],"inset-x":[{"inset-x":[f]}],"inset-y":[{"inset-y":[f]}],start:[{start:[f]}],end:[{end:[f]}],top:[{top:[f]}],right:[{right:[f]}],bottom:[{bottom:[f]}],left:[{left:[f]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",To,Ze]}],basis:[{basis:F()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Ze]}],grow:[{grow:W()}],shrink:[{shrink:W()}],order:[{order:["first","last","none",To,Ze]}],"grid-cols":[{"grid-cols":[Ao]}],"col-start-end":[{col:["auto",{span:["full",To,Ze]},Ze]}],"col-start":[{"col-start":I()}],"col-end":[{"col-end":I()}],"grid-rows":[{"grid-rows":[Ao]}],"row-start-end":[{row:["auto",{span:[To,Ze]},Ze]}],"row-start":[{"row-start":I()}],"row-end":[{"row-end":I()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Ze]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Ze]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal",...Y()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...Y(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...Y(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[m]}],mx:[{mx:[m]}],my:[{my:[m]}],ms:[{ms:[m]}],me:[{me:[m]}],mt:[{mt:[m]}],mr:[{mr:[m]}],mb:[{mb:[m]}],ml:[{ml:[m]}],"space-x":[{"space-x":[A]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[A]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Ze,e]}],"min-w":[{"min-w":[Ze,e,"min","max","fit"]}],"max-w":[{"max-w":[Ze,e,"none","full","min","max","fit","prose",{screen:[Hr]},Hr]}],h:[{h:[Ze,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Ze,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Ze,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Ze,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Hr,Vr]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",ll]}],"font-family":[{font:[Ao]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Ze]}],"line-clamp":[{"line-clamp":["none",Yn,ll]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",hr,Ze]}],"list-image":[{"list-image":["none",Ze]}],"list-style-type":[{list:["none","disc","decimal",Ze]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[i]}],"placeholder-opacity":[{"placeholder-opacity":[b]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[i]}],"text-opacity":[{"text-opacity":[b]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...N(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",hr,Vr]}],"underline-offset":[{"underline-offset":["auto",hr,Ze]}],"text-decoration-color":[{decoration:[i]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:R()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ze]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ze]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[b]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...V(),OI]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",II]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},zI]}],"bg-color":[{bg:[i]}],"gradient-from-pos":[{from:[g]}],"gradient-via-pos":[{via:[g]}],"gradient-to-pos":[{to:[g]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[b]}],"border-style":[{border:[...N(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[b]}],"divide-style":[{divide:N()}],"border-color":[{border:[n]}],"border-color-x":[{"border-x":[n]}],"border-color-y":[{"border-y":[n]}],"border-color-t":[{"border-t":[n]}],"border-color-r":[{"border-r":[n]}],"border-color-b":[{"border-b":[n]}],"border-color-l":[{"border-l":[n]}],"divide-color":[{divide:[n]}],"outline-style":[{outline:["",...N()]}],"outline-offset":[{"outline-offset":[hr,Ze]}],"outline-w":[{outline:[hr,Vr]}],"outline-color":[{outline:[i]}],"ring-w":[{ring:B()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[i]}],"ring-opacity":[{"ring-opacity":[b]}],"ring-offset-w":[{"ring-offset":[hr,Vr]}],"ring-offset-color":[{"ring-offset":[i]}],shadow:[{shadow:["","inner","none",Hr,NI]}],"shadow-color":[{shadow:[Ao]}],opacity:[{opacity:[b]}],"mix-blend":[{"mix-blend":[...j(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":j()}],filter:[{filter:["","none"]}],blur:[{blur:[t]}],brightness:[{brightness:[r]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Hr,Ze]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[u]}],saturate:[{saturate:[w]}],sepia:[{sepia:[M]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[t]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[u]}],"backdrop-opacity":[{"backdrop-opacity":[b]}],"backdrop-saturate":[{"backdrop-saturate":[w]}],"backdrop-sepia":[{"backdrop-sepia":[M]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Ze]}],duration:[{duration:X()}],ease:[{ease:["linear","in","out","in-out",Ze]}],delay:[{delay:X()}],animate:[{animate:["none","spin","ping","pulse","bounce",Ze]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[_]}],"scale-x":[{"scale-x":[_]}],"scale-y":[{"scale-y":[_]}],rotate:[{rotate:[To,Ze]}],"translate-x":[{"translate-x":[x]}],"translate-y":[{"translate-y":[x]}],"skew-x":[{"skew-x":[S]}],"skew-y":[{"skew-y":[S]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Ze]}],accent:[{accent:["auto",i]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ze]}],"caret-color":[{caret:[i]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":R()}],"scroll-mx":[{"scroll-mx":R()}],"scroll-my":[{"scroll-my":R()}],"scroll-ms":[{"scroll-ms":R()}],"scroll-me":[{"scroll-me":R()}],"scroll-mt":[{"scroll-mt":R()}],"scroll-mr":[{"scroll-mr":R()}],"scroll-mb":[{"scroll-mb":R()}],"scroll-ml":[{"scroll-ml":R()}],"scroll-p":[{"scroll-p":R()}],"scroll-px":[{"scroll-px":R()}],"scroll-py":[{"scroll-py":R()}],"scroll-ps":[{"scroll-ps":R()}],"scroll-pe":[{"scroll-pe":R()}],"scroll-pt":[{"scroll-pt":R()}],"scroll-pr":[{"scroll-pr":R()}],"scroll-pb":[{"scroll-pb":R()}],"scroll-pl":[{"scroll-pl":R()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ze]}],fill:[{fill:[i,"none"]}],"stroke-w":[{stroke:[hr,Vr,ll]}],stroke:[{stroke:[i,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}const gi=MI(HI),UI="p-5 border border-gray-200 dark:border-gray-700 dark:bg-gray-900";function jI(i){const e=ke(()=>i.value.parentElement.parentElement.dataset.accordionId),t=ke(()=>i.value.parentElement.dataset.panelId),{accordionsStates:r}=Na(),n=ke(()=>r[e.value]),s=ke(()=>r[e.value].panels[t.value]),o=ke(()=>Object.keys(n.value.panels).length),a=ke(()=>s.value.order===o.value-1);return{contentClasses:ke(()=>gi(UI,!s.value.isVisible&&"hidden",(!a.value||n.value.flush)&&"border-b-0",a.value&&"border-t-0",n.value.flush&&"border-x-0"))}}const WI=ht({__name:"FwbAccordionContent",setup(i){const e=Qt(!1),t=Qt();let r;return uo(()=>{r=jI(t).contentClasses,e.value=!0}),(n,s)=>(P(),z("div",{ref_key:"content",ref:t},[e.value?(P(),z("div",{key:0,class:Se(Ee(r))},[Xe(n.$slots,"default")],2)):Le("",!0)],512))}}),GI="flex items-center p-5 w-full font-medium text-left border border-gray-200 dark:border-gray-700",qI="hover:bg-gray-100 dark:hover:bg-gray-800 focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-800",YI="w-6 h-6 shrink-0";function XI(i){const e=ke(()=>i.value.parentElement.parentElement.dataset.accordionId),t=ke(()=>i.value.parentElement.dataset.panelId),{accordionsStates:r}=Na(),n=ke(()=>r[e.value]),s=ke(()=>n.value.panels[t.value]),o=ke(()=>Object.keys(n.value.panels).length),a=ke(()=>s.value.order===0),l=ke(()=>s.value.order===o.value-1),c=ke(()=>gi(GI,s.value.isVisible?"text-gray-900 dark:text-white":"text-gray-500 dark:text-gray-400",s.value.isVisible&&!n.value.flush&&"bg-gray-100 dark:bg-gray-800",a.value&&!n.value.flush&&"rounded-t-xl",a.value&&n.value.flush&&"border-t-0",n.value.flush?"border-x-0":qI,!l.value&&"border-b-0")),d=ke(()=>gi(YI,s.value.isVisible&&"rotate-180"));return{headerClasses:c,arrowClasses:d}}const KI={class:"w-full"},JI=v("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"},null,-1),ZI=[JI],QI=ht({__name:"FwbAccordionHeader",setup(i){const e=Qt(!1),t=Qt(),r=ke(()=>t.value.parentElement.parentElement.dataset.accordionId),n=ke(()=>t.value.parentElement.dataset.panelId),{accordionsStates:s}=Na(),o=ke(()=>s[r.value]),a=ke(()=>o.value.panels[n.value]);let l,c;function d(){const p=a.value.isVisible;for(const g in o.value.panels){const f=o.value.panels[g];f.id!==n.value?f.isVisible=!1:f.isVisible=!p}}function u(){a.value.isVisible=!a.value.isVisible}function h(){if(o.value.alwaysOpen)return u();d()}return uo(()=>{const p=XI(t);l=p.headerClasses,c=p.arrowClasses,e.value=!0}),(p,g)=>(P(),z("div",{ref_key:"header",ref:t},[e.value?(P(),z("button",{key:0,type:"button",class:Se(Ee(l)),onClick:h},[v("span",KI,[Xe(p.$slots,"default")]),(P(),z("svg",{"data-accordion-icon":"",class:Se(Ee(c)),fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},ZI,2))],2)):Le("",!0)],512))}}),e5=["data-panel-id"],t5=ht({__name:"FwbAccordionPanel",setup(i){const{accordionsStates:e}=Na(),t=oy(),r=Qt(),n=ke(()=>r.value?r.value.parentElement.dataset.accordionId:null),s=ke(()=>e[n.value]);return uo(()=>{const o=Array.from(r.value.parentElement.children).indexOf(r.value);s.value.panels[t]={id:t,order:o,isVisible:(s.value.openFirstItem&&o===0)??!1}}),Ph(()=>{s.value.panels[t]&&delete s.value.panels[t]}),(o,a)=>(P(),z("div",{ref_key:"panel",ref:r,"data-panel-id":Ee(t)},[n.value?Xe(o.$slots,"default",{key:0}):Le("",!0)],8,e5))}}),Gm=i=>gi(i),od=(i,e)=>{const t=i.__vccOpts||i;for(const[r,n]of e)t[r]=n;return t};function i5(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var hy={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(i){(function(){var e={}.hasOwnProperty;function t(){for(var s="",o=0;o<arguments.length;o++){var a=arguments[o];a&&(s=n(s,r(a)))}return s}function r(s){if(typeof s=="string"||typeof s=="number")return s;if(typeof s!="object")return"";if(Array.isArray(s))return t.apply(null,s);if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]"))return s.toString();var o="";for(var a in s)e.call(s,a)&&s[a]&&(o=n(o,a));return o}function n(s,o){return o?s?s+" "+o:s+o:s}i.exports?(t.default=t,i.exports=t):window.classNames=t})()})(hy);var r5=hy.exports;const fo=i5(r5),n5={0:"w-0 h-0",.5:"w-0.5 h-0.5",1:"w-1 h-1",1.5:"w-1.5 h-1.5",10:"w-10 h-10",11:"w-11 h-11",12:"w-12 h-12",2:"w-2 h-2",2.5:"w-2.5 h-2.5",3:"w-3 h-3",4:"w-4 h-4",5:"w-5 h-5",6:"w-6 h-6",7:"w-7 h-7",8:"w-8 h-8",9:"w-9 h-9"},s5={blue:"fill-blue-600",gray:"fill-gray-600 dark:fill-gray-300",green:"fill-green-500",pink:"fill-pink-600",purple:"fill-purple-600",red:"fill-red-600",white:"fill-white",yellow:"fill-yellow-400"};function o5(i){const e=ke(()=>n5[i.size.value]),t=ke(()=>s5[i.color.value]),r=ke(()=>"text-gray-200 dark:text-gray-600"),n=ke(()=>"animate-spin");return{spinnerClasses:ke(()=>fo(n.value,r.value,t.value,e.value))}}const a5=v("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"currentColor"},null,-1),l5=v("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentFill"},null,-1),c5=[a5,l5],cl=ht({__name:"FwbSpinner",props:{color:{default:"blue"},size:{default:"4"}},setup(i){const e=i,{spinnerClasses:t}=o5(yn(e));return(r,n)=>(P(),z("svg",{class:Se(Ee(t)),fill:"none",role:"status",viewBox:"0 0 100 101",xmlns:"http://www.w3.org/2000/svg"},c5,2))}}),qm={default:{default:"text-white bg-blue-700 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg dark:bg-blue-600 focus:outline-none dark:focus:ring-blue-800",blue:"text-white bg-blue-700 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg dark:bg-blue-600 focus:outline-none dark:focus:ring-blue-800",alternative:"font-medium text-gray-900 focus:outline-none bg-white rounded-lg border border-gray-200 focus:z-10 focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600",dark:"text-white bg-gray-800 focus:outline-none focus:ring-4 focus:ring-gray-300 font-medium rounded-lg dark:bg-gray-800 dark:focus:ring-gray-700 dark:border-gray-700",light:"text-gray-900 bg-white border border-gray-300 focus:outline-none focus:ring-4 focus:ring-gray-200 font-medium rounded-lg dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:focus:ring-gray-700",green:"focus:outline-none text-white bg-green-700 focus:ring-4 focus:ring-green-300 font-medium rounded-lg dark:bg-green-600 dark:focus:ring-green-800",red:"focus:outline-none text-white bg-red-700 focus:ring-4 focus:ring-red-300 font-medium rounded-lg dark:bg-red-600 dark:focus:ring-red-900",yellow:"focus:outline-none text-white bg-yellow-400 focus:ring-4 focus:ring-yellow-300 font-medium rounded-lg dark:focus:ring-yellow-900",purple:"focus:outline-none text-white bg-purple-700 focus:ring-4 focus:ring-purple-300 font-medium rounded-lg dark:bg-purple-600 dark:focus:ring-purple-900",pink:"focus:outline-none text-white bg-pink-700 focus:ring-4 focus:ring-pink-300 font-medium rounded-lg dark:bg-pink-600 dark:focus:ring-pink-900"},hover:{default:"hover:bg-blue-800 dark:hover:bg-blue-700",blue:"hover:bg-blue-800 dark:hover:bg-blue-700",alternative:"hover:bg-gray-100 hover:text-blue-700 dark:hover:text-white dark:hover:bg-gray-700",dark:"hover:bg-gray-900 dark:hover:bg-gray-700",light:"hover:bg-gray-100 dark:hover:border-gray-600",green:"hover:bg-green-800 dark:hover:bg-green-700",red:"hover:bg-red-800 dark:hover:bg-red-700",yellow:"hover:bg-yellow-500",purple:"hover:bg-purple-800 dark:hover:bg-purple-700",pink:"hover:bg-pink-800 dark:hover:bg-pink-700"}},Ym={default:{dark:"text-gray-900 border border-gray-800 focus:ring-4 focus:outline-none focus:ring-gray-300 font-medium rounded-lg text-sm text-center dark:border-gray-600 dark:text-gray-400 dark:focus:ring-gray-800",default:"text-blue-700 border border-blue-700 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm text-center dark:border-blue-500 dark:text-blue-500 dark:focus:ring-blue-800",blue:"text-blue-700 border border-blue-700 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm text-center dark:border-blue-500 dark:text-blue-500 dark:focus:ring-blue-800",green:"text-green-700 border border-green-700 focus:ring-4 focus:outline-none focus:ring-green-300 font-medium rounded-lg text-sm text-center dark:border-green-500 dark:text-green-500 dark:focus:ring-green-800",purple:"text-purple-700 border border-purple-700 focus:ring-4 focus:outline-none focus:ring-purple-300 font-medium rounded-lg text-sm text-center dark:border-purple-400 dark:text-purple-400 dark:focus:ring-purple-900",pink:"text-pink-700 border border-pink-700 focus:ring-4 focus:outline-none focus:ring-pink-300 font-medium rounded-lg text-sm text-center dark:border-pink-400 dark:text-pink-400 dark:focus:ring-pink-900",red:"text-red-700 border border-red-700 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm text-center dark:border-red-500 dark:text-red-500 dark:focus:ring-red-900",yellow:"text-yellow-400 border border-yellow-400 focus:ring-4 focus:outline-none focus:ring-yellow-300 font-medium rounded-lg text-sm text-center dark:border-yellow-300 dark:text-yellow-300 dark:focus:ring-yellow-900"},hover:{dark:"hover:text-white hover:bg-gray-900 dark:hover:text-white dark:hover:bg-gray-600",default:"hover:text-white hover:bg-blue-800 dark:hover:text-white dark:hover:bg-blue-600",blue:"hover:text-white hover:bg-blue-800 dark:hover:text-white dark:hover:bg-blue-600",green:"hover:text-white hover:bg-green-800 dark:hover:text-white dark:hover:bg-green-600",purple:"hover:text-white hover:bg-purple-800 dark:hover:text-white dark:hover:bg-purple-500",pink:"hover:text-white hover:bg-pink-800 dark:hover:text-white dark:hover:bg-pink-500",red:"hover:text-white hover:bg-red-800 dark:hover:text-white dark:hover:bg-red-600",yellow:"hover:text-white hover:bg-yellow-500 dark:hover:text-white dark:hover:bg-yellow-400"}},Xm={hover:{"cyan-blue":"hover:bg-gradient-to-bl","green-blue":"hover:bg-gradient-to-bl","pink-orange":"hover:bg-gradient-to-bl","purple-blue":"hover:bg-gradient-to-bl","purple-pink":"hover:bg-gradient-to-l","red-yellow":"hover:bg-gradient-to-bl","teal-lime":"hover:bg-gradient-to-l hover:from-teal-200 hover:to-lime-200",blue:"hover:bg-gradient-to-br",cyan:"hover:bg-gradient-to-br",green:"hover:bg-gradient-to-br",lime:"hover:bg-gradient-to-br",pink:"hover:bg-gradient-to-br",purple:"hover:bg-gradient-to-br",red:"hover:bg-gradient-to-br",teal:"hover:bg-gradient-to-br"},default:{"cyan-blue":"text-white bg-gradient-to-r from-cyan-500 to-blue-500 focus:ring-4 focus:outline-none focus:ring-cyan-300 dark:focus:ring-cyan-800 font-medium rounded-lg","green-blue":"text-white bg-gradient-to-br from-green-400 to-blue-600 focus:ring-4 focus:outline-none focus:ring-green-200 dark:focus:ring-green-800 font-medium rounded-lg","pink-orange":"text-white bg-gradient-to-br from-pink-500 to-orange-400 focus:ring-4 focus:outline-none focus:ring-pink-200 dark:focus:ring-pink-800 font-medium rounded-lg","purple-blue":"text-white bg-gradient-to-br from-purple-600 to-blue-500 focus:ring-4 focus:outline-none focus:ring-blue-300 dark:focus:ring-blue-800 font-medium rounded-lg","purple-pink":"text-white bg-gradient-to-r from-purple-500 to-pink-500 focus:ring-4 focus:outline-none focus:ring-purple-200 dark:focus:ring-purple-800 font-medium rounded-lg","red-yellow":"text-gray-900 bg-gradient-to-r from-red-200 via-red-300 to-yellow-200 focus:ring-4 focus:outline-none focus:ring-red-100 dark:focus:ring-red-400 font-medium rounded-lg","teal-lime":"text-gray-900 bg-gradient-to-r from-teal-200 to-lime-200 focus:ring-4 focus:outline-none focus:ring-lime-200 dark:focus:ring-teal-700 font-medium rounded-lg",blue:"text-white bg-gradient-to-r from-blue-500 via-blue-600 to-blue-700 focus:ring-4 focus:outline-none focus:ring-blue-300 dark:focus:ring-blue-800 rounded-lg",cyan:"text-white bg-gradient-to-r from-cyan-500 via-cyan-600 to-cyan-700 focus:ring-4 focus:outline-none focus:ring-cyan-300 dark:focus:ring-cyan-800 rounded-lg",green:"text-white bg-gradient-to-r from-green-500 via-green-600 to-green-700 focus:ring-4 focus:outline-none focus:ring-green-300 dark:focus:ring-green-800 rounded-lg",lime:"text-gray-900 bg-gradient-to-r from-lime-500 via-lime-600 to-lime-700 focus:ring-4 focus:outline-none focus:ring-lime-300 dark:focus:ring-lime-800 rounded-lg",pink:"text-white bg-gradient-to-r from-pink-500 via-pink-600 to-pink-700 focus:ring-4 focus:outline-none focus:ring-pink-300 dark:focus:ring-pink-800 rounded-lg",purple:"text-white bg-gradient-to-r from-purple-500 via-purple-600 to-purple-700 focus:ring-4 focus:outline-none focus:ring-purple-300 dark:focus:ring-purple-800 rounded-lg",red:"text-white bg-gradient-to-r from-red-500 via-red-600 to-red-700 focus:ring-4 focus:outline-none focus:ring-red-300 dark:focus:ring-red-800 rounded-lg",teal:"text-white bg-gradient-to-r from-teal-500 via-teal-600 to-teal-700 focus:ring-4 focus:outline-none focus:ring-teal-300 dark:focus:ring-teal-800 rounded-lg"}},Km={default:{"cyan-blue":"relative inline-flex items-center justify-center overflow-hidden font-medium text-gray-900 rounded-lg group bg-gradient-to-br from-cyan-500 to-blue-500 dark:text-white focus:ring-4 focus:outline-none focus:ring-cyan-200 dark:focus:ring-cyan-800","green-blue":"relative inline-flex items-center justify-center overflow-hidden font-medium text-gray-900 rounded-lg group bg-gradient-to-br from-green-400 to-blue-600 dark:text-white focus:ring-4 focus:outline-none focus:ring-green-200 dark:focus:ring-green-800","pink-orange":"relative inline-flex items-center justify-center overflow-hidden font-medium text-gray-900 rounded-lg group bg-gradient-to-br from-pink-500 to-orange-400 dark:text-white focus:ring-4 focus:outline-none focus:ring-pink-200 dark:focus:ring-pink-800","purple-blue":"relative inline-flex items-center justify-center overflow-hidden font-medium text-gray-900 rounded-lg group bg-gradient-to-br from-purple-600 to-blue-500 dark:text-white focus:ring-4 focus:outline-none focus:ring-blue-300 dark:focus:ring-blue-800","purple-pink":"relative inline-flex items-center justify-center overflow-hidden font-medium text-gray-900 rounded-lg group bg-gradient-to-br from-purple-500 to-pink-500 dark:text-white focus:ring-4 focus:outline-none focus:ring-purple-200 dark:focus:ring-purple-800","red-yellow":"relative inline-flex items-center justify-center overflow-hidden font-medium text-gray-900 rounded-lg group bg-gradient-to-br from-red-200 via-red-300 to-yellow-200 dark:text-white focus:ring-4 focus:outline-none focus:ring-red-100 dark:focus:ring-red-400","teal-lime":"relative inline-flex items-center justify-center overflow-hidden font-medium text-gray-900 rounded-lg group bg-gradient-to-br from-teal-300 to-lime-300 dark:text-white focus:ring-4 focus:outline-none focus:ring-lime-200 dark:focus:ring-lime-800"},hover:{"cyan-blue":"group-hover:from-cyan-500 group-hover:to-blue-500 hover:text-white","green-blue":"group-hover:from-green-400 group-hover:to-blue-600 hover:text-white","pink-orange":"group-hover:from-pink-500 group-hover:to-orange-400 hover:text-white","purple-blue":"group-hover:from-purple-600 group-hover:to-blue-500 hover:text-white","purple-pink":"group-hover:from-purple-500 group-hover:to-pink-500 hover:text-white","red-yellow":"group-hover:from-red-200 group-hover:via-red-300 group-hover:to-yellow-200 dark:hover:text-gray-900","teal-lime":"group-hover:from-teal-300 group-hover:to-lime-300 dark:hover:text-gray-900"}},d5={xs:"text-xs px-2 py-1",sm:"text-sm px-3 py-1.5",md:"text-sm px-4 py-2",lg:"text-base px-5 py-2.5",xl:"text-base px-6 py-3"},u5={xs:"text-xs p-1",sm:"text-sm p-1.5",md:"text-sm p-2",lg:"text-base p-2.5",xl:"text-base p-3"},Jm={blue:"shadow-lg shadow-blue-500/50 dark:shadow-lg dark:shadow-blue-800/80",cyan:"shadow-lg shadow-cyan-500/50 dark:shadow-lg dark:shadow-cyan-800/80",green:"shadow-lg shadow-green-500/50 dark:shadow-lg dark:shadow-green-800/80",lime:"shadow-lg shadow-lime-500/50 dark:shadow-lg dark:shadow-lime-800/80",pink:"shadow-lg shadow-pink-500/50 dark:shadow-lg dark:shadow-pink-800/80",purple:"shadow-lg shadow-purple-500/50 dark:shadow-lg dark:shadow-purple-800/80",red:"shadow-lg shadow-red-500/50 dark:shadow-lg dark:shadow-red-800/80",teal:"shadow-lg shadow-teal-500/50 dark:shadow-lg dark:shadow-teal-800/80"},Ud=["blue","green","cyan","teal","lime","red","pink","purple"],h5=["alternative","light"];function f5(i){const e=gv(),t=ke(()=>i.square.value?u5[i.size.value]:d5[i.size.value]),r=ke(()=>{const s=!!i.gradient.value,o=!!i.color.value,a=i.outline.value;let l="",c="";if(s&&a)Ud.includes(i.gradient.value)?console.warn(`cannot use outline prop with "${i.gradient.value}" gradient`):(c=Km.default[i.gradient.value],i.disabled.value||(l=Km.hover[i.gradient.value]));else if(s)c=Xm.default[i.gradient.value],i.disabled.value||(l=Xm.hover[i.gradient.value]);else if(o&&a)if(h5.includes(i.color.value))console.warn(`cannot use outline prop with "${i.color.value}" color`);else{const u=i.color.value;c=Ym.default[u],i.disabled.value||(l=Ym.hover[u])}else{const u=i.color.value;c=qm.default[u],i.disabled.value||(l=qm.hover[u])}let d="";return i.shadow.value===""?i.gradient.value&&Ud.includes(i.gradient.value)&&(d=Jm[i.gradient.value]):typeof i.shadow.value=="string"&&Ud.includes(i.shadow.value)&&(d=Jm[i.shadow.value]),[c,l,d,i.pill.value&&"!rounded-full",i.disabled.value&&"cursor-not-allowed opacity-50",s&&a?"p-0.5":t.value,(e.prefix||e.suffix||i.loading.value)&&"inline-flex items-center",i.class.value].filter(u=>u).join(" ")}),n=ke(()=>i.gradient.value&&i.outline.value?["relative bg-white dark:bg-gray-900 rounded-md inline-flex items-center",t.value,i.disabled.value?"":"group-hover:bg-opacity-0 transition-all ease-in duration-75"].filter(s=>s).join(" "):"");return{wrapperClasses:r.value,spanClasses:n.value}}function p5(i){const e={xs:"2.5",sm:"3",md:"4",lg:"5",xl:"6"},t=ke(()=>e[i.size.value]);return{color:ke(()=>i.outline.value?i.gradient.value?i.gradient.value.includes("purple")?"purple":i.gradient.value.includes("blue")?"blue":i.gradient.value.includes("pink")?"pink":i.gradient.value.includes("red")?"red":"white":["alternative","dark","light"].includes(i.color.value)?"white":i.color.value==="default"?"blue":i.color.value:"white"),size:t}}const m5={key:0,class:"mr-2"},g5={key:0,class:"mr-2"},v5={key:1,class:"ml-2"},b5={key:1,class:"ml-2"},fy=ht({__name:"FwbButton",props:{class:{default:""},color:{default:"default"},gradient:{default:null},size:{default:"md"},shadow:{default:null},pill:{type:Boolean,default:!1},square:{type:Boolean,default:!1},outline:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},loadingPosition:{default:"prefix"},disabled:{type:Boolean,default:!1},href:{default:""},tag:{default:"a"}},setup(i){const e=i,t=ke(()=>f5(yn(e))),r=ke(()=>Gm(t.value.wrapperClasses)),n=ke(()=>Gm(t.value.spanClasses)),s=ke(()=>e.outline&&e.gradient),o=ke(()=>e.loading&&e.loadingPosition==="prefix"),a=ke(()=>e.loading&&e.loadingPosition==="suffix"),{color:l,size:c}=p5(yn(e)),d=e.tag!=="a"?st(e.tag):"a",u=e.href?d:"button",h=e.tag==="router-link"||e.tag==="nuxt-link"?"to":"href";return(p,g)=>(P(),Ge(hv(Ee(u)),yh({class:r.value,[Ee(h)||""]:p.href,disabled:Ee(u)==="button"&&p.disabled}),{default:K(()=>[!s.value&&(p.$slots.prefix||o.value)?(P(),z("div",m5,[o.value?(P(),Ge(cl,{key:0,color:Ee(l),size:Ee(c)},null,8,["color","size"])):Xe(p.$slots,"prefix",{key:1})])):Le("",!0),v("span",{class:Se(n.value)},[s.value&&(p.$slots.prefix||o.value)?(P(),z("span",g5,[o.value?(P(),Ge(cl,{key:0,color:Ee(l),size:Ee(c)},null,8,["color","size"])):Xe(p.$slots,"prefix",{key:1})])):Le("",!0),Xe(p.$slots,"default"),s.value&&(p.$slots.suffix||a.value)?(P(),z("span",v5,[a.value?(P(),Ge(cl,{key:0,color:Ee(l),size:Ee(c)},null,8,["color","size"])):Xe(p.$slots,"suffix",{key:1})])):Le("",!0)],2),!s.value&&(p.$slots.suffix||a.value)?(P(),z("div",b5,[a.value?(P(),Ge(cl,{key:0,color:Ee(l),size:Ee(c)},null,8,["color","size"])):Xe(p.$slots,"suffix",{key:1})])):Le("",!0)]),_:3},16,["class","disabled"]))}});function y5(i){return N0()?($_(i),!0):!1}function py(i){return typeof i=="function"?i():Ee(i)}const my=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const _5=i=>typeof i<"u",w5=Object.prototype.toString,x5=i=>w5.call(i)==="[object Object]",Jl=()=>{},S5=M5();function M5(){var i,e;return my&&((i=window==null?void 0:window.navigator)==null?void 0:i.userAgent)&&(/iP(?:ad|hone|od)/.test(window.navigator.userAgent)||((e=window==null?void 0:window.navigator)==null?void 0:e.maxTouchPoints)>2&&/iPad|Macintosh/.test(window==null?void 0:window.navigator.userAgent))}function Vo(i){var e;const t=py(i);return(e=t==null?void 0:t.$el)!=null?e:t}const gy=my?window:void 0;function jd(...i){let e,t,r,n;if(typeof i[0]=="string"||Array.isArray(i[0])?([t,r,n]=i,e=gy):[e,t,r,n]=i,!e)return Jl;Array.isArray(t)||(t=[t]),Array.isArray(r)||(r=[r]);const s=[],o=()=>{s.forEach(d=>d()),s.length=0},a=(d,u,h,p)=>(d.addEventListener(u,h,p),()=>d.removeEventListener(u,h,p)),l=Ar(()=>[Vo(e),py(n)],([d,u])=>{if(o(),!d)return;const h=x5(u)?{...u}:u;s.push(...t.flatMap(p=>r.map(g=>a(d,p,g,h))))},{immediate:!0,flush:"post"}),c=()=>{l(),o()};return y5(c),c}let Zm=!1;function E5(i,e,t={}){const{window:r=gy,ignore:n=[],capture:s=!0,detectIframe:o=!1}=t;if(!r)return Jl;S5&&!Zm&&(Zm=!0,Array.from(r.document.body.children).forEach(d=>d.addEventListener("click",Jl)),r.document.documentElement.addEventListener("click",Jl));let a=!0;const l=d=>n.some(u=>{if(typeof u=="string")return Array.from(r.document.querySelectorAll(u)).some(h=>h===d.target||d.composedPath().includes(h));{const h=Vo(u);return h&&(d.target===h||d.composedPath().includes(h))}}),c=[jd(r,"click",d=>{const u=Vo(i);if(!(!u||u===d.target||d.composedPath().includes(u))){if(d.detail===0&&(a=!l(d)),!a){a=!0;return}e(d)}},{passive:!0,capture:s}),jd(r,"pointerdown",d=>{const u=Vo(i);a=!l(d)&&!!(u&&!d.composedPath().includes(u))},{passive:!0}),o&&jd(r,"blur",d=>{setTimeout(()=>{var u;const h=Vo(i);((u=r.document.activeElement)==null?void 0:u.tagName)==="IFRAME"&&!(h!=null&&h.contains(r.document.activeElement))&&e(d)},0)})].filter(Boolean);return()=>c.forEach(d=>d())}function k5(i){return JSON.parse(JSON.stringify(i))}function vy(i,e,t,r={}){var n,s,o;const{clone:a=!1,passive:l=!1,eventName:c,deep:d=!1,defaultValue:u,shouldEmit:h}=r,p=zh(),g=t||(p==null?void 0:p.emit)||((n=p==null?void 0:p.$emit)==null?void 0:n.bind(p))||((o=(s=p==null?void 0:p.proxy)==null?void 0:s.$emit)==null?void 0:o.bind(p==null?void 0:p.proxy));let f=c;f=f||`update:${e.toString()}`;const m=w=>a?typeof a=="function"?a(w):k5(w):w,b=()=>_5(i[e])?m(i[e]):u,y=w=>{h?h(w)&&g(f,w):g(f,w)};if(l){const w=b(),_=Qt(w);let M=!1;return Ar(()=>i[e],S=>{M||(M=!0,_.value=m(S),co(()=>M=!1))}),Ar(_,S=>{!M&&(S!==i[e]||d)&&y(S)},{deep:d}),_}else return ke({get(){return b()},set(w){y(w)}})}var C5=typeof global=="object"&&global&&global.Object===Object&&global,T5=typeof self=="object"&&self&&self.Object===Object&&self,Ef=C5||T5||Function("return this")(),Sn=Ef.Symbol,by=Object.prototype,A5=by.hasOwnProperty,L5=by.toString,Lo=Sn?Sn.toStringTag:void 0;function D5(i){var e=A5.call(i,Lo),t=i[Lo];try{i[Lo]=void 0;var r=!0}catch{}var n=L5.call(i);return r&&(e?i[Lo]=t:delete i[Lo]),n}var P5=Object.prototype,R5=P5.toString;function I5(i){return R5.call(i)}var O5="[object Null]",F5="[object Undefined]",Qm=Sn?Sn.toStringTag:void 0;function kf(i){return i==null?i===void 0?F5:O5:Qm&&Qm in Object(i)?D5(i):I5(i)}function Cf(i){return i!=null&&typeof i=="object"}var z5="[object Symbol]";function Tf(i){return typeof i=="symbol"||Cf(i)&&kf(i)==z5}function N5(i,e){for(var t=-1,r=i==null?0:i.length,n=Array(r);++t<r;)n[t]=e(i[t],t,i);return n}var $a=Array.isArray,$5=1/0,eg=Sn?Sn.prototype:void 0,tg=eg?eg.toString:void 0;function yy(i){if(typeof i=="string")return i;if($a(i))return N5(i,yy)+"";if(Tf(i))return tg?tg.call(i):"";var e=i+"";return e=="0"&&1/i==-$5?"-0":e}function Ic(i){var e=typeof i;return i!=null&&(e=="object"||e=="function")}function B5(i){return i}var V5="[object AsyncFunction]",H5="[object Function]",U5="[object GeneratorFunction]",j5="[object Proxy]";function W5(i){if(!Ic(i))return!1;var e=kf(i);return e==H5||e==U5||e==V5||e==j5}var Wd=Ef["__core-js_shared__"],ig=function(){var i=/[^.]+$/.exec(Wd&&Wd.keys&&Wd.keys.IE_PROTO||"");return i?"Symbol(src)_1."+i:""}();function G5(i){return!!ig&&ig in i}var q5=Function.prototype,Y5=q5.toString;function X5(i){if(i!=null){try{return Y5.call(i)}catch{}try{return i+""}catch{}}return""}var K5=/[\\^$.*+?()[\]{}|]/g,J5=/^\[object .+?Constructor\]$/,Z5=Function.prototype,Q5=Object.prototype,e4=Z5.toString,t4=Q5.hasOwnProperty,i4=RegExp("^"+e4.call(t4).replace(K5,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function r4(i){if(!Ic(i)||G5(i))return!1;var e=W5(i)?i4:J5;return e.test(X5(i))}function n4(i,e){return i==null?void 0:i[e]}function Af(i,e){var t=n4(i,e);return r4(t)?t:void 0}function s4(i,e,t){switch(t.length){case 0:return i.call(e);case 1:return i.call(e,t[0]);case 2:return i.call(e,t[0],t[1]);case 3:return i.call(e,t[0],t[1],t[2])}return i.apply(e,t)}var o4=800,a4=16,l4=Date.now;function c4(i){var e=0,t=0;return function(){var r=l4(),n=a4-(r-t);if(t=r,n>0){if(++e>=o4)return arguments[0]}else e=0;return i.apply(void 0,arguments)}}function d4(i){return function(){return i}}var Oc=function(){try{var i=Af(Object,"defineProperty");return i({},"",{}),i}catch{}}(),u4=Oc?function(i,e){return Oc(i,"toString",{configurable:!0,enumerable:!1,value:d4(e),writable:!0})}:B5,h4=c4(u4),f4=9007199254740991,p4=/^(?:0|[1-9]\d*)$/;function _y(i,e){var t=typeof i;return e=e??f4,!!e&&(t=="number"||t!="symbol"&&p4.test(i))&&i>-1&&i%1==0&&i<e}function m4(i,e,t){e=="__proto__"&&Oc?Oc(i,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):i[e]=t}function wy(i,e){return i===e||i!==i&&e!==e}var g4=Object.prototype,v4=g4.hasOwnProperty;function b4(i,e,t){var r=i[e];(!(v4.call(i,e)&&wy(r,t))||t===void 0&&!(e in i))&&m4(i,e,t)}var rg=Math.max;function y4(i,e,t){return e=rg(e===void 0?i.length-1:e,0),function(){for(var r=arguments,n=-1,s=rg(r.length-e,0),o=Array(s);++n<s;)o[n]=r[e+n];n=-1;for(var a=Array(e+1);++n<e;)a[n]=r[n];return a[e]=t(o),s4(i,this,a)}}var _4=9007199254740991;function w4(i){return typeof i=="number"&&i>-1&&i%1==0&&i<=_4}var x4="[object Arguments]";function ng(i){return Cf(i)&&kf(i)==x4}var xy=Object.prototype,S4=xy.hasOwnProperty,M4=xy.propertyIsEnumerable,Sy=ng(function(){return arguments}())?ng:function(i){return Cf(i)&&S4.call(i,"callee")&&!M4.call(i,"callee")},E4=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,k4=/^\w*$/;function C4(i,e){if($a(i))return!1;var t=typeof i;return t=="number"||t=="symbol"||t=="boolean"||i==null||Tf(i)?!0:k4.test(i)||!E4.test(i)||e!=null&&i in Object(e)}var ka=Af(Object,"create");function T4(){this.__data__=ka?ka(null):{},this.size=0}function A4(i){var e=this.has(i)&&delete this.__data__[i];return this.size-=e?1:0,e}var L4="__lodash_hash_undefined__",D4=Object.prototype,P4=D4.hasOwnProperty;function R4(i){var e=this.__data__;if(ka){var t=e[i];return t===L4?void 0:t}return P4.call(e,i)?e[i]:void 0}var I4=Object.prototype,O4=I4.hasOwnProperty;function F4(i){var e=this.__data__;return ka?e[i]!==void 0:O4.call(e,i)}var z4="__lodash_hash_undefined__";function N4(i,e){var t=this.__data__;return this.size+=this.has(i)?0:1,t[i]=ka&&e===void 0?z4:e,this}function cs(i){var e=-1,t=i==null?0:i.length;for(this.clear();++e<t;){var r=i[e];this.set(r[0],r[1])}}cs.prototype.clear=T4;cs.prototype.delete=A4;cs.prototype.get=R4;cs.prototype.has=F4;cs.prototype.set=N4;function $4(){this.__data__=[],this.size=0}function ad(i,e){for(var t=i.length;t--;)if(wy(i[t][0],e))return t;return-1}var B4=Array.prototype,V4=B4.splice;function H4(i){var e=this.__data__,t=ad(e,i);if(t<0)return!1;var r=e.length-1;return t==r?e.pop():V4.call(e,t,1),--this.size,!0}function U4(i){var e=this.__data__,t=ad(e,i);return t<0?void 0:e[t][1]}function j4(i){return ad(this.__data__,i)>-1}function W4(i,e){var t=this.__data__,r=ad(t,i);return r<0?(++this.size,t.push([i,e])):t[r][1]=e,this}function po(i){var e=-1,t=i==null?0:i.length;for(this.clear();++e<t;){var r=i[e];this.set(r[0],r[1])}}po.prototype.clear=$4;po.prototype.delete=H4;po.prototype.get=U4;po.prototype.has=j4;po.prototype.set=W4;var G4=Af(Ef,"Map");function q4(){this.size=0,this.__data__={hash:new cs,map:new(G4||po),string:new cs}}function Y4(i){var e=typeof i;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?i!=="__proto__":i===null}function ld(i,e){var t=i.__data__;return Y4(e)?t[typeof e=="string"?"string":"hash"]:t.map}function X4(i){var e=ld(this,i).delete(i);return this.size-=e?1:0,e}function K4(i){return ld(this,i).get(i)}function J4(i){return ld(this,i).has(i)}function Z4(i,e){var t=ld(this,i),r=t.size;return t.set(i,e),this.size+=t.size==r?0:1,this}function gs(i){var e=-1,t=i==null?0:i.length;for(this.clear();++e<t;){var r=i[e];this.set(r[0],r[1])}}gs.prototype.clear=q4;gs.prototype.delete=X4;gs.prototype.get=K4;gs.prototype.has=J4;gs.prototype.set=Z4;var Q4="Expected a function";function Lf(i,e){if(typeof i!="function"||e!=null&&typeof e!="function")throw new TypeError(Q4);var t=function(){var r=arguments,n=e?e.apply(this,r):r[0],s=t.cache;if(s.has(n))return s.get(n);var o=i.apply(this,r);return t.cache=s.set(n,o)||s,o};return t.cache=new(Lf.Cache||gs),t}Lf.Cache=gs;var e6=500;function t6(i){var e=Lf(i,function(r){return t.size===e6&&t.clear(),r}),t=e.cache;return e}var i6=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r6=/\\(\\)?/g,n6=t6(function(i){var e=[];return i.charCodeAt(0)===46&&e.push(""),i.replace(i6,function(t,r,n,s){e.push(n?s.replace(r6,"$1"):r||t)}),e});function s6(i){return i==null?"":yy(i)}function cd(i,e){return $a(i)?i:C4(i,e)?[i]:n6(s6(i))}var o6=1/0;function Df(i){if(typeof i=="string"||Tf(i))return i;var e=i+"";return e=="0"&&1/i==-o6?"-0":e}function a6(i,e){e=cd(e,i);for(var t=0,r=e.length;i!=null&&t<r;)i=i[Df(e[t++])];return t&&t==r?i:void 0}function l6(i,e){for(var t=-1,r=e.length,n=i.length;++t<r;)i[n+t]=e[t];return i}var sg=Sn?Sn.isConcatSpreadable:void 0;function c6(i){return $a(i)||Sy(i)||!!(sg&&i&&i[sg])}function d6(i,e,t,r,n){var s=-1,o=i.length;for(t||(t=c6),n||(n=[]);++s<o;){var a=i[s];t(a)?l6(n,a):n[n.length]=a}return n}function u6(i){var e=i==null?0:i.length;return e?d6(i):[]}function h6(i){return h4(y4(i,void 0,u6),i+"")}function f6(i,e){return i!=null&&e in Object(i)}function p6(i,e,t){e=cd(e,i);for(var r=-1,n=e.length,s=!1;++r<n;){var o=Df(e[r]);if(!(s=i!=null&&t(i,o)))break;i=i[o]}return s||++r!=n?s:(n=i==null?0:i.length,!!n&&w4(n)&&_y(o,n)&&($a(i)||Sy(i)))}function m6(i,e){return i!=null&&p6(i,e,f6)}function g6(i,e,t,r){if(!Ic(i))return i;e=cd(e,i);for(var n=-1,s=e.length,o=s-1,a=i;a!=null&&++n<s;){var l=Df(e[n]),c=t;if(l==="__proto__"||l==="constructor"||l==="prototype")return i;if(n!=o){var d=a[l];c=void 0,c===void 0&&(c=Ic(d)?d:_y(e[n+1])?[]:{})}b4(a,l,c),a=a[l]}return i}function v6(i,e,t){for(var r=-1,n=e.length,s={};++r<n;){var o=e[r],a=a6(i,o);t(a,o)&&g6(s,cd(o,i),a)}return s}function b6(i,e){return v6(i,e,function(t,r){return m6(i,r)})}var y6=h6(function(i,e){return i==null?{}:b6(i,e)});function Fc(i,e=!0,t=[]){return i.forEach(r=>{if(r!==null){if(typeof r!="object"){(typeof r=="string"||typeof r=="number")&&t.push(he(String(r)));return}if(Array.isArray(r)){Fc(r,e,t);return}if(r.type===be){if(r.children===null)return;Array.isArray(r.children)&&Fc(r.children,e,t)}else r.type!==Zt&&t.push(r)}}),t}function _6(i,e="default",t=void 0){const r=i[e];if(!r)return console.warn("getFirstSlotVNode",`slot[${e}] is empty`),null;const n=Fc(r(t));return n.length===1?n[0]:(console.warn("getFirstSlotVNode",`slot[${e}] should have exactly one child`),null)}const w6={focus:["onFocus","onBlur"],click:["onClick"],hover:["onMouseenter","onMouseleave"]};function x6(i,e){Object.entries(w6).forEach(([,t])=>{t.forEach(r=>{i.props?i.props=Object.assign({},i.props):i.props={};const n=i.props[r],s=e[r];n?i.props[r]=(...o)=>{n(...o),s(...o)}:i.props[r]=s})})}const og=ht({name:"SlotListener",props:{trigger:{type:String,default:"click"}},emits:["click","focus","blur","mouseenter","mouseleave"],setup(i,{emit:e}){return{handleClick:t=>{e("click",t)},handleBlur:t=>{e("blur",t)},handleFocus:t=>{e("focus",t)},handleMouseLeave:t=>{e("mouseleave",t)},handleMouseEnter:t=>{e("mouseenter",t)}}},render(){const{$slots:i}=this,e={onClick:this.handleClick,onMouseenter:this.handleMouseEnter,onMouseleave:this.handleMouseLeave,onFocus:this.handleFocus,onBlur:this.handleBlur},t=_6(i,"default"),r=[e];return t!=null&&t.props&&r.push(y6(t.props,"onClick","onMouseenter","onMouseleave","onFocus","onBlur")),t&&x6(t,{onBlur:n=>{r.forEach(s=>{var o;(o=s==null?void 0:s.onBlur)==null||o.call(s,n)})},onFocus:n=>{r.forEach(s=>{var o;(o=s==null?void 0:s.onFocus)==null||o.call(s,n)})},onClick:n=>{r.forEach(s=>{var o;(o=s==null?void 0:s.onClick)==null||o.call(s,n)})},onMouseenter:n=>{r.forEach(s=>{var o;(o=s==null?void 0:s.onMouseenter)==null||o.call(s,n)})},onMouseleave:n=>{r.forEach(s=>{var o;(o=s==null?void 0:s.onMouseleave)==null||o.call(s,n)})}}),t}}),S6="absolute z-10 bg-white divide-y divide-gray-100 rounded shadow dark:bg-gray-700",dl=8,M6={horizontal:"left-0",vertical:"top-0",horizontal_reverse:"right-0",vertical_reverse:"bottom-0"},E6={bottom(i){return`bottom: -${i.height+dl}px;`},left(i){return`left: -${i.width+dl}px;`},right(i){return`right: -${i.width+dl}px;`},top(i){return`top: -${i.height+dl}px;`}};function k6(i){Ar(i.visible,n=>{n&&co(()=>t())});const e=Qt(""),t=()=>{var s;const n=(s=i.contentRef.value)==null?void 0:s.getBoundingClientRect();if(!n){e.value="";return}e.value=E6[i.placement.value](n)},r=new MutationObserver(()=>{t()});return Ar(i.contentRef,n=>{n?r.observe(n,{childList:!0,subtree:!0}):r.disconnect()}),{contentClasses:ke(()=>{let n=["top","bottom"].includes(i.placement.value)?"horizontal":"vertical";return i.alignToEnd.value&&(n=`${n}_reverse`),fo(S6,M6[n])}),contentStyles:e}}const C6=i=>(cv("data-v-2d4adfeb"),i=i(),dv(),i),T6={class:"inline-flex items-center"},A6=C6(()=>v("svg",{class:"w-4 h-4 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[v("path",{d:"M19 9l-7 7-7-7","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"})],-1)),L6=ht({__name:"FwbDropdown",props:{placement:{default:"bottom"},text:{default:""},transition:{default:""},closeInside:{type:Boolean,default:!1},alignToEnd:{type:Boolean,default:!1}},setup(i){const e=Qt(!1),t=()=>{n.closeInside&&(e.value=!1)},r=()=>e.value=!e.value,n=i,s={bottom:"to-bottom",left:"to-left",right:"to-right",top:"to-top"},o=ke(()=>n.transition===null?s[n.placement]:n.transition),a=Qt(),l=Qt(),{contentClasses:c,contentStyles:d}=k6({placement:ua(n,"placement"),alignToEnd:ua(n,"alignToEnd"),visible:e,contentRef:a});return E5(l,()=>{e.value&&(e.value=!1)}),(u,h)=>(P(),z("div",{ref_key:"wrapper",ref:l,class:"inline-flex relative"},[v("div",T6,[H(og,{onClick:r},{default:K(()=>[Xe(u.$slots,"trigger",{},()=>[H(fy,null,{suffix:K(()=>[A6]),default:K(()=>[he(U(u.text)+" ",1)]),_:1})],!0)]),_:3})]),H(Nh,{name:o.value},{default:K(()=>[e.value?(P(),z("div",{key:0,ref_key:"content",ref:a,class:Se([Ee(c)]),style:Ut(Ee(d))},[H(og,{onClick:t},{default:K(()=>[Xe(u.$slots,"default",{},void 0,!0)]),_:3})],6)):Le("",!0)]),_:3},8,["name"])],512))}}),D6=od(L6,[["__scopeId","data-v-2d4adfeb"]]);new Date().getFullYear();const P6="overflow-hidden w-48 text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white";function R6(){return{containerClasses:ke(()=>fo(P6))}}const I6=ht({__name:"FwbListGroup",setup(i){const{containerClasses:e}=R6();return(t,r)=>(P(),z("ul",{class:Se(Ee(e))},[Xe(t.$slots,"default")],2))}}),O6={border:i=>i.substring(0,i.lastIndexOf("-"))},F6=(i,e=O6)=>{const t=Object.keys(e).find(r=>i.includes(r));return t?e[t](i):i.substring(0,i.indexOf("-"))};function Ks(...i){return i.filter(e=>e).reduce((e,t)=>{const r=Array.isArray(t)?Array.from(t).map(c=>c.split(" ")).flat():t.split(" "),n=r.map(c=>F6(c)),s=n.filter(c=>!e.types.includes(c)),o=[...n.filter(c=>e.types.includes(c)),...s],a=[...new Set([...e.types,...o])],l=a.map(c=>{if(o.includes(c)){const u=n.indexOf(c);if(u>=0)return r[u]||""}const d=e.types.indexOf(c);return d>=0&&e.classes[d]||""}).filter(c=>!!c);return{types:a,classes:l}},{types:[],classes:[]}).classes.join(" ")}const z6="inline-flex items-center w-full px-4 py-2 border-b border-gray-200 dark:border-gray-600",N6="block w-full px-4 py-2 cursor-pointer hover:bg-gray-100 hover:text-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-700 focus:text-blue-700 dark:hover:bg-gray-600 dark:hover:text-white dark:focus:ring-gray-500 dark:focus:text-white",$6="bg-gray-100 cursor-not-allowed dark:bg-gray-600 dark:text-gray-400";function B6(i){return{itemClasses:ke(()=>Ks(z6,i.disabled.value?$6:"",!i.disabled.value&&i.hover.value?N6:""))}}const V6={key:0,class:"mr-2"},H6={key:1,class:"ml-2"},U6=ht({__name:"FwbListGroupItem",props:{hover:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},setup(i){const e=i,{itemClasses:t}=B6(yn(e));return(r,n)=>(P(),z("li",{class:Se(Ee(t))},[r.$slots.prefix?(P(),z("div",V6,[Xe(r.$slots,"prefix")])):Le("",!0),Xe(r.$slots,"default"),r.$slots.suffix?(P(),z("div",H6,[Xe(r.$slots,"suffix")])):Le("",!0)],2))}}),j6=v("div",{class:"bg-gray-900 bg-opacity-50 dark:bg-opacity-80 fixed inset-0 z-40"},null,-1),W6={class:"relative bg-white rounded-lg shadow dark:bg-gray-700"},G6=v("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[v("path",{"clip-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","fill-rule":"evenodd"})],-1),q6={key:0,class:"p-6 rounded-b border-gray-200 border-t dark:border-gray-600"},Y6=ht({__name:"FwbModal",props:{notEscapable:{type:Boolean,default:!1},persistent:{type:Boolean,default:!1},size:{default:"2xl"}},emits:["close","click:outside"],setup(i,{emit:e}){const t=i,r=e,n={xs:"max-w-xs",sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl","2xl":"max-w-2xl","3xl":"max-w-3xl","4xl":"max-w-4xl","5xl":"max-w-5xl","6xl":"max-w-6xl","7xl":"max-w-7xl"};function s(){r("close")}function o(){t.persistent||(r("click:outside"),s())}function a(){!t.notEscapable&&!t.persistent&&s()}const l=Qt(null);return uo(()=>{l.value&&l.value.focus()}),(c,d)=>(P(),z("div",null,[j6,v("div",{ref_key:"modalRef",ref:l,class:"overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 w-full md:inset-0 h-modal md:h-full justify-center items-center flex",tabindex:"0",onClick:Gw(o,["self"]),onKeyup:qv(a,["esc"])},[v("div",{class:Se([`${n[c.size]}`,"relative p-4 w-full h-full"])},[v("div",W6,[v("div",{class:Se([c.$slots.header?"border-b border-gray-200 dark:border-gray-600":"","p-4 rounded-t flex justify-between items-center"])},[Xe(c.$slots,"header"),c.persistent?Le("",!0):(P(),z("button",{key:0,"aria-label":"close",class:"text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center dark:hover:bg-gray-600 dark:hover:text-white",type:"button",onClick:s},[Xe(c.$slots,"close-icon",{},()=>[G6])]))],2),v("div",{class:Se([c.$slots.header?"":"pt-0","p-6"])},[Xe(c.$slots,"body")],2),c.$slots.footer?(P(),z("div",q6,[Xe(c.$slots,"footer")])):Le("",!0)])],2)],544)]))}}),X6={class:"relative overflow-x-auto shadow-md sm:rounded-lg"},K6={class:"w-full text-sm text-left text-gray-500 dark:text-gray-400"},J6=ht({__name:"FwbTable",props:{striped:{type:Boolean,default:!1},stripedColumns:{type:Boolean,default:!1},hoverable:{type:Boolean,default:!1}},setup(i){const e=i;return Bi("hoverable",e.hoverable),Bi("striped",e.striped),Bi("stripedColumns",e.stripedColumns),(t,r)=>(P(),z("div",X6,[v("table",K6,[Xe(t.$slots,"default")])]))}}),Z6={};function Q6(i,e){return P(),z("tbody",null,[Xe(i.$slots,"default")])}const eO=od(Z6,[["render",Q6]]),tO="px-6 py-4 first:font-medium first:text-gray-900 first:dark:text-white first:whitespace-nowrap last:text-right",iO="even:bg-gray-white even:dark:bg-gray-900 odd:dark:bg-gray-800 odd:bg-gray-50";function rO(){const i=Vt("stripedColumns");return{tableCellClasses:ke(()=>fo(tO,{[iO]:i}))}}const nO=ht({__name:"FwbTableCell",setup(i){const{tableCellClasses:e}=rO();return(t,r)=>(P(),z("td",{class:Se(Ee(e))},[Xe(t.$slots,"default")],2))}}),sO={},oO={class:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"};function aO(i,e){return P(),z("thead",oO,[v("tr",null,[Xe(i.$slots,"default")])])}const lO=od(sO,[["render",aO]]),cO="px-6 py-3 text-xs uppercase",dO="even:bg-white even:dark:bg-gray-900 odd:dark:bg-gray-800 odd:bg-gray-50";function uO(){const i=Vt("stripedColumns");return{tableHeadCellClasses:ke(()=>fo(cO,{[dO]:i}))}}const hO=ht({__name:"FwbTableHeadCell",setup(i){const{tableHeadCellClasses:e}=uO();return(t,r)=>(P(),z("th",{scope:"col",class:Se(Ee(e))},[Xe(t.$slots,"default")],2))}}),fO="bg-white dark:bg-gray-800 [&:not(:last-child)]:border-b [&:not(:last-child)]:dark:border-gray-700",pO="odd:bg-white even:bg-gray-50 odd:dark:bg-gray-800 even:dark:bg-gray-700",mO="hover:bg-gray-50 dark:hover:bg-gray-600";function gO(){const i=Vt("striped"),e=Vt("hoverable");return{tableRowClasses:ke(()=>fo(fO,{[mO]:e,[pO]:i}))}}const vO=ht({__name:"FwbTableRow",setup(i){const{tableRowClasses:e}=gO();return(t,r)=>(P(),z("tr",{class:Se(Ee(e))},[Xe(t.$slots,"default")],2))}}),My="flowbite-tab-activate-func-injection",Ey="flowbite-tab-active-name-injection",ky="flowbite-tab-style-injection",Cy="flowbite-tab-visibility-directive-injection",bO={key:0},yO={key:1},_O=ht({__FLOWBITE_TAB__:!0,__name:"FwbTab",props:{name:{type:String,required:!0},title:{type:String,default:""},disabled:{type:Boolean,default:!1}},setup(i){const e=Vt(Ey,""),t=Vt(Cy,"if");return(r,n)=>Ee(t)==="if"?(P(),z(be,{key:0},[Ee(e)===i.name?(P(),z("div",bO,[Xe(r.$slots,"default")])):Le("",!0)],64)):Ee(t)==="show"?At((P(),z("div",yO,[Xe(r.$slots,"default")],512)),[[jv,Ee(e)===i.name]]):Le("",!0)}});function wO(i){const e=ke(()=>gi("flex flex-wrap font-medium text-center text-gray-500 dark:text-gray-400 text-sm",i.variant==="underline"&&"-mb-px",i.variant==="default"&&"border-b border-gray-200 dark:border-gray-700"));return{divClasses:ke(()=>i.variant==="underline"?"border-b border-gray-200 dark:border-gray-700 font-medium text-center text-gray-500 dark:text-gray-400 text-sm":""),ulClasses:e}}const xO="flowbite-themable-injection-key",xs={blue:{background:"bg-blue-700 dark:bg-blue-600",disabled:"",hover:"hover:bg-blue-800 dark:hover:bg-blue-700",text:"text-blue-600 dark:text-blue-500",border:"border-blue-600 dark:border-blue-500",focus:"focus:ring-blue-300 dark:focus:ring-blue-800"},green:{background:"bg-green-700 dark:bg-green-600",disabled:"",hover:"hover:bg-green-800 dark:hover:bg-green-700",text:"text-green-600 dark:text-green-500",border:"border-green-600 dark:border-green-500",focus:"focus:ring-green-300 dark:focus:ring-green-800"},pink:{background:"bg-pink-700 dark:bg-pink-600",disabled:"",hover:"hover:bg-pink-800 dark:hover:bg-pink-700",text:"text-pink-600 dark:text-pink-500",border:"border-pink-600 dark:border-pink-500",focus:"focus:ring-pink-300 dark:focus:ring-pink-900"},purple:{background:"bg-purple-700 dark:bg-purple-600",disabled:"",hover:"hover:bg-purple-800 dark:hover:bg-purple-700",text:"text-purple-600 dark:text-purple-500",border:"border-purple-600 dark:border-purple-500",focus:"focus:ring-purple-300 dark:focus:ring-purple-900"},red:{background:"bg-red-700 dark:bg-red-600",disabled:"",hover:"hover:bg-red-800 dark:hover:bg-red-700",text:"text-red-600 dark:text-red-500",border:"border-red-600 dark:border-red-500",focus:"focus:ring-red-300 dark:focus:ring-red-900"}};function SO(i){const e=Vt(xO,Qt(null)),t=ke(()=>e.value),r=ke(()=>!!(e!=null&&e.value)),n=ke(()=>t.value?xs[t.value].background:""),s=ke(()=>t.value?xs[t.value].border:""),o=ke(()=>(e==null?void 0:e.value)||void 0),a=ke(()=>t.value?xs[t.value].disabled:""),l=ke(()=>t.value?xs[t.value].focus:""),c=ke(()=>t.value?xs[t.value].hover:""),d=ke(()=>t.value?xs[t.value].text:"");return{backgroundClasses:n,borderClasses:s,color:o,disabledClasses:a,focusClasses:l,hoverClasses:c,isActive:r,textClasses:d}}const MO={default:"cursor-pointer inline-block p-4 rounded-t-lg hover:text-gray-600 hover:bg-gray-50 dark:hover:bg-gray-800 dark:hover:text-gray-300",active:"cursor-pointer inline-block p-4 text-blue-600 bg-gray-100 rounded-t-lg active dark:bg-gray-800 dark:text-blue-500",disabled:"inline-block p-4 text-gray-400 rounded-t-lg cursor-not-allowed dark:text-gray-500"},EO={default:"cursor-pointer inline-block p-4 rounded-t-lg border-b-2 border-transparent hover:text-gray-600 hover:border-gray-300 dark:hover:text-gray-300",active:"cursor-pointer inline-block p-4 text-blue-600 rounded-t-lg border-b-2 border-blue-600 active dark:text-blue-500 dark:border-blue-500",disabled:"inline-block p-4 text-gray-400 rounded-t-lg cursor-not-allowed dark:text-gray-500"},kO={default:"cursor-pointer inline-block py-3 px-4 rounded-lg hover:text-gray-900 hover:bg-gray-100 dark:hover:bg-gray-800 dark:hover:text-white",active:"cursor-pointer inline-block py-3 px-4 text-white bg-blue-600 rounded-lg active",disabled:"inline-block py-3 px-4 text-gray-400 cursor-not-allowed dark:text-gray-500"};function CO(i){const e=SO();return{tabClasses:ke(()=>{const t=e.isActive.value,r=i.active.value?"active":i.disabled.value?"disabled":"default";return i.variant==="default"?Ks(MO[r],(t&&r)==="active"?e.textClasses.value:""):i.variant==="underline"?Ks(EO[r],(t&&r)==="active"?[e.borderClasses.value,e.textClasses.value]:""):i.variant==="pills"?Ks(kO[r],(t&&r)==="active"?[e.backgroundClasses.value,"text-white"]:""):""})}}const TO=ht({__name:"FwbTabPane",props:{name:{type:String,required:!0},title:{type:String,default:""},disabled:{type:Boolean,default:!1},active:{type:Boolean,default:!1}},setup(i){const e=i,t=Vt(ky);t||console.warn("you can't use Tab outside of Tabs component. No tab style injection found");const r=Vt(My);r||console.warn("you can't use Tab outside of Tabs component. No tab activate injection found");const n=()=>{if(!e.disabled){if(!r)return console.warn("no onActivate");r(e.name)}},{tabClasses:s}=CO({active:ua(e,"active"),disabled:ua(e,"disabled"),variant:t});return(o,a)=>(P(),z("li",null,[v("div",{class:Se(Ee(s)),onClick:n},U(i.title),3)]))}}),AO=ht({inheritAttrs:!1,__name:"FwbTabs",props:{variant:{default:"default"},modelValue:{default:""},directive:{default:"if"}},emits:["update:modelValue","click:pane"],setup(i,{emit:e}){const t=i,r=e,{ulClasses:n,divClasses:s}=wO(t);Bi(ky,t.variant);const o=gv().default,a=ke(()=>o?Fc(o()).filter(u=>u.type.__FLOWBITE_TAB__):[]),l=ke({get:()=>t.modelValue,set:u=>r("update:modelValue",u)});Bi(Ey,l),Bi(Cy,ua(t,"directive"));const c=u=>{l.value=u},d=()=>{r("click:pane")};return Bi(My,c),(u,h)=>(P(),z(be,null,[v("div",{class:Se(Ee(s))},[v("ul",{class:Se(Ee(n))},[(P(!0),z(be,null,Fe(a.value,(p,g)=>{var f,m,b,y;return P(),Ge(TO,{key:g,active:l.value===((f=p.props)==null?void 0:f.name),disabled:(m=p.props)==null?void 0:m.disabled,name:(b=p.props)==null?void 0:b.name,title:(y=p.props)==null?void 0:y.title,onClick:d},null,8,["active","disabled","name","title"])}),128))],2)],2),v("div",yh(Oh(u.$attrs)),[Xe(u.$slots,"default")],16)],64))}}),LO=["top","right","bottom","left"],ag=["start","end"],lg=LO.reduce((i,e)=>i.concat(e,e+"-"+ag[0],e+"-"+ag[1]),[]),Xn=Math.min,$n=Math.max,DO={left:"right",right:"left",bottom:"top",top:"bottom"},PO={start:"end",end:"start"};function oh(i,e,t){return $n(i,Xn(e,t))}function vs(i,e){return typeof i=="function"?i(e):i}function ar(i){return i.split("-")[0]}function Ui(i){return i.split("-")[1]}function Ty(i){return i==="x"?"y":"x"}function Pf(i){return i==="y"?"height":"width"}function Ba(i){return["top","bottom"].includes(ar(i))?"y":"x"}function Rf(i){return Ty(Ba(i))}function Ay(i,e,t){t===void 0&&(t=!1);const r=Ui(i),n=Rf(i),s=Pf(n);let o=n==="x"?r===(t?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(o=Nc(o)),[o,Nc(o)]}function RO(i){const e=Nc(i);return[zc(i),e,zc(e)]}function zc(i){return i.replace(/start|end/g,e=>PO[e])}function IO(i,e,t){const r=["left","right"],n=["right","left"],s=["top","bottom"],o=["bottom","top"];switch(i){case"top":case"bottom":return t?e?n:r:e?r:n;case"left":case"right":return e?s:o;default:return[]}}function OO(i,e,t,r){const n=Ui(i);let s=IO(ar(i),t==="start",r);return n&&(s=s.map(o=>o+"-"+n),e&&(s=s.concat(s.map(zc)))),s}function Nc(i){return i.replace(/left|right|bottom|top/g,e=>DO[e])}function FO(i){return{top:0,right:0,bottom:0,left:0,...i}}function Ly(i){return typeof i!="number"?FO(i):{top:i,right:i,bottom:i,left:i}}function sa(i){const{x:e,y:t,width:r,height:n}=i;return{width:r,height:n,top:t,left:e,right:e+r,bottom:t+n,x:e,y:t}}function cg(i,e,t){let{reference:r,floating:n}=i;const s=Ba(e),o=Rf(e),a=Pf(o),l=ar(e),c=s==="y",d=r.x+r.width/2-n.width/2,u=r.y+r.height/2-n.height/2,h=r[a]/2-n[a]/2;let p;switch(l){case"top":p={x:d,y:r.y-n.height};break;case"bottom":p={x:d,y:r.y+r.height};break;case"right":p={x:r.x+r.width,y:u};break;case"left":p={x:r.x-n.width,y:u};break;default:p={x:r.x,y:r.y}}switch(Ui(e)){case"start":p[o]-=h*(t&&c?-1:1);break;case"end":p[o]+=h*(t&&c?-1:1);break}return p}const zO=async(i,e,t)=>{const{placement:r="bottom",strategy:n="absolute",middleware:s=[],platform:o}=t,a=s.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let c=await o.getElementRects({reference:i,floating:e,strategy:n}),{x:d,y:u}=cg(c,r,l),h=r,p={},g=0;for(let f=0;f<a.length;f++){const{name:m,fn:b}=a[f],{x:y,y:w,data:_,reset:M}=await b({x:d,y:u,initialPlacement:r,placement:h,strategy:n,middlewareData:p,rects:c,platform:o,elements:{reference:i,floating:e}});d=y??d,u=w??u,p={...p,[m]:{...p[m],..._}},M&&g<=50&&(g++,typeof M=="object"&&(M.placement&&(h=M.placement),M.rects&&(c=M.rects===!0?await o.getElementRects({reference:i,floating:e,strategy:n}):M.rects),{x:d,y:u}=cg(c,h,l)),f=-1)}return{x:d,y:u,placement:h,strategy:n,middlewareData:p}};async function dd(i,e){var t;e===void 0&&(e={});const{x:r,y:n,platform:s,rects:o,elements:a,strategy:l}=i,{boundary:c="clippingAncestors",rootBoundary:d="viewport",elementContext:u="floating",altBoundary:h=!1,padding:p=0}=vs(e,i),g=Ly(p),f=a[h?u==="floating"?"reference":"floating":u],m=sa(await s.getClippingRect({element:(t=await(s.isElement==null?void 0:s.isElement(f)))==null||t?f:f.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(a.floating)),boundary:c,rootBoundary:d,strategy:l})),b=u==="floating"?{x:r,y:n,width:o.floating.width,height:o.floating.height}:o.reference,y=await(s.getOffsetParent==null?void 0:s.getOffsetParent(a.floating)),w=await(s.isElement==null?void 0:s.isElement(y))?await(s.getScale==null?void 0:s.getScale(y))||{x:1,y:1}:{x:1,y:1},_=sa(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:b,offsetParent:y,strategy:l}):b);return{top:(m.top-_.top+g.top)/w.y,bottom:(_.bottom-m.bottom+g.bottom)/w.y,left:(m.left-_.left+g.left)/w.x,right:(_.right-m.right+g.right)/w.x}}const NO=i=>({name:"arrow",options:i,async fn(e){const{x:t,y:r,placement:n,rects:s,platform:o,elements:a,middlewareData:l}=e,{element:c,padding:d=0}=vs(i,e)||{};if(c==null)return{};const u=Ly(d),h={x:t,y:r},p=Rf(n),g=Pf(p),f=await o.getDimensions(c),m=p==="y",b=m?"top":"left",y=m?"bottom":"right",w=m?"clientHeight":"clientWidth",_=s.reference[g]+s.reference[p]-h[p]-s.floating[g],M=h[p]-s.reference[p],S=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let A=S?S[w]:0;(!A||!await(o.isElement==null?void 0:o.isElement(S)))&&(A=a.floating[w]||s.floating[g]);const x=_/2-M/2,E=A/2-f[g]/2-1,D=Xn(u[b],E),F=Xn(u[y],E),R=D,B=A-f[g]-F,I=A/2-f[g]/2+x,V=oh(R,I,B),N=!l.arrow&&Ui(n)!=null&&I!==V&&s.reference[g]/2-(I<R?D:F)-f[g]/2<0,j=N?I<R?I-R:I-B:0;return{[p]:h[p]+j,data:{[p]:V,centerOffset:I-V-j,...N&&{alignmentOffset:j}},reset:N}}});function $O(i,e,t){return(i?[...t.filter(r=>Ui(r)===i),...t.filter(r=>Ui(r)!==i)]:t.filter(r=>ar(r)===r)).filter(r=>i?Ui(r)===i||(e?zc(r)!==r:!1):!0)}const BO=function(i){return i===void 0&&(i={}),{name:"autoPlacement",options:i,async fn(e){var t,r,n;const{rects:s,middlewareData:o,placement:a,platform:l,elements:c}=e,{crossAxis:d=!1,alignment:u,allowedPlacements:h=lg,autoAlignment:p=!0,...g}=vs(i,e),f=u!==void 0||h===lg?$O(u||null,p,h):h,m=await dd(e,g),b=((t=o.autoPlacement)==null?void 0:t.index)||0,y=f[b];if(y==null)return{};const w=Ay(y,s,await(l.isRTL==null?void 0:l.isRTL(c.floating)));if(a!==y)return{reset:{placement:f[0]}};const _=[m[ar(y)],m[w[0]],m[w[1]]],M=[...((r=o.autoPlacement)==null?void 0:r.overflows)||[],{placement:y,overflows:_}],S=f[b+1];if(S)return{data:{index:b+1,overflows:M},reset:{placement:S}};const A=M.map(E=>{const D=Ui(E.placement);return[E.placement,D&&d?E.overflows.slice(0,2).reduce((F,R)=>F+R,0):E.overflows[0],E.overflows]}).sort((E,D)=>E[1]-D[1]),x=((n=A.filter(E=>E[2].slice(0,Ui(E[0])?2:3).every(D=>D<=0))[0])==null?void 0:n[0])||A[0][0];return x!==a?{data:{index:b+1,overflows:M},reset:{placement:x}}:{}}}},VO=function(i){return i===void 0&&(i={}),{name:"flip",options:i,async fn(e){var t,r;const{placement:n,middlewareData:s,rects:o,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:d=!0,crossAxis:u=!0,fallbackPlacements:h,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:f=!0,...m}=vs(i,e);if((t=s.arrow)!=null&&t.alignmentOffset)return{};const b=ar(n),y=ar(a)===a,w=await(l.isRTL==null?void 0:l.isRTL(c.floating)),_=h||(y||!f?[Nc(a)]:RO(a));!h&&g!=="none"&&_.push(...OO(a,f,g,w));const M=[a,..._],S=await dd(e,m),A=[];let x=((r=s.flip)==null?void 0:r.overflows)||[];if(d&&A.push(S[b]),u){const R=Ay(n,o,w);A.push(S[R[0]],S[R[1]])}if(x=[...x,{placement:n,overflows:A}],!A.every(R=>R<=0)){var E,D;const R=(((E=s.flip)==null?void 0:E.index)||0)+1,B=M[R];if(B)return{data:{index:R,overflows:x},reset:{placement:B}};let I=(D=x.filter(V=>V.overflows[0]<=0).sort((V,N)=>V.overflows[1]-N.overflows[1])[0])==null?void 0:D.placement;if(!I)switch(p){case"bestFit":{var F;const V=(F=x.map(N=>[N.placement,N.overflows.filter(j=>j>0).reduce((j,Y)=>j+Y,0)]).sort((N,j)=>N[1]-j[1])[0])==null?void 0:F[0];V&&(I=V);break}case"initialPlacement":I=a;break}if(n!==I)return{reset:{placement:I}}}return{}}}};async function HO(i,e){const{placement:t,platform:r,elements:n}=i,s=await(r.isRTL==null?void 0:r.isRTL(n.floating)),o=ar(t),a=Ui(t),l=Ba(t)==="y",c=["left","top"].includes(o)?-1:1,d=s&&l?-1:1,u=vs(e,i);let{mainAxis:h,crossAxis:p,alignmentAxis:g}=typeof u=="number"?{mainAxis:u,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...u};return a&&typeof g=="number"&&(p=a==="end"?g*-1:g),l?{x:p*d,y:h*c}:{x:h*c,y:p*d}}const UO=function(i){return i===void 0&&(i=0),{name:"offset",options:i,async fn(e){var t,r;const{x:n,y:s,placement:o,middlewareData:a}=e,l=await HO(e,i);return o===((t=a.offset)==null?void 0:t.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:n+l.x,y:s+l.y,data:{...l,placement:o}}}}},jO=function(i){return i===void 0&&(i={}),{name:"shift",options:i,async fn(e){const{x:t,y:r,placement:n}=e,{mainAxis:s=!0,crossAxis:o=!1,limiter:a={fn:m=>{let{x:b,y}=m;return{x:b,y}}},...l}=vs(i,e),c={x:t,y:r},d=await dd(e,l),u=Ba(ar(n)),h=Ty(u);let p=c[h],g=c[u];if(s){const m=h==="y"?"top":"left",b=h==="y"?"bottom":"right",y=p+d[m],w=p-d[b];p=oh(y,p,w)}if(o){const m=u==="y"?"top":"left",b=u==="y"?"bottom":"right",y=g+d[m],w=g-d[b];g=oh(y,g,w)}const f=a.fn({...e,[h]:p,[u]:g});return{...f,data:{x:f.x-t,y:f.y-r}}}}},WO=function(i){return i===void 0&&(i={}),{name:"size",options:i,async fn(e){const{placement:t,rects:r,platform:n,elements:s}=e,{apply:o=()=>{},...a}=vs(i,e),l=await dd(e,a),c=ar(t),d=Ui(t),u=Ba(t)==="y",{width:h,height:p}=r.floating;let g,f;c==="top"||c==="bottom"?(g=c,f=d===(await(n.isRTL==null?void 0:n.isRTL(s.floating))?"start":"end")?"left":"right"):(f=c,g=d==="end"?"top":"bottom");const m=p-l.top-l.bottom,b=h-l.left-l.right,y=Xn(p-l[g],m),w=Xn(h-l[f],b),_=!e.middlewareData.shift;let M=y,S=w;if(u?S=d||_?Xn(w,b):b:M=d||_?Xn(y,m):m,_&&!d){const x=$n(l.left,0),E=$n(l.right,0),D=$n(l.top,0),F=$n(l.bottom,0);u?S=h-2*(x!==0||E!==0?x+E:$n(l.left,l.right)):M=p-2*(D!==0||F!==0?D+F:$n(l.top,l.bottom))}await o({...e,availableWidth:S,availableHeight:M});const A=await n.getDimensions(s.floating);return h!==A.width||p!==A.height?{reset:{rects:!0}}:{}}}};function Ci(i){var e;return((e=i.ownerDocument)==null?void 0:e.defaultView)||window}function tr(i){return Ci(i).getComputedStyle(i)}const dg=Math.min,oa=Math.max,$c=Math.round;function Dy(i){const e=tr(i);let t=parseFloat(e.width),r=parseFloat(e.height);const n=i.offsetWidth,s=i.offsetHeight,o=$c(t)!==n||$c(r)!==s;return o&&(t=n,r=s),{width:t,height:r,fallback:o}}function Mn(i){return Ry(i)?(i.nodeName||"").toLowerCase():""}let ul;function Py(){if(ul)return ul;const i=navigator.userAgentData;return i&&Array.isArray(i.brands)?(ul=i.brands.map(e=>e.brand+"/"+e.version).join(" "),ul):navigator.userAgent}function ir(i){return i instanceof Ci(i).HTMLElement}function gn(i){return i instanceof Ci(i).Element}function Ry(i){return i instanceof Ci(i).Node}function ug(i){return typeof ShadowRoot>"u"?!1:i instanceof Ci(i).ShadowRoot||i instanceof ShadowRoot}function ud(i){const{overflow:e,overflowX:t,overflowY:r,display:n}=tr(i);return/auto|scroll|overlay|hidden|clip/.test(e+r+t)&&!["inline","contents"].includes(n)}function GO(i){return["table","td","th"].includes(Mn(i))}function ah(i){const e=/firefox/i.test(Py()),t=tr(i),r=t.backdropFilter||t.WebkitBackdropFilter;return t.transform!=="none"||t.perspective!=="none"||!!r&&r!=="none"||e&&t.willChange==="filter"||e&&!!t.filter&&t.filter!=="none"||["transform","perspective"].some(n=>t.willChange.includes(n))||["paint","layout","strict","content"].some(n=>{const s=t.contain;return s!=null&&s.includes(n)})}function Iy(){return!/^((?!chrome|android).)*safari/i.test(Py())}function If(i){return["html","body","#document"].includes(Mn(i))}function Oy(i){return gn(i)?i:i.contextElement}const Fy={x:1,y:1};function Js(i){const e=Oy(i);if(!ir(e))return Fy;const t=e.getBoundingClientRect(),{width:r,height:n,fallback:s}=Dy(e);let o=(s?$c(t.width):t.width)/r,a=(s?$c(t.height):t.height)/n;return o&&Number.isFinite(o)||(o=1),a&&Number.isFinite(a)||(a=1),{x:o,y:a}}function Ca(i,e,t,r){var n,s;e===void 0&&(e=!1),t===void 0&&(t=!1);const o=i.getBoundingClientRect(),a=Oy(i);let l=Fy;e&&(r?gn(r)&&(l=Js(r)):l=Js(i));const c=a?Ci(a):window,d=!Iy()&&t;let u=(o.left+(d&&((n=c.visualViewport)==null?void 0:n.offsetLeft)||0))/l.x,h=(o.top+(d&&((s=c.visualViewport)==null?void 0:s.offsetTop)||0))/l.y,p=o.width/l.x,g=o.height/l.y;if(a){const f=Ci(a),m=r&&gn(r)?Ci(r):r;let b=f.frameElement;for(;b&&r&&m!==f;){const y=Js(b),w=b.getBoundingClientRect(),_=getComputedStyle(b);w.x+=(b.clientLeft+parseFloat(_.paddingLeft))*y.x,w.y+=(b.clientTop+parseFloat(_.paddingTop))*y.y,u*=y.x,h*=y.y,p*=y.x,g*=y.y,u+=w.x,h+=w.y,b=Ci(b).frameElement}}return{width:p,height:g,top:h,right:u+p,bottom:h+g,left:u,x:u,y:h}}function vn(i){return((Ry(i)?i.ownerDocument:i.document)||window.document).documentElement}function hd(i){return gn(i)?{scrollLeft:i.scrollLeft,scrollTop:i.scrollTop}:{scrollLeft:i.pageXOffset,scrollTop:i.pageYOffset}}function zy(i){return Ca(vn(i)).left+hd(i).scrollLeft}function Ta(i){if(Mn(i)==="html")return i;const e=i.assignedSlot||i.parentNode||ug(i)&&i.host||vn(i);return ug(e)?e.host:e}function Ny(i){const e=Ta(i);return If(e)?e.ownerDocument.body:ir(e)&&ud(e)?e:Ny(e)}function Bc(i,e){var t;e===void 0&&(e=[]);const r=Ny(i),n=r===((t=i.ownerDocument)==null?void 0:t.body),s=Ci(r);return n?e.concat(s,s.visualViewport||[],ud(r)?r:[]):e.concat(r,Bc(r))}function hg(i,e,t){return e==="viewport"?sa(function(r,n){const s=Ci(r),o=vn(r),a=s.visualViewport;let l=o.clientWidth,c=o.clientHeight,d=0,u=0;if(a){l=a.width,c=a.height;const h=Iy();(h||!h&&n==="fixed")&&(d=a.offsetLeft,u=a.offsetTop)}return{width:l,height:c,x:d,y:u}}(i,t)):gn(e)?sa(function(r,n){const s=Ca(r,!0,n==="fixed"),o=s.top+r.clientTop,a=s.left+r.clientLeft,l=ir(r)?Js(r):{x:1,y:1};return{width:r.clientWidth*l.x,height:r.clientHeight*l.y,x:a*l.x,y:o*l.y}}(e,t)):sa(function(r){const n=vn(r),s=hd(r),o=r.ownerDocument.body,a=oa(n.scrollWidth,n.clientWidth,o.scrollWidth,o.clientWidth),l=oa(n.scrollHeight,n.clientHeight,o.scrollHeight,o.clientHeight);let c=-s.scrollLeft+zy(r);const d=-s.scrollTop;return tr(o).direction==="rtl"&&(c+=oa(n.clientWidth,o.clientWidth)-a),{width:a,height:l,x:c,y:d}}(vn(i)))}function fg(i){return ir(i)&&tr(i).position!=="fixed"?i.offsetParent:null}function pg(i){const e=Ci(i);let t=fg(i);for(;t&&GO(t)&&tr(t).position==="static";)t=fg(t);return t&&(Mn(t)==="html"||Mn(t)==="body"&&tr(t).position==="static"&&!ah(t))?e:t||function(r){let n=Ta(r);for(;ir(n)&&!If(n);){if(ah(n))return n;n=Ta(n)}return null}(i)||e}function qO(i,e,t){const r=ir(e),n=vn(e),s=Ca(i,!0,t==="fixed",e);let o={scrollLeft:0,scrollTop:0};const a={x:0,y:0};if(r||!r&&t!=="fixed")if((Mn(e)!=="body"||ud(n))&&(o=hd(e)),ir(e)){const l=Ca(e,!0);a.x=l.x+e.clientLeft,a.y=l.y+e.clientTop}else n&&(a.x=zy(n));return{x:s.left+o.scrollLeft-a.x,y:s.top+o.scrollTop-a.y,width:s.width,height:s.height}}const YO={getClippingRect:function(i){let{element:e,boundary:t,rootBoundary:r,strategy:n}=i;const s=t==="clippingAncestors"?function(c,d){const u=d.get(c);if(u)return u;let h=Bc(c).filter(m=>gn(m)&&Mn(m)!=="body"),p=null;const g=tr(c).position==="fixed";let f=g?Ta(c):c;for(;gn(f)&&!If(f);){const m=tr(f),b=ah(f);(g?b||p:b||m.position!=="static"||!p||!["absolute","fixed"].includes(p.position))?p=m:h=h.filter(y=>y!==f),f=Ta(f)}return d.set(c,h),h}(e,this._c):[].concat(t),o=[...s,r],a=o[0],l=o.reduce((c,d)=>{const u=hg(e,d,n);return c.top=oa(u.top,c.top),c.right=dg(u.right,c.right),c.bottom=dg(u.bottom,c.bottom),c.left=oa(u.left,c.left),c},hg(e,a,n));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(i){let{rect:e,offsetParent:t,strategy:r}=i;const n=ir(t),s=vn(t);if(t===s)return e;let o={scrollLeft:0,scrollTop:0},a={x:1,y:1};const l={x:0,y:0};if((n||!n&&r!=="fixed")&&((Mn(t)!=="body"||ud(s))&&(o=hd(t)),ir(t))){const c=Ca(t);a=Js(t),l.x=c.x+t.clientLeft,l.y=c.y+t.clientTop}return{width:e.width*a.x,height:e.height*a.y,x:e.x*a.x-o.scrollLeft*a.x+l.x,y:e.y*a.y-o.scrollTop*a.y+l.y}},isElement:gn,getDimensions:function(i){return ir(i)?Dy(i):i.getBoundingClientRect()},getOffsetParent:pg,getDocumentElement:vn,getScale:Js,async getElementRects(i){let{reference:e,floating:t,strategy:r}=i;const n=this.getOffsetParent||pg,s=this.getDimensions;return{reference:qO(e,await n(t),r),floating:{x:0,y:0,...await s(t)}}},getClientRects:i=>Array.from(i.getClientRects()),isRTL:i=>tr(i).direction==="rtl"},XO=(i,e,t)=>{const r=new Map,n={platform:YO,...t},s={...n.platform,_c:r};return zO(i,e,{...n,platform:s})},es={disabled:!1,distance:5,skidding:0,container:"body",boundary:void 0,instantMove:!1,disposeTimeout:150,popperTriggers:[],strategy:"absolute",preventOverflow:!0,flip:!0,shift:!0,overflowPadding:0,arrowPadding:0,arrowOverflow:!0,autoHideOnMousedown:!1,themes:{tooltip:{placement:"top",triggers:["hover","focus","touch"],hideTriggers:i=>[...i,"click"],delay:{show:200,hide:0},handleResize:!1,html:!1,loadingContent:"..."},dropdown:{placement:"bottom",triggers:["click"],delay:0,handleResize:!0,autoHide:!0},menu:{$extend:"dropdown",triggers:["hover","focus"],popperTriggers:["hover"],delay:{show:0,hide:400}}}};function lh(i,e){let t=es.themes[i]||{},r;do r=t[e],typeof r>"u"?t.$extend?t=es.themes[t.$extend]||{}:(t=null,r=es[e]):t=null;while(t);return r}function KO(i){const e=[i];let t=es.themes[i]||{};do t.$extend&&!t.$resetCss?(e.push(t.$extend),t=es.themes[t.$extend]||{}):t=null;while(t);return e.map(r=>`v-popper--theme-${r}`)}function mg(i){const e=[i];let t=es.themes[i]||{};do t.$extend?(e.push(t.$extend),t=es.themes[t.$extend]||{}):t=null;while(t);return e}let Aa=!1;if(typeof window<"u"){Aa=!1;try{const i=Object.defineProperty({},"passive",{get(){Aa=!0}});window.addEventListener("test",null,i)}catch{}}let $y=!1;typeof window<"u"&&typeof navigator<"u"&&($y=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream);const JO=["auto","top","bottom","left","right"].reduce((i,e)=>i.concat([e,`${e}-start`,`${e}-end`]),[]),gg={hover:"mouseenter",focus:"focus",click:"click",touch:"touchstart",pointer:"pointerdown"},vg={hover:"mouseleave",focus:"blur",click:"click",touch:"touchend",pointer:"pointerup"};function bg(i,e){const t=i.indexOf(e);t!==-1&&i.splice(t,1)}function Gd(){return new Promise(i=>requestAnimationFrame(()=>{requestAnimationFrame(i)}))}const $i=[];let Rn=null;const yg={};function _g(i){let e=yg[i];return e||(e=yg[i]=[]),e}let ch=function(){};typeof window<"u"&&(ch=window.Element);function nt(i){return function(e){return lh(e.theme,i)}}const qd="__floating-vue__popper",By=()=>ht({name:"VPopper",provide(){return{[qd]:{parentPopper:this}}},inject:{[qd]:{default:null}},props:{theme:{type:String,required:!0},targetNodes:{type:Function,required:!0},referenceNode:{type:Function,default:null},popperNode:{type:Function,required:!0},shown:{type:Boolean,default:!1},showGroup:{type:String,default:null},ariaId:{default:null},disabled:{type:Boolean,default:nt("disabled")},positioningDisabled:{type:Boolean,default:nt("positioningDisabled")},placement:{type:String,default:nt("placement"),validator:i=>JO.includes(i)},delay:{type:[String,Number,Object],default:nt("delay")},distance:{type:[Number,String],default:nt("distance")},skidding:{type:[Number,String],default:nt("skidding")},triggers:{type:Array,default:nt("triggers")},showTriggers:{type:[Array,Function],default:nt("showTriggers")},hideTriggers:{type:[Array,Function],default:nt("hideTriggers")},popperTriggers:{type:Array,default:nt("popperTriggers")},popperShowTriggers:{type:[Array,Function],default:nt("popperShowTriggers")},popperHideTriggers:{type:[Array,Function],default:nt("popperHideTriggers")},container:{type:[String,Object,ch,Boolean],default:nt("container")},boundary:{type:[String,ch],default:nt("boundary")},strategy:{type:String,validator:i=>["absolute","fixed"].includes(i),default:nt("strategy")},autoHide:{type:[Boolean,Function],default:nt("autoHide")},handleResize:{type:Boolean,default:nt("handleResize")},instantMove:{type:Boolean,default:nt("instantMove")},eagerMount:{type:Boolean,default:nt("eagerMount")},popperClass:{type:[String,Array,Object],default:nt("popperClass")},computeTransformOrigin:{type:Boolean,default:nt("computeTransformOrigin")},autoMinSize:{type:Boolean,default:nt("autoMinSize")},autoSize:{type:[Boolean,String],default:nt("autoSize")},autoMaxSize:{type:Boolean,default:nt("autoMaxSize")},autoBoundaryMaxSize:{type:Boolean,default:nt("autoBoundaryMaxSize")},preventOverflow:{type:Boolean,default:nt("preventOverflow")},overflowPadding:{type:[Number,String],default:nt("overflowPadding")},arrowPadding:{type:[Number,String],default:nt("arrowPadding")},arrowOverflow:{type:Boolean,default:nt("arrowOverflow")},flip:{type:Boolean,default:nt("flip")},shift:{type:Boolean,default:nt("shift")},shiftCrossAxis:{type:Boolean,default:nt("shiftCrossAxis")},noAutoFocus:{type:Boolean,default:nt("noAutoFocus")},disposeTimeout:{type:Number,default:nt("disposeTimeout")}},emits:{show:()=>!0,hide:()=>!0,"update:shown":i=>!0,"apply-show":()=>!0,"apply-hide":()=>!0,"close-group":()=>!0,"close-directive":()=>!0,"auto-hide":()=>!0,resize:()=>!0},data(){return{isShown:!1,isMounted:!1,skipTransition:!1,classes:{showFrom:!1,showTo:!1,hideFrom:!1,hideTo:!0},result:{x:0,y:0,placement:"",strategy:this.strategy,arrow:{x:0,y:0,centerOffset:0},transformOrigin:null},randomId:`popper_${[Math.random(),Date.now()].map(i=>i.toString(36).substring(2,10)).join("_")}`,shownChildren:new Set,lastAutoHide:!0,pendingHide:!1,containsGlobalTarget:!1,isDisposed:!0,mouseDownContains:!1}},computed:{popperId(){return this.ariaId!=null?this.ariaId:this.randomId},shouldMountContent(){return this.eagerMount||this.isMounted},slotData(){return{popperId:this.popperId,isShown:this.isShown,shouldMountContent:this.shouldMountContent,skipTransition:this.skipTransition,autoHide:typeof this.autoHide=="function"?this.lastAutoHide:this.autoHide,show:this.show,hide:this.hide,handleResize:this.handleResize,onResize:this.onResize,classes:{...this.classes,popperClass:this.popperClass},result:this.positioningDisabled?null:this.result,attrs:this.$attrs}},parentPopper(){var i;return(i=this[qd])==null?void 0:i.parentPopper},hasPopperShowTriggerHover(){var i,e;return((i=this.popperTriggers)==null?void 0:i.includes("hover"))||((e=this.popperShowTriggers)==null?void 0:e.includes("hover"))}},watch:{shown:"$_autoShowHide",disabled(i){i?this.dispose():this.init()},async container(){this.isShown&&(this.$_ensureTeleport(),await this.$_computePosition())},triggers:{handler:"$_refreshListeners",deep:!0},positioningDisabled:"$_refreshListeners",...["placement","distance","skidding","boundary","strategy","overflowPadding","arrowPadding","preventOverflow","shift","shiftCrossAxis","flip"].reduce((i,e)=>(i[e]="$_computePosition",i),{})},created(){this.autoMinSize&&console.warn('[floating-vue] `autoMinSize` option is deprecated. Use `autoSize="min"` instead.'),this.autoMaxSize&&console.warn("[floating-vue] `autoMaxSize` option is deprecated. Use `autoBoundaryMaxSize` instead.")},mounted(){this.init(),this.$_detachPopperNode()},activated(){this.$_autoShowHide()},deactivated(){this.hide()},beforeUnmount(){this.dispose()},methods:{show({event:i=null,skipDelay:e=!1,force:t=!1}={}){var r,n;(r=this.parentPopper)!=null&&r.lockedChild&&this.parentPopper.lockedChild!==this||(this.pendingHide=!1,(t||!this.disabled)&&(((n=this.parentPopper)==null?void 0:n.lockedChild)===this&&(this.parentPopper.lockedChild=null),this.$_scheduleShow(i,e),this.$emit("show"),this.$_showFrameLocked=!0,requestAnimationFrame(()=>{this.$_showFrameLocked=!1})),this.$emit("update:shown",!0))},hide({event:i=null,skipDelay:e=!1}={}){var t;if(!this.$_hideInProgress){if(this.shownChildren.size>0){this.pendingHide=!0;return}if(this.hasPopperShowTriggerHover&&this.$_isAimingPopper()){this.parentPopper&&(this.parentPopper.lockedChild=this,clearTimeout(this.parentPopper.lockedChildTimer),this.parentPopper.lockedChildTimer=setTimeout(()=>{this.parentPopper.lockedChild===this&&(this.parentPopper.lockedChild.hide({skipDelay:e}),this.parentPopper.lockedChild=null)},1e3));return}((t=this.parentPopper)==null?void 0:t.lockedChild)===this&&(this.parentPopper.lockedChild=null),this.pendingHide=!1,this.$_scheduleHide(i,e),this.$emit("hide"),this.$emit("update:shown",!1)}},init(){var i;this.isDisposed&&(this.isDisposed=!1,this.isMounted=!1,this.$_events=[],this.$_preventShow=!1,this.$_referenceNode=((i=this.referenceNode)==null?void 0:i.call(this))??this.$el,this.$_targetNodes=this.targetNodes().filter(e=>e.nodeType===e.ELEMENT_NODE),this.$_popperNode=this.popperNode(),this.$_innerNode=this.$_popperNode.querySelector(".v-popper__inner"),this.$_arrowNode=this.$_popperNode.querySelector(".v-popper__arrow-container"),this.$_swapTargetAttrs("title","data-original-title"),this.$_detachPopperNode(),this.triggers.length&&this.$_addEventListeners(),this.shown&&this.show())},dispose(){this.isDisposed||(this.isDisposed=!0,this.$_removeEventListeners(),this.hide({skipDelay:!0}),this.$_detachPopperNode(),this.isMounted=!1,this.isShown=!1,this.$_updateParentShownChildren(!1),this.$_swapTargetAttrs("data-original-title","title"))},async onResize(){this.isShown&&(await this.$_computePosition(),this.$emit("resize"))},async $_computePosition(){if(this.isDisposed||this.positioningDisabled)return;const i={strategy:this.strategy,middleware:[]};(this.distance||this.skidding)&&i.middleware.push(UO({mainAxis:this.distance,crossAxis:this.skidding}));const e=this.placement.startsWith("auto");if(e?i.middleware.push(BO({alignment:this.placement.split("-")[1]??""})):i.placement=this.placement,this.preventOverflow&&(this.shift&&i.middleware.push(jO({padding:this.overflowPadding,boundary:this.boundary,crossAxis:this.shiftCrossAxis})),!e&&this.flip&&i.middleware.push(VO({padding:this.overflowPadding,boundary:this.boundary}))),i.middleware.push(NO({element:this.$_arrowNode,padding:this.arrowPadding})),this.arrowOverflow&&i.middleware.push({name:"arrowOverflow",fn:({placement:r,rects:n,middlewareData:s})=>{let o;const{centerOffset:a}=s.arrow;return r.startsWith("top")||r.startsWith("bottom")?o=Math.abs(a)>n.reference.width/2:o=Math.abs(a)>n.reference.height/2,{data:{overflow:o}}}}),this.autoMinSize||this.autoSize){const r=this.autoSize?this.autoSize:this.autoMinSize?"min":null;i.middleware.push({name:"autoSize",fn:({rects:n,placement:s,middlewareData:o})=>{var a;if((a=o.autoSize)!=null&&a.skip)return{};let l,c;return s.startsWith("top")||s.startsWith("bottom")?l=n.reference.width:c=n.reference.height,this.$_innerNode.style[r==="min"?"minWidth":r==="max"?"maxWidth":"width"]=l!=null?`${l}px`:null,this.$_innerNode.style[r==="min"?"minHeight":r==="max"?"maxHeight":"height"]=c!=null?`${c}px`:null,{data:{skip:!0},reset:{rects:!0}}}})}(this.autoMaxSize||this.autoBoundaryMaxSize)&&(this.$_innerNode.style.maxWidth=null,this.$_innerNode.style.maxHeight=null,i.middleware.push(WO({boundary:this.boundary,padding:this.overflowPadding,apply:({availableWidth:r,availableHeight:n})=>{this.$_innerNode.style.maxWidth=r!=null?`${r}px`:null,this.$_innerNode.style.maxHeight=n!=null?`${n}px`:null}})));const t=await XO(this.$_referenceNode,this.$_popperNode,i);Object.assign(this.result,{x:t.x,y:t.y,placement:t.placement,strategy:t.strategy,arrow:{...t.middlewareData.arrow,...t.middlewareData.arrowOverflow}})},$_scheduleShow(i,e=!1){if(this.$_updateParentShownChildren(!0),this.$_hideInProgress=!1,clearTimeout(this.$_scheduleTimer),Rn&&this.instantMove&&Rn.instantMove&&Rn!==this.parentPopper){Rn.$_applyHide(!0),this.$_applyShow(!0);return}e?this.$_applyShow():this.$_scheduleTimer=setTimeout(this.$_applyShow.bind(this),this.$_computeDelay("show"))},$_scheduleHide(i,e=!1){if(this.shownChildren.size>0){this.pendingHide=!0;return}this.$_updateParentShownChildren(!1),this.$_hideInProgress=!0,clearTimeout(this.$_scheduleTimer),this.isShown&&(Rn=this),e?this.$_applyHide():this.$_scheduleTimer=setTimeout(this.$_applyHide.bind(this),this.$_computeDelay("hide"))},$_computeDelay(i){const e=this.delay;return parseInt(e&&e[i]||e||0)},async $_applyShow(i=!1){clearTimeout(this.$_disposeTimer),clearTimeout(this.$_scheduleTimer),this.skipTransition=i,!this.isShown&&(this.$_ensureTeleport(),await Gd(),await this.$_computePosition(),await this.$_applyShowEffect(),this.positioningDisabled||this.$_registerEventListeners([...Bc(this.$_referenceNode),...Bc(this.$_popperNode)],"scroll",()=>{this.$_computePosition()}))},async $_applyShowEffect(){if(this.$_hideInProgress)return;if(this.computeTransformOrigin){const e=this.$_referenceNode.getBoundingClientRect(),t=this.$_popperNode.querySelector(".v-popper__wrapper"),r=t.parentNode.getBoundingClientRect(),n=e.x+e.width/2-(r.left+t.offsetLeft),s=e.y+e.height/2-(r.top+t.offsetTop);this.result.transformOrigin=`${n}px ${s}px`}this.isShown=!0,this.$_applyAttrsToTarget({"aria-describedby":this.popperId,"data-popper-shown":""});const i=this.showGroup;if(i){let e;for(let t=0;t<$i.length;t++)e=$i[t],e.showGroup!==i&&(e.hide(),e.$emit("close-group"))}$i.push(this),document.body.classList.add("v-popper--some-open");for(const e of mg(this.theme))_g(e).push(this),document.body.classList.add(`v-popper--some-open--${e}`);this.$emit("apply-show"),this.classes.showFrom=!0,this.classes.showTo=!1,this.classes.hideFrom=!1,this.classes.hideTo=!1,await Gd(),this.classes.showFrom=!1,this.classes.showTo=!0,this.noAutoFocus||this.$_popperNode.focus()},async $_applyHide(i=!1){if(this.shownChildren.size>0){this.pendingHide=!0,this.$_hideInProgress=!1;return}if(clearTimeout(this.$_scheduleTimer),!this.isShown)return;this.skipTransition=i,bg($i,this),$i.length===0&&document.body.classList.remove("v-popper--some-open");for(const t of mg(this.theme)){const r=_g(t);bg(r,this),r.length===0&&document.body.classList.remove(`v-popper--some-open--${t}`)}Rn===this&&(Rn=null),this.isShown=!1,this.$_applyAttrsToTarget({"aria-describedby":void 0,"data-popper-shown":void 0}),clearTimeout(this.$_disposeTimer);const e=this.disposeTimeout;e!==null&&(this.$_disposeTimer=setTimeout(()=>{this.$_popperNode&&(this.$_detachPopperNode(),this.isMounted=!1)},e)),this.$_removeEventListeners("scroll"),this.$emit("apply-hide"),this.classes.showFrom=!1,this.classes.showTo=!1,this.classes.hideFrom=!0,this.classes.hideTo=!1,await Gd(),this.classes.hideFrom=!1,this.classes.hideTo=!0},$_autoShowHide(){this.shown?this.show():this.hide()},$_ensureTeleport(){if(this.isDisposed)return;let i=this.container;if(typeof i=="string"?i=window.document.querySelector(i):i===!1&&(i=this.$_targetNodes[0].parentNode),!i)throw new Error("No container for popover: "+this.container);i.appendChild(this.$_popperNode),this.isMounted=!0},$_addEventListeners(){const i=t=>{this.isShown&&!this.$_hideInProgress||(t.usedByTooltip=!0,!this.$_preventShow&&this.show({event:t}))};this.$_registerTriggerListeners(this.$_targetNodes,gg,this.triggers,this.showTriggers,i),this.$_registerTriggerListeners([this.$_popperNode],gg,this.popperTriggers,this.popperShowTriggers,i);const e=t=>{t.usedByTooltip||this.hide({event:t})};this.$_registerTriggerListeners(this.$_targetNodes,vg,this.triggers,this.hideTriggers,e),this.$_registerTriggerListeners([this.$_popperNode],vg,this.popperTriggers,this.popperHideTriggers,e)},$_registerEventListeners(i,e,t){this.$_events.push({targetNodes:i,eventType:e,handler:t}),i.forEach(r=>r.addEventListener(e,t,Aa?{passive:!0}:void 0))},$_registerTriggerListeners(i,e,t,r,n){let s=t;r!=null&&(s=typeof r=="function"?r(s):r),s.forEach(o=>{const a=e[o];a&&this.$_registerEventListeners(i,a,n)})},$_removeEventListeners(i){const e=[];this.$_events.forEach(t=>{const{targetNodes:r,eventType:n,handler:s}=t;!i||i===n?r.forEach(o=>o.removeEventListener(n,s)):e.push(t)}),this.$_events=e},$_refreshListeners(){this.isDisposed||(this.$_removeEventListeners(),this.$_addEventListeners())},$_handleGlobalClose(i,e=!1){this.$_showFrameLocked||(this.hide({event:i}),i.closePopover?this.$emit("close-directive"):this.$emit("auto-hide"),e&&(this.$_preventShow=!0,setTimeout(()=>{this.$_preventShow=!1},300)))},$_detachPopperNode(){this.$_popperNode.parentNode&&this.$_popperNode.parentNode.removeChild(this.$_popperNode)},$_swapTargetAttrs(i,e){for(const t of this.$_targetNodes){const r=t.getAttribute(i);r&&(t.removeAttribute(i),t.setAttribute(e,r))}},$_applyAttrsToTarget(i){for(const e of this.$_targetNodes)for(const t in i){const r=i[t];r==null?e.removeAttribute(t):e.setAttribute(t,r)}},$_updateParentShownChildren(i){let e=this.parentPopper;for(;e;)i?e.shownChildren.add(this.randomId):(e.shownChildren.delete(this.randomId),e.pendingHide&&e.hide()),e=e.parentPopper},$_isAimingPopper(){const i=this.$_referenceNode.getBoundingClientRect();if(aa>=i.left&&aa<=i.right&&la>=i.top&&la<=i.bottom){const e=this.$_popperNode.getBoundingClientRect(),t=aa-Zr,r=la-Qr,n=e.left+e.width/2-Zr+(e.top+e.height/2)-Qr+e.width+e.height,s=Zr+t*n,o=Qr+r*n;return hl(Zr,Qr,s,o,e.left,e.top,e.left,e.bottom)||hl(Zr,Qr,s,o,e.left,e.top,e.right,e.top)||hl(Zr,Qr,s,o,e.right,e.top,e.right,e.bottom)||hl(Zr,Qr,s,o,e.left,e.bottom,e.right,e.bottom)}return!1}},render(){return this.$slots.default(this.slotData)}});if(typeof document<"u"&&typeof window<"u"){if($y){const i=Aa?{passive:!0,capture:!0}:!0;document.addEventListener("touchstart",e=>wg(e),i),document.addEventListener("touchend",e=>xg(e,!0),i)}else window.addEventListener("mousedown",i=>wg(i),!0),window.addEventListener("click",i=>xg(i,!1),!0);window.addEventListener("resize",eF)}function wg(i,e){for(let t=0;t<$i.length;t++){const r=$i[t];try{r.mouseDownContains=r.popperNode().contains(i.target)}catch{}}}function xg(i,e){ZO(i,e)}function ZO(i,e){const t={};for(let r=$i.length-1;r>=0;r--){const n=$i[r];try{const s=n.containsGlobalTarget=n.mouseDownContains||n.popperNode().contains(i.target);n.pendingHide=!1,requestAnimationFrame(()=>{if(n.pendingHide=!1,!t[n.randomId]&&Sg(n,s,i)){if(n.$_handleGlobalClose(i,e),!i.closeAllPopover&&i.closePopover&&s){let a=n.parentPopper;for(;a;)t[a.randomId]=!0,a=a.parentPopper;return}let o=n.parentPopper;for(;o&&Sg(o,o.containsGlobalTarget,i);)o.$_handleGlobalClose(i,e),o=o.parentPopper}})}catch{}}}function Sg(i,e,t){return t.closeAllPopover||t.closePopover&&e||QO(i,t)&&!e}function QO(i,e){if(typeof i.autoHide=="function"){const t=i.autoHide(e);return i.lastAutoHide=t,t}return i.autoHide}function eF(){for(let i=0;i<$i.length;i++)$i[i].$_computePosition()}let Zr=0,Qr=0,aa=0,la=0;typeof window<"u"&&window.addEventListener("mousemove",i=>{Zr=aa,Qr=la,aa=i.clientX,la=i.clientY},Aa?{passive:!0}:void 0);function hl(i,e,t,r,n,s,o,a){const l=((o-n)*(e-s)-(a-s)*(i-n))/((a-s)*(t-i)-(o-n)*(r-e)),c=((t-i)*(e-s)-(r-e)*(i-n))/((a-s)*(t-i)-(o-n)*(r-e));return l>=0&&l<=1&&c>=0&&c<=1}const tF={extends:By()},Of=(i,e)=>{const t=i.__vccOpts||i;for(const[r,n]of e)t[r]=n;return t};function iF(i,e,t,r,n,s){return P(),z("div",{ref:"reference",class:Se(["v-popper",{"v-popper--shown":i.slotData.isShown}])},[Xe(i.$slots,"default",yh(Oh(i.slotData)))],2)}const rF=Of(tF,[["render",iF]]);function nF(){var i=window.navigator.userAgent,e=i.indexOf("MSIE ");if(e>0)return parseInt(i.substring(e+5,i.indexOf(".",e)),10);var t=i.indexOf("Trident/");if(t>0){var r=i.indexOf("rv:");return parseInt(i.substring(r+3,i.indexOf(".",r)),10)}var n=i.indexOf("Edge/");return n>0?parseInt(i.substring(n+5,i.indexOf(".",n)),10):-1}let Zl;function dh(){dh.init||(dh.init=!0,Zl=nF()!==-1)}var fd={name:"ResizeObserver",props:{emitOnMount:{type:Boolean,default:!1},ignoreWidth:{type:Boolean,default:!1},ignoreHeight:{type:Boolean,default:!1}},emits:["notify"],mounted(){dh(),co(()=>{this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitOnMount&&this.emitSize()});const i=document.createElement("object");this._resizeObject=i,i.setAttribute("aria-hidden","true"),i.setAttribute("tabindex",-1),i.onload=this.addResizeHandlers,i.type="text/html",Zl&&this.$el.appendChild(i),i.data="about:blank",Zl||this.$el.appendChild(i)},beforeUnmount(){this.removeResizeHandlers()},methods:{compareAndNotify(){(!this.ignoreWidth&&this._w!==this.$el.offsetWidth||!this.ignoreHeight&&this._h!==this.$el.offsetHeight)&&(this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitSize())},emitSize(){this.$emit("notify",{width:this._w,height:this._h})},addResizeHandlers(){this._resizeObject.contentDocument.defaultView.addEventListener("resize",this.compareAndNotify),this.compareAndNotify()},removeResizeHandlers(){this._resizeObject&&this._resizeObject.onload&&(!Zl&&this._resizeObject.contentDocument&&this._resizeObject.contentDocument.defaultView.removeEventListener("resize",this.compareAndNotify),this.$el.removeChild(this._resizeObject),this._resizeObject.onload=null,this._resizeObject=null)}}};const sF=y1();cv("data-v-b329ee4c");const oF={class:"resize-observer",tabindex:"-1"};dv();const aF=sF((i,e,t,r,n,s)=>(P(),Ge("div",oF)));fd.render=aF;fd.__scopeId="data-v-b329ee4c";fd.__file="src/components/ResizeObserver.vue";const Vy=(i="theme")=>({computed:{themeClass(){return KO(this[i])}}}),lF=ht({name:"VPopperContent",components:{ResizeObserver:fd},mixins:[Vy()],props:{popperId:String,theme:String,shown:Boolean,mounted:Boolean,skipTransition:Boolean,autoHide:Boolean,handleResize:Boolean,classes:Object,result:Object},emits:["hide","resize"],methods:{toPx(i){return i!=null&&!isNaN(i)?`${i}px`:null}}}),cF=["id","aria-hidden","tabindex","data-popper-placement"],dF={ref:"inner",class:"v-popper__inner"},uF=v("div",{class:"v-popper__arrow-outer"},null,-1),hF=v("div",{class:"v-popper__arrow-inner"},null,-1),fF=[uF,hF];function pF(i,e,t,r,n,s){const o=st("ResizeObserver");return P(),z("div",{id:i.popperId,ref:"popover",class:Se(["v-popper__popper",[i.themeClass,i.classes.popperClass,{"v-popper__popper--shown":i.shown,"v-popper__popper--hidden":!i.shown,"v-popper__popper--show-from":i.classes.showFrom,"v-popper__popper--show-to":i.classes.showTo,"v-popper__popper--hide-from":i.classes.hideFrom,"v-popper__popper--hide-to":i.classes.hideTo,"v-popper__popper--skip-transition":i.skipTransition,"v-popper__popper--arrow-overflow":i.result&&i.result.arrow.overflow,"v-popper__popper--no-positioning":!i.result}]]),style:Ut(i.result?{position:i.result.strategy,transform:`translate3d(${Math.round(i.result.x)}px,${Math.round(i.result.y)}px,0)`}:void 0),"aria-hidden":i.shown?"false":"true",tabindex:i.autoHide?0:void 0,"data-popper-placement":i.result?i.result.placement:void 0,onKeyup:e[2]||(e[2]=qv(a=>i.autoHide&&i.$emit("hide"),["esc"]))},[v("div",{class:"v-popper__backdrop",onClick:e[0]||(e[0]=a=>i.autoHide&&i.$emit("hide"))}),v("div",{class:"v-popper__wrapper",style:Ut(i.result?{transformOrigin:i.result.transformOrigin}:void 0)},[v("div",dF,[i.mounted?(P(),z(be,{key:0},[v("div",null,[Xe(i.$slots,"default")]),i.handleResize?(P(),Ge(o,{key:0,onNotify:e[1]||(e[1]=a=>i.$emit("resize",a))})):Le("",!0)],64)):Le("",!0)],512),v("div",{ref:"arrow",class:"v-popper__arrow-container",style:Ut(i.result?{left:i.toPx(i.result.arrow.x),top:i.toPx(i.result.arrow.y)}:void 0)},fF,4)],4)],46,cF)}const Hy=Of(lF,[["render",pF]]),Uy={methods:{show(...i){return this.$refs.popper.show(...i)},hide(...i){return this.$refs.popper.hide(...i)},dispose(...i){return this.$refs.popper.dispose(...i)},onResize(...i){return this.$refs.popper.onResize(...i)}}};let uh=function(){};typeof window<"u"&&(uh=window.Element);const mF=ht({name:"VPopperWrapper",components:{Popper:rF,PopperContent:Hy},mixins:[Uy,Vy("finalTheme")],props:{theme:{type:String,default:null},referenceNode:{type:Function,default:null},shown:{type:Boolean,default:!1},showGroup:{type:String,default:null},ariaId:{default:null},disabled:{type:Boolean,default:void 0},positioningDisabled:{type:Boolean,default:void 0},placement:{type:String,default:void 0},delay:{type:[String,Number,Object],default:void 0},distance:{type:[Number,String],default:void 0},skidding:{type:[Number,String],default:void 0},triggers:{type:Array,default:void 0},showTriggers:{type:[Array,Function],default:void 0},hideTriggers:{type:[Array,Function],default:void 0},popperTriggers:{type:Array,default:void 0},popperShowTriggers:{type:[Array,Function],default:void 0},popperHideTriggers:{type:[Array,Function],default:void 0},container:{type:[String,Object,uh,Boolean],default:void 0},boundary:{type:[String,uh],default:void 0},strategy:{type:String,default:void 0},autoHide:{type:[Boolean,Function],default:void 0},handleResize:{type:Boolean,default:void 0},instantMove:{type:Boolean,default:void 0},eagerMount:{type:Boolean,default:void 0},popperClass:{type:[String,Array,Object],default:void 0},computeTransformOrigin:{type:Boolean,default:void 0},autoMinSize:{type:Boolean,default:void 0},autoSize:{type:[Boolean,String],default:void 0},autoMaxSize:{type:Boolean,default:void 0},autoBoundaryMaxSize:{type:Boolean,default:void 0},preventOverflow:{type:Boolean,default:void 0},overflowPadding:{type:[Number,String],default:void 0},arrowPadding:{type:[Number,String],default:void 0},arrowOverflow:{type:Boolean,default:void 0},flip:{type:Boolean,default:void 0},shift:{type:Boolean,default:void 0},shiftCrossAxis:{type:Boolean,default:void 0},noAutoFocus:{type:Boolean,default:void 0},disposeTimeout:{type:Number,default:void 0}},emits:{show:()=>!0,hide:()=>!0,"update:shown":i=>!0,"apply-show":()=>!0,"apply-hide":()=>!0,"close-group":()=>!0,"close-directive":()=>!0,"auto-hide":()=>!0,resize:()=>!0},computed:{finalTheme(){return this.theme??this.$options.vPopperTheme}},methods:{getTargetNodes(){return Array.from(this.$el.children).filter(i=>i!==this.$refs.popperContent.$el)}}});function gF(i,e,t,r,n,s){const o=st("PopperContent"),a=st("Popper");return P(),Ge(a,Pa({ref:"popper"},i.$props,{theme:i.finalTheme,"target-nodes":i.getTargetNodes,"popper-node":()=>i.$refs.popperContent.$el,class:[i.themeClass],onShow:e[0]||(e[0]=()=>i.$emit("show")),onHide:e[1]||(e[1]=()=>i.$emit("hide")),"onUpdate:shown":e[2]||(e[2]=l=>i.$emit("update:shown",l)),onApplyShow:e[3]||(e[3]=()=>i.$emit("apply-show")),onApplyHide:e[4]||(e[4]=()=>i.$emit("apply-hide")),onCloseGroup:e[5]||(e[5]=()=>i.$emit("close-group")),onCloseDirective:e[6]||(e[6]=()=>i.$emit("close-directive")),onAutoHide:e[7]||(e[7]=()=>i.$emit("auto-hide")),onResize:e[8]||(e[8]=()=>i.$emit("resize"))}),{default:K(({popperId:l,isShown:c,shouldMountContent:d,skipTransition:u,autoHide:h,show:p,hide:g,handleResize:f,onResize:m,classes:b,result:y})=>[Xe(i.$slots,"default",{shown:c,show:p,hide:g}),H(o,{ref:"popperContent","popper-id":l,theme:i.finalTheme,shown:c,mounted:d,"skip-transition":u,"auto-hide":h,"handle-resize":f,classes:b,result:y,onHide:g,onResize:m},{default:K(()=>[Xe(i.$slots,"popper",{shown:c,hide:g})]),_:2},1032,["popper-id","theme","shown","mounted","skip-transition","auto-hide","handle-resize","classes","result","onHide","onResize"])]),_:3},16,["theme","target-nodes","popper-node","class"])}const Ff=Of(mF,[["render",gF]]);({...Ff});({...Ff});const vF={...Ff,name:"VTooltip",vPopperTheme:"tooltip"};By();const bF=vF,yF={class:"flex items-start"},_F=ht({__name:"FwbTooltip",props:{placement:{default:"top"},theme:{default:"dark"},trigger:{default:"hover"}},setup(i){const e=i,t=ke(()=>({light:"tooltip-light",dark:"tooltip-dark"})[e.theme]);return(r,n)=>(P(),z("div",yF,[H(Ee(bF),{placement:r.placement,triggers:[r.trigger],theme:t.value,"auto-hide":""},{popper:K(()=>[Xe(r.$slots,"content")]),default:K(()=>[Xe(r.$slots,"trigger")]),_:3},8,["placement","triggers","theme"])]))}}),Vs={Success:"success",Error:"error"},wF="block mb-2 text-sm font-medium",xF="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",SF="cursor-not-allowed bg-gray-100",MF={lg:"p-4",md:"p-2.5 text-sm",sm:"p-2 text-sm"},EF="bg-green-50 border-green-500 dark:border-green-500 text-green-900 dark:text-green-400 placeholder-green-700 dark:placeholder-green-500 focus:ring-green-500 focus:border-green-500",kF="bg-red-50 border-red-500 text-red-900 placeholder-red-700 focus:ring-red-500 focus:border-red-500 dark:text-red-500 dark:placeholder-red-500 dark:border-red-500";function CF(i){const e=ke(()=>{const r=i.validationStatus.value,n=r===Vs.Success?EF:r===Vs.Error?kF:"";return gi(xF,n,MF[i.size.value],i.disabled.value?SF:"")}),t=ke(()=>{const r=i.validationStatus.value,n=r===Vs.Success?"text-green-700 dark:text-green-500":r===Vs.Error?"text-red-700 dark:text-red-500":"text-gray-900 dark:text-white";return gi(wF,n)});return{inputClasses:e,labelClasses:t}}const TF={class:"flex relative"},AF={key:0,class:"w-10 flex absolute inset-y-0 left-0 items-center pl-3 pointer-events-none overflow-hidden"},LF=["disabled","type","required"],DF={key:1,class:"absolute right-2.5 bottom-2.5"},PF={key:2,class:"mt-2 text-sm text-gray-500 dark:text-gray-400"},RF=ht({__name:"FwbInput",props:{disabled:{type:Boolean,default:!1},label:{default:""},modelValue:{default:""},required:{type:Boolean,default:!1},size:{default:"md"},type:{default:"text"},validationStatus:{default:void 0}},setup(i){const e=i,t=vy(e,"modelValue"),{inputClasses:r,labelClasses:n}=CF(yn(e)),s=ke(()=>gi("mt-2 text-sm",e.validationStatus===Vs.Success?"text-green-600 dark:text-green-500":"",e.validationStatus===Vs.Error?"text-red-600 dark:text-red-500":""));return(o,a)=>(P(),z("div",null,[o.label?(P(),z("label",{key:0,class:Se(Ee(n))},U(o.label),3)):Le("",!0),v("div",TF,[o.$slots.prefix?(P(),z("div",AF,[Xe(o.$slots,"prefix")])):Le("",!0),At(v("input",Pa(o.$attrs,{"onUpdate:modelValue":a[0]||(a[0]=l=>Ht(t)?t.value=l:null),disabled:o.disabled,type:o.type,required:o.required,class:[Ee(r),o.$slots.prefix?"pl-10":""]}),null,16,LF),[[Hw,Ee(t)]]),o.$slots.suffix?(P(),z("div",DF,[Xe(o.$slots,"suffix")])):Le("",!0)]),o.$slots.validationMessage?(P(),z("p",{key:1,class:Se(s.value)},[Xe(o.$slots,"validationMessage")],2)):Le("",!0),o.$slots.helper?(P(),z("p",PF,[Xe(o.$slots,"helper")])):Le("",!0)]))}}),IF="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700",OF="block mb-2 text-sm font-medium text-gray-900 dark:text-white",FF={lg:"h-3 range-lg",md:"h-2 range-md",sm:"h-1 range-sm"};function zF(i){const e=ke(()=>Ks(IF,FF[i.size.value])),t=ke(()=>OF);return{rangeClasses:e,labelClasses:t}}const NF={class:"flex flex-col"},$F=["step","min","max","disabled"],BF=ht({__name:"FwbRange",props:{disabled:{type:Boolean,default:!1},label:{default:"Range slider"},max:{default:100},min:{default:0},modelValue:{default:50},size:{default:"md"},steps:{default:1}},emits:["update:modelValue"],setup(i,{emit:e}){const t=i,r=e,n=ke({get(){return t.modelValue},set(a){r("update:modelValue",a)}}),{rangeClasses:s,labelClasses:o}=zF(yn(t));return(a,l)=>(P(),z("label",NF,[v("span",{class:Se(Ee(o))},U(a.label),3),At(v("input",{"onUpdate:modelValue":l[0]||(l[0]=c=>n.value=c),step:a.steps,min:a.min,max:a.max,disabled:a.disabled,type:"range",class:Se(Ee(s))},null,10,$F),[[qt,n.value]])]))}}),VF=od(BF,[["__scopeId","data-v-c4cfe3d4"]]),cn={Success:"success",Error:"error"},HF="block mb-2 text-sm font-medium",UF="w-full text-gray-900 bg-gray-50 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",jF="cursor-not-allowed bg-gray-100",WF="bg-transparent dark:bg-transparent border-b-2 border-gray-200 appearance-none dark:border-gray-700 focus:outline-none focus:ring-0 focus:border-gray-200 peer",GF={lg:"p-4",md:"p-2.5 text-sm",sm:"p-2 text-sm"},qF="bg-green-50 border-green-500 dark:border-green-500 text-green-900 dark:text-green-400 placeholder-green-700 dark:placeholder-green-500 focus:ring-green-500 focus:border-green-500",YF="bg-red-50 border-red-500 text-red-900 placeholder-red-700 focus:ring-red-500 focus:border-red-500 dark:text-red-500 dark:placeholder-red-500 dark:border-red-500";function XF(i){const e=ke(()=>{const r=i.validationStatus.value,n=r===cn.Success?qF:r===cn.Error?YF:"",s=r===cn.Success?"focus:border-green-500":r===cn.Error?"focus:border-red-500":"";return gi(UF,n,GF[i.size.value],i.disabled.value&&jF,i.underline.value?WF:"border border-gray-300 rounded-lg",i.underline.value&&s)}),t=ke(()=>{const r=i.validationStatus.value,n=r===cn.Success?"text-green-700 dark:text-green-500":r===cn.Error?"text-red-700 dark:text-red-500":"text-gray-900 dark:text-white";return gi(HF,n)});return{selectClasses:e,labelClasses:t}}const KF=["disabled"],JF={disabled:"",selected:"",value:""},ZF=["value"],QF={key:1,class:"mt-2 text-sm text-gray-500 dark:text-gray-400"},ez=ht({__name:"FwbSelect",props:{modelValue:{default:""},label:{default:""},options:{default:()=>[]},placeholder:{default:"Please select one"},disabled:{type:Boolean,default:!1},underline:{type:Boolean,default:!1},size:{default:"md"},validationStatus:{default:void 0}},emits:["update:modelValue"],setup(i,{emit:e}){const t=i,r=vy(t,"modelValue",e),{selectClasses:n,labelClasses:s}=XF(yn(t)),o=ke(()=>gi("mt-2 text-sm",t.validationStatus===cn.Success?"text-green-600 dark:text-green-500":"",t.validationStatus===cn.Error?"text-red-600 dark:text-red-500":""));return(a,l)=>(P(),z("div",null,[v("label",null,[a.label?(P(),z("span",{key:0,class:Se(Ee(s))},U(a.label),3)):Le("",!0),At(v("select",{"onUpdate:modelValue":l[0]||(l[0]=c=>Ht(r)?r.value=c:null),disabled:a.disabled,class:Se(Ee(n))},[v("option",JF,U(a.placeholder),1),(P(!0),z(be,null,Fe(a.options,(c,d)=>(P(),z("option",{key:d,value:c.value},U(c.name),9,ZF))),128))],10,KF),[[Wv,Ee(r)]])]),a.$slots.validationMessage?(P(),z("p",{key:0,class:Se(o.value)},[Xe(a.$slots,"validationMessage")],2)):Le("",!0),a.$slots.helper?(P(),z("p",QF,[Xe(a.$slots,"helper")])):Le("",!0)]))}}),tz="block w-full mb-4 border border-gray-200 rounded-lg bg-gray-50 dark:bg-gray-700 dark:border-gray-600",iz="block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-200 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",rz="block mb-2 text-sm font-medium text-gray-900 dark:text-white",nz="block py-2 px-3 border-gray-200 dark:border-gray-600";function sz(i){const e=ke(()=>Ks(iz,i?"bg-white dark:bg-gray-800 border-none":"border")),t=ke(()=>rz),r=ke(()=>i?tz:""),n=ke(()=>nz);return{textareaClasses:e,labelClasses:t,wrapperClasses:r,footerClasses:n}}const oz=["rows","placeholder"],az=ht({inheritAttrs:!1,__name:"FwbTextarea",props:{modelValue:{default:""},label:{default:"Your message"},rows:{default:4},custom:{type:Boolean,default:!1},placeholder:{default:"Write your message here..."}},emits:["update:modelValue"],setup(i,{emit:e}){const t=i,r=e,n=ke({get(){return t.modelValue},set(c){r("update:modelValue",c)}}),{textareaClasses:s,labelClasses:o,wrapperClasses:a,footerClasses:l}=sz(t.custom);return(c,d)=>(P(),z("label",null,[v("span",{class:Se(Ee(o))},U(c.label),3),v("span",{class:Se(Ee(a))},[At(v("textarea",Pa({"onUpdate:modelValue":d[0]||(d[0]=u=>n.value=u)},c.$attrs,{class:Ee(s),rows:c.rows,placeholder:c.placeholder}),null,16,oz),[[qt,n.value]]),c.$slots.footer?(P(),z("span",{key:0,class:Se(Ee(l))},[Xe(c.$slots,"footer")],2)):Le("",!0)],2)]))}}),lz="w-fit relative inline-flex items-center cursor-pointer",cz='bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[""] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600',dz="ml-3 text-sm font-medium text-gray-900 dark:text-gray-300",uz={lg:"w-14 h-7 after:top-0.5 after:left-[4px] after:h-6 after:w-6",md:"w-11 h-6 after:top-[2px] after:left-[2px] after:h-5 after:w-5",sm:"w-9 h-5 after:top-[2px] after:left-[2px] after:h-4 after:w-4"},hz={red:"peer-focus:ring-red-300 dark:peer-focus:ring-red-800 peer-checked:bg-red-600",green:"peer-focus:ring-green-300 dark:peer-focus:ring-green-800 peer-checked:bg-green-600",purple:"peer-focus:ring-purple-300 dark:peer-focus:ring-purple-800 peer-checked:bg-purple-600",yellow:"peer-focus:ring-yellow-300 dark:peer-focus:ring-yellow-800 peer-checked:bg-yellow-400",teal:"peer-focus:ring-teal-300 dark:peer-focus:ring-teal-800 peer-checked:bg-teal-600",orange:"peer-focus:ring-orange-300 dark:peer-focus:ring-orange-800 peer-checked:bg-orange-500"};function fz(i){const e=ke(()=>lz),t=ke(()=>cz),r=ke(()=>uz[i.size.value]),n=ke(()=>hz[i.color.value]),s=ke(()=>dz);return{labelClasses:e,toggleSize:r,toggleClasses:t,toggleColor:n,toggleBallClasses:s}}const pz=["disabled"],mz=ht({__name:"FwbToggle",props:{color:{default:""},disabled:{type:Boolean,default:!1},label:{default:""},modelValue:{type:Boolean,default:!1},size:{default:"md"}},emits:["update:modelValue"],setup(i,{emit:e}){const t=i,r=e,n=ke({get(){return t.modelValue},set(d){r("update:modelValue",d)}}),{labelClasses:s,toggleSize:o,toggleClasses:a,toggleColor:l,toggleBallClasses:c}=fz(yn(t));return(d,u)=>(P(),z("label",{class:Se(Ee(s))},[At(v("input",{"onUpdate:modelValue":u[0]||(u[0]=h=>n.value=h),disabled:d.disabled,class:"sr-only peer",type:"checkbox"},null,8,pz),[[$h,n.value]]),v("span",{class:Se([Ee(a),Ee(o),Ee(l)])},null,2),v("span",{class:Se(Ee(c))},U(d.label),3)],2))}}),gz=["href"],vz=ht({__name:"FwbA",props:{href:{default:""},color:{default:"text-primary-600 dark:text-primary-500"}},setup(i){return(e,t)=>(P(),z("a",{href:e.href,class:Se([e.color,"inline-flex items-center hover:underline"])},[Xe(e.$slots,"default")],10,gz))}});var bz=Object.defineProperty,yz=(i,e,t)=>e in i?bz(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,_z=(i,e,t)=>(yz(i,e+"",t),t);/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const zf="143",Er="srgb",Kn="srgb-linear",Mg="300 es";class mo{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const n=r.indexOf(t);n!==-1&&r.splice(n,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const t=this._listeners[e.type];if(t!==void 0){e.target=this;const r=t.slice(0);for(let n=0,s=r.length;n<s;n++)r[n].call(this,e);e.target=null}}}const Wt=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],Yd=Math.PI/180,hh=180/Math.PI;function Va(){const i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(Wt[i&255]+Wt[i>>8&255]+Wt[i>>16&255]+Wt[i>>24&255]+"-"+Wt[e&255]+Wt[e>>8&255]+"-"+Wt[e>>16&15|64]+Wt[e>>24&255]+"-"+Wt[t&63|128]+Wt[t>>8&255]+"-"+Wt[t>>16&255]+Wt[t>>24&255]+Wt[r&255]+Wt[r>>8&255]+Wt[r>>16&255]+Wt[r>>24&255]).toLowerCase()}function hi(i,e,t){return Math.max(e,Math.min(t,i))}function wz(i,e){return(i%e+e)%e}function Xd(i,e,t){return(1-t)*i+t*e}function Eg(i){return(i&i-1)===0&&i!==0}function fh(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}class at{constructor(e=0,t=0){at.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,r=this.y,n=e.elements;return this.x=n[0]*t+n[3]*r+n[6],this.y=n[1]*t+n[4]*r+n[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const r=Math.cos(t),n=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*r-o*n+e.x,this.y=s*n+o*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Ti{constructor(){Ti.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,r,n,s,o,a,l,c){const d=this.elements;return d[0]=e,d[1]=n,d[2]=a,d[3]=t,d[4]=s,d[5]=l,d[6]=r,d[7]=o,d[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,n=t.elements,s=this.elements,o=r[0],a=r[3],l=r[6],c=r[1],d=r[4],u=r[7],h=r[2],p=r[5],g=r[8],f=n[0],m=n[3],b=n[6],y=n[1],w=n[4],_=n[7],M=n[2],S=n[5],A=n[8];return s[0]=o*f+a*y+l*M,s[3]=o*m+a*w+l*S,s[6]=o*b+a*_+l*A,s[1]=c*f+d*y+u*M,s[4]=c*m+d*w+u*S,s[7]=c*b+d*_+u*A,s[2]=h*f+p*y+g*M,s[5]=h*m+p*w+g*S,s[8]=h*b+p*_+g*A,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],n=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],d=e[8];return t*o*d-t*a*c-r*s*d+r*a*l+n*s*c-n*o*l}invert(){const e=this.elements,t=e[0],r=e[1],n=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],d=e[8],u=d*o-a*c,h=a*l-d*s,p=c*s-o*l,g=t*u+r*h+n*p;if(g===0)return this.set(0,0,0,0,0,0,0,0,0);const f=1/g;return e[0]=u*f,e[1]=(n*c-d*r)*f,e[2]=(a*r-n*o)*f,e[3]=h*f,e[4]=(d*t-n*l)*f,e[5]=(n*s-a*t)*f,e[6]=p*f,e[7]=(r*l-c*t)*f,e[8]=(o*t-r*s)*f,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,n,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(r*l,r*c,-r*(l*o+c*a)+o+e,-n*c,n*l,-n*(-c*o+l*a)+a+t,0,0,1),this}scale(e,t){const r=this.elements;return r[0]*=e,r[3]*=e,r[6]*=e,r[1]*=t,r[4]*=t,r[7]*=t,this}rotate(e){const t=Math.cos(e),r=Math.sin(e),n=this.elements,s=n[0],o=n[3],a=n[6],l=n[1],c=n[4],d=n[7];return n[0]=t*s+r*l,n[3]=t*o+r*c,n[6]=t*a+r*d,n[1]=-r*s+t*l,n[4]=-r*o+t*c,n[7]=-r*a+t*d,this}translate(e,t){const r=this.elements;return r[0]+=e*r[2],r[3]+=e*r[5],r[6]+=e*r[8],r[1]+=t*r[2],r[4]+=t*r[5],r[7]+=t*r[8],this}equals(e){const t=this.elements,r=e.elements;for(let n=0;n<9;n++)if(t[n]!==r[n])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}function jy(i){for(let e=i.length-1;e>=0;--e)if(i[e]>65535)return!0;return!1}function Vc(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function ts(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function Ql(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}const Kd={[Er]:{[Kn]:ts},[Kn]:{[Er]:Ql}},Ii={legacyMode:!0,get workingColorSpace(){return Kn},set workingColorSpace(i){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(i,e,t){if(this.legacyMode||e===t||!e||!t)return i;if(Kd[e]&&Kd[e][t]!==void 0){const r=Kd[e][t];return i.r=r(i.r),i.g=r(i.g),i.b=r(i.b),i}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(i,e){return this.convert(i,this.workingColorSpace,e)},toWorkingColorSpace:function(i,e){return this.convert(i,e,this.workingColorSpace)}},Wy={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Rt={r:0,g:0,b:0},Oi={h:0,s:0,l:0},fl={h:0,s:0,l:0};function Jd(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*6*(2/3-t):i}function pl(i,e){return e.r=i.r,e.g=i.g,e.b=i.b,e}class ot{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,t===void 0&&r===void 0?this.set(e):this.setRGB(e,t,r)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Er){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Ii.toWorkingColorSpace(this,t),this}setRGB(e,t,r,n=Kn){return this.r=e,this.g=t,this.b=r,Ii.toWorkingColorSpace(this,n),this}setHSL(e,t,r,n=Kn){if(e=wz(e,1),t=hi(t,0,1),r=hi(r,0,1),t===0)this.r=this.g=this.b=r;else{const s=r<=.5?r*(1+t):r+t-r*t,o=2*r-s;this.r=Jd(o,s,e+1/3),this.g=Jd(o,s,e),this.b=Jd(o,s,e-1/3)}return Ii.toWorkingColorSpace(this,n),this}setStyle(e,t=Er){function r(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let s;const o=n[1],a=n[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(s[1],10))/255,this.g=Math.min(255,parseInt(s[2],10))/255,this.b=Math.min(255,parseInt(s[3],10))/255,Ii.toWorkingColorSpace(this,t),r(s[4]),this;if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(s[1],10))/100,this.g=Math.min(100,parseInt(s[2],10))/100,this.b=Math.min(100,parseInt(s[3],10))/100,Ii.toWorkingColorSpace(this,t),r(s[4]),this;break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){const l=parseFloat(s[1])/360,c=parseInt(s[2],10)/100,d=parseInt(s[3],10)/100;return r(s[4]),this.setHSL(l,c,d,t)}break}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=n[1],o=s.length;if(o===3)return this.r=parseInt(s.charAt(0)+s.charAt(0),16)/255,this.g=parseInt(s.charAt(1)+s.charAt(1),16)/255,this.b=parseInt(s.charAt(2)+s.charAt(2),16)/255,Ii.toWorkingColorSpace(this,t),this;if(o===6)return this.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,this.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,this.b=parseInt(s.charAt(4)+s.charAt(5),16)/255,Ii.toWorkingColorSpace(this,t),this}return e&&e.length>0?this.setColorName(e,t):this}setColorName(e,t=Er){const r=Wy[e.toLowerCase()];return r!==void 0?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=ts(e.r),this.g=ts(e.g),this.b=ts(e.b),this}copyLinearToSRGB(e){return this.r=Ql(e.r),this.g=Ql(e.g),this.b=Ql(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Er){return Ii.fromWorkingColorSpace(pl(this,Rt),e),hi(Rt.r*255,0,255)<<16^hi(Rt.g*255,0,255)<<8^hi(Rt.b*255,0,255)<<0}getHexString(e=Er){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Kn){Ii.fromWorkingColorSpace(pl(this,Rt),t);const r=Rt.r,n=Rt.g,s=Rt.b,o=Math.max(r,n,s),a=Math.min(r,n,s);let l,c;const d=(a+o)/2;if(a===o)l=0,c=0;else{const u=o-a;switch(c=d<=.5?u/(o+a):u/(2-o-a),o){case r:l=(n-s)/u+(n<s?6:0);break;case n:l=(s-r)/u+2;break;case s:l=(r-n)/u+4;break}l/=6}return e.h=l,e.s=c,e.l=d,e}getRGB(e,t=Kn){return Ii.fromWorkingColorSpace(pl(this,Rt),t),e.r=Rt.r,e.g=Rt.g,e.b=Rt.b,e}getStyle(e=Er){return Ii.fromWorkingColorSpace(pl(this,Rt),e),e!==Er?`color(${e} ${Rt.r} ${Rt.g} ${Rt.b})`:`rgb(${Rt.r*255|0},${Rt.g*255|0},${Rt.b*255|0})`}offsetHSL(e,t,r){return this.getHSL(Oi),Oi.h+=e,Oi.s+=t,Oi.l+=r,this.setHSL(Oi.h,Oi.s,Oi.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(Oi),e.getHSL(fl);const r=Xd(Oi.h,fl.h,t),n=Xd(Oi.s,fl.s,t),s=Xd(Oi.l,fl.l,t);return this.setHSL(r,n,s),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),e.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}ot.NAMES=Wy;let Ss;class Gy{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Ss===void 0&&(Ss=Vc("canvas")),Ss.width=e.width,Ss.height=e.height;const r=Ss.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=Ss}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Vc("canvas");t.width=e.width,t.height=e.height;const r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const n=r.getImageData(0,0,e.width,e.height),s=n.data;for(let o=0;o<s.length;o++)s[o]=ts(s[o]/255)*255;return r.putImageData(n,0,0),t}else if(e.data){const t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(ts(t[r]/255)*255):t[r]=ts(t[r]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class qy{constructor(e=null){this.isSource=!0,this.uuid=Va(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},n=this.data;if(n!==null){let s;if(Array.isArray(n)){s=[];for(let o=0,a=n.length;o<a;o++)n[o].isDataTexture?s.push(Zd(n[o].image)):s.push(Zd(n[o]))}else s=Zd(n);r.url=s}return t||(e.images[this.uuid]=r),r}}function Zd(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?Gy.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let xz=0;class vi extends mo{constructor(e=vi.DEFAULT_IMAGE,t=vi.DEFAULT_MAPPING,r=1001,n=1001,s=1006,o=1008,a=1023,l=1009,c=1,d=3e3){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:xz++}),this.uuid=Va(),this.name="",this.source=new qy(e),this.mipmaps=[],this.mapping=t,this.wrapS=r,this.wrapT=n,this.magFilter=s,this.minFilter=o,this.anisotropy=c,this.format=a,this.internalFormat=null,this.type=l,this.offset=new at(0,0),this.repeat=new at(1,1),this.center=new at(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ti,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=d,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return JSON.stringify(this.userData)!=="{}"&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==300)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case 1e3:e.x=e.x-Math.floor(e.x);break;case 1001:e.x=e.x<0?0:1;break;case 1002:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case 1e3:e.y=e.y-Math.floor(e.y);break;case 1001:e.y=e.y<0?0:1;break;case 1002:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}}vi.DEFAULT_IMAGE=null;vi.DEFAULT_MAPPING=300;class Ot{constructor(e=0,t=0,r=0,n=1){Ot.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=n}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,n){return this.x=e,this.y=t,this.z=r,this.w=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,r=this.y,n=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*r+o[8]*n+o[12]*s,this.y=o[1]*t+o[5]*r+o[9]*n+o[13]*s,this.z=o[2]*t+o[6]*r+o[10]*n+o[14]*s,this.w=o[3]*t+o[7]*r+o[11]*n+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,n,s;const o=e.elements,a=o[0],l=o[4],c=o[8],d=o[1],u=o[5],h=o[9],p=o[2],g=o[6],f=o[10];if(Math.abs(l-d)<.01&&Math.abs(c-p)<.01&&Math.abs(h-g)<.01){if(Math.abs(l+d)<.1&&Math.abs(c+p)<.1&&Math.abs(h+g)<.1&&Math.abs(a+u+f-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const b=(a+1)/2,y=(u+1)/2,w=(f+1)/2,_=(l+d)/4,M=(c+p)/4,S=(h+g)/4;return b>y&&b>w?b<.01?(r=0,n=.707106781,s=.707106781):(r=Math.sqrt(b),n=_/r,s=M/r):y>w?y<.01?(r=.707106781,n=0,s=.707106781):(n=Math.sqrt(y),r=_/n,s=S/n):w<.01?(r=.707106781,n=.707106781,s=0):(s=Math.sqrt(w),r=M/s,n=S/s),this.set(r,n,s,t),this}let m=Math.sqrt((g-h)*(g-h)+(c-p)*(c-p)+(d-l)*(d-l));return Math.abs(m)<.001&&(m=1),this.x=(g-h)/m,this.y=(c-p)/m,this.z=(d-l)/m,this.w=Math.acos((a+u+f-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class ds extends mo{constructor(e,t,r={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Ot(0,0,e,t),this.scissorTest=!1,this.viewport=new Ot(0,0,e,t);const n={width:e,height:t,depth:1};this.texture=new vi(n,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=r.generateMipmaps!==void 0?r.generateMipmaps:!1,this.texture.internalFormat=r.internalFormat!==void 0?r.internalFormat:null,this.texture.minFilter=r.minFilter!==void 0?r.minFilter:1006,this.depthBuffer=r.depthBuffer!==void 0?r.depthBuffer:!0,this.stencilBuffer=r.stencilBuffer!==void 0?r.stencilBuffer:!1,this.depthTexture=r.depthTexture!==void 0?r.depthTexture:null,this.samples=r.samples!==void 0?r.samples:0}setSize(e,t,r=1){(this.width!==e||this.height!==t||this.depth!==r)&&(this.width=e,this.height=t,this.depth=r,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new qy(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Yy extends vi{constructor(e=null,t=1,r=1,n=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:n},this.magFilter=1003,this.minFilter=1003,this.wrapR=1001,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Sz extends vi{constructor(e=null,t=1,r=1,n=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:n},this.magFilter=1003,this.minFilter=1003,this.wrapR=1001,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Ha{constructor(e=0,t=0,r=0,n=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=n}static slerpFlat(e,t,r,n,s,o,a){let l=r[n+0],c=r[n+1],d=r[n+2],u=r[n+3];const h=s[o+0],p=s[o+1],g=s[o+2],f=s[o+3];if(a===0){e[t+0]=l,e[t+1]=c,e[t+2]=d,e[t+3]=u;return}if(a===1){e[t+0]=h,e[t+1]=p,e[t+2]=g,e[t+3]=f;return}if(u!==f||l!==h||c!==p||d!==g){let m=1-a;const b=l*h+c*p+d*g+u*f,y=b>=0?1:-1,w=1-b*b;if(w>Number.EPSILON){const M=Math.sqrt(w),S=Math.atan2(M,b*y);m=Math.sin(m*S)/M,a=Math.sin(a*S)/M}const _=a*y;if(l=l*m+h*_,c=c*m+p*_,d=d*m+g*_,u=u*m+f*_,m===1-a){const M=1/Math.sqrt(l*l+c*c+d*d+u*u);l*=M,c*=M,d*=M,u*=M}}e[t]=l,e[t+1]=c,e[t+2]=d,e[t+3]=u}static multiplyQuaternionsFlat(e,t,r,n,s,o){const a=r[n],l=r[n+1],c=r[n+2],d=r[n+3],u=s[o],h=s[o+1],p=s[o+2],g=s[o+3];return e[t]=a*g+d*u+l*p-c*h,e[t+1]=l*g+d*h+c*u-a*p,e[t+2]=c*g+d*p+a*h-l*u,e[t+3]=d*g-a*u-l*h-c*p,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!(e&&e.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const r=e._x,n=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(r/2),d=a(n/2),u=a(s/2),h=l(r/2),p=l(n/2),g=l(s/2);switch(o){case"XYZ":this._x=h*d*u+c*p*g,this._y=c*p*u-h*d*g,this._z=c*d*g+h*p*u,this._w=c*d*u-h*p*g;break;case"YXZ":this._x=h*d*u+c*p*g,this._y=c*p*u-h*d*g,this._z=c*d*g-h*p*u,this._w=c*d*u+h*p*g;break;case"ZXY":this._x=h*d*u-c*p*g,this._y=c*p*u+h*d*g,this._z=c*d*g+h*p*u,this._w=c*d*u-h*p*g;break;case"ZYX":this._x=h*d*u-c*p*g,this._y=c*p*u+h*d*g,this._z=c*d*g-h*p*u,this._w=c*d*u+h*p*g;break;case"YZX":this._x=h*d*u+c*p*g,this._y=c*p*u+h*d*g,this._z=c*d*g-h*p*u,this._w=c*d*u-h*p*g;break;case"XZY":this._x=h*d*u-c*p*g,this._y=c*p*u-h*d*g,this._z=c*d*g+h*p*u,this._w=c*d*u+h*p*g;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,n=Math.sin(r);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],n=t[4],s=t[8],o=t[1],a=t[5],l=t[9],c=t[2],d=t[6],u=t[10],h=r+a+u;if(h>0){const p=.5/Math.sqrt(h+1);this._w=.25/p,this._x=(d-l)*p,this._y=(s-c)*p,this._z=(o-n)*p}else if(r>a&&r>u){const p=2*Math.sqrt(1+r-a-u);this._w=(d-l)/p,this._x=.25*p,this._y=(n+o)/p,this._z=(s+c)/p}else if(a>u){const p=2*Math.sqrt(1+a-r-u);this._w=(s-c)/p,this._x=(n+o)/p,this._y=.25*p,this._z=(l+d)/p}else{const p=2*Math.sqrt(1+u-r-a);this._w=(o-n)/p,this._x=(s+c)/p,this._y=(l+d)/p,this._z=.25*p}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(hi(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(r===0)return this;const n=Math.min(1,t/r);return this.slerp(e,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,n=e._y,s=e._z,o=e._w,a=t._x,l=t._y,c=t._z,d=t._w;return this._x=r*d+o*a+n*c-s*l,this._y=n*d+o*l+s*a-r*c,this._z=s*d+o*c+r*l-n*a,this._w=o*d-r*a-n*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const r=this._x,n=this._y,s=this._z,o=this._w;let a=o*e._w+r*e._x+n*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=r,this._y=n,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const p=1-t;return this._w=p*o+t*this._w,this._x=p*r+t*this._x,this._y=p*n+t*this._y,this._z=p*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(l),d=Math.atan2(c,a),u=Math.sin((1-t)*d)/c,h=Math.sin(t*d)/c;return this._w=o*u+this._w*h,this._x=r*u+this._x*h,this._y=n*u+this._y*h,this._z=s*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){const e=Math.random(),t=Math.sqrt(1-e),r=Math.sqrt(e),n=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(n),r*Math.sin(s),r*Math.cos(s),t*Math.sin(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class J{constructor(e=0,t=0,r=0){J.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(kg.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(kg.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,n=this.z,s=e.elements;return this.x=s[0]*t+s[3]*r+s[6]*n,this.y=s[1]*t+s[4]*r+s[7]*n,this.z=s[2]*t+s[5]*r+s[8]*n,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,n=this.z,s=e.elements,o=1/(s[3]*t+s[7]*r+s[11]*n+s[15]);return this.x=(s[0]*t+s[4]*r+s[8]*n+s[12])*o,this.y=(s[1]*t+s[5]*r+s[9]*n+s[13])*o,this.z=(s[2]*t+s[6]*r+s[10]*n+s[14])*o,this}applyQuaternion(e){const t=this.x,r=this.y,n=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=l*t+o*n-a*r,d=l*r+a*t-s*n,u=l*n+s*r-o*t,h=-s*t-o*r-a*n;return this.x=c*l+h*-s+d*-a-u*-o,this.y=d*l+h*-o+u*-s-c*-a,this.z=u*l+h*-a+c*-o-d*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,n=this.z,s=e.elements;return this.x=s[0]*t+s[4]*r+s[8]*n,this.y=s[1]*t+s[5]*r+s[9]*n,this.z=s[2]*t+s[6]*r+s[10]*n,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,n=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=n*l-s*a,this.y=s*o-r*l,this.z=r*a-n*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return Qd.copy(this).projectOnVector(e),this.sub(Qd)}reflect(e){return this.sub(Qd.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(hi(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return t*t+r*r+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const n=Math.sin(t)*e;return this.x=n*Math.sin(r),this.y=Math.cos(t)*e,this.z=n*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=n,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(t),this.y=r*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Qd=new J,kg=new Ha;class Ua{constructor(e=new J(1/0,1/0,1/0),t=new J(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,r=1/0,n=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,c=e.length;l<c;l+=3){const d=e[l],u=e[l+1],h=e[l+2];d<t&&(t=d),u<r&&(r=u),h<n&&(n=h),d>s&&(s=d),u>o&&(o=u),h>a&&(a=h)}return this.min.set(t,r,n),this.max.set(s,o,a),this}setFromBufferAttribute(e){let t=1/0,r=1/0,n=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,c=e.count;l<c;l++){const d=e.getX(l),u=e.getY(l),h=e.getZ(l);d<t&&(t=d),u<r&&(r=u),h<n&&(n=h),d>s&&(s=d),u>o&&(o=u),h>a&&(a=h)}return this.min.set(t,r,n),this.max.set(s,o,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=In.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(r!==void 0)if(t&&r.attributes!=null&&r.attributes.position!==void 0){const s=r.attributes.position;for(let o=0,a=s.count;o<a;o++)In.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(In)}else r.boundingBox===null&&r.computeBoundingBox(),eu.copy(r.boundingBox),eu.applyMatrix4(e.matrixWorld),this.union(eu);const n=e.children;for(let s=0,o=n.length;s<o;s++)this.expandByObject(n[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,In),In.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Do),ml.subVectors(this.max,Do),Ms.subVectors(e.a,Do),Es.subVectors(e.b,Do),ks.subVectors(e.c,Do),Ur.subVectors(Es,Ms),jr.subVectors(ks,Es),On.subVectors(Ms,ks);let t=[0,-Ur.z,Ur.y,0,-jr.z,jr.y,0,-On.z,On.y,Ur.z,0,-Ur.x,jr.z,0,-jr.x,On.z,0,-On.x,-Ur.y,Ur.x,0,-jr.y,jr.x,0,-On.y,On.x,0];return!tu(t,Ms,Es,ks,ml)||(t=[1,0,0,0,1,0,0,0,1],!tu(t,Ms,Es,ks,ml))?!1:(gl.crossVectors(Ur,jr),t=[gl.x,gl.y,gl.z],tu(t,Ms,Es,ks,ml))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return In.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=this.getSize(In).length()*.5,e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(fr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),fr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),fr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),fr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),fr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),fr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),fr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),fr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(fr),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const fr=[new J,new J,new J,new J,new J,new J,new J,new J],In=new J,eu=new Ua,Ms=new J,Es=new J,ks=new J,Ur=new J,jr=new J,On=new J,Do=new J,ml=new J,gl=new J,Fn=new J;function tu(i,e,t,r,n){for(let s=0,o=i.length-3;s<=o;s+=3){Fn.fromArray(i,s);const a=n.x*Math.abs(Fn.x)+n.y*Math.abs(Fn.y)+n.z*Math.abs(Fn.z),l=e.dot(Fn),c=t.dot(Fn),d=r.dot(Fn);if(Math.max(-Math.max(l,c,d),Math.min(l,c,d))>a)return!1}return!0}const Mz=new Ua,Cg=new J,vl=new J,iu=new J;class La{constructor(e=new J,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const r=this.center;t!==void 0?r.copy(t):Mz.setFromPoints(e).getCenter(r);let n=0;for(let s=0,o=e.length;s<o;s++)n=Math.max(n,r.distanceToSquared(e[s]));return this.radius=Math.sqrt(n),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){iu.subVectors(e,this.center);const t=iu.lengthSq();if(t>this.radius*this.radius){const r=Math.sqrt(t),n=(r-this.radius)*.5;this.center.add(iu.multiplyScalar(n/r)),this.radius+=n}return this}union(e){return this.center.equals(e.center)===!0?vl.set(0,0,1).multiplyScalar(e.radius):vl.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(Cg.copy(e.center).add(vl)),this.expandByPoint(Cg.copy(e.center).sub(vl)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const pr=new J,ru=new J,bl=new J,Wr=new J,nu=new J,yl=new J,su=new J;class Ez{constructor(e=new J,t=new J(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,pr)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(r).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=pr.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(pr.copy(this.direction).multiplyScalar(t).add(this.origin),pr.distanceToSquared(e))}distanceSqToSegment(e,t,r,n){ru.copy(e).add(t).multiplyScalar(.5),bl.copy(t).sub(e).normalize(),Wr.copy(this.origin).sub(ru);const s=e.distanceTo(t)*.5,o=-this.direction.dot(bl),a=Wr.dot(this.direction),l=-Wr.dot(bl),c=Wr.lengthSq(),d=Math.abs(1-o*o);let u,h,p,g;if(d>0)if(u=o*l-a,h=o*a-l,g=s*d,u>=0)if(h>=-g)if(h<=g){const f=1/d;u*=f,h*=f,p=u*(u+o*h+2*a)+h*(o*u+h+2*l)+c}else h=s,u=Math.max(0,-(o*h+a)),p=-u*u+h*(h+2*l)+c;else h=-s,u=Math.max(0,-(o*h+a)),p=-u*u+h*(h+2*l)+c;else h<=-g?(u=Math.max(0,-(-o*s+a)),h=u>0?-s:Math.min(Math.max(-s,-l),s),p=-u*u+h*(h+2*l)+c):h<=g?(u=0,h=Math.min(Math.max(-s,-l),s),p=h*(h+2*l)+c):(u=Math.max(0,-(o*s+a)),h=u>0?s:Math.min(Math.max(-s,-l),s),p=-u*u+h*(h+2*l)+c);else h=o>0?-s:s,u=Math.max(0,-(o*h+a)),p=-u*u+h*(h+2*l)+c;return r&&r.copy(this.direction).multiplyScalar(u).add(this.origin),n&&n.copy(bl).multiplyScalar(h).add(ru),p}intersectSphere(e,t){pr.subVectors(e.center,this.origin);const r=pr.dot(this.direction),n=pr.dot(pr)-r*r,s=e.radius*e.radius;if(n>s)return null;const o=Math.sqrt(s-n),a=r-o,l=r+o;return a<0&&l<0?null:a<0?this.at(l,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){const r=this.distanceToPlane(e);return r===null?null:this.at(r,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,n,s,o,a,l;const c=1/this.direction.x,d=1/this.direction.y,u=1/this.direction.z,h=this.origin;return c>=0?(r=(e.min.x-h.x)*c,n=(e.max.x-h.x)*c):(r=(e.max.x-h.x)*c,n=(e.min.x-h.x)*c),d>=0?(s=(e.min.y-h.y)*d,o=(e.max.y-h.y)*d):(s=(e.max.y-h.y)*d,o=(e.min.y-h.y)*d),r>o||s>n||((s>r||r!==r)&&(r=s),(o<n||n!==n)&&(n=o),u>=0?(a=(e.min.z-h.z)*u,l=(e.max.z-h.z)*u):(a=(e.max.z-h.z)*u,l=(e.min.z-h.z)*u),r>l||a>n)||((a>r||r!==r)&&(r=a),(l<n||n!==n)&&(n=l),n<0)?null:this.at(r>=0?r:n,t)}intersectsBox(e){return this.intersectBox(e,pr)!==null}intersectTriangle(e,t,r,n,s){nu.subVectors(t,e),yl.subVectors(r,e),su.crossVectors(nu,yl);let o=this.direction.dot(su),a;if(o>0){if(n)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Wr.subVectors(this.origin,e);const l=a*this.direction.dot(yl.crossVectors(Wr,yl));if(l<0)return null;const c=a*this.direction.dot(nu.cross(Wr));if(c<0||l+c>o)return null;const d=-a*Wr.dot(su);return d<0?null:this.at(d/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Ft{constructor(){Ft.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,r,n,s,o,a,l,c,d,u,h,p,g,f,m){const b=this.elements;return b[0]=e,b[4]=t,b[8]=r,b[12]=n,b[1]=s,b[5]=o,b[9]=a,b[13]=l,b[2]=c,b[6]=d,b[10]=u,b[14]=h,b[3]=p,b[7]=g,b[11]=f,b[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Ft().fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,r=e.elements,n=1/Cs.setFromMatrixColumn(e,0).length(),s=1/Cs.setFromMatrixColumn(e,1).length(),o=1/Cs.setFromMatrixColumn(e,2).length();return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=0,t[4]=r[4]*s,t[5]=r[5]*s,t[6]=r[6]*s,t[7]=0,t[8]=r[8]*o,t[9]=r[9]*o,t[10]=r[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,r=e.x,n=e.y,s=e.z,o=Math.cos(r),a=Math.sin(r),l=Math.cos(n),c=Math.sin(n),d=Math.cos(s),u=Math.sin(s);if(e.order==="XYZ"){const h=o*d,p=o*u,g=a*d,f=a*u;t[0]=l*d,t[4]=-l*u,t[8]=c,t[1]=p+g*c,t[5]=h-f*c,t[9]=-a*l,t[2]=f-h*c,t[6]=g+p*c,t[10]=o*l}else if(e.order==="YXZ"){const h=l*d,p=l*u,g=c*d,f=c*u;t[0]=h+f*a,t[4]=g*a-p,t[8]=o*c,t[1]=o*u,t[5]=o*d,t[9]=-a,t[2]=p*a-g,t[6]=f+h*a,t[10]=o*l}else if(e.order==="ZXY"){const h=l*d,p=l*u,g=c*d,f=c*u;t[0]=h-f*a,t[4]=-o*u,t[8]=g+p*a,t[1]=p+g*a,t[5]=o*d,t[9]=f-h*a,t[2]=-o*c,t[6]=a,t[10]=o*l}else if(e.order==="ZYX"){const h=o*d,p=o*u,g=a*d,f=a*u;t[0]=l*d,t[4]=g*c-p,t[8]=h*c+f,t[1]=l*u,t[5]=f*c+h,t[9]=p*c-g,t[2]=-c,t[6]=a*l,t[10]=o*l}else if(e.order==="YZX"){const h=o*l,p=o*c,g=a*l,f=a*c;t[0]=l*d,t[4]=f-h*u,t[8]=g*u+p,t[1]=u,t[5]=o*d,t[9]=-a*d,t[2]=-c*d,t[6]=p*u+g,t[10]=h-f*u}else if(e.order==="XZY"){const h=o*l,p=o*c,g=a*l,f=a*c;t[0]=l*d,t[4]=-u,t[8]=c*d,t[1]=h*u+f,t[5]=o*d,t[9]=p*u-g,t[2]=g*u-p,t[6]=a*d,t[10]=f*u+h}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(kz,e,Cz)}lookAt(e,t,r){const n=this.elements;return ci.subVectors(e,t),ci.lengthSq()===0&&(ci.z=1),ci.normalize(),Gr.crossVectors(r,ci),Gr.lengthSq()===0&&(Math.abs(r.z)===1?ci.x+=1e-4:ci.z+=1e-4,ci.normalize(),Gr.crossVectors(r,ci)),Gr.normalize(),_l.crossVectors(ci,Gr),n[0]=Gr.x,n[4]=_l.x,n[8]=ci.x,n[1]=Gr.y,n[5]=_l.y,n[9]=ci.y,n[2]=Gr.z,n[6]=_l.z,n[10]=ci.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,n=t.elements,s=this.elements,o=r[0],a=r[4],l=r[8],c=r[12],d=r[1],u=r[5],h=r[9],p=r[13],g=r[2],f=r[6],m=r[10],b=r[14],y=r[3],w=r[7],_=r[11],M=r[15],S=n[0],A=n[4],x=n[8],E=n[12],D=n[1],F=n[5],R=n[9],B=n[13],I=n[2],V=n[6],N=n[10],j=n[14],Y=n[3],W=n[7],ee=n[11],me=n[15];return s[0]=o*S+a*D+l*I+c*Y,s[4]=o*A+a*F+l*V+c*W,s[8]=o*x+a*R+l*N+c*ee,s[12]=o*E+a*B+l*j+c*me,s[1]=d*S+u*D+h*I+p*Y,s[5]=d*A+u*F+h*V+p*W,s[9]=d*x+u*R+h*N+p*ee,s[13]=d*E+u*B+h*j+p*me,s[2]=g*S+f*D+m*I+b*Y,s[6]=g*A+f*F+m*V+b*W,s[10]=g*x+f*R+m*N+b*ee,s[14]=g*E+f*B+m*j+b*me,s[3]=y*S+w*D+_*I+M*Y,s[7]=y*A+w*F+_*V+M*W,s[11]=y*x+w*R+_*N+M*ee,s[15]=y*E+w*B+_*j+M*me,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],n=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],d=e[2],u=e[6],h=e[10],p=e[14],g=e[3],f=e[7],m=e[11],b=e[15];return g*(+s*l*u-n*c*u-s*a*h+r*c*h+n*a*p-r*l*p)+f*(+t*l*p-t*c*h+s*o*h-n*o*p+n*c*d-s*l*d)+m*(+t*c*u-t*a*p-s*o*u+r*o*p+s*a*d-r*c*d)+b*(-n*a*d-t*l*u+t*a*h+n*o*u-r*o*h+r*l*d)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=t,n[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],n=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],d=e[8],u=e[9],h=e[10],p=e[11],g=e[12],f=e[13],m=e[14],b=e[15],y=u*m*c-f*h*c+f*l*p-a*m*p-u*l*b+a*h*b,w=g*h*c-d*m*c-g*l*p+o*m*p+d*l*b-o*h*b,_=d*f*c-g*u*c+g*a*p-o*f*p-d*a*b+o*u*b,M=g*u*l-d*f*l-g*a*h+o*f*h+d*a*m-o*u*m,S=t*y+r*w+n*_+s*M;if(S===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const A=1/S;return e[0]=y*A,e[1]=(f*h*s-u*m*s-f*n*p+r*m*p+u*n*b-r*h*b)*A,e[2]=(a*m*s-f*l*s+f*n*c-r*m*c-a*n*b+r*l*b)*A,e[3]=(u*l*s-a*h*s-u*n*c+r*h*c+a*n*p-r*l*p)*A,e[4]=w*A,e[5]=(d*m*s-g*h*s+g*n*p-t*m*p-d*n*b+t*h*b)*A,e[6]=(g*l*s-o*m*s-g*n*c+t*m*c+o*n*b-t*l*b)*A,e[7]=(o*h*s-d*l*s+d*n*c-t*h*c-o*n*p+t*l*p)*A,e[8]=_*A,e[9]=(g*u*s-d*f*s-g*r*p+t*f*p+d*r*b-t*u*b)*A,e[10]=(o*f*s-g*a*s+g*r*c-t*f*c-o*r*b+t*a*b)*A,e[11]=(d*a*s-o*u*s-d*r*c+t*u*c+o*r*p-t*a*p)*A,e[12]=M*A,e[13]=(d*f*n-g*u*n+g*r*h-t*f*h-d*r*m+t*u*m)*A,e[14]=(g*a*n-o*f*n-g*r*l+t*f*l+o*r*m-t*a*m)*A,e[15]=(o*u*n-d*a*n+d*r*l-t*u*l-o*r*h+t*a*h)*A,this}scale(e){const t=this.elements,r=e.x,n=e.y,s=e.z;return t[0]*=r,t[4]*=n,t[8]*=s,t[1]*=r,t[5]*=n,t[9]*=s,t[2]*=r,t[6]*=n,t[10]*=s,t[3]*=r,t[7]*=n,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,n))}makeTranslation(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),n=Math.sin(t),s=1-r,o=e.x,a=e.y,l=e.z,c=s*o,d=s*a;return this.set(c*o+r,c*a-n*l,c*l+n*a,0,c*a+n*l,d*a+r,d*l-n*o,0,c*l-n*a,d*l+n*o,s*l*l+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,n,s,o){return this.set(1,r,s,0,e,1,o,0,t,n,1,0,0,0,0,1),this}compose(e,t,r){const n=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,c=s+s,d=o+o,u=a+a,h=s*c,p=s*d,g=s*u,f=o*d,m=o*u,b=a*u,y=l*c,w=l*d,_=l*u,M=r.x,S=r.y,A=r.z;return n[0]=(1-(f+b))*M,n[1]=(p+_)*M,n[2]=(g-w)*M,n[3]=0,n[4]=(p-_)*S,n[5]=(1-(h+b))*S,n[6]=(m+y)*S,n[7]=0,n[8]=(g+w)*A,n[9]=(m-y)*A,n[10]=(1-(h+f))*A,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this}decompose(e,t,r){const n=this.elements;let s=Cs.set(n[0],n[1],n[2]).length();const o=Cs.set(n[4],n[5],n[6]).length(),a=Cs.set(n[8],n[9],n[10]).length();this.determinant()<0&&(s=-s),e.x=n[12],e.y=n[13],e.z=n[14],Fi.copy(this);const l=1/s,c=1/o,d=1/a;return Fi.elements[0]*=l,Fi.elements[1]*=l,Fi.elements[2]*=l,Fi.elements[4]*=c,Fi.elements[5]*=c,Fi.elements[6]*=c,Fi.elements[8]*=d,Fi.elements[9]*=d,Fi.elements[10]*=d,t.setFromRotationMatrix(Fi),r.x=s,r.y=o,r.z=a,this}makePerspective(e,t,r,n,s,o){const a=this.elements,l=2*s/(t-e),c=2*s/(r-n),d=(t+e)/(t-e),u=(r+n)/(r-n),h=-(o+s)/(o-s),p=-2*o*s/(o-s);return a[0]=l,a[4]=0,a[8]=d,a[12]=0,a[1]=0,a[5]=c,a[9]=u,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=p,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,r,n,s,o){const a=this.elements,l=1/(t-e),c=1/(r-n),d=1/(o-s),u=(t+e)*l,h=(r+n)*c,p=(o+s)*d;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-u,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*d,a[14]=-p,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let n=0;n<16;n++)if(t[n]!==r[n])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}const Cs=new J,Fi=new Ft,kz=new J(0,0,0),Cz=new J(1,1,1),Gr=new J,_l=new J,ci=new J,Tg=new Ft,Ag=new Ha;class ja{constructor(e=0,t=0,r=0,n=ja.DefaultOrder){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=n}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,n=this._order){return this._x=e,this._y=t,this._z=r,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){const n=e.elements,s=n[0],o=n[4],a=n[8],l=n[1],c=n[5],d=n[9],u=n[2],h=n[6],p=n[10];switch(t){case"XYZ":this._y=Math.asin(hi(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-d,p),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(h,c),this._z=0);break;case"YXZ":this._x=Math.asin(-hi(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(a,p),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-u,s),this._z=0);break;case"ZXY":this._x=Math.asin(hi(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,p),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-hi(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,p),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,c));break;case"YZX":this._z=Math.asin(hi(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-d,c),this._y=Math.atan2(-u,s)):(this._x=0,this._y=Math.atan2(a,p));break;case"XZY":this._z=Math.asin(-hi(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(h,c),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-d,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return Tg.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Tg,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return Ag.setFromEuler(this),this.setFromQuaternion(Ag,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}}ja.DefaultOrder="XYZ";ja.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class Xy{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let Tz=0;const Lg=new J,Ts=new Ha,mr=new Ft,wl=new J,Po=new J,Az=new J,Lz=new Ha,Dg=new J(1,0,0),Pg=new J(0,1,0),Rg=new J(0,0,1),Dz={type:"added"},Ig={type:"removed"};class ei extends mo{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Tz++}),this.uuid=Va(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ei.DefaultUp.clone();const e=new J,t=new ja,r=new Ha,n=new J(1,1,1);function s(){r.setFromEuler(t,!1)}function o(){t.setFromQuaternion(r,void 0,!1)}t._onChange(s),r._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new Ft},normalMatrix:{value:new Ti}}),this.matrix=new Ft,this.matrixWorld=new Ft,this.matrixAutoUpdate=ei.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Xy,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Ts.setFromAxisAngle(e,t),this.quaternion.multiply(Ts),this}rotateOnWorldAxis(e,t){return Ts.setFromAxisAngle(e,t),this.quaternion.premultiply(Ts),this}rotateX(e){return this.rotateOnAxis(Dg,e)}rotateY(e){return this.rotateOnAxis(Pg,e)}rotateZ(e){return this.rotateOnAxis(Rg,e)}translateOnAxis(e,t){return Lg.copy(e).applyQuaternion(this.quaternion),this.position.add(Lg.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(Dg,e)}translateY(e){return this.translateOnAxis(Pg,e)}translateZ(e){return this.translateOnAxis(Rg,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(mr.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?wl.copy(e):wl.set(e,t,r);const n=this.parent;this.updateWorldMatrix(!0,!1),Po.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?mr.lookAt(Po,wl,this.up):mr.lookAt(wl,Po,this.up),this.quaternion.setFromRotationMatrix(mr),n&&(mr.extractRotation(n.matrixWorld),Ts.setFromRotationMatrix(mr),this.quaternion.premultiply(Ts.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Dz)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Ig)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(Ig)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),mr.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),mr.multiply(e.parent.matrixWorld)),e.applyMatrix4(mr),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,n=this.children.length;r<n;r++){const s=this.children[r].getObjectByProperty(e,t);if(s!==void 0)return s}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Po,e,Az),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Po,Lz,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].updateMatrixWorld(e)}updateWorldMatrix(e,t){const r=this.parent;if(e===!0&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const n=this.children;for(let s=0,o=n.length;s<o;s++)n[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const n={};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.castShadow===!0&&(n.castShadow=!0),this.receiveShadow===!0&&(n.receiveShadow=!0),this.visible===!1&&(n.visible=!1),this.frustumCulled===!1&&(n.frustumCulled=!1),this.renderOrder!==0&&(n.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(n.instanceColor=this.instanceColor.toJSON()));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(n.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let c=0,d=l.length;c<d;c++){const u=l[c];s(e.shapes,u)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,c=this.material.length;l<c;l++)a.push(s(e.materials,this.material[l]));n.material=a}else n.material=s(e.materials,this.material);if(this.children.length>0){n.children=[];for(let a=0;a<this.children.length;a++)n.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){n.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];n.animations.push(s(e.animations,l))}}if(t){const a=o(e.geometries),l=o(e.materials),c=o(e.textures),d=o(e.images),u=o(e.shapes),h=o(e.skeletons),p=o(e.animations),g=o(e.nodes);a.length>0&&(r.geometries=a),l.length>0&&(r.materials=l),c.length>0&&(r.textures=c),d.length>0&&(r.images=d),u.length>0&&(r.shapes=u),h.length>0&&(r.skeletons=h),p.length>0&&(r.animations=p),g.length>0&&(r.nodes=g)}return r.object=n,r;function o(a){const l=[];for(const c in a){const d=a[c];delete d.metadata,l.push(d)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){const n=e.children[r];this.add(n.clone())}return this}}ei.DefaultUp=new J(0,1,0);ei.DefaultMatrixAutoUpdate=!0;const zi=new J,gr=new J,ou=new J,vr=new J,As=new J,Ls=new J,Og=new J,au=new J,lu=new J,cu=new J;class Cr{constructor(e=new J,t=new J,r=new J){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,n){n.subVectors(r,t),zi.subVectors(e,t),n.cross(zi);const s=n.lengthSq();return s>0?n.multiplyScalar(1/Math.sqrt(s)):n.set(0,0,0)}static getBarycoord(e,t,r,n,s){zi.subVectors(n,t),gr.subVectors(r,t),ou.subVectors(e,t);const o=zi.dot(zi),a=zi.dot(gr),l=zi.dot(ou),c=gr.dot(gr),d=gr.dot(ou),u=o*c-a*a;if(u===0)return s.set(-2,-1,-1);const h=1/u,p=(c*l-a*d)*h,g=(o*d-a*l)*h;return s.set(1-p-g,g,p)}static containsPoint(e,t,r,n){return this.getBarycoord(e,t,r,n,vr),vr.x>=0&&vr.y>=0&&vr.x+vr.y<=1}static getUV(e,t,r,n,s,o,a,l){return this.getBarycoord(e,t,r,n,vr),l.set(0,0),l.addScaledVector(s,vr.x),l.addScaledVector(o,vr.y),l.addScaledVector(a,vr.z),l}static isFrontFacing(e,t,r,n){return zi.subVectors(r,t),gr.subVectors(e,t),zi.cross(gr).dot(n)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,n){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[n]),this}setFromAttributeAndIndices(e,t,r,n){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return zi.subVectors(this.c,this.b),gr.subVectors(this.a,this.b),zi.cross(gr).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Cr.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Cr.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,r,n,s){return Cr.getUV(e,this.a,this.b,this.c,t,r,n,s)}containsPoint(e){return Cr.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Cr.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const r=this.a,n=this.b,s=this.c;let o,a;As.subVectors(n,r),Ls.subVectors(s,r),au.subVectors(e,r);const l=As.dot(au),c=Ls.dot(au);if(l<=0&&c<=0)return t.copy(r);lu.subVectors(e,n);const d=As.dot(lu),u=Ls.dot(lu);if(d>=0&&u<=d)return t.copy(n);const h=l*u-d*c;if(h<=0&&l>=0&&d<=0)return o=l/(l-d),t.copy(r).addScaledVector(As,o);cu.subVectors(e,s);const p=As.dot(cu),g=Ls.dot(cu);if(g>=0&&p<=g)return t.copy(s);const f=p*c-l*g;if(f<=0&&c>=0&&g<=0)return a=c/(c-g),t.copy(r).addScaledVector(Ls,a);const m=d*g-p*u;if(m<=0&&u-d>=0&&p-g>=0)return Og.subVectors(s,n),a=(u-d)/(u-d+(p-g)),t.copy(n).addScaledVector(Og,a);const b=1/(m+f+h);return o=f*b,a=h*b,t.copy(r).addScaledVector(As,o).addScaledVector(Ls,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let Pz=0;class bs extends mo{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Pz++}),this.uuid=Va(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const r=e[t];if(r===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if(t==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=r===1;continue}const n=this[t];if(n===void 0){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}n&&n.isColor?n.set(r):n&&n.isVector3&&r&&r.isVector3?n.copy(r):this[t]=r}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==1&&(r.blending=this.blending),this.side!==0&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.colorWrite=this.colorWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(r.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=this.flatShading),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),JSON.stringify(this.userData)!=="{}"&&(r.userData=this.userData);function n(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(t){const s=n(e.textures),o=n(e.images);s.length>0&&(r.textures=s),o.length>0&&(r.images=o)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let r=null;if(t!==null){const n=t.length;r=new Array(n);for(let s=0;s!==n;++s)r[s]=t[s].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class Ky extends bs{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new ot(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Tt=new J,xl=new at;class rr{constructor(e,t,r){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=r===!0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let n=0,s=this.itemSize;n<s;n++)this.array[e+n]=t.array[r+n];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const t=this.array;let r=0;for(let n=0,s=e.length;n<s;n++){let o=e[n];o===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),o=new ot),t[r++]=o.r,t[r++]=o.g,t[r++]=o.b}return this}copyVector2sArray(e){const t=this.array;let r=0;for(let n=0,s=e.length;n<s;n++){let o=e[n];o===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),o=new at),t[r++]=o.x,t[r++]=o.y}return this}copyVector3sArray(e){const t=this.array;let r=0;for(let n=0,s=e.length;n<s;n++){let o=e[n];o===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),o=new J),t[r++]=o.x,t[r++]=o.y,t[r++]=o.z}return this}copyVector4sArray(e){const t=this.array;let r=0;for(let n=0,s=e.length;n<s;n++){let o=e[n];o===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),o=new Ot),t[r++]=o.x,t[r++]=o.y,t[r++]=o.z,t[r++]=o.w}return this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,r=this.count;t<r;t++)xl.fromBufferAttribute(this,t),xl.applyMatrix3(e),this.setXY(t,xl.x,xl.y);else if(this.itemSize===3)for(let t=0,r=this.count;t<r;t++)Tt.fromBufferAttribute(this,t),Tt.applyMatrix3(e),this.setXYZ(t,Tt.x,Tt.y,Tt.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)Tt.fromBufferAttribute(this,t),Tt.applyMatrix4(e),this.setXYZ(t,Tt.x,Tt.y,Tt.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Tt.fromBufferAttribute(this,t),Tt.applyNormalMatrix(e),this.setXYZ(t,Tt.x,Tt.y,Tt.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Tt.fromBufferAttribute(this,t),Tt.transformDirection(e),this.setXYZ(t,Tt.x,Tt.y,Tt.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){return this.array[e*this.itemSize]}setX(e,t){return this.array[e*this.itemSize]=t,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,t){return this.array[e*this.itemSize+1]=t,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,t){return this.array[e*this.itemSize+2]=t,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,t){return this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this}setXYZW(e,t,r,n,s){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==35044&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}}class Jy extends rr{constructor(e,t,r){super(new Uint16Array(e),t,r)}}class Zy extends rr{constructor(e,t,r){super(new Uint32Array(e),t,r)}}class Yt extends rr{constructor(e,t,r){super(new Float32Array(e),t,r)}}let Rz=0;const xi=new Ft,du=new ei,Ds=new J,di=new Ua,Ro=new Ua,$t=new J;class lr extends mo{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Rz++}),this.uuid=Va(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(jy(e)?Zy:Jy)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const s=new Ti().getNormalMatrix(e);r.applyNormalMatrix(s),r.needsUpdate=!0}const n=this.attributes.tangent;return n!==void 0&&(n.transformDirection(e),n.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return xi.makeRotationFromQuaternion(e),this.applyMatrix4(xi),this}rotateX(e){return xi.makeRotationX(e),this.applyMatrix4(xi),this}rotateY(e){return xi.makeRotationY(e),this.applyMatrix4(xi),this}rotateZ(e){return xi.makeRotationZ(e),this.applyMatrix4(xi),this}translate(e,t,r){return xi.makeTranslation(e,t,r),this.applyMatrix4(xi),this}scale(e,t,r){return xi.makeScale(e,t,r),this.applyMatrix4(xi),this}lookAt(e){return du.lookAt(e),du.updateMatrix(),this.applyMatrix4(du.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Ds).negate(),this.translate(Ds.x,Ds.y,Ds.z),this}setFromPoints(e){const t=[];for(let r=0,n=e.length;r<n;r++){const s=e[r];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Yt(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ua);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new J(-1/0,-1/0,-1/0),new J(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,n=t.length;r<n;r++){const s=t[r];di.setFromBufferAttribute(s),this.morphTargetsRelative?($t.addVectors(this.boundingBox.min,di.min),this.boundingBox.expandByPoint($t),$t.addVectors(this.boundingBox.max,di.max),this.boundingBox.expandByPoint($t)):(this.boundingBox.expandByPoint(di.min),this.boundingBox.expandByPoint(di.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new La);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new J,1/0);return}if(e){const r=this.boundingSphere.center;if(di.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){const a=t[s];Ro.setFromBufferAttribute(a),this.morphTargetsRelative?($t.addVectors(di.min,Ro.min),di.expandByPoint($t),$t.addVectors(di.max,Ro.max),di.expandByPoint($t)):(di.expandByPoint(Ro.min),di.expandByPoint(Ro.max))}di.getCenter(r);let n=0;for(let s=0,o=e.count;s<o;s++)$t.fromBufferAttribute(e,s),n=Math.max(n,r.distanceToSquared($t));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let c=0,d=a.count;c<d;c++)$t.fromBufferAttribute(a,c),l&&(Ds.fromBufferAttribute(e,c),$t.add(Ds)),n=Math.max(n,r.distanceToSquared($t))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=e.array,n=t.position.array,s=t.normal.array,o=t.uv.array,a=n.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new rr(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,c=[],d=[];for(let D=0;D<a;D++)c[D]=new J,d[D]=new J;const u=new J,h=new J,p=new J,g=new at,f=new at,m=new at,b=new J,y=new J;function w(D,F,R){u.fromArray(n,D*3),h.fromArray(n,F*3),p.fromArray(n,R*3),g.fromArray(o,D*2),f.fromArray(o,F*2),m.fromArray(o,R*2),h.sub(u),p.sub(u),f.sub(g),m.sub(g);const B=1/(f.x*m.y-m.x*f.y);!isFinite(B)||(b.copy(h).multiplyScalar(m.y).addScaledVector(p,-f.y).multiplyScalar(B),y.copy(p).multiplyScalar(f.x).addScaledVector(h,-m.x).multiplyScalar(B),c[D].add(b),c[F].add(b),c[R].add(b),d[D].add(y),d[F].add(y),d[R].add(y))}let _=this.groups;_.length===0&&(_=[{start:0,count:r.length}]);for(let D=0,F=_.length;D<F;++D){const R=_[D],B=R.start,I=R.count;for(let V=B,N=B+I;V<N;V+=3)w(r[V+0],r[V+1],r[V+2])}const M=new J,S=new J,A=new J,x=new J;function E(D){A.fromArray(s,D*3),x.copy(A);const F=c[D];M.copy(F),M.sub(A.multiplyScalar(A.dot(F))).normalize(),S.crossVectors(x,F);const R=S.dot(d[D])<0?-1:1;l[D*4]=M.x,l[D*4+1]=M.y,l[D*4+2]=M.z,l[D*4+3]=R}for(let D=0,F=_.length;D<F;++D){const R=_[D],B=R.start,I=R.count;for(let V=B,N=B+I;V<N;V+=3)E(r[V+0]),E(r[V+1]),E(r[V+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new rr(new Float32Array(t.count*3),3),this.setAttribute("normal",r);else for(let h=0,p=r.count;h<p;h++)r.setXYZ(h,0,0,0);const n=new J,s=new J,o=new J,a=new J,l=new J,c=new J,d=new J,u=new J;if(e)for(let h=0,p=e.count;h<p;h+=3){const g=e.getX(h+0),f=e.getX(h+1),m=e.getX(h+2);n.fromBufferAttribute(t,g),s.fromBufferAttribute(t,f),o.fromBufferAttribute(t,m),d.subVectors(o,s),u.subVectors(n,s),d.cross(u),a.fromBufferAttribute(r,g),l.fromBufferAttribute(r,f),c.fromBufferAttribute(r,m),a.add(d),l.add(d),c.add(d),r.setXYZ(g,a.x,a.y,a.z),r.setXYZ(f,l.x,l.y,l.z),r.setXYZ(m,c.x,c.y,c.z)}else for(let h=0,p=t.count;h<p;h+=3)n.fromBufferAttribute(t,h+0),s.fromBufferAttribute(t,h+1),o.fromBufferAttribute(t,h+2),d.subVectors(o,s),u.subVectors(n,s),d.cross(u),r.setXYZ(h+0,d.x,d.y,d.z),r.setXYZ(h+1,d.x,d.y,d.z),r.setXYZ(h+2,d.x,d.y,d.z);this.normalizeNormals(),r.needsUpdate=!0}}merge(e,t){if(!(e&&e.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);return}t===void 0&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const r=this.attributes;for(const n in r){if(e.attributes[n]===void 0)continue;const s=r[n].array,o=e.attributes[n],a=o.array,l=o.itemSize*t,c=Math.min(a.length,s.length-l);for(let d=0,u=l;d<c;d++,u++)s[u]=a[d]}return this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)$t.fromBufferAttribute(e,t),$t.normalize(),e.setXYZ(t,$t.x,$t.y,$t.z)}toNonIndexed(){function e(a,l){const c=a.array,d=a.itemSize,u=a.normalized,h=new c.constructor(l.length*d);let p=0,g=0;for(let f=0,m=l.length;f<m;f++){a.isInterleavedBufferAttribute?p=l[f]*a.data.stride+a.offset:p=l[f]*d;for(let b=0;b<d;b++)h[g++]=c[p++]}return new rr(h,d,u)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new lr,r=this.index.array,n=this.attributes;for(const a in n){const l=n[a],c=e(l,r);t.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let d=0,u=c.length;d<u;d++){const h=c[d],p=e(h,r);l.push(p)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const c in l)l[c]!==void 0&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const r=this.attributes;for(const l in r){const c=r[l];e.data.attributes[l]=c.toJSON(e.data)}const n={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],d=[];for(let u=0,h=c.length;u<h;u++){const p=c[u];d.push(p.toJSON(e.data))}d.length>0&&(n[l]=d,s=!0)}s&&(e.data.morphAttributes=n,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const r=e.index;r!==null&&this.setIndex(r.clone(t));const n=e.attributes;for(const c in n){const d=n[c];this.setAttribute(c,d.clone(t))}const s=e.morphAttributes;for(const c in s){const d=[],u=s[c];for(let h=0,p=u.length;h<p;h++)d.push(u[h].clone(t));this.morphAttributes[c]=d}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,d=o.length;c<d;c++){const u=o[c];this.addGroup(u.start,u.count,u.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,e.parameters!==void 0&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}const Fg=new Ft,Ps=new Ez,uu=new La,qr=new J,Yr=new J,Xr=new J,hu=new J,fu=new J,pu=new J,Sl=new J,Ml=new J,El=new J,kl=new at,Cl=new at,Tl=new at,mu=new J,Al=new J;class Qi extends ei{constructor(e=new lr,t=new Ky){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const r=e[t[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let n=0,s=r.length;n<s;n++){const o=r[n].name||String(n);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=n}}}}raycast(e,t){const r=this.geometry,n=this.material,s=this.matrixWorld;if(n===void 0||(r.boundingSphere===null&&r.computeBoundingSphere(),uu.copy(r.boundingSphere),uu.applyMatrix4(s),e.ray.intersectsSphere(uu)===!1)||(Fg.copy(s).invert(),Ps.copy(e.ray).applyMatrix4(Fg),r.boundingBox!==null&&Ps.intersectsBox(r.boundingBox)===!1))return;let o;const a=r.index,l=r.attributes.position,c=r.morphAttributes.position,d=r.morphTargetsRelative,u=r.attributes.uv,h=r.attributes.uv2,p=r.groups,g=r.drawRange;if(a!==null)if(Array.isArray(n))for(let f=0,m=p.length;f<m;f++){const b=p[f],y=n[b.materialIndex],w=Math.max(b.start,g.start),_=Math.min(a.count,Math.min(b.start+b.count,g.start+g.count));for(let M=w,S=_;M<S;M+=3){const A=a.getX(M),x=a.getX(M+1),E=a.getX(M+2);o=Ll(this,y,e,Ps,l,c,d,u,h,A,x,E),o&&(o.faceIndex=Math.floor(M/3),o.face.materialIndex=b.materialIndex,t.push(o))}}else{const f=Math.max(0,g.start),m=Math.min(a.count,g.start+g.count);for(let b=f,y=m;b<y;b+=3){const w=a.getX(b),_=a.getX(b+1),M=a.getX(b+2);o=Ll(this,n,e,Ps,l,c,d,u,h,w,_,M),o&&(o.faceIndex=Math.floor(b/3),t.push(o))}}else if(l!==void 0)if(Array.isArray(n))for(let f=0,m=p.length;f<m;f++){const b=p[f],y=n[b.materialIndex],w=Math.max(b.start,g.start),_=Math.min(l.count,Math.min(b.start+b.count,g.start+g.count));for(let M=w,S=_;M<S;M+=3){const A=M,x=M+1,E=M+2;o=Ll(this,y,e,Ps,l,c,d,u,h,A,x,E),o&&(o.faceIndex=Math.floor(M/3),o.face.materialIndex=b.materialIndex,t.push(o))}}else{const f=Math.max(0,g.start),m=Math.min(l.count,g.start+g.count);for(let b=f,y=m;b<y;b+=3){const w=b,_=b+1,M=b+2;o=Ll(this,n,e,Ps,l,c,d,u,h,w,_,M),o&&(o.faceIndex=Math.floor(b/3),t.push(o))}}}}function Iz(i,e,t,r,n,s,o,a){let l;if(e.side===1?l=r.intersectTriangle(o,s,n,!0,a):l=r.intersectTriangle(n,s,o,e.side!==2,a),l===null)return null;Al.copy(a),Al.applyMatrix4(i.matrixWorld);const c=t.ray.origin.distanceTo(Al);return c<t.near||c>t.far?null:{distance:c,point:Al.clone(),object:i}}function Ll(i,e,t,r,n,s,o,a,l,c,d,u){qr.fromBufferAttribute(n,c),Yr.fromBufferAttribute(n,d),Xr.fromBufferAttribute(n,u);const h=i.morphTargetInfluences;if(s&&h){Sl.set(0,0,0),Ml.set(0,0,0),El.set(0,0,0);for(let g=0,f=s.length;g<f;g++){const m=h[g],b=s[g];m!==0&&(hu.fromBufferAttribute(b,c),fu.fromBufferAttribute(b,d),pu.fromBufferAttribute(b,u),o?(Sl.addScaledVector(hu,m),Ml.addScaledVector(fu,m),El.addScaledVector(pu,m)):(Sl.addScaledVector(hu.sub(qr),m),Ml.addScaledVector(fu.sub(Yr),m),El.addScaledVector(pu.sub(Xr),m)))}qr.add(Sl),Yr.add(Ml),Xr.add(El)}i.isSkinnedMesh&&(i.boneTransform(c,qr),i.boneTransform(d,Yr),i.boneTransform(u,Xr));const p=Iz(i,e,t,r,qr,Yr,Xr,mu);if(p){a&&(kl.fromBufferAttribute(a,c),Cl.fromBufferAttribute(a,d),Tl.fromBufferAttribute(a,u),p.uv=Cr.getUV(mu,qr,Yr,Xr,kl,Cl,Tl,new at)),l&&(kl.fromBufferAttribute(l,c),Cl.fromBufferAttribute(l,d),Tl.fromBufferAttribute(l,u),p.uv2=Cr.getUV(mu,qr,Yr,Xr,kl,Cl,Tl,new at));const g={a:c,b:d,c:u,normal:new J,materialIndex:0};Cr.getNormal(qr,Yr,Xr,g.normal),p.face=g}return p}class Wa extends lr{constructor(e=1,t=1,r=1,n=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:n,heightSegments:s,depthSegments:o};const a=this;n=Math.floor(n),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],d=[],u=[];let h=0,p=0;g("z","y","x",-1,-1,r,t,e,o,s,0),g("z","y","x",1,-1,r,t,-e,o,s,1),g("x","z","y",1,1,e,r,t,n,o,2),g("x","z","y",1,-1,e,r,-t,n,o,3),g("x","y","z",1,-1,e,t,r,n,s,4),g("x","y","z",-1,-1,e,t,-r,n,s,5),this.setIndex(l),this.setAttribute("position",new Yt(c,3)),this.setAttribute("normal",new Yt(d,3)),this.setAttribute("uv",new Yt(u,2));function g(f,m,b,y,w,_,M,S,A,x,E){const D=_/A,F=M/x,R=_/2,B=M/2,I=S/2,V=A+1,N=x+1;let j=0,Y=0;const W=new J;for(let ee=0;ee<N;ee++){const me=ee*F-B;for(let X=0;X<V;X++){const ye=X*D-R;W[f]=ye*y,W[m]=me*w,W[b]=I,c.push(W.x,W.y,W.z),W[f]=0,W[m]=0,W[b]=S>0?1:-1,d.push(W.x,W.y,W.z),u.push(X/A),u.push(1-ee/x),j+=1}}for(let ee=0;ee<x;ee++)for(let me=0;me<A;me++){const X=h+me+V*ee,ye=h+me+V*(ee+1),Ce=h+(me+1)+V*(ee+1),We=h+(me+1)+V*ee;l.push(X,ye,We),l.push(ye,Ce,We),Y+=6}a.addGroup(p,Y,E),p+=Y,h+=j}}static fromJSON(e){return new Wa(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function oo(i){const e={};for(const t in i){e[t]={};for(const r in i[t]){const n=i[t][r];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture||n.isQuaternion)?e[t][r]=n.clone():Array.isArray(n)?e[t][r]=n.slice():e[t][r]=n}}return e}function Gt(i){const e={};for(let t=0;t<i.length;t++){const r=oo(i[t]);for(const n in r)e[n]=r[n]}return e}function Oz(i){const e=[];for(let t=0;t<i.length;t++)e.push(i[t].clone());return e}const Fz={clone:oo,merge:Gt};var zz=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Nz=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class us extends bs{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=zz,this.fragmentShader=Nz,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&(e.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=oo(e.uniforms),this.uniformsGroups=Oz(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const n in this.uniforms){const s=this.uniforms[n].value;s&&s.isTexture?t.uniforms[n]={type:"t",value:s.toJSON(e).uuid}:s&&s.isColor?t.uniforms[n]={type:"c",value:s.getHex()}:s&&s.isVector2?t.uniforms[n]={type:"v2",value:s.toArray()}:s&&s.isVector3?t.uniforms[n]={type:"v3",value:s.toArray()}:s&&s.isVector4?t.uniforms[n]={type:"v4",value:s.toArray()}:s&&s.isMatrix3?t.uniforms[n]={type:"m3",value:s.toArray()}:s&&s.isMatrix4?t.uniforms[n]={type:"m4",value:s.toArray()}:t.uniforms[n]={value:s}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const r={};for(const n in this.extensions)this.extensions[n]===!0&&(r[n]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}}class Qy extends ei{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ft,this.projectionMatrix=new Ft,this.projectionMatrixInverse=new Ft}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class fi extends Qy{constructor(e=50,t=1,r=.1,n=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=n,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=hh*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Yd*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return hh*2*Math.atan(Math.tan(Yd*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,r,n,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Yd*.5*this.fov)/this.zoom,r=2*t,n=this.aspect*r,s=-.5*n;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*n/l,t-=o.offsetY*r/c,n*=o.width/l,r*=o.height/c}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+n,t,t-r,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Rs=90,Is=1;class $z extends ei{constructor(e,t,r){if(super(),this.type="CubeCamera",r.isWebGLCubeRenderTarget!==!0){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=r;const n=new fi(Rs,Is,e,t);n.layers=this.layers,n.up.set(0,-1,0),n.lookAt(new J(1,0,0)),this.add(n);const s=new fi(Rs,Is,e,t);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new J(-1,0,0)),this.add(s);const o=new fi(Rs,Is,e,t);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(new J(0,1,0)),this.add(o);const a=new fi(Rs,Is,e,t);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new J(0,-1,0)),this.add(a);const l=new fi(Rs,Is,e,t);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new J(0,0,1)),this.add(l);const c=new fi(Rs,Is,e,t);c.layers=this.layers,c.up.set(0,-1,0),c.lookAt(new J(0,0,-1)),this.add(c)}update(e,t){this.parent===null&&this.updateMatrixWorld();const r=this.renderTarget,[n,s,o,a,l,c]=this.children,d=e.getRenderTarget(),u=e.toneMapping,h=e.xr.enabled;e.toneMapping=0,e.xr.enabled=!1;const p=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0),e.render(t,n),e.setRenderTarget(r,1),e.render(t,s),e.setRenderTarget(r,2),e.render(t,o),e.setRenderTarget(r,3),e.render(t,a),e.setRenderTarget(r,4),e.render(t,l),r.texture.generateMipmaps=p,e.setRenderTarget(r,5),e.render(t,c),e.setRenderTarget(d),e.toneMapping=u,e.xr.enabled=h,r.texture.needsPMREMUpdate=!0}}class e_ extends vi{constructor(e,t,r,n,s,o,a,l,c,d){e=e!==void 0?e:[],t=t!==void 0?t:301,super(e,t,r,n,s,o,a,l,c,d),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Bz extends ds{constructor(e,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},n=[r,r,r,r,r,r];this.texture=new e_(n,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:1006}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},n=new Wa(5,5,5),s=new us({name:"CubemapFromEquirect",uniforms:oo(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:1,blending:0});s.uniforms.tEquirect.value=t;const o=new Qi(n,s),a=t.minFilter;return t.minFilter===1008&&(t.minFilter=1006),new $z(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,r,n){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,r,n);e.setRenderTarget(s)}}const gu=new J,Vz=new J,Hz=new Ti;class Bn{constructor(e=new J(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,n){return this.normal.set(e,t,r),this.constant=n,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){const n=gu.subVectors(r,t).cross(Vz.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(n,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const r=e.delta(gu),n=this.normal.dot(r);if(n===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/n;return s<0||s>1?null:t.copy(r).multiplyScalar(s).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const r=t||Hz.getNormalMatrix(e),n=this.coplanarPoint(gu).applyMatrix4(e),s=this.normal.applyMatrix3(r).normalize();return this.constant=-n.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Os=new La,Dl=new J;class Nf{constructor(e=new Bn,t=new Bn,r=new Bn,n=new Bn,s=new Bn,o=new Bn){this.planes=[e,t,r,n,s,o]}set(e,t,r,n,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(r),a[3].copy(n),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e){const t=this.planes,r=e.elements,n=r[0],s=r[1],o=r[2],a=r[3],l=r[4],c=r[5],d=r[6],u=r[7],h=r[8],p=r[9],g=r[10],f=r[11],m=r[12],b=r[13],y=r[14],w=r[15];return t[0].setComponents(a-n,u-l,f-h,w-m).normalize(),t[1].setComponents(a+n,u+l,f+h,w+m).normalize(),t[2].setComponents(a+s,u+c,f+p,w+b).normalize(),t[3].setComponents(a-s,u-c,f-p,w-b).normalize(),t[4].setComponents(a-o,u-d,f-g,w-y).normalize(),t[5].setComponents(a+o,u+d,f+g,w+y).normalize(),this}intersectsObject(e){const t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),Os.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Os)}intersectsSprite(e){return Os.center.set(0,0,0),Os.radius=.7071067811865476,Os.applyMatrix4(e.matrixWorld),this.intersectsSphere(Os)}intersectsSphere(e){const t=this.planes,r=e.center,n=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(r)<n)return!1;return!0}intersectsBox(e){const t=this.planes;for(let r=0;r<6;r++){const n=t[r];if(Dl.x=n.normal.x>0?e.max.x:e.min.x,Dl.y=n.normal.y>0?e.max.y:e.min.y,Dl.z=n.normal.z>0?e.max.z:e.min.z,n.distanceToPoint(Dl)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function t_(){let i=null,e=!1,t=null,r=null;function n(s,o){t(s,o),r=i.requestAnimationFrame(n)}return{start:function(){e!==!0&&t!==null&&(r=i.requestAnimationFrame(n),e=!0)},stop:function(){i.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){i=s}}}function Uz(i,e){const t=e.isWebGL2,r=new WeakMap;function n(c,d){const u=c.array,h=c.usage,p=i.createBuffer();i.bindBuffer(d,p),i.bufferData(d,u,h),c.onUploadCallback();let g;if(u instanceof Float32Array)g=5126;else if(u instanceof Uint16Array)if(c.isFloat16BufferAttribute)if(t)g=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else g=5123;else if(u instanceof Int16Array)g=5122;else if(u instanceof Uint32Array)g=5125;else if(u instanceof Int32Array)g=5124;else if(u instanceof Int8Array)g=5120;else if(u instanceof Uint8Array)g=5121;else if(u instanceof Uint8ClampedArray)g=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+u);return{buffer:p,type:g,bytesPerElement:u.BYTES_PER_ELEMENT,version:c.version}}function s(c,d,u){const h=d.array,p=d.updateRange;i.bindBuffer(u,c),p.count===-1?i.bufferSubData(u,0,h):(t?i.bufferSubData(u,p.offset*h.BYTES_PER_ELEMENT,h,p.offset,p.count):i.bufferSubData(u,p.offset*h.BYTES_PER_ELEMENT,h.subarray(p.offset,p.offset+p.count)),p.count=-1)}function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),r.get(c)}function a(c){c.isInterleavedBufferAttribute&&(c=c.data);const d=r.get(c);d&&(i.deleteBuffer(d.buffer),r.delete(c))}function l(c,d){if(c.isGLBufferAttribute){const h=r.get(c);(!h||h.version<c.version)&&r.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);const u=r.get(c);u===void 0?r.set(c,n(c,d)):u.version<c.version&&(s(u.buffer,c,d),u.version=c.version)}return{get:o,remove:a,update:l}}class pd extends lr{constructor(e=1,t=1,r=1,n=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:n};const s=e/2,o=t/2,a=Math.floor(r),l=Math.floor(n),c=a+1,d=l+1,u=e/a,h=t/l,p=[],g=[],f=[],m=[];for(let b=0;b<d;b++){const y=b*h-o;for(let w=0;w<c;w++){const _=w*u-s;g.push(_,-y,0),f.push(0,0,1),m.push(w/a),m.push(1-b/l)}}for(let b=0;b<l;b++)for(let y=0;y<a;y++){const w=y+c*b,_=y+c*(b+1),M=y+1+c*(b+1),S=y+1+c*b;p.push(w,_,S),p.push(_,M,S)}this.setIndex(p),this.setAttribute("position",new Yt(g,3)),this.setAttribute("normal",new Yt(f,3)),this.setAttribute("uv",new Yt(m,2))}static fromJSON(e){return new pd(e.width,e.height,e.widthSegments,e.heightSegments)}}var jz=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,Wz=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Gz=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,qz=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,Yz=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,Xz=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,Kz="vec3 transformed = vec3( position );",Jz=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Zz=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,Qz=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,eN=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,tN=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,iN=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,rN=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,nN=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,sN=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,oN=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,aN=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,lN=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,cN=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,dN=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,uN=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,hN=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,fN=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,pN=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,mN=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,gN="gl_FragColor = linearToOutputTexel( gl_FragColor );",vN=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,bN=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,yN=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,_N=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,wN=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,xN=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,SN=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,MN=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,EN=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,kN=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,CN=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,TN=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,AN=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,LN=`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointLightInfo( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotLightInfo( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
		#endif
	}
	#pragma unroll_loop_end
#endif`,DN=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,PN=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,RN=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,IN=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,ON=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,FN=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,zN=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,NN=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,$N=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,BN=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,VN=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,HN=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,UN=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,jN=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,WN=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,GN=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,qN=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,YN=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,XN=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,KN=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,JN=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,ZN=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,QN=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,e$=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,t$=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,i$=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,r$=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,n$=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,s$=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,o$=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,a$=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,l$=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,c$=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,d$=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,u$=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,h$=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,f$=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,p$=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,m$=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,g$=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,v$=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,b$=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,y$=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,_$=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,w$=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,x$=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,S$=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,M$=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,E$=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,k$=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,C$=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,T$=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,A$=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,L$=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,D$=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,P$=`#ifdef USE_TRANSMISSION
	float transmissionAlpha = 1.0;
	float transmissionFactor = transmission;
	float thicknessFactor = thickness;
	#ifdef USE_TRANSMISSIONMAP
		transmissionFactor *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		thicknessFactor *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,
		attenuationColor, attenuationDistance );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );
	transmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );
#endif`,R$=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( attenuationDistance == 0.0 ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,I$=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,O$=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,F$=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,z$=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,N$=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,$$=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,B$=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const V$=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,H$=`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	gl_FragColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		gl_FragColor = vec4( mix( pow( gl_FragColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), gl_FragColor.rgb * 0.0773993808, vec3( lessThanEqual( gl_FragColor.rgb, vec3( 0.04045 ) ) ) ), gl_FragColor.w );
	#endif
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,U$=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,j$=`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,W$=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,G$=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,q$=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,Y$=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,X$=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,K$=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,J$=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Z$=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Q$=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,eB=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,tB=`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,iB=`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,rB=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,nB=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,sB=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,oB=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,aB=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,lB=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,cB=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,dB=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,uB=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,hB=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,fB=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,pB=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,mB=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,gB=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,vB=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,bB=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,et={alphamap_fragment:jz,alphamap_pars_fragment:Wz,alphatest_fragment:Gz,alphatest_pars_fragment:qz,aomap_fragment:Yz,aomap_pars_fragment:Xz,begin_vertex:Kz,beginnormal_vertex:Jz,bsdfs:Zz,iridescence_fragment:Qz,bumpmap_pars_fragment:eN,clipping_planes_fragment:tN,clipping_planes_pars_fragment:iN,clipping_planes_pars_vertex:rN,clipping_planes_vertex:nN,color_fragment:sN,color_pars_fragment:oN,color_pars_vertex:aN,color_vertex:lN,common:cN,cube_uv_reflection_fragment:dN,defaultnormal_vertex:uN,displacementmap_pars_vertex:hN,displacementmap_vertex:fN,emissivemap_fragment:pN,emissivemap_pars_fragment:mN,encodings_fragment:gN,encodings_pars_fragment:vN,envmap_fragment:bN,envmap_common_pars_fragment:yN,envmap_pars_fragment:_N,envmap_pars_vertex:wN,envmap_physical_pars_fragment:PN,envmap_vertex:xN,fog_vertex:SN,fog_pars_vertex:MN,fog_fragment:EN,fog_pars_fragment:kN,gradientmap_pars_fragment:CN,lightmap_fragment:TN,lightmap_pars_fragment:AN,lights_lambert_vertex:LN,lights_pars_begin:DN,lights_toon_fragment:RN,lights_toon_pars_fragment:IN,lights_phong_fragment:ON,lights_phong_pars_fragment:FN,lights_physical_fragment:zN,lights_physical_pars_fragment:NN,lights_fragment_begin:$N,lights_fragment_maps:BN,lights_fragment_end:VN,logdepthbuf_fragment:HN,logdepthbuf_pars_fragment:UN,logdepthbuf_pars_vertex:jN,logdepthbuf_vertex:WN,map_fragment:GN,map_pars_fragment:qN,map_particle_fragment:YN,map_particle_pars_fragment:XN,metalnessmap_fragment:KN,metalnessmap_pars_fragment:JN,morphcolor_vertex:ZN,morphnormal_vertex:QN,morphtarget_pars_vertex:e$,morphtarget_vertex:t$,normal_fragment_begin:i$,normal_fragment_maps:r$,normal_pars_fragment:n$,normal_pars_vertex:s$,normal_vertex:o$,normalmap_pars_fragment:a$,clearcoat_normal_fragment_begin:l$,clearcoat_normal_fragment_maps:c$,clearcoat_pars_fragment:d$,iridescence_pars_fragment:u$,output_fragment:h$,packing:f$,premultiplied_alpha_fragment:p$,project_vertex:m$,dithering_fragment:g$,dithering_pars_fragment:v$,roughnessmap_fragment:b$,roughnessmap_pars_fragment:y$,shadowmap_pars_fragment:_$,shadowmap_pars_vertex:w$,shadowmap_vertex:x$,shadowmask_pars_fragment:S$,skinbase_vertex:M$,skinning_pars_vertex:E$,skinning_vertex:k$,skinnormal_vertex:C$,specularmap_fragment:T$,specularmap_pars_fragment:A$,tonemapping_fragment:L$,tonemapping_pars_fragment:D$,transmission_fragment:P$,transmission_pars_fragment:R$,uv_pars_fragment:I$,uv_pars_vertex:O$,uv_vertex:F$,uv2_pars_fragment:z$,uv2_pars_vertex:N$,uv2_vertex:$$,worldpos_vertex:B$,background_vert:V$,background_frag:H$,cube_vert:U$,cube_frag:j$,depth_vert:W$,depth_frag:G$,distanceRGBA_vert:q$,distanceRGBA_frag:Y$,equirect_vert:X$,equirect_frag:K$,linedashed_vert:J$,linedashed_frag:Z$,meshbasic_vert:Q$,meshbasic_frag:eB,meshlambert_vert:tB,meshlambert_frag:iB,meshmatcap_vert:rB,meshmatcap_frag:nB,meshnormal_vert:sB,meshnormal_frag:oB,meshphong_vert:aB,meshphong_frag:lB,meshphysical_vert:cB,meshphysical_frag:dB,meshtoon_vert:uB,meshtoon_frag:hB,points_vert:fB,points_frag:pB,shadow_vert:mB,shadow_frag:gB,sprite_vert:vB,sprite_frag:bB},Pe={common:{diffuse:{value:new ot(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Ti},uv2Transform:{value:new Ti},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new at(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ot(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new ot(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Ti}},sprite:{diffuse:{value:new ot(16777215)},opacity:{value:1},center:{value:new at(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Ti}}},Ji={basic:{uniforms:Gt([Pe.common,Pe.specularmap,Pe.envmap,Pe.aomap,Pe.lightmap,Pe.fog]),vertexShader:et.meshbasic_vert,fragmentShader:et.meshbasic_frag},lambert:{uniforms:Gt([Pe.common,Pe.specularmap,Pe.envmap,Pe.aomap,Pe.lightmap,Pe.emissivemap,Pe.fog,Pe.lights,{emissive:{value:new ot(0)}}]),vertexShader:et.meshlambert_vert,fragmentShader:et.meshlambert_frag},phong:{uniforms:Gt([Pe.common,Pe.specularmap,Pe.envmap,Pe.aomap,Pe.lightmap,Pe.emissivemap,Pe.bumpmap,Pe.normalmap,Pe.displacementmap,Pe.fog,Pe.lights,{emissive:{value:new ot(0)},specular:{value:new ot(1118481)},shininess:{value:30}}]),vertexShader:et.meshphong_vert,fragmentShader:et.meshphong_frag},standard:{uniforms:Gt([Pe.common,Pe.envmap,Pe.aomap,Pe.lightmap,Pe.emissivemap,Pe.bumpmap,Pe.normalmap,Pe.displacementmap,Pe.roughnessmap,Pe.metalnessmap,Pe.fog,Pe.lights,{emissive:{value:new ot(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:et.meshphysical_vert,fragmentShader:et.meshphysical_frag},toon:{uniforms:Gt([Pe.common,Pe.aomap,Pe.lightmap,Pe.emissivemap,Pe.bumpmap,Pe.normalmap,Pe.displacementmap,Pe.gradientmap,Pe.fog,Pe.lights,{emissive:{value:new ot(0)}}]),vertexShader:et.meshtoon_vert,fragmentShader:et.meshtoon_frag},matcap:{uniforms:Gt([Pe.common,Pe.bumpmap,Pe.normalmap,Pe.displacementmap,Pe.fog,{matcap:{value:null}}]),vertexShader:et.meshmatcap_vert,fragmentShader:et.meshmatcap_frag},points:{uniforms:Gt([Pe.points,Pe.fog]),vertexShader:et.points_vert,fragmentShader:et.points_frag},dashed:{uniforms:Gt([Pe.common,Pe.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:et.linedashed_vert,fragmentShader:et.linedashed_frag},depth:{uniforms:Gt([Pe.common,Pe.displacementmap]),vertexShader:et.depth_vert,fragmentShader:et.depth_frag},normal:{uniforms:Gt([Pe.common,Pe.bumpmap,Pe.normalmap,Pe.displacementmap,{opacity:{value:1}}]),vertexShader:et.meshnormal_vert,fragmentShader:et.meshnormal_frag},sprite:{uniforms:Gt([Pe.sprite,Pe.fog]),vertexShader:et.sprite_vert,fragmentShader:et.sprite_frag},background:{uniforms:{uvTransform:{value:new Ti},t2D:{value:null}},vertexShader:et.background_vert,fragmentShader:et.background_frag},cube:{uniforms:Gt([Pe.envmap,{opacity:{value:1}}]),vertexShader:et.cube_vert,fragmentShader:et.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:et.equirect_vert,fragmentShader:et.equirect_frag},distanceRGBA:{uniforms:Gt([Pe.common,Pe.displacementmap,{referencePosition:{value:new J},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:et.distanceRGBA_vert,fragmentShader:et.distanceRGBA_frag},shadow:{uniforms:Gt([Pe.lights,Pe.fog,{color:{value:new ot(0)},opacity:{value:1}}]),vertexShader:et.shadow_vert,fragmentShader:et.shadow_frag}};Ji.physical={uniforms:Gt([Ji.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new at(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new ot(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new at},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new ot(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new ot(1,1,1)},specularColorMap:{value:null}}]),vertexShader:et.meshphysical_vert,fragmentShader:et.meshphysical_frag};function yB(i,e,t,r,n,s){const o=new ot(0);let a=n===!0?0:1,l,c,d=null,u=0,h=null;function p(f,m){let b=!1,y=m.isScene===!0?m.background:null;y&&y.isTexture&&(y=e.get(y));const w=i.xr,_=w.getSession&&w.getSession();_&&_.environmentBlendMode==="additive"&&(y=null),y===null?g(o,a):y&&y.isColor&&(g(y,1),b=!0),(i.autoClear||b)&&i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil),y&&(y.isCubeTexture||y.mapping===306)?(c===void 0&&(c=new Qi(new Wa(1,1,1),new us({name:"BackgroundCubeMaterial",uniforms:oo(Ji.cube.uniforms),vertexShader:Ji.cube.vertexShader,fragmentShader:Ji.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(M,S,A){this.matrixWorld.copyPosition(A.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(c)),c.material.uniforms.envMap.value=y,c.material.uniforms.flipEnvMap.value=y.isCubeTexture&&y.isRenderTargetTexture===!1?-1:1,(d!==y||u!==y.version||h!==i.toneMapping)&&(c.material.needsUpdate=!0,d=y,u=y.version,h=i.toneMapping),c.layers.enableAll(),f.unshift(c,c.geometry,c.material,0,0,null)):y&&y.isTexture&&(l===void 0&&(l=new Qi(new pd(2,2),new us({name:"BackgroundMaterial",uniforms:oo(Ji.background.uniforms),vertexShader:Ji.background.vertexShader,fragmentShader:Ji.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(l)),l.material.uniforms.t2D.value=y,y.matrixAutoUpdate===!0&&y.updateMatrix(),l.material.uniforms.uvTransform.value.copy(y.matrix),(d!==y||u!==y.version||h!==i.toneMapping)&&(l.material.needsUpdate=!0,d=y,u=y.version,h=i.toneMapping),l.layers.enableAll(),f.unshift(l,l.geometry,l.material,0,0,null))}function g(f,m){t.buffers.color.setClear(f.r,f.g,f.b,m,s)}return{getClearColor:function(){return o},setClearColor:function(f,m=1){o.set(f),a=m,g(o,a)},getClearAlpha:function(){return a},setClearAlpha:function(f){a=f,g(o,a)},render:p}}function _B(i,e,t,r){const n=i.getParameter(34921),s=r.isWebGL2?null:e.get("OES_vertex_array_object"),o=r.isWebGL2||s!==null,a={},l=m(null);let c=l,d=!1;function u(I,V,N,j,Y){let W=!1;if(o){const ee=f(j,N,V);c!==ee&&(c=ee,p(c.object)),W=b(I,j,N,Y),W&&y(I,j,N,Y)}else{const ee=V.wireframe===!0;(c.geometry!==j.id||c.program!==N.id||c.wireframe!==ee)&&(c.geometry=j.id,c.program=N.id,c.wireframe=ee,W=!0)}Y!==null&&t.update(Y,34963),(W||d)&&(d=!1,x(I,V,N,j),Y!==null&&i.bindBuffer(34963,t.get(Y).buffer))}function h(){return r.isWebGL2?i.createVertexArray():s.createVertexArrayOES()}function p(I){return r.isWebGL2?i.bindVertexArray(I):s.bindVertexArrayOES(I)}function g(I){return r.isWebGL2?i.deleteVertexArray(I):s.deleteVertexArrayOES(I)}function f(I,V,N){const j=N.wireframe===!0;let Y=a[I.id];Y===void 0&&(Y={},a[I.id]=Y);let W=Y[V.id];W===void 0&&(W={},Y[V.id]=W);let ee=W[j];return ee===void 0&&(ee=m(h()),W[j]=ee),ee}function m(I){const V=[],N=[],j=[];for(let Y=0;Y<n;Y++)V[Y]=0,N[Y]=0,j[Y]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:V,enabledAttributes:N,attributeDivisors:j,object:I,attributes:{},index:null}}function b(I,V,N,j){const Y=c.attributes,W=V.attributes;let ee=0;const me=N.getAttributes();for(const X in me)if(me[X].location>=0){const ye=Y[X];let Ce=W[X];if(Ce===void 0&&(X==="instanceMatrix"&&I.instanceMatrix&&(Ce=I.instanceMatrix),X==="instanceColor"&&I.instanceColor&&(Ce=I.instanceColor)),ye===void 0||ye.attribute!==Ce||Ce&&ye.data!==Ce.data)return!0;ee++}return c.attributesNum!==ee||c.index!==j}function y(I,V,N,j){const Y={},W=V.attributes;let ee=0;const me=N.getAttributes();for(const X in me)if(me[X].location>=0){let ye=W[X];ye===void 0&&(X==="instanceMatrix"&&I.instanceMatrix&&(ye=I.instanceMatrix),X==="instanceColor"&&I.instanceColor&&(ye=I.instanceColor));const Ce={};Ce.attribute=ye,ye&&ye.data&&(Ce.data=ye.data),Y[X]=Ce,ee++}c.attributes=Y,c.attributesNum=ee,c.index=j}function w(){const I=c.newAttributes;for(let V=0,N=I.length;V<N;V++)I[V]=0}function _(I){M(I,0)}function M(I,V){const N=c.newAttributes,j=c.enabledAttributes,Y=c.attributeDivisors;N[I]=1,j[I]===0&&(i.enableVertexAttribArray(I),j[I]=1),Y[I]!==V&&((r.isWebGL2?i:e.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](I,V),Y[I]=V)}function S(){const I=c.newAttributes,V=c.enabledAttributes;for(let N=0,j=V.length;N<j;N++)V[N]!==I[N]&&(i.disableVertexAttribArray(N),V[N]=0)}function A(I,V,N,j,Y,W){r.isWebGL2===!0&&(N===5124||N===5125)?i.vertexAttribIPointer(I,V,N,Y,W):i.vertexAttribPointer(I,V,N,j,Y,W)}function x(I,V,N,j){if(r.isWebGL2===!1&&(I.isInstancedMesh||j.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;w();const Y=j.attributes,W=N.getAttributes(),ee=V.defaultAttributeValues;for(const me in W){const X=W[me];if(X.location>=0){let ye=Y[me];if(ye===void 0&&(me==="instanceMatrix"&&I.instanceMatrix&&(ye=I.instanceMatrix),me==="instanceColor"&&I.instanceColor&&(ye=I.instanceColor)),ye!==void 0){const Ce=ye.normalized,We=ye.itemSize,se=t.get(ye);if(se===void 0)continue;const te=se.buffer,fe=se.type,pe=se.bytesPerElement;if(ye.isInterleavedBufferAttribute){const de=ye.data,He=de.stride,$e=ye.offset;if(de.isInstancedInterleavedBuffer){for(let L=0;L<X.locationSize;L++)M(X.location+L,de.meshPerAttribute);I.isInstancedMesh!==!0&&j._maxInstanceCount===void 0&&(j._maxInstanceCount=de.meshPerAttribute*de.count)}else for(let L=0;L<X.locationSize;L++)_(X.location+L);i.bindBuffer(34962,te);for(let L=0;L<X.locationSize;L++)A(X.location+L,We/X.locationSize,fe,Ce,He*pe,($e+We/X.locationSize*L)*pe)}else{if(ye.isInstancedBufferAttribute){for(let de=0;de<X.locationSize;de++)M(X.location+de,ye.meshPerAttribute);I.isInstancedMesh!==!0&&j._maxInstanceCount===void 0&&(j._maxInstanceCount=ye.meshPerAttribute*ye.count)}else for(let de=0;de<X.locationSize;de++)_(X.location+de);i.bindBuffer(34962,te);for(let de=0;de<X.locationSize;de++)A(X.location+de,We/X.locationSize,fe,Ce,We*pe,We/X.locationSize*de*pe)}}else if(ee!==void 0){const Ce=ee[me];if(Ce!==void 0)switch(Ce.length){case 2:i.vertexAttrib2fv(X.location,Ce);break;case 3:i.vertexAttrib3fv(X.location,Ce);break;case 4:i.vertexAttrib4fv(X.location,Ce);break;default:i.vertexAttrib1fv(X.location,Ce)}}}}S()}function E(){R();for(const I in a){const V=a[I];for(const N in V){const j=V[N];for(const Y in j)g(j[Y].object),delete j[Y];delete V[N]}delete a[I]}}function D(I){if(a[I.id]===void 0)return;const V=a[I.id];for(const N in V){const j=V[N];for(const Y in j)g(j[Y].object),delete j[Y];delete V[N]}delete a[I.id]}function F(I){for(const V in a){const N=a[V];if(N[I.id]===void 0)continue;const j=N[I.id];for(const Y in j)g(j[Y].object),delete j[Y];delete N[I.id]}}function R(){B(),d=!0,c!==l&&(c=l,p(c.object))}function B(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:u,reset:R,resetDefaultState:B,dispose:E,releaseStatesOfGeometry:D,releaseStatesOfProgram:F,initAttributes:w,enableAttribute:_,disableUnusedAttributes:S}}function wB(i,e,t,r){const n=r.isWebGL2;let s;function o(c){s=c}function a(c,d){i.drawArrays(s,c,d),t.update(d,s,1)}function l(c,d,u){if(u===0)return;let h,p;if(n)h=i,p="drawArraysInstanced";else if(h=e.get("ANGLE_instanced_arrays"),p="drawArraysInstancedANGLE",h===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}h[p](s,c,d,u),t.update(d,s,u)}this.setMode=o,this.render=a,this.renderInstances=l}function xB(i,e,t){let r;function n(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const A=e.get("EXT_texture_filter_anisotropic");r=i.getParameter(A.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function s(A){if(A==="highp"){if(i.getShaderPrecisionFormat(35633,36338).precision>0&&i.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";A="mediump"}return A==="mediump"&&i.getShaderPrecisionFormat(35633,36337).precision>0&&i.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&i instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&i instanceof WebGL2ComputeRenderingContext;let a=t.precision!==void 0?t.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=o||e.has("WEBGL_draw_buffers"),d=t.logarithmicDepthBuffer===!0,u=i.getParameter(34930),h=i.getParameter(35660),p=i.getParameter(3379),g=i.getParameter(34076),f=i.getParameter(34921),m=i.getParameter(36347),b=i.getParameter(36348),y=i.getParameter(36349),w=h>0,_=o||e.has("OES_texture_float"),M=w&&_,S=o?i.getParameter(36183):0;return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:n,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:d,maxTextures:u,maxVertexTextures:h,maxTextureSize:p,maxCubemapSize:g,maxAttributes:f,maxVertexUniforms:m,maxVaryings:b,maxFragmentUniforms:y,vertexTextures:w,floatFragmentTextures:_,floatVertexTextures:M,maxSamples:S}}function SB(i){const e=this;let t=null,r=0,n=!1,s=!1;const o=new Bn,a=new Ti,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(u,h,p){const g=u.length!==0||h||r!==0||n;return n=h,t=d(u,p,0),r=u.length,g},this.beginShadows=function(){s=!0,d(null)},this.endShadows=function(){s=!1,c()},this.setState=function(u,h,p){const g=u.clippingPlanes,f=u.clipIntersection,m=u.clipShadows,b=i.get(u);if(!n||g===null||g.length===0||s&&!m)s?d(null):c();else{const y=s?0:r,w=y*4;let _=b.clippingState||null;l.value=_,_=d(g,h,w,p);for(let M=0;M!==w;++M)_[M]=t[M];b.clippingState=_,this.numIntersection=f?this.numPlanes:0,this.numPlanes+=y}};function c(){l.value!==t&&(l.value=t,l.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function d(u,h,p,g){const f=u!==null?u.length:0;let m=null;if(f!==0){if(m=l.value,g!==!0||m===null){const b=p+f*4,y=h.matrixWorldInverse;a.getNormalMatrix(y),(m===null||m.length<b)&&(m=new Float32Array(b));for(let w=0,_=p;w!==f;++w,_+=4)o.copy(u[w]).applyMatrix4(y,a),o.normal.toArray(m,_),m[_+3]=o.constant}l.value=m,l.needsUpdate=!0}return e.numPlanes=f,e.numIntersection=0,m}}function MB(i){let e=new WeakMap;function t(o,a){return a===303?o.mapping=301:a===304&&(o.mapping=302),o}function r(o){if(o&&o.isTexture&&o.isRenderTargetTexture===!1){const a=o.mapping;if(a===303||a===304)if(e.has(o)){const l=e.get(o).texture;return t(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const c=new Bz(l.height/2);return c.fromEquirectangularTexture(i,o),e.set(o,c),o.addEventListener("dispose",n),t(c.texture,o.mapping)}else return null}}return o}function n(o){const a=o.target;a.removeEventListener("dispose",n);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:r,dispose:s}}class EB extends Qy{constructor(e=-1,t=1,r=1,n=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=n,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,r,n,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2;let s=r-e,o=r+e,a=n+t,l=n-t;if(this.view!==null&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,d=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=d*this.view.offsetY,l=a-d*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const Hs=4,zg=[.125,.215,.35,.446,.526,.582],Gn=20,vu=new EB,Ng=new ot;let bu=null;const Vn=(1+Math.sqrt(5))/2,Fs=1/Vn,$g=[new J(1,1,1),new J(-1,1,1),new J(1,1,-1),new J(-1,1,-1),new J(0,Vn,Fs),new J(0,Vn,-Fs),new J(Fs,0,Vn),new J(-Fs,0,Vn),new J(Vn,Fs,0),new J(-Vn,Fs,0)];class Bg{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,n=100){bu=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,r,n,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=Ug(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=Hg(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(bu),e.scissorTest=!1,Pl(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===301||e.mapping===302?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),bu=this._renderer.getRenderTarget();const r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:1006,minFilter:1006,generateMipmaps:!1,type:1016,format:1023,encoding:3e3,depthBuffer:!1},n=Vg(e,t,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=Vg(e,t,r);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=kB(s)),this._blurMaterial=CB(s,e,t)}return n}_compileMaterial(e){const t=new Qi(this._lodPlanes[0],e);this._renderer.compile(t,vu)}_sceneToCubeUV(e,t,r,n){const s=new fi(90,1,t,r),o=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],l=this._renderer,c=l.autoClear,d=l.toneMapping;l.getClearColor(Ng),l.toneMapping=0,l.autoClear=!1;const u=new Ky({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),h=new Qi(new Wa,u);let p=!1;const g=e.background;g?g.isColor&&(u.color.copy(g),e.background=null,p=!0):(u.color.copy(Ng),p=!0);for(let f=0;f<6;f++){const m=f%3;m===0?(s.up.set(0,o[f],0),s.lookAt(a[f],0,0)):m===1?(s.up.set(0,0,o[f]),s.lookAt(0,a[f],0)):(s.up.set(0,o[f],0),s.lookAt(0,0,a[f]));const b=this._cubeSize;Pl(n,m*b,f>2?b:0,b,b),l.setRenderTarget(n),p&&l.render(h,s),l.render(e,s)}h.geometry.dispose(),h.material.dispose(),l.toneMapping=d,l.autoClear=c,e.background=g}_textureToCubeUV(e,t){const r=this._renderer,n=e.mapping===301||e.mapping===302;n?(this._cubemapMaterial===null&&(this._cubemapMaterial=Ug()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=Hg());const s=n?this._cubemapMaterial:this._equirectMaterial,o=new Qi(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const l=this._cubeSize;Pl(t,0,0,3*l,2*l),r.setRenderTarget(t),r.render(o,vu)}_applyPMREM(e){const t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let n=1;n<this._lodPlanes.length;n++){const s=Math.sqrt(this._sigmas[n]*this._sigmas[n]-this._sigmas[n-1]*this._sigmas[n-1]),o=$g[(n-1)%$g.length];this._blur(e,n-1,n,s,o)}t.autoClear=r}_blur(e,t,r,n,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,r,n,"latitudinal",s),this._halfBlur(o,e,r,r,n,"longitudinal",s)}_halfBlur(e,t,r,n,s,o,a){const l=this._renderer,c=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const d=3,u=new Qi(this._lodPlanes[n],c),h=c.uniforms,p=this._sizeLods[r]-1,g=isFinite(s)?Math.PI/(2*p):2*Math.PI/(2*Gn-1),f=s/g,m=isFinite(s)?1+Math.floor(d*f):Gn;m>Gn&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${m} samples when the maximum is set to ${Gn}`);const b=[];let y=0;for(let A=0;A<Gn;++A){const x=A/f,E=Math.exp(-x*x/2);b.push(E),A===0?y+=E:A<m&&(y+=2*E)}for(let A=0;A<b.length;A++)b[A]=b[A]/y;h.envMap.value=e.texture,h.samples.value=m,h.weights.value=b,h.latitudinal.value=o==="latitudinal",a&&(h.poleAxis.value=a);const{_lodMax:w}=this;h.dTheta.value=g,h.mipInt.value=w-r;const _=this._sizeLods[n],M=3*_*(n>w-Hs?n-w+Hs:0),S=4*(this._cubeSize-_);Pl(t,M,S,3*_,2*_),l.setRenderTarget(t),l.render(u,vu)}}function kB(i){const e=[],t=[],r=[];let n=i;const s=i-Hs+1+zg.length;for(let o=0;o<s;o++){const a=Math.pow(2,n);t.push(a);let l=1/a;o>i-Hs?l=zg[o-i+Hs-1]:o===0&&(l=0),r.push(l);const c=1/(a-2),d=-c,u=1+c,h=[d,d,u,d,u,u,d,d,u,u,d,u],p=6,g=6,f=3,m=2,b=1,y=new Float32Array(f*g*p),w=new Float32Array(m*g*p),_=new Float32Array(b*g*p);for(let S=0;S<p;S++){const A=S%3*2/3-1,x=S>2?0:-1,E=[A,x,0,A+2/3,x,0,A+2/3,x+1,0,A,x,0,A+2/3,x+1,0,A,x+1,0];y.set(E,f*g*S),w.set(h,m*g*S);const D=[S,S,S,S,S,S];_.set(D,b*g*S)}const M=new lr;M.setAttribute("position",new rr(y,f)),M.setAttribute("uv",new rr(w,m)),M.setAttribute("faceIndex",new rr(_,b)),e.push(M),n>Hs&&n--}return{lodPlanes:e,sizeLods:t,sigmas:r}}function Vg(i,e,t){const r=new ds(i,e,t);return r.texture.mapping=306,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function Pl(i,e,t,r,n){i.viewport.set(e,t,r,n),i.scissor.set(e,t,r,n)}function CB(i,e,t){const r=new Float32Array(Gn),n=new J(0,1,0);return new us({name:"SphericalGaussianBlur",defines:{n:Gn,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n}},vertexShader:$f(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:0,depthTest:!1,depthWrite:!1})}function Hg(){return new us({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:$f(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:0,depthTest:!1,depthWrite:!1})}function Ug(){return new us({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:$f(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:0,depthTest:!1,depthWrite:!1})}function $f(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function TB(i){let e=new WeakMap,t=null;function r(a){if(a&&a.isTexture){const l=a.mapping,c=l===303||l===304,d=l===301||l===302;if(c||d)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let u=e.get(a);return t===null&&(t=new Bg(i)),u=c?t.fromEquirectangular(a,u):t.fromCubemap(a,u),e.set(a,u),u.texture}else{if(e.has(a))return e.get(a).texture;{const u=a.image;if(c&&u&&u.height>0||d&&u&&n(u)){t===null&&(t=new Bg(i));const h=c?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,h),a.addEventListener("dispose",s),h.texture}else return null}}}return a}function n(a){let l=0;const c=6;for(let d=0;d<c;d++)a[d]!==void 0&&l++;return l===c}function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:r,dispose:o}}function AB(i){const e={};function t(r){if(e[r]!==void 0)return e[r];let n;switch(r){case"WEBGL_depth_texture":n=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=i.getExtension(r)}return e[r]=n,n}return{has:function(r){return t(r)!==null},init:function(r){r.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(r){const n=t(r);return n===null&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),n}}}function LB(i,e,t,r){const n={},s=new WeakMap;function o(u){const h=u.target;h.index!==null&&e.remove(h.index);for(const g in h.attributes)e.remove(h.attributes[g]);h.removeEventListener("dispose",o),delete n[h.id];const p=s.get(h);p&&(e.remove(p),s.delete(h)),r.releaseStatesOfGeometry(h),h.isInstancedBufferGeometry===!0&&delete h._maxInstanceCount,t.memory.geometries--}function a(u,h){return n[h.id]===!0||(h.addEventListener("dispose",o),n[h.id]=!0,t.memory.geometries++),h}function l(u){const h=u.attributes;for(const g in h)e.update(h[g],34962);const p=u.morphAttributes;for(const g in p){const f=p[g];for(let m=0,b=f.length;m<b;m++)e.update(f[m],34962)}}function c(u){const h=[],p=u.index,g=u.attributes.position;let f=0;if(p!==null){const y=p.array;f=p.version;for(let w=0,_=y.length;w<_;w+=3){const M=y[w+0],S=y[w+1],A=y[w+2];h.push(M,S,S,A,A,M)}}else{const y=g.array;f=g.version;for(let w=0,_=y.length/3-1;w<_;w+=3){const M=w+0,S=w+1,A=w+2;h.push(M,S,S,A,A,M)}}const m=new(jy(h)?Zy:Jy)(h,1);m.version=f;const b=s.get(u);b&&e.remove(b),s.set(u,m)}function d(u){const h=s.get(u);if(h){const p=u.index;p!==null&&h.version<p.version&&c(u)}else c(u);return s.get(u)}return{get:a,update:l,getWireframeAttribute:d}}function DB(i,e,t,r){const n=r.isWebGL2;let s;function o(h){s=h}let a,l;function c(h){a=h.type,l=h.bytesPerElement}function d(h,p){i.drawElements(s,p,a,h*l),t.update(p,s,1)}function u(h,p,g){if(g===0)return;let f,m;if(n)f=i,m="drawElementsInstanced";else if(f=e.get("ANGLE_instanced_arrays"),m="drawElementsInstancedANGLE",f===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}f[m](s,p,a,h*l,g),t.update(p,s,g)}this.setMode=o,this.setIndex=c,this.render=d,this.renderInstances=u}function PB(i){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function r(s,o,a){switch(t.calls++,o){case 4:t.triangles+=a*(s/3);break;case 1:t.lines+=a*(s/2);break;case 3:t.lines+=a*(s-1);break;case 2:t.lines+=a*s;break;case 0:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function n(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:n,update:r}}function RB(i,e){return i[0]-e[0]}function IB(i,e){return Math.abs(e[1])-Math.abs(i[1])}function yu(i,e){let t=1;const r=e.isInterleavedBufferAttribute?e.data.array:e.array;r instanceof Int8Array?t=127:r instanceof Uint8Array?t=255:r instanceof Uint16Array?t=65535:r instanceof Int16Array?t=32767:r instanceof Int32Array?t=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",r),i.divideScalar(t)}function OB(i,e,t){const r={},n=new Float32Array(8),s=new WeakMap,o=new Ot,a=[];for(let c=0;c<8;c++)a[c]=[c,0];function l(c,d,u,h){const p=c.morphTargetInfluences;if(e.isWebGL2===!0){const g=d.morphAttributes.position||d.morphAttributes.normal||d.morphAttributes.color,f=g!==void 0?g.length:0;let m=s.get(d);if(m===void 0||m.count!==f){let w=function(){I.dispose(),s.delete(d),d.removeEventListener("dispose",w)};m!==void 0&&m.texture.dispose();const _=d.morphAttributes.position!==void 0,M=d.morphAttributes.normal!==void 0,S=d.morphAttributes.color!==void 0,A=d.morphAttributes.position||[],x=d.morphAttributes.normal||[],E=d.morphAttributes.color||[];let D=0;_===!0&&(D=1),M===!0&&(D=2),S===!0&&(D=3);let F=d.attributes.position.count*D,R=1;F>e.maxTextureSize&&(R=Math.ceil(F/e.maxTextureSize),F=e.maxTextureSize);const B=new Float32Array(F*R*4*f),I=new Yy(B,F,R,f);I.type=1015,I.needsUpdate=!0;const V=D*4;for(let N=0;N<f;N++){const j=A[N],Y=x[N],W=E[N],ee=F*R*4*N;for(let me=0;me<j.count;me++){const X=me*V;_===!0&&(o.fromBufferAttribute(j,me),j.normalized===!0&&yu(o,j),B[ee+X+0]=o.x,B[ee+X+1]=o.y,B[ee+X+2]=o.z,B[ee+X+3]=0),M===!0&&(o.fromBufferAttribute(Y,me),Y.normalized===!0&&yu(o,Y),B[ee+X+4]=o.x,B[ee+X+5]=o.y,B[ee+X+6]=o.z,B[ee+X+7]=0),S===!0&&(o.fromBufferAttribute(W,me),W.normalized===!0&&yu(o,W),B[ee+X+8]=o.x,B[ee+X+9]=o.y,B[ee+X+10]=o.z,B[ee+X+11]=W.itemSize===4?o.w:1)}}m={count:f,texture:I,size:new at(F,R)},s.set(d,m),d.addEventListener("dispose",w)}let b=0;for(let w=0;w<p.length;w++)b+=p[w];const y=d.morphTargetsRelative?1:1-b;h.getUniforms().setValue(i,"morphTargetBaseInfluence",y),h.getUniforms().setValue(i,"morphTargetInfluences",p),h.getUniforms().setValue(i,"morphTargetsTexture",m.texture,t),h.getUniforms().setValue(i,"morphTargetsTextureSize",m.size)}else{const g=p===void 0?0:p.length;let f=r[d.id];if(f===void 0||f.length!==g){f=[];for(let _=0;_<g;_++)f[_]=[_,0];r[d.id]=f}for(let _=0;_<g;_++){const M=f[_];M[0]=_,M[1]=p[_]}f.sort(IB);for(let _=0;_<8;_++)_<g&&f[_][1]?(a[_][0]=f[_][0],a[_][1]=f[_][1]):(a[_][0]=Number.MAX_SAFE_INTEGER,a[_][1]=0);a.sort(RB);const m=d.morphAttributes.position,b=d.morphAttributes.normal;let y=0;for(let _=0;_<8;_++){const M=a[_],S=M[0],A=M[1];S!==Number.MAX_SAFE_INTEGER&&A?(m&&d.getAttribute("morphTarget"+_)!==m[S]&&d.setAttribute("morphTarget"+_,m[S]),b&&d.getAttribute("morphNormal"+_)!==b[S]&&d.setAttribute("morphNormal"+_,b[S]),n[_]=A,y+=A):(m&&d.hasAttribute("morphTarget"+_)===!0&&d.deleteAttribute("morphTarget"+_),b&&d.hasAttribute("morphNormal"+_)===!0&&d.deleteAttribute("morphNormal"+_),n[_]=0)}const w=d.morphTargetsRelative?1:1-y;h.getUniforms().setValue(i,"morphTargetBaseInfluence",w),h.getUniforms().setValue(i,"morphTargetInfluences",n)}}return{update:l}}function FB(i,e,t,r){let n=new WeakMap;function s(l){const c=r.render.frame,d=l.geometry,u=e.get(l,d);return n.get(u)!==c&&(e.update(u),n.set(u,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),t.update(l.instanceMatrix,34962),l.instanceColor!==null&&t.update(l.instanceColor,34962)),u}function o(){n=new WeakMap}function a(l){const c=l.target;c.removeEventListener("dispose",a),t.remove(c.instanceMatrix),c.instanceColor!==null&&t.remove(c.instanceColor)}return{update:s,dispose:o}}const i_=new vi,r_=new Yy,n_=new Sz,s_=new e_,jg=[],Wg=[],Gg=new Float32Array(16),qg=new Float32Array(9),Yg=new Float32Array(4);function go(i,e,t){const r=i[0];if(r<=0||r>0)return i;const n=e*t;let s=jg[n];if(s===void 0&&(s=new Float32Array(n),jg[n]=s),e!==0){r.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,i[o].toArray(s,a)}return s}function ti(i,e){if(i.length!==e.length)return!1;for(let t=0,r=i.length;t<r;t++)if(i[t]!==e[t])return!1;return!0}function ii(i,e){for(let t=0,r=e.length;t<r;t++)i[t]=e[t]}function md(i,e){let t=Wg[e];t===void 0&&(t=new Int32Array(e),Wg[e]=t);for(let r=0;r!==e;++r)t[r]=i.allocateTextureUnit();return t}function zB(i,e){const t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}function NB(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ti(t,e))return;i.uniform2fv(this.addr,e),ii(t,e)}}function $B(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(ti(t,e))return;i.uniform3fv(this.addr,e),ii(t,e)}}function BB(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ti(t,e))return;i.uniform4fv(this.addr,e),ii(t,e)}}function VB(i,e){const t=this.cache,r=e.elements;if(r===void 0){if(ti(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),ii(t,e)}else{if(ti(t,r))return;Yg.set(r),i.uniformMatrix2fv(this.addr,!1,Yg),ii(t,r)}}function HB(i,e){const t=this.cache,r=e.elements;if(r===void 0){if(ti(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),ii(t,e)}else{if(ti(t,r))return;qg.set(r),i.uniformMatrix3fv(this.addr,!1,qg),ii(t,r)}}function UB(i,e){const t=this.cache,r=e.elements;if(r===void 0){if(ti(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),ii(t,e)}else{if(ti(t,r))return;Gg.set(r),i.uniformMatrix4fv(this.addr,!1,Gg),ii(t,r)}}function jB(i,e){const t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}function WB(i,e){const t=this.cache;ti(t,e)||(i.uniform2iv(this.addr,e),ii(t,e))}function GB(i,e){const t=this.cache;ti(t,e)||(i.uniform3iv(this.addr,e),ii(t,e))}function qB(i,e){const t=this.cache;ti(t,e)||(i.uniform4iv(this.addr,e),ii(t,e))}function YB(i,e){const t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}function XB(i,e){const t=this.cache;ti(t,e)||(i.uniform2uiv(this.addr,e),ii(t,e))}function KB(i,e){const t=this.cache;ti(t,e)||(i.uniform3uiv(this.addr,e),ii(t,e))}function JB(i,e){const t=this.cache;ti(t,e)||(i.uniform4uiv(this.addr,e),ii(t,e))}function ZB(i,e,t){const r=this.cache,n=t.allocateTextureUnit();r[0]!==n&&(i.uniform1i(this.addr,n),r[0]=n),t.setTexture2D(e||i_,n)}function QB(i,e,t){const r=this.cache,n=t.allocateTextureUnit();r[0]!==n&&(i.uniform1i(this.addr,n),r[0]=n),t.setTexture3D(e||n_,n)}function e8(i,e,t){const r=this.cache,n=t.allocateTextureUnit();r[0]!==n&&(i.uniform1i(this.addr,n),r[0]=n),t.setTextureCube(e||s_,n)}function t8(i,e,t){const r=this.cache,n=t.allocateTextureUnit();r[0]!==n&&(i.uniform1i(this.addr,n),r[0]=n),t.setTexture2DArray(e||r_,n)}function i8(i){switch(i){case 5126:return zB;case 35664:return NB;case 35665:return $B;case 35666:return BB;case 35674:return VB;case 35675:return HB;case 35676:return UB;case 5124:case 35670:return jB;case 35667:case 35671:return WB;case 35668:case 35672:return GB;case 35669:case 35673:return qB;case 5125:return YB;case 36294:return XB;case 36295:return KB;case 36296:return JB;case 35678:case 36198:case 36298:case 36306:case 35682:return ZB;case 35679:case 36299:case 36307:return QB;case 35680:case 36300:case 36308:case 36293:return e8;case 36289:case 36303:case 36311:case 36292:return t8}}function r8(i,e){i.uniform1fv(this.addr,e)}function n8(i,e){const t=go(e,this.size,2);i.uniform2fv(this.addr,t)}function s8(i,e){const t=go(e,this.size,3);i.uniform3fv(this.addr,t)}function o8(i,e){const t=go(e,this.size,4);i.uniform4fv(this.addr,t)}function a8(i,e){const t=go(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}function l8(i,e){const t=go(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}function c8(i,e){const t=go(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}function d8(i,e){i.uniform1iv(this.addr,e)}function u8(i,e){i.uniform2iv(this.addr,e)}function h8(i,e){i.uniform3iv(this.addr,e)}function f8(i,e){i.uniform4iv(this.addr,e)}function p8(i,e){i.uniform1uiv(this.addr,e)}function m8(i,e){i.uniform2uiv(this.addr,e)}function g8(i,e){i.uniform3uiv(this.addr,e)}function v8(i,e){i.uniform4uiv(this.addr,e)}function b8(i,e,t){const r=e.length,n=md(t,r);i.uniform1iv(this.addr,n);for(let s=0;s!==r;++s)t.setTexture2D(e[s]||i_,n[s])}function y8(i,e,t){const r=e.length,n=md(t,r);i.uniform1iv(this.addr,n);for(let s=0;s!==r;++s)t.setTexture3D(e[s]||n_,n[s])}function _8(i,e,t){const r=e.length,n=md(t,r);i.uniform1iv(this.addr,n);for(let s=0;s!==r;++s)t.setTextureCube(e[s]||s_,n[s])}function w8(i,e,t){const r=e.length,n=md(t,r);i.uniform1iv(this.addr,n);for(let s=0;s!==r;++s)t.setTexture2DArray(e[s]||r_,n[s])}function x8(i){switch(i){case 5126:return r8;case 35664:return n8;case 35665:return s8;case 35666:return o8;case 35674:return a8;case 35675:return l8;case 35676:return c8;case 5124:case 35670:return d8;case 35667:case 35671:return u8;case 35668:case 35672:return h8;case 35669:case 35673:return f8;case 5125:return p8;case 36294:return m8;case 36295:return g8;case 36296:return v8;case 35678:case 36198:case 36298:case 36306:case 35682:return b8;case 35679:case 36299:case 36307:return y8;case 35680:case 36300:case 36308:case 36293:return _8;case 36289:case 36303:case 36311:case 36292:return w8}}class S8{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.setValue=i8(t.type)}}class M8{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.size=t.size,this.setValue=x8(t.type)}}class E8{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){const n=this.seq;for(let s=0,o=n.length;s!==o;++s){const a=n[s];a.setValue(e,t[a.id],r)}}}const _u=/(\w+)(\])?(\[|\.)?/g;function Xg(i,e){i.seq.push(e),i.map[e.id]=e}function k8(i,e,t){const r=i.name,n=r.length;for(_u.lastIndex=0;;){const s=_u.exec(r),o=_u.lastIndex;let a=s[1];const l=s[2]==="]",c=s[3];if(l&&(a=a|0),c===void 0||c==="["&&o+2===n){Xg(t,c===void 0?new S8(a,i,e):new M8(a,i,e));break}else{let d=t.map[a];d===void 0&&(d=new E8(a),Xg(t,d)),t=d}}}class ec{constructor(e,t){this.seq=[],this.map={};const r=e.getProgramParameter(t,35718);for(let n=0;n<r;++n){const s=e.getActiveUniform(t,n),o=e.getUniformLocation(t,s.name);k8(s,o,this)}}setValue(e,t,r,n){const s=this.map[t];s!==void 0&&s.setValue(e,r,n)}setOptional(e,t,r){const n=t[r];n!==void 0&&this.setValue(e,r,n)}static upload(e,t,r,n){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=r[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,n)}}static seqWithValue(e,t){const r=[];for(let n=0,s=e.length;n!==s;++n){const o=e[n];o.id in t&&r.push(o)}return r}}function Kg(i,e,t){const r=i.createShader(e);return i.shaderSource(r,t),i.compileShader(r),r}let C8=0;function T8(i,e){const t=i.split(`
`),r=[],n=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=n;o<s;o++){const a=o+1;r.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return r.join(`
`)}function A8(i){switch(i){case 3e3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",i),["Linear","( value )"]}}function Jg(i,e,t){const r=i.getShaderParameter(e,35713),n=i.getShaderInfoLog(e).trim();if(r&&n==="")return"";const s=/ERROR: 0:(\d+)/.exec(n);if(s){const o=parseInt(s[1]);return t.toUpperCase()+`

`+n+`

`+T8(i.getShaderSource(e),o)}else return n}function L8(i,e){const t=A8(e);return"vec4 "+i+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function D8(i,e){let t;switch(e){case 1:t="Linear";break;case 2:t="Reinhard";break;case 3:t="OptimizedCineon";break;case 4:t="ACESFilmic";break;case 5:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function P8(i){return[i.extensionDerivatives||i.envMapCubeUVHeight||i.bumpMap||i.tangentSpaceNormalMap||i.clearcoatNormalMap||i.flatShading||i.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(i.extensionFragDepth||i.logarithmicDepthBuffer)&&i.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",i.extensionDrawBuffers&&i.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(i.extensionShaderTextureLOD||i.envMap||i.transmission)&&i.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Ho).join(`
`)}function R8(i){const e=[];for(const t in i){const r=i[t];r!==!1&&e.push("#define "+t+" "+r)}return e.join(`
`)}function I8(i,e){const t={},r=i.getProgramParameter(e,35721);for(let n=0;n<r;n++){const s=i.getActiveAttrib(e,n),o=s.name;let a=1;s.type===35674&&(a=2),s.type===35675&&(a=3),s.type===35676&&(a=4),t[o]={type:s.type,location:i.getAttribLocation(e,o),locationSize:a}}return t}function Ho(i){return i!==""}function Zg(i,e){return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Qg(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const O8=/^[ \t]*#include +<([\w\d./]+)>/gm;function ph(i){return i.replace(O8,F8)}function F8(i,e){const t=et[e];if(t===void 0)throw new Error("Can not resolve #include <"+e+">");return ph(t)}const z8=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,N8=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function e0(i){return i.replace(N8,o_).replace(z8,$8)}function $8(i,e,t,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),o_(i,e,t,r)}function o_(i,e,t,r){let n="";for(let s=parseInt(e);s<parseInt(t);s++)n+=r.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return n}function t0(i){let e="precision "+i.precision+` float;
precision `+i.precision+" int;";return i.precision==="highp"?e+=`
#define HIGH_PRECISION`:i.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function B8(i){let e="SHADOWMAP_TYPE_BASIC";return i.shadowMapType===1?e="SHADOWMAP_TYPE_PCF":i.shadowMapType===2?e="SHADOWMAP_TYPE_PCF_SOFT":i.shadowMapType===3&&(e="SHADOWMAP_TYPE_VSM"),e}function V8(i){let e="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case 301:case 302:e="ENVMAP_TYPE_CUBE";break;case 306:e="ENVMAP_TYPE_CUBE_UV";break}return e}function H8(i){let e="ENVMAP_MODE_REFLECTION";if(i.envMap)switch(i.envMapMode){case 302:e="ENVMAP_MODE_REFRACTION";break}return e}function U8(i){let e="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD";break}return e}function j8(i){const e=i.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:r,maxMip:t}}function W8(i,e,t,r){const n=i.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=B8(t),c=V8(t),d=H8(t),u=U8(t),h=j8(t),p=t.isWebGL2?"":P8(t),g=R8(s),f=n.createProgram();let m,b,y=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(m=[g].filter(Ho).join(`
`),m.length>0&&(m+=`
`),b=[p,g].filter(Ho).join(`
`),b.length>0&&(b+=`
`)):(m=[t0(t),"#define SHADER_NAME "+t.shaderName,g,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+d:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Ho).join(`
`),b=[p,t0(t),"#define SHADER_NAME "+t.shaderName,g,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+d:"",t.envMap?"#define "+u:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==0?"#define TONE_MAPPING":"",t.toneMapping!==0?et.tonemapping_pars_fragment:"",t.toneMapping!==0?D8("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",et.encodings_pars_fragment,L8("linearToOutputTexel",t.outputEncoding),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Ho).join(`
`)),o=ph(o),o=Zg(o,t),o=Qg(o,t),a=ph(a),a=Zg(a,t),a=Qg(a,t),o=e0(o),a=e0(a),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(y=`#version 300 es
`,m=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+m,b=["#define varying in",t.glslVersion===Mg?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===Mg?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+b);const w=y+m+o,_=y+b+a,M=Kg(n,35633,w),S=Kg(n,35632,_);if(n.attachShader(f,M),n.attachShader(f,S),t.index0AttributeName!==void 0?n.bindAttribLocation(f,0,t.index0AttributeName):t.morphTargets===!0&&n.bindAttribLocation(f,0,"position"),n.linkProgram(f),i.debug.checkShaderErrors){const E=n.getProgramInfoLog(f).trim(),D=n.getShaderInfoLog(M).trim(),F=n.getShaderInfoLog(S).trim();let R=!0,B=!0;if(n.getProgramParameter(f,35714)===!1){R=!1;const I=Jg(n,M,"vertex"),V=Jg(n,S,"fragment");console.error("THREE.WebGLProgram: Shader Error "+n.getError()+" - VALIDATE_STATUS "+n.getProgramParameter(f,35715)+`

Program Info Log: `+E+`
`+I+`
`+V)}else E!==""?console.warn("THREE.WebGLProgram: Program Info Log:",E):(D===""||F==="")&&(B=!1);B&&(this.diagnostics={runnable:R,programLog:E,vertexShader:{log:D,prefix:m},fragmentShader:{log:F,prefix:b}})}n.deleteShader(M),n.deleteShader(S);let A;this.getUniforms=function(){return A===void 0&&(A=new ec(n,f)),A};let x;return this.getAttributes=function(){return x===void 0&&(x=I8(n,f)),x},this.destroy=function(){r.releaseStatesOfProgram(this),n.deleteProgram(f),this.program=void 0},this.name=t.shaderName,this.id=C8++,this.cacheKey=e,this.usedTimes=1,this.program=f,this.vertexShader=M,this.fragmentShader=S,this}let G8=0;class q8{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,r=e.fragmentShader,n=this._getShaderStage(t),s=this._getShaderStage(r),o=this._getShaderCacheForMaterial(e);return o.has(n)===!1&&(o.add(n),n.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const r of t)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;return t.has(e)===!1&&t.set(e,new Set),t.get(e)}_getShaderStage(e){const t=this.shaderCache;if(t.has(e)===!1){const r=new Y8(e);t.set(e,r)}return t.get(e)}}class Y8{constructor(e){this.id=G8++,this.code=e,this.usedTimes=0}}function X8(i,e,t,r,n,s,o){const a=new Xy,l=new q8,c=[],d=n.isWebGL2,u=n.logarithmicDepthBuffer,h=n.vertexTextures;let p=n.precision;const g={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function f(x,E,D,F,R){const B=F.fog,I=R.geometry,V=x.isMeshStandardMaterial?F.environment:null,N=(x.isMeshStandardMaterial?t:e).get(x.envMap||V),j=N&&N.mapping===306?N.image.height:null,Y=g[x.type];x.precision!==null&&(p=n.getMaxPrecision(x.precision),p!==x.precision&&console.warn("THREE.WebGLProgram.getParameters:",x.precision,"not supported, using",p,"instead."));const W=I.morphAttributes.position||I.morphAttributes.normal||I.morphAttributes.color,ee=W!==void 0?W.length:0;let me=0;I.morphAttributes.position!==void 0&&(me=1),I.morphAttributes.normal!==void 0&&(me=2),I.morphAttributes.color!==void 0&&(me=3);let X,ye,Ce,We;if(Y){const de=Ji[Y];X=de.vertexShader,ye=de.fragmentShader}else X=x.vertexShader,ye=x.fragmentShader,l.update(x),Ce=l.getVertexShaderID(x),We=l.getFragmentShaderID(x);const se=i.getRenderTarget(),te=x.alphaTest>0,fe=x.clearcoat>0,pe=x.iridescence>0;return{isWebGL2:d,shaderID:Y,shaderName:x.type,vertexShader:X,fragmentShader:ye,defines:x.defines,customVertexShaderID:Ce,customFragmentShaderID:We,isRawShaderMaterial:x.isRawShaderMaterial===!0,glslVersion:x.glslVersion,precision:p,instancing:R.isInstancedMesh===!0,instancingColor:R.isInstancedMesh===!0&&R.instanceColor!==null,supportsVertexTextures:h,outputEncoding:se===null?i.outputEncoding:se.isXRRenderTarget===!0?se.texture.encoding:3e3,map:!!x.map,matcap:!!x.matcap,envMap:!!N,envMapMode:N&&N.mapping,envMapCubeUVHeight:j,lightMap:!!x.lightMap,aoMap:!!x.aoMap,emissiveMap:!!x.emissiveMap,bumpMap:!!x.bumpMap,normalMap:!!x.normalMap,objectSpaceNormalMap:x.normalMapType===1,tangentSpaceNormalMap:x.normalMapType===0,decodeVideoTexture:!!x.map&&x.map.isVideoTexture===!0&&x.map.encoding===3001,clearcoat:fe,clearcoatMap:fe&&!!x.clearcoatMap,clearcoatRoughnessMap:fe&&!!x.clearcoatRoughnessMap,clearcoatNormalMap:fe&&!!x.clearcoatNormalMap,iridescence:pe,iridescenceMap:pe&&!!x.iridescenceMap,iridescenceThicknessMap:pe&&!!x.iridescenceThicknessMap,displacementMap:!!x.displacementMap,roughnessMap:!!x.roughnessMap,metalnessMap:!!x.metalnessMap,specularMap:!!x.specularMap,specularIntensityMap:!!x.specularIntensityMap,specularColorMap:!!x.specularColorMap,opaque:x.transparent===!1&&x.blending===1,alphaMap:!!x.alphaMap,alphaTest:te,gradientMap:!!x.gradientMap,sheen:x.sheen>0,sheenColorMap:!!x.sheenColorMap,sheenRoughnessMap:!!x.sheenRoughnessMap,transmission:x.transmission>0,transmissionMap:!!x.transmissionMap,thicknessMap:!!x.thicknessMap,combine:x.combine,vertexTangents:!!x.normalMap&&!!I.attributes.tangent,vertexColors:x.vertexColors,vertexAlphas:x.vertexColors===!0&&!!I.attributes.color&&I.attributes.color.itemSize===4,vertexUvs:!!x.map||!!x.bumpMap||!!x.normalMap||!!x.specularMap||!!x.alphaMap||!!x.emissiveMap||!!x.roughnessMap||!!x.metalnessMap||!!x.clearcoatMap||!!x.clearcoatRoughnessMap||!!x.clearcoatNormalMap||!!x.iridescenceMap||!!x.iridescenceThicknessMap||!!x.displacementMap||!!x.transmissionMap||!!x.thicknessMap||!!x.specularIntensityMap||!!x.specularColorMap||!!x.sheenColorMap||!!x.sheenRoughnessMap,uvsVertexOnly:!(x.map||x.bumpMap||x.normalMap||x.specularMap||x.alphaMap||x.emissiveMap||x.roughnessMap||x.metalnessMap||x.clearcoatNormalMap||x.iridescenceMap||x.iridescenceThicknessMap||x.transmission>0||x.transmissionMap||x.thicknessMap||x.specularIntensityMap||x.specularColorMap||x.sheen>0||x.sheenColorMap||x.sheenRoughnessMap)&&!!x.displacementMap,fog:!!B,useFog:x.fog===!0,fogExp2:B&&B.isFogExp2,flatShading:!!x.flatShading,sizeAttenuation:x.sizeAttenuation,logarithmicDepthBuffer:u,skinning:R.isSkinnedMesh===!0,morphTargets:I.morphAttributes.position!==void 0,morphNormals:I.morphAttributes.normal!==void 0,morphColors:I.morphAttributes.color!==void 0,morphTargetsCount:ee,morphTextureStride:me,numDirLights:E.directional.length,numPointLights:E.point.length,numSpotLights:E.spot.length,numRectAreaLights:E.rectArea.length,numHemiLights:E.hemi.length,numDirLightShadows:E.directionalShadowMap.length,numPointLightShadows:E.pointShadowMap.length,numSpotLightShadows:E.spotShadowMap.length,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:x.dithering,shadowMapEnabled:i.shadowMap.enabled&&D.length>0,shadowMapType:i.shadowMap.type,toneMapping:x.toneMapped?i.toneMapping:0,physicallyCorrectLights:i.physicallyCorrectLights,premultipliedAlpha:x.premultipliedAlpha,doubleSided:x.side===2,flipSided:x.side===1,useDepthPacking:!!x.depthPacking,depthPacking:x.depthPacking||0,index0AttributeName:x.index0AttributeName,extensionDerivatives:x.extensions&&x.extensions.derivatives,extensionFragDepth:x.extensions&&x.extensions.fragDepth,extensionDrawBuffers:x.extensions&&x.extensions.drawBuffers,extensionShaderTextureLOD:x.extensions&&x.extensions.shaderTextureLOD,rendererExtensionFragDepth:d||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:d||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:d||r.has("EXT_shader_texture_lod"),customProgramCacheKey:x.customProgramCacheKey()}}function m(x){const E=[];if(x.shaderID?E.push(x.shaderID):(E.push(x.customVertexShaderID),E.push(x.customFragmentShaderID)),x.defines!==void 0)for(const D in x.defines)E.push(D),E.push(x.defines[D]);return x.isRawShaderMaterial===!1&&(b(E,x),y(E,x),E.push(i.outputEncoding)),E.push(x.customProgramCacheKey),E.join()}function b(x,E){x.push(E.precision),x.push(E.outputEncoding),x.push(E.envMapMode),x.push(E.envMapCubeUVHeight),x.push(E.combine),x.push(E.vertexUvs),x.push(E.fogExp2),x.push(E.sizeAttenuation),x.push(E.morphTargetsCount),x.push(E.morphAttributeCount),x.push(E.numDirLights),x.push(E.numPointLights),x.push(E.numSpotLights),x.push(E.numHemiLights),x.push(E.numRectAreaLights),x.push(E.numDirLightShadows),x.push(E.numPointLightShadows),x.push(E.numSpotLightShadows),x.push(E.shadowMapType),x.push(E.toneMapping),x.push(E.numClippingPlanes),x.push(E.numClipIntersection),x.push(E.depthPacking)}function y(x,E){a.disableAll(),E.isWebGL2&&a.enable(0),E.supportsVertexTextures&&a.enable(1),E.instancing&&a.enable(2),E.instancingColor&&a.enable(3),E.map&&a.enable(4),E.matcap&&a.enable(5),E.envMap&&a.enable(6),E.lightMap&&a.enable(7),E.aoMap&&a.enable(8),E.emissiveMap&&a.enable(9),E.bumpMap&&a.enable(10),E.normalMap&&a.enable(11),E.objectSpaceNormalMap&&a.enable(12),E.tangentSpaceNormalMap&&a.enable(13),E.clearcoat&&a.enable(14),E.clearcoatMap&&a.enable(15),E.clearcoatRoughnessMap&&a.enable(16),E.clearcoatNormalMap&&a.enable(17),E.iridescence&&a.enable(18),E.iridescenceMap&&a.enable(19),E.iridescenceThicknessMap&&a.enable(20),E.displacementMap&&a.enable(21),E.specularMap&&a.enable(22),E.roughnessMap&&a.enable(23),E.metalnessMap&&a.enable(24),E.gradientMap&&a.enable(25),E.alphaMap&&a.enable(26),E.alphaTest&&a.enable(27),E.vertexColors&&a.enable(28),E.vertexAlphas&&a.enable(29),E.vertexUvs&&a.enable(30),E.vertexTangents&&a.enable(31),E.uvsVertexOnly&&a.enable(32),E.fog&&a.enable(33),x.push(a.mask),a.disableAll(),E.useFog&&a.enable(0),E.flatShading&&a.enable(1),E.logarithmicDepthBuffer&&a.enable(2),E.skinning&&a.enable(3),E.morphTargets&&a.enable(4),E.morphNormals&&a.enable(5),E.morphColors&&a.enable(6),E.premultipliedAlpha&&a.enable(7),E.shadowMapEnabled&&a.enable(8),E.physicallyCorrectLights&&a.enable(9),E.doubleSided&&a.enable(10),E.flipSided&&a.enable(11),E.useDepthPacking&&a.enable(12),E.dithering&&a.enable(13),E.specularIntensityMap&&a.enable(14),E.specularColorMap&&a.enable(15),E.transmission&&a.enable(16),E.transmissionMap&&a.enable(17),E.thicknessMap&&a.enable(18),E.sheen&&a.enable(19),E.sheenColorMap&&a.enable(20),E.sheenRoughnessMap&&a.enable(21),E.decodeVideoTexture&&a.enable(22),E.opaque&&a.enable(23),x.push(a.mask)}function w(x){const E=g[x.type];let D;if(E){const F=Ji[E];D=Fz.clone(F.uniforms)}else D=x.uniforms;return D}function _(x,E){let D;for(let F=0,R=c.length;F<R;F++){const B=c[F];if(B.cacheKey===E){D=B,++D.usedTimes;break}}return D===void 0&&(D=new W8(i,E,x,s),c.push(D)),D}function M(x){if(--x.usedTimes===0){const E=c.indexOf(x);c[E]=c[c.length-1],c.pop(),x.destroy()}}function S(x){l.remove(x)}function A(){l.dispose()}return{getParameters:f,getProgramCacheKey:m,getUniforms:w,acquireProgram:_,releaseProgram:M,releaseShaderCache:S,programs:c,dispose:A}}function K8(){let i=new WeakMap;function e(s){let o=i.get(s);return o===void 0&&(o={},i.set(s,o)),o}function t(s){i.delete(s)}function r(s,o,a){i.get(s)[o]=a}function n(){i=new WeakMap}return{get:e,remove:t,update:r,dispose:n}}function J8(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}function i0(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function r0(){const i=[];let e=0;const t=[],r=[],n=[];function s(){e=0,t.length=0,r.length=0,n.length=0}function o(u,h,p,g,f,m){let b=i[e];return b===void 0?(b={id:u.id,object:u,geometry:h,material:p,groupOrder:g,renderOrder:u.renderOrder,z:f,group:m},i[e]=b):(b.id=u.id,b.object=u,b.geometry=h,b.material=p,b.groupOrder=g,b.renderOrder=u.renderOrder,b.z=f,b.group=m),e++,b}function a(u,h,p,g,f,m){const b=o(u,h,p,g,f,m);p.transmission>0?r.push(b):p.transparent===!0?n.push(b):t.push(b)}function l(u,h,p,g,f,m){const b=o(u,h,p,g,f,m);p.transmission>0?r.unshift(b):p.transparent===!0?n.unshift(b):t.unshift(b)}function c(u,h){t.length>1&&t.sort(u||J8),r.length>1&&r.sort(h||i0),n.length>1&&n.sort(h||i0)}function d(){for(let u=e,h=i.length;u<h;u++){const p=i[u];if(p.id===null)break;p.id=null,p.object=null,p.geometry=null,p.material=null,p.group=null}}return{opaque:t,transmissive:r,transparent:n,init:s,push:a,unshift:l,finish:d,sort:c}}function Z8(){let i=new WeakMap;function e(r,n){let s;return i.has(r)===!1?(s=new r0,i.set(r,[s])):n>=i.get(r).length?(s=new r0,i.get(r).push(s)):s=i.get(r)[n],s}function t(){i=new WeakMap}return{get:e,dispose:t}}function Q8(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new J,color:new ot};break;case"SpotLight":t={position:new J,direction:new J,color:new ot,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new J,color:new ot,distance:0,decay:0};break;case"HemisphereLight":t={direction:new J,skyColor:new ot,groundColor:new ot};break;case"RectAreaLight":t={color:new ot,position:new J,halfWidth:new J,halfHeight:new J};break}return i[e.id]=t,t}}}function e7(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new at};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new at};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new at,shadowCameraNear:1,shadowCameraFar:1e3};break}return i[e.id]=t,t}}}let t7=0;function i7(i,e){return(e.castShadow?1:0)-(i.castShadow?1:0)}function r7(i,e){const t=new Q8,r=e7(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let d=0;d<9;d++)n.probe.push(new J);const s=new J,o=new Ft,a=new Ft;function l(d,u){let h=0,p=0,g=0;for(let E=0;E<9;E++)n.probe[E].set(0,0,0);let f=0,m=0,b=0,y=0,w=0,_=0,M=0,S=0;d.sort(i7);const A=u!==!0?Math.PI:1;for(let E=0,D=d.length;E<D;E++){const F=d[E],R=F.color,B=F.intensity,I=F.distance,V=F.shadow&&F.shadow.map?F.shadow.map.texture:null;if(F.isAmbientLight)h+=R.r*B*A,p+=R.g*B*A,g+=R.b*B*A;else if(F.isLightProbe)for(let N=0;N<9;N++)n.probe[N].addScaledVector(F.sh.coefficients[N],B);else if(F.isDirectionalLight){const N=t.get(F);if(N.color.copy(F.color).multiplyScalar(F.intensity*A),F.castShadow){const j=F.shadow,Y=r.get(F);Y.shadowBias=j.bias,Y.shadowNormalBias=j.normalBias,Y.shadowRadius=j.radius,Y.shadowMapSize=j.mapSize,n.directionalShadow[f]=Y,n.directionalShadowMap[f]=V,n.directionalShadowMatrix[f]=F.shadow.matrix,_++}n.directional[f]=N,f++}else if(F.isSpotLight){const N=t.get(F);if(N.position.setFromMatrixPosition(F.matrixWorld),N.color.copy(R).multiplyScalar(B*A),N.distance=I,N.coneCos=Math.cos(F.angle),N.penumbraCos=Math.cos(F.angle*(1-F.penumbra)),N.decay=F.decay,F.castShadow){const j=F.shadow,Y=r.get(F);Y.shadowBias=j.bias,Y.shadowNormalBias=j.normalBias,Y.shadowRadius=j.radius,Y.shadowMapSize=j.mapSize,n.spotShadow[b]=Y,n.spotShadowMap[b]=V,n.spotShadowMatrix[b]=F.shadow.matrix,S++}n.spot[b]=N,b++}else if(F.isRectAreaLight){const N=t.get(F);N.color.copy(R).multiplyScalar(B),N.halfWidth.set(F.width*.5,0,0),N.halfHeight.set(0,F.height*.5,0),n.rectArea[y]=N,y++}else if(F.isPointLight){const N=t.get(F);if(N.color.copy(F.color).multiplyScalar(F.intensity*A),N.distance=F.distance,N.decay=F.decay,F.castShadow){const j=F.shadow,Y=r.get(F);Y.shadowBias=j.bias,Y.shadowNormalBias=j.normalBias,Y.shadowRadius=j.radius,Y.shadowMapSize=j.mapSize,Y.shadowCameraNear=j.camera.near,Y.shadowCameraFar=j.camera.far,n.pointShadow[m]=Y,n.pointShadowMap[m]=V,n.pointShadowMatrix[m]=F.shadow.matrix,M++}n.point[m]=N,m++}else if(F.isHemisphereLight){const N=t.get(F);N.skyColor.copy(F.color).multiplyScalar(B*A),N.groundColor.copy(F.groundColor).multiplyScalar(B*A),n.hemi[w]=N,w++}}y>0&&(e.isWebGL2||i.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=Pe.LTC_FLOAT_1,n.rectAreaLTC2=Pe.LTC_FLOAT_2):i.has("OES_texture_half_float_linear")===!0?(n.rectAreaLTC1=Pe.LTC_HALF_1,n.rectAreaLTC2=Pe.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),n.ambient[0]=h,n.ambient[1]=p,n.ambient[2]=g;const x=n.hash;(x.directionalLength!==f||x.pointLength!==m||x.spotLength!==b||x.rectAreaLength!==y||x.hemiLength!==w||x.numDirectionalShadows!==_||x.numPointShadows!==M||x.numSpotShadows!==S)&&(n.directional.length=f,n.spot.length=b,n.rectArea.length=y,n.point.length=m,n.hemi.length=w,n.directionalShadow.length=_,n.directionalShadowMap.length=_,n.pointShadow.length=M,n.pointShadowMap.length=M,n.spotShadow.length=S,n.spotShadowMap.length=S,n.directionalShadowMatrix.length=_,n.pointShadowMatrix.length=M,n.spotShadowMatrix.length=S,x.directionalLength=f,x.pointLength=m,x.spotLength=b,x.rectAreaLength=y,x.hemiLength=w,x.numDirectionalShadows=_,x.numPointShadows=M,x.numSpotShadows=S,n.version=t7++)}function c(d,u){let h=0,p=0,g=0,f=0,m=0;const b=u.matrixWorldInverse;for(let y=0,w=d.length;y<w;y++){const _=d[y];if(_.isDirectionalLight){const M=n.directional[h];M.direction.setFromMatrixPosition(_.matrixWorld),s.setFromMatrixPosition(_.target.matrixWorld),M.direction.sub(s),M.direction.transformDirection(b),h++}else if(_.isSpotLight){const M=n.spot[g];M.position.setFromMatrixPosition(_.matrixWorld),M.position.applyMatrix4(b),M.direction.setFromMatrixPosition(_.matrixWorld),s.setFromMatrixPosition(_.target.matrixWorld),M.direction.sub(s),M.direction.transformDirection(b),g++}else if(_.isRectAreaLight){const M=n.rectArea[f];M.position.setFromMatrixPosition(_.matrixWorld),M.position.applyMatrix4(b),a.identity(),o.copy(_.matrixWorld),o.premultiply(b),a.extractRotation(o),M.halfWidth.set(_.width*.5,0,0),M.halfHeight.set(0,_.height*.5,0),M.halfWidth.applyMatrix4(a),M.halfHeight.applyMatrix4(a),f++}else if(_.isPointLight){const M=n.point[p];M.position.setFromMatrixPosition(_.matrixWorld),M.position.applyMatrix4(b),p++}else if(_.isHemisphereLight){const M=n.hemi[m];M.direction.setFromMatrixPosition(_.matrixWorld),M.direction.transformDirection(b),m++}}}return{setup:l,setupView:c,state:n}}function n0(i,e){const t=new r7(i,e),r=[],n=[];function s(){r.length=0,n.length=0}function o(d){r.push(d)}function a(d){n.push(d)}function l(d){t.setup(r,d)}function c(d){t.setupView(r,d)}return{init:s,state:{lightsArray:r,shadowsArray:n,lights:t},setupLights:l,setupLightsView:c,pushLight:o,pushShadow:a}}function n7(i,e){let t=new WeakMap;function r(s,o=0){let a;return t.has(s)===!1?(a=new n0(i,e),t.set(s,[a])):o>=t.get(s).length?(a=new n0(i,e),t.get(s).push(a)):a=t.get(s)[o],a}function n(){t=new WeakMap}return{get:r,dispose:n}}class s7 extends bs{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class o7 extends bs{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new J,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const a7=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,l7=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function c7(i,e,t){let r=new Nf;const n=new at,s=new at,o=new Ot,a=new s7({depthPacking:3201}),l=new o7,c={},d=t.maxTextureSize,u={0:1,1:0,2:2},h=new us({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new at},radius:{value:4}},vertexShader:a7,fragmentShader:l7}),p=h.clone();p.defines.HORIZONTAL_PASS=1;const g=new lr;g.setAttribute("position",new rr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const f=new Qi(g,h),m=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(_,M,S){if(m.enabled===!1||m.autoUpdate===!1&&m.needsUpdate===!1||_.length===0)return;const A=i.getRenderTarget(),x=i.getActiveCubeFace(),E=i.getActiveMipmapLevel(),D=i.state;D.setBlending(0),D.buffers.color.setClear(1,1,1,1),D.buffers.depth.setTest(!0),D.setScissorTest(!1);for(let F=0,R=_.length;F<R;F++){const B=_[F],I=B.shadow;if(I===void 0){console.warn("THREE.WebGLShadowMap:",B,"has no shadow.");continue}if(I.autoUpdate===!1&&I.needsUpdate===!1)continue;n.copy(I.mapSize);const V=I.getFrameExtents();if(n.multiply(V),s.copy(I.mapSize),(n.x>d||n.y>d)&&(n.x>d&&(s.x=Math.floor(d/V.x),n.x=s.x*V.x,I.mapSize.x=s.x),n.y>d&&(s.y=Math.floor(d/V.y),n.y=s.y*V.y,I.mapSize.y=s.y)),I.map===null){const j=this.type!==3?{minFilter:1003,magFilter:1003}:{};I.map=new ds(n.x,n.y,j),I.map.texture.name=B.name+".shadowMap",I.camera.updateProjectionMatrix()}i.setRenderTarget(I.map),i.clear();const N=I.getViewportCount();for(let j=0;j<N;j++){const Y=I.getViewport(j);o.set(s.x*Y.x,s.y*Y.y,s.x*Y.z,s.y*Y.w),D.viewport(o),I.updateMatrices(B,j),r=I.getFrustum(),w(M,S,I.camera,B,this.type)}I.isPointLightShadow!==!0&&this.type===3&&b(I,S),I.needsUpdate=!1}m.needsUpdate=!1,i.setRenderTarget(A,x,E)};function b(_,M){const S=e.update(f);h.defines.VSM_SAMPLES!==_.blurSamples&&(h.defines.VSM_SAMPLES=_.blurSamples,p.defines.VSM_SAMPLES=_.blurSamples,h.needsUpdate=!0,p.needsUpdate=!0),_.mapPass===null&&(_.mapPass=new ds(n.x,n.y)),h.uniforms.shadow_pass.value=_.map.texture,h.uniforms.resolution.value=_.mapSize,h.uniforms.radius.value=_.radius,i.setRenderTarget(_.mapPass),i.clear(),i.renderBufferDirect(M,null,S,h,f,null),p.uniforms.shadow_pass.value=_.mapPass.texture,p.uniforms.resolution.value=_.mapSize,p.uniforms.radius.value=_.radius,i.setRenderTarget(_.map),i.clear(),i.renderBufferDirect(M,null,S,p,f,null)}function y(_,M,S,A,x,E){let D=null;const F=S.isPointLight===!0?_.customDistanceMaterial:_.customDepthMaterial;if(F!==void 0?D=F:D=S.isPointLight===!0?l:a,i.localClippingEnabled&&M.clipShadows===!0&&Array.isArray(M.clippingPlanes)&&M.clippingPlanes.length!==0||M.displacementMap&&M.displacementScale!==0||M.alphaMap&&M.alphaTest>0){const R=D.uuid,B=M.uuid;let I=c[R];I===void 0&&(I={},c[R]=I);let V=I[B];V===void 0&&(V=D.clone(),I[B]=V),D=V}return D.visible=M.visible,D.wireframe=M.wireframe,E===3?D.side=M.shadowSide!==null?M.shadowSide:M.side:D.side=M.shadowSide!==null?M.shadowSide:u[M.side],D.alphaMap=M.alphaMap,D.alphaTest=M.alphaTest,D.clipShadows=M.clipShadows,D.clippingPlanes=M.clippingPlanes,D.clipIntersection=M.clipIntersection,D.displacementMap=M.displacementMap,D.displacementScale=M.displacementScale,D.displacementBias=M.displacementBias,D.wireframeLinewidth=M.wireframeLinewidth,D.linewidth=M.linewidth,S.isPointLight===!0&&D.isMeshDistanceMaterial===!0&&(D.referencePosition.setFromMatrixPosition(S.matrixWorld),D.nearDistance=A,D.farDistance=x),D}function w(_,M,S,A,x){if(_.visible===!1)return;if(_.layers.test(M.layers)&&(_.isMesh||_.isLine||_.isPoints)&&(_.castShadow||_.receiveShadow&&x===3)&&(!_.frustumCulled||r.intersectsObject(_))){_.modelViewMatrix.multiplyMatrices(S.matrixWorldInverse,_.matrixWorld);const D=e.update(_),F=_.material;if(Array.isArray(F)){const R=D.groups;for(let B=0,I=R.length;B<I;B++){const V=R[B],N=F[V.materialIndex];if(N&&N.visible){const j=y(_,N,A,S.near,S.far,x);i.renderBufferDirect(S,null,D,j,_,V)}}}else if(F.visible){const R=y(_,F,A,S.near,S.far,x);i.renderBufferDirect(S,null,D,R,_,null)}}const E=_.children;for(let D=0,F=E.length;D<F;D++)w(E[D],M,S,A,x)}}function d7(i,e,t){const r=t.isWebGL2;function n(){let G=!1;const Oe=new Ot;let ce=null;const Be=new Ot(0,0,0,0);return{setMask:function(Te){ce!==Te&&!G&&(i.colorMask(Te,Te,Te,Te),ce=Te)},setLocked:function(Te){G=Te},setClear:function(Te,_t,zt,Ct,Ir){Ir===!0&&(Te*=Ct,_t*=Ct,zt*=Ct),Oe.set(Te,_t,zt,Ct),Be.equals(Oe)===!1&&(i.clearColor(Te,_t,zt,Ct),Be.copy(Oe))},reset:function(){G=!1,ce=null,Be.set(-1,0,0,0)}}}function s(){let G=!1,Oe=null,ce=null,Be=null;return{setTest:function(Te){Te?te(2929):fe(2929)},setMask:function(Te){Oe!==Te&&!G&&(i.depthMask(Te),Oe=Te)},setFunc:function(Te){if(ce!==Te){if(Te)switch(Te){case 0:i.depthFunc(512);break;case 1:i.depthFunc(519);break;case 2:i.depthFunc(513);break;case 3:i.depthFunc(515);break;case 4:i.depthFunc(514);break;case 5:i.depthFunc(518);break;case 6:i.depthFunc(516);break;case 7:i.depthFunc(517);break;default:i.depthFunc(515)}else i.depthFunc(515);ce=Te}},setLocked:function(Te){G=Te},setClear:function(Te){Be!==Te&&(i.clearDepth(Te),Be=Te)},reset:function(){G=!1,Oe=null,ce=null,Be=null}}}function o(){let G=!1,Oe=null,ce=null,Be=null,Te=null,_t=null,zt=null,Ct=null,Ir=null;return{setTest:function(Mt){G||(Mt?te(2960):fe(2960))},setMask:function(Mt){Oe!==Mt&&!G&&(i.stencilMask(Mt),Oe=Mt)},setFunc:function(Mt,cr,yi){(ce!==Mt||Be!==cr||Te!==yi)&&(i.stencilFunc(Mt,cr,yi),ce=Mt,Be=cr,Te=yi)},setOp:function(Mt,cr,yi){(_t!==Mt||zt!==cr||Ct!==yi)&&(i.stencilOp(Mt,cr,yi),_t=Mt,zt=cr,Ct=yi)},setLocked:function(Mt){G=Mt},setClear:function(Mt){Ir!==Mt&&(i.clearStencil(Mt),Ir=Mt)},reset:function(){G=!1,Oe=null,ce=null,Be=null,Te=null,_t=null,zt=null,Ct=null,Ir=null}}}const a=new n,l=new s,c=new o,d=new WeakMap,u=new WeakMap;let h={},p={},g=new WeakMap,f=[],m=null,b=!1,y=null,w=null,_=null,M=null,S=null,A=null,x=null,E=!1,D=null,F=null,R=null,B=null,I=null;const V=i.getParameter(35661);let N=!1,j=0;const Y=i.getParameter(7938);Y.indexOf("WebGL")!==-1?(j=parseFloat(/^WebGL (\d)/.exec(Y)[1]),N=j>=1):Y.indexOf("OpenGL ES")!==-1&&(j=parseFloat(/^OpenGL ES (\d)/.exec(Y)[1]),N=j>=2);let W=null,ee={};const me=i.getParameter(3088),X=i.getParameter(2978),ye=new Ot().fromArray(me),Ce=new Ot().fromArray(X);function We(G,Oe,ce){const Be=new Uint8Array(4),Te=i.createTexture();i.bindTexture(G,Te),i.texParameteri(G,10241,9728),i.texParameteri(G,10240,9728);for(let _t=0;_t<ce;_t++)i.texImage2D(Oe+_t,0,6408,1,1,0,6408,5121,Be);return Te}const se={};se[3553]=We(3553,3553,1),se[34067]=We(34067,34069,6),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),te(2929),l.setFunc(3),le(!1),oe(1),te(2884),$(0);function te(G){h[G]!==!0&&(i.enable(G),h[G]=!0)}function fe(G){h[G]!==!1&&(i.disable(G),h[G]=!1)}function pe(G,Oe){return p[G]!==Oe?(i.bindFramebuffer(G,Oe),p[G]=Oe,r&&(G===36009&&(p[36160]=Oe),G===36160&&(p[36009]=Oe)),!0):!1}function de(G,Oe){let ce=f,Be=!1;if(G)if(ce=g.get(Oe),ce===void 0&&(ce=[],g.set(Oe,ce)),G.isWebGLMultipleRenderTargets){const Te=G.texture;if(ce.length!==Te.length||ce[0]!==36064){for(let _t=0,zt=Te.length;_t<zt;_t++)ce[_t]=36064+_t;ce.length=Te.length,Be=!0}}else ce[0]!==36064&&(ce[0]=36064,Be=!0);else ce[0]!==1029&&(ce[0]=1029,Be=!0);Be&&(t.isWebGL2?i.drawBuffers(ce):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(ce))}function He(G){return m!==G?(i.useProgram(G),m=G,!0):!1}const $e={100:32774,101:32778,102:32779};if(r)$e[103]=32775,$e[104]=32776;else{const G=e.get("EXT_blend_minmax");G!==null&&($e[103]=G.MIN_EXT,$e[104]=G.MAX_EXT)}const L={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function $(G,Oe,ce,Be,Te,_t,zt,Ct){if(G===0){b===!0&&(fe(3042),b=!1);return}if(b===!1&&(te(3042),b=!0),G!==5){if(G!==y||Ct!==E){if((w!==100||S!==100)&&(i.blendEquation(32774),w=100,S=100),Ct)switch(G){case 1:i.blendFuncSeparate(1,771,1,771);break;case 2:i.blendFunc(1,1);break;case 3:i.blendFuncSeparate(0,769,0,1);break;case 4:i.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",G);break}else switch(G){case 1:i.blendFuncSeparate(770,771,1,771);break;case 2:i.blendFunc(770,1);break;case 3:i.blendFuncSeparate(0,769,0,1);break;case 4:i.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",G);break}_=null,M=null,A=null,x=null,y=G,E=Ct}return}Te=Te||Oe,_t=_t||ce,zt=zt||Be,(Oe!==w||Te!==S)&&(i.blendEquationSeparate($e[Oe],$e[Te]),w=Oe,S=Te),(ce!==_||Be!==M||_t!==A||zt!==x)&&(i.blendFuncSeparate(L[ce],L[Be],L[_t],L[zt]),_=ce,M=Be,A=_t,x=zt),y=G,E=null}function Z(G,Oe){G.side===2?fe(2884):te(2884);let ce=G.side===1;Oe&&(ce=!ce),le(ce),G.blending===1&&G.transparent===!1?$(0):$(G.blending,G.blendEquation,G.blendSrc,G.blendDst,G.blendEquationAlpha,G.blendSrcAlpha,G.blendDstAlpha,G.premultipliedAlpha),l.setFunc(G.depthFunc),l.setTest(G.depthTest),l.setMask(G.depthWrite),a.setMask(G.colorWrite);const Be=G.stencilWrite;c.setTest(Be),Be&&(c.setMask(G.stencilWriteMask),c.setFunc(G.stencilFunc,G.stencilRef,G.stencilFuncMask),c.setOp(G.stencilFail,G.stencilZFail,G.stencilZPass)),we(G.polygonOffset,G.polygonOffsetFactor,G.polygonOffsetUnits),G.alphaToCoverage===!0?te(32926):fe(32926)}function le(G){D!==G&&(G?i.frontFace(2304):i.frontFace(2305),D=G)}function oe(G){G!==0?(te(2884),G!==F&&(G===1?i.cullFace(1029):G===2?i.cullFace(1028):i.cullFace(1032))):fe(2884),F=G}function _e(G){G!==R&&(N&&i.lineWidth(G),R=G)}function we(G,Oe,ce){G?(te(32823),(B!==Oe||I!==ce)&&(i.polygonOffset(Oe,ce),B=Oe,I=ce)):fe(32823)}function xe(G){G?te(3089):fe(3089)}function Me(G){G===void 0&&(G=33984+V-1),W!==G&&(i.activeTexture(G),W=G)}function T(G,Oe){W===null&&Me();let ce=ee[W];ce===void 0&&(ce={type:void 0,texture:void 0},ee[W]=ce),(ce.type!==G||ce.texture!==Oe)&&(i.bindTexture(G,Oe||se[G]),ce.type=G,ce.texture=Oe)}function C(){const G=ee[W];G!==void 0&&G.type!==void 0&&(i.bindTexture(G.type,null),G.type=void 0,G.texture=void 0)}function q(){try{i.compressedTexImage2D.apply(i,arguments)}catch(G){console.error("THREE.WebGLState:",G)}}function re(){try{i.texSubImage2D.apply(i,arguments)}catch(G){console.error("THREE.WebGLState:",G)}}function ue(){try{i.texSubImage3D.apply(i,arguments)}catch(G){console.error("THREE.WebGLState:",G)}}function ve(){try{i.compressedTexSubImage2D.apply(i,arguments)}catch(G){console.error("THREE.WebGLState:",G)}}function Re(){try{i.texStorage2D.apply(i,arguments)}catch(G){console.error("THREE.WebGLState:",G)}}function Q(){try{i.texStorage3D.apply(i,arguments)}catch(G){console.error("THREE.WebGLState:",G)}}function Ie(){try{i.texImage2D.apply(i,arguments)}catch(G){console.error("THREE.WebGLState:",G)}}function De(){try{i.texImage3D.apply(i,arguments)}catch(G){console.error("THREE.WebGLState:",G)}}function Ve(G){ye.equals(G)===!1&&(i.scissor(G.x,G.y,G.z,G.w),ye.copy(G))}function Ne(G){Ce.equals(G)===!1&&(i.viewport(G.x,G.y,G.z,G.w),Ce.copy(G))}function qe(G,Oe){let ce=u.get(Oe);ce===void 0&&(ce=new WeakMap,u.set(Oe,ce));let Be=ce.get(G);Be===void 0&&(Be=i.getUniformBlockIndex(Oe,G.name),ce.set(G,Be))}function lt(G,Oe){const ce=u.get(Oe).get(G);d.get(G)!==ce&&(i.uniformBlockBinding(Oe,ce,G.__bindingPointIndex),d.set(G,ce))}function tt(){i.disable(3042),i.disable(2884),i.disable(2929),i.disable(32823),i.disable(3089),i.disable(2960),i.disable(32926),i.blendEquation(32774),i.blendFunc(1,0),i.blendFuncSeparate(1,0,1,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(513),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(519,0,4294967295),i.stencilOp(7680,7680,7680),i.clearStencil(0),i.cullFace(1029),i.frontFace(2305),i.polygonOffset(0,0),i.activeTexture(33984),i.bindFramebuffer(36160,null),r===!0&&(i.bindFramebuffer(36009,null),i.bindFramebuffer(36008,null)),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),h={},W=null,ee={},p={},g=new WeakMap,f=[],m=null,b=!1,y=null,w=null,_=null,M=null,S=null,A=null,x=null,E=!1,D=null,F=null,R=null,B=null,I=null,ye.set(0,0,i.canvas.width,i.canvas.height),Ce.set(0,0,i.canvas.width,i.canvas.height),a.reset(),l.reset(),c.reset()}return{buffers:{color:a,depth:l,stencil:c},enable:te,disable:fe,bindFramebuffer:pe,drawBuffers:de,useProgram:He,setBlending:$,setMaterial:Z,setFlipSided:le,setCullFace:oe,setLineWidth:_e,setPolygonOffset:we,setScissorTest:xe,activeTexture:Me,bindTexture:T,unbindTexture:C,compressedTexImage2D:q,texImage2D:Ie,texImage3D:De,updateUBOMapping:qe,uniformBlockBinding:lt,texStorage2D:Re,texStorage3D:Q,texSubImage2D:re,texSubImage3D:ue,compressedTexSubImage2D:ve,scissor:Ve,viewport:Ne,reset:tt}}function u7(i,e,t,r,n,s,o){const a=n.isWebGL2,l=n.maxTextures,c=n.maxCubemapSize,d=n.maxTextureSize,u=n.maxSamples,h=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,p=/OculusBrowser/g.test(navigator.userAgent),g=new WeakMap;let f;const m=new WeakMap;let b=!1;try{b=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function y(T,C){return b?new OffscreenCanvas(T,C):Vc("canvas")}function w(T,C,q,re){let ue=1;if((T.width>re||T.height>re)&&(ue=re/Math.max(T.width,T.height)),ue<1||C===!0)if(typeof HTMLImageElement<"u"&&T instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&T instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&T instanceof ImageBitmap){const ve=C?fh:Math.floor,Re=ve(ue*T.width),Q=ve(ue*T.height);f===void 0&&(f=y(Re,Q));const Ie=q?y(Re,Q):f;return Ie.width=Re,Ie.height=Q,Ie.getContext("2d").drawImage(T,0,0,Re,Q),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+T.width+"x"+T.height+") to ("+Re+"x"+Q+")."),Ie}else return"data"in T&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+T.width+"x"+T.height+")."),T;return T}function _(T){return Eg(T.width)&&Eg(T.height)}function M(T){return a?!1:T.wrapS!==1001||T.wrapT!==1001||T.minFilter!==1003&&T.minFilter!==1006}function S(T,C){return T.generateMipmaps&&C&&T.minFilter!==1003&&T.minFilter!==1006}function A(T){i.generateMipmap(T)}function x(T,C,q,re,ue=!1){if(a===!1)return C;if(T!==null){if(i[T]!==void 0)return i[T];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+T+"'")}let ve=C;return C===6403&&(q===5126&&(ve=33326),q===5131&&(ve=33325),q===5121&&(ve=33321)),C===33319&&(q===5126&&(ve=33328),q===5131&&(ve=33327),q===5121&&(ve=33323)),C===6408&&(q===5126&&(ve=34836),q===5131&&(ve=34842),q===5121&&(ve=re===3001&&ue===!1?35907:32856),q===32819&&(ve=32854),q===32820&&(ve=32855)),(ve===33325||ve===33326||ve===33327||ve===33328||ve===34842||ve===34836)&&e.get("EXT_color_buffer_float"),ve}function E(T,C,q){return S(T,q)===!0||T.isFramebufferTexture&&T.minFilter!==1003&&T.minFilter!==1006?Math.log2(Math.max(C.width,C.height))+1:T.mipmaps!==void 0&&T.mipmaps.length>0?T.mipmaps.length:T.isCompressedTexture&&Array.isArray(T.image)?C.mipmaps.length:1}function D(T){return T===1003||T===1004||T===1005?9728:9729}function F(T){const C=T.target;C.removeEventListener("dispose",F),B(C),C.isVideoTexture&&g.delete(C)}function R(T){const C=T.target;C.removeEventListener("dispose",R),V(C)}function B(T){const C=r.get(T);if(C.__webglInit===void 0)return;const q=T.source,re=m.get(q);if(re){const ue=re[C.__cacheKey];ue.usedTimes--,ue.usedTimes===0&&I(T),Object.keys(re).length===0&&m.delete(q)}r.remove(T)}function I(T){const C=r.get(T);i.deleteTexture(C.__webglTexture);const q=T.source,re=m.get(q);delete re[C.__cacheKey],o.memory.textures--}function V(T){const C=T.texture,q=r.get(T),re=r.get(C);if(re.__webglTexture!==void 0&&(i.deleteTexture(re.__webglTexture),o.memory.textures--),T.depthTexture&&T.depthTexture.dispose(),T.isWebGLCubeRenderTarget)for(let ue=0;ue<6;ue++)i.deleteFramebuffer(q.__webglFramebuffer[ue]),q.__webglDepthbuffer&&i.deleteRenderbuffer(q.__webglDepthbuffer[ue]);else{if(i.deleteFramebuffer(q.__webglFramebuffer),q.__webglDepthbuffer&&i.deleteRenderbuffer(q.__webglDepthbuffer),q.__webglMultisampledFramebuffer&&i.deleteFramebuffer(q.__webglMultisampledFramebuffer),q.__webglColorRenderbuffer)for(let ue=0;ue<q.__webglColorRenderbuffer.length;ue++)q.__webglColorRenderbuffer[ue]&&i.deleteRenderbuffer(q.__webglColorRenderbuffer[ue]);q.__webglDepthRenderbuffer&&i.deleteRenderbuffer(q.__webglDepthRenderbuffer)}if(T.isWebGLMultipleRenderTargets)for(let ue=0,ve=C.length;ue<ve;ue++){const Re=r.get(C[ue]);Re.__webglTexture&&(i.deleteTexture(Re.__webglTexture),o.memory.textures--),r.remove(C[ue])}r.remove(C),r.remove(T)}let N=0;function j(){N=0}function Y(){const T=N;return T>=l&&console.warn("THREE.WebGLTextures: Trying to use "+T+" texture units while this GPU supports only "+l),N+=1,T}function W(T){const C=[];return C.push(T.wrapS),C.push(T.wrapT),C.push(T.magFilter),C.push(T.minFilter),C.push(T.anisotropy),C.push(T.internalFormat),C.push(T.format),C.push(T.type),C.push(T.generateMipmaps),C.push(T.premultiplyAlpha),C.push(T.flipY),C.push(T.unpackAlignment),C.push(T.encoding),C.join()}function ee(T,C){const q=r.get(T);if(T.isVideoTexture&&xe(T),T.isRenderTargetTexture===!1&&T.version>0&&q.__version!==T.version){const re=T.image;if(re===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(re.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{fe(q,T,C);return}}t.activeTexture(33984+C),t.bindTexture(3553,q.__webglTexture)}function me(T,C){const q=r.get(T);if(T.version>0&&q.__version!==T.version){fe(q,T,C);return}t.activeTexture(33984+C),t.bindTexture(35866,q.__webglTexture)}function X(T,C){const q=r.get(T);if(T.version>0&&q.__version!==T.version){fe(q,T,C);return}t.activeTexture(33984+C),t.bindTexture(32879,q.__webglTexture)}function ye(T,C){const q=r.get(T);if(T.version>0&&q.__version!==T.version){pe(q,T,C);return}t.activeTexture(33984+C),t.bindTexture(34067,q.__webglTexture)}const Ce={1e3:10497,1001:33071,1002:33648},We={1003:9728,1004:9984,1005:9986,1006:9729,1007:9985,1008:9987};function se(T,C,q){if(q?(i.texParameteri(T,10242,Ce[C.wrapS]),i.texParameteri(T,10243,Ce[C.wrapT]),(T===32879||T===35866)&&i.texParameteri(T,32882,Ce[C.wrapR]),i.texParameteri(T,10240,We[C.magFilter]),i.texParameteri(T,10241,We[C.minFilter])):(i.texParameteri(T,10242,33071),i.texParameteri(T,10243,33071),(T===32879||T===35866)&&i.texParameteri(T,32882,33071),(C.wrapS!==1001||C.wrapT!==1001)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),i.texParameteri(T,10240,D(C.magFilter)),i.texParameteri(T,10241,D(C.minFilter)),C.minFilter!==1003&&C.minFilter!==1006&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){const re=e.get("EXT_texture_filter_anisotropic");if(C.type===1015&&e.has("OES_texture_float_linear")===!1||a===!1&&C.type===1016&&e.has("OES_texture_half_float_linear")===!1)return;(C.anisotropy>1||r.get(C).__currentAnisotropy)&&(i.texParameterf(T,re.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(C.anisotropy,n.getMaxAnisotropy())),r.get(C).__currentAnisotropy=C.anisotropy)}}function te(T,C){let q=!1;T.__webglInit===void 0&&(T.__webglInit=!0,C.addEventListener("dispose",F));const re=C.source;let ue=m.get(re);ue===void 0&&(ue={},m.set(re,ue));const ve=W(C);if(ve!==T.__cacheKey){ue[ve]===void 0&&(ue[ve]={texture:i.createTexture(),usedTimes:0},o.memory.textures++,q=!0),ue[ve].usedTimes++;const Re=ue[T.__cacheKey];Re!==void 0&&(ue[T.__cacheKey].usedTimes--,Re.usedTimes===0&&I(C)),T.__cacheKey=ve,T.__webglTexture=ue[ve].texture}return q}function fe(T,C,q){let re=3553;C.isDataArrayTexture&&(re=35866),C.isData3DTexture&&(re=32879);const ue=te(T,C),ve=C.source;if(t.activeTexture(33984+q),t.bindTexture(re,T.__webglTexture),ve.version!==ve.__currentVersion||ue===!0){i.pixelStorei(37440,C.flipY),i.pixelStorei(37441,C.premultiplyAlpha),i.pixelStorei(3317,C.unpackAlignment),i.pixelStorei(37443,0);const Re=M(C)&&_(C.image)===!1;let Q=w(C.image,Re,!1,d);Q=Me(C,Q);const Ie=_(Q)||a,De=s.convert(C.format,C.encoding);let Ve=s.convert(C.type),Ne=x(C.internalFormat,De,Ve,C.encoding,C.isVideoTexture);se(re,C,Ie);let qe;const lt=C.mipmaps,tt=a&&C.isVideoTexture!==!0,G=ve.__currentVersion===void 0||ue===!0,Oe=E(C,Q,Ie);if(C.isDepthTexture)Ne=6402,a?C.type===1015?Ne=36012:C.type===1014?Ne=33190:C.type===1020?Ne=35056:Ne=33189:C.type===1015&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),C.format===1026&&Ne===6402&&C.type!==1012&&C.type!==1014&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),C.type=1014,Ve=s.convert(C.type)),C.format===1027&&Ne===6402&&(Ne=34041,C.type!==1020&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),C.type=1020,Ve=s.convert(C.type))),G&&(tt?t.texStorage2D(3553,1,Ne,Q.width,Q.height):t.texImage2D(3553,0,Ne,Q.width,Q.height,0,De,Ve,null));else if(C.isDataTexture)if(lt.length>0&&Ie){tt&&G&&t.texStorage2D(3553,Oe,Ne,lt[0].width,lt[0].height);for(let ce=0,Be=lt.length;ce<Be;ce++)qe=lt[ce],tt?t.texSubImage2D(3553,ce,0,0,qe.width,qe.height,De,Ve,qe.data):t.texImage2D(3553,ce,Ne,qe.width,qe.height,0,De,Ve,qe.data);C.generateMipmaps=!1}else tt?(G&&t.texStorage2D(3553,Oe,Ne,Q.width,Q.height),t.texSubImage2D(3553,0,0,0,Q.width,Q.height,De,Ve,Q.data)):t.texImage2D(3553,0,Ne,Q.width,Q.height,0,De,Ve,Q.data);else if(C.isCompressedTexture){tt&&G&&t.texStorage2D(3553,Oe,Ne,lt[0].width,lt[0].height);for(let ce=0,Be=lt.length;ce<Be;ce++)qe=lt[ce],C.format!==1023?De!==null?tt?t.compressedTexSubImage2D(3553,ce,0,0,qe.width,qe.height,De,qe.data):t.compressedTexImage2D(3553,ce,Ne,qe.width,qe.height,0,qe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):tt?t.texSubImage2D(3553,ce,0,0,qe.width,qe.height,De,Ve,qe.data):t.texImage2D(3553,ce,Ne,qe.width,qe.height,0,De,Ve,qe.data)}else if(C.isDataArrayTexture)tt?(G&&t.texStorage3D(35866,Oe,Ne,Q.width,Q.height,Q.depth),t.texSubImage3D(35866,0,0,0,0,Q.width,Q.height,Q.depth,De,Ve,Q.data)):t.texImage3D(35866,0,Ne,Q.width,Q.height,Q.depth,0,De,Ve,Q.data);else if(C.isData3DTexture)tt?(G&&t.texStorage3D(32879,Oe,Ne,Q.width,Q.height,Q.depth),t.texSubImage3D(32879,0,0,0,0,Q.width,Q.height,Q.depth,De,Ve,Q.data)):t.texImage3D(32879,0,Ne,Q.width,Q.height,Q.depth,0,De,Ve,Q.data);else if(C.isFramebufferTexture){if(G)if(tt)t.texStorage2D(3553,Oe,Ne,Q.width,Q.height);else{let ce=Q.width,Be=Q.height;for(let Te=0;Te<Oe;Te++)t.texImage2D(3553,Te,Ne,ce,Be,0,De,Ve,null),ce>>=1,Be>>=1}}else if(lt.length>0&&Ie){tt&&G&&t.texStorage2D(3553,Oe,Ne,lt[0].width,lt[0].height);for(let ce=0,Be=lt.length;ce<Be;ce++)qe=lt[ce],tt?t.texSubImage2D(3553,ce,0,0,De,Ve,qe):t.texImage2D(3553,ce,Ne,De,Ve,qe);C.generateMipmaps=!1}else tt?(G&&t.texStorage2D(3553,Oe,Ne,Q.width,Q.height),t.texSubImage2D(3553,0,0,0,De,Ve,Q)):t.texImage2D(3553,0,Ne,De,Ve,Q);S(C,Ie)&&A(re),ve.__currentVersion=ve.version,C.onUpdate&&C.onUpdate(C)}T.__version=C.version}function pe(T,C,q){if(C.image.length!==6)return;const re=te(T,C),ue=C.source;if(t.activeTexture(33984+q),t.bindTexture(34067,T.__webglTexture),ue.version!==ue.__currentVersion||re===!0){i.pixelStorei(37440,C.flipY),i.pixelStorei(37441,C.premultiplyAlpha),i.pixelStorei(3317,C.unpackAlignment),i.pixelStorei(37443,0);const ve=C.isCompressedTexture||C.image[0].isCompressedTexture,Re=C.image[0]&&C.image[0].isDataTexture,Q=[];for(let ce=0;ce<6;ce++)!ve&&!Re?Q[ce]=w(C.image[ce],!1,!0,c):Q[ce]=Re?C.image[ce].image:C.image[ce],Q[ce]=Me(C,Q[ce]);const Ie=Q[0],De=_(Ie)||a,Ve=s.convert(C.format,C.encoding),Ne=s.convert(C.type),qe=x(C.internalFormat,Ve,Ne,C.encoding),lt=a&&C.isVideoTexture!==!0,tt=ue.__currentVersion===void 0||re===!0;let G=E(C,Ie,De);se(34067,C,De);let Oe;if(ve){lt&&tt&&t.texStorage2D(34067,G,qe,Ie.width,Ie.height);for(let ce=0;ce<6;ce++){Oe=Q[ce].mipmaps;for(let Be=0;Be<Oe.length;Be++){const Te=Oe[Be];C.format!==1023?Ve!==null?lt?t.compressedTexSubImage2D(34069+ce,Be,0,0,Te.width,Te.height,Ve,Te.data):t.compressedTexImage2D(34069+ce,Be,qe,Te.width,Te.height,0,Te.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):lt?t.texSubImage2D(34069+ce,Be,0,0,Te.width,Te.height,Ve,Ne,Te.data):t.texImage2D(34069+ce,Be,qe,Te.width,Te.height,0,Ve,Ne,Te.data)}}}else{Oe=C.mipmaps,lt&&tt&&(Oe.length>0&&G++,t.texStorage2D(34067,G,qe,Q[0].width,Q[0].height));for(let ce=0;ce<6;ce++)if(Re){lt?t.texSubImage2D(34069+ce,0,0,0,Q[ce].width,Q[ce].height,Ve,Ne,Q[ce].data):t.texImage2D(34069+ce,0,qe,Q[ce].width,Q[ce].height,0,Ve,Ne,Q[ce].data);for(let Be=0;Be<Oe.length;Be++){const Te=Oe[Be].image[ce].image;lt?t.texSubImage2D(34069+ce,Be+1,0,0,Te.width,Te.height,Ve,Ne,Te.data):t.texImage2D(34069+ce,Be+1,qe,Te.width,Te.height,0,Ve,Ne,Te.data)}}else{lt?t.texSubImage2D(34069+ce,0,0,0,Ve,Ne,Q[ce]):t.texImage2D(34069+ce,0,qe,Ve,Ne,Q[ce]);for(let Be=0;Be<Oe.length;Be++){const Te=Oe[Be];lt?t.texSubImage2D(34069+ce,Be+1,0,0,Ve,Ne,Te.image[ce]):t.texImage2D(34069+ce,Be+1,qe,Ve,Ne,Te.image[ce])}}}S(C,De)&&A(34067),ue.__currentVersion=ue.version,C.onUpdate&&C.onUpdate(C)}T.__version=C.version}function de(T,C,q,re,ue){const ve=s.convert(q.format,q.encoding),Re=s.convert(q.type),Q=x(q.internalFormat,ve,Re,q.encoding);r.get(C).__hasExternalTextures||(ue===32879||ue===35866?t.texImage3D(ue,0,Q,C.width,C.height,C.depth,0,ve,Re,null):t.texImage2D(ue,0,Q,C.width,C.height,0,ve,Re,null)),t.bindFramebuffer(36160,T),we(C)?h.framebufferTexture2DMultisampleEXT(36160,re,ue,r.get(q).__webglTexture,0,_e(C)):i.framebufferTexture2D(36160,re,ue,r.get(q).__webglTexture,0),t.bindFramebuffer(36160,null)}function He(T,C,q){if(i.bindRenderbuffer(36161,T),C.depthBuffer&&!C.stencilBuffer){let re=33189;if(q||we(C)){const ue=C.depthTexture;ue&&ue.isDepthTexture&&(ue.type===1015?re=36012:ue.type===1014&&(re=33190));const ve=_e(C);we(C)?h.renderbufferStorageMultisampleEXT(36161,ve,re,C.width,C.height):i.renderbufferStorageMultisample(36161,ve,re,C.width,C.height)}else i.renderbufferStorage(36161,re,C.width,C.height);i.framebufferRenderbuffer(36160,36096,36161,T)}else if(C.depthBuffer&&C.stencilBuffer){const re=_e(C);q&&we(C)===!1?i.renderbufferStorageMultisample(36161,re,35056,C.width,C.height):we(C)?h.renderbufferStorageMultisampleEXT(36161,re,35056,C.width,C.height):i.renderbufferStorage(36161,34041,C.width,C.height),i.framebufferRenderbuffer(36160,33306,36161,T)}else{const re=C.isWebGLMultipleRenderTargets===!0?C.texture:[C.texture];for(let ue=0;ue<re.length;ue++){const ve=re[ue],Re=s.convert(ve.format,ve.encoding),Q=s.convert(ve.type),Ie=x(ve.internalFormat,Re,Q,ve.encoding),De=_e(C);q&&we(C)===!1?i.renderbufferStorageMultisample(36161,De,Ie,C.width,C.height):we(C)?h.renderbufferStorageMultisampleEXT(36161,De,Ie,C.width,C.height):i.renderbufferStorage(36161,Ie,C.width,C.height)}}i.bindRenderbuffer(36161,null)}function $e(T,C){if(C&&C.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,T),!(C.depthTexture&&C.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(C.depthTexture).__webglTexture||C.depthTexture.image.width!==C.width||C.depthTexture.image.height!==C.height)&&(C.depthTexture.image.width=C.width,C.depthTexture.image.height=C.height,C.depthTexture.needsUpdate=!0),ee(C.depthTexture,0);const q=r.get(C.depthTexture).__webglTexture,re=_e(C);if(C.depthTexture.format===1026)we(C)?h.framebufferTexture2DMultisampleEXT(36160,36096,3553,q,0,re):i.framebufferTexture2D(36160,36096,3553,q,0);else if(C.depthTexture.format===1027)we(C)?h.framebufferTexture2DMultisampleEXT(36160,33306,3553,q,0,re):i.framebufferTexture2D(36160,33306,3553,q,0);else throw new Error("Unknown depthTexture format")}function L(T){const C=r.get(T),q=T.isWebGLCubeRenderTarget===!0;if(T.depthTexture&&!C.__autoAllocateDepthBuffer){if(q)throw new Error("target.depthTexture not supported in Cube render targets");$e(C.__webglFramebuffer,T)}else if(q){C.__webglDepthbuffer=[];for(let re=0;re<6;re++)t.bindFramebuffer(36160,C.__webglFramebuffer[re]),C.__webglDepthbuffer[re]=i.createRenderbuffer(),He(C.__webglDepthbuffer[re],T,!1)}else t.bindFramebuffer(36160,C.__webglFramebuffer),C.__webglDepthbuffer=i.createRenderbuffer(),He(C.__webglDepthbuffer,T,!1);t.bindFramebuffer(36160,null)}function $(T,C,q){const re=r.get(T);C!==void 0&&de(re.__webglFramebuffer,T,T.texture,36064,3553),q!==void 0&&L(T)}function Z(T){const C=T.texture,q=r.get(T),re=r.get(C);T.addEventListener("dispose",R),T.isWebGLMultipleRenderTargets!==!0&&(re.__webglTexture===void 0&&(re.__webglTexture=i.createTexture()),re.__version=C.version,o.memory.textures++);const ue=T.isWebGLCubeRenderTarget===!0,ve=T.isWebGLMultipleRenderTargets===!0,Re=_(T)||a;if(ue){q.__webglFramebuffer=[];for(let Q=0;Q<6;Q++)q.__webglFramebuffer[Q]=i.createFramebuffer()}else{if(q.__webglFramebuffer=i.createFramebuffer(),ve)if(n.drawBuffers){const Q=T.texture;for(let Ie=0,De=Q.length;Ie<De;Ie++){const Ve=r.get(Q[Ie]);Ve.__webglTexture===void 0&&(Ve.__webglTexture=i.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&T.samples>0&&we(T)===!1){const Q=ve?C:[C];q.__webglMultisampledFramebuffer=i.createFramebuffer(),q.__webglColorRenderbuffer=[],t.bindFramebuffer(36160,q.__webglMultisampledFramebuffer);for(let Ie=0;Ie<Q.length;Ie++){const De=Q[Ie];q.__webglColorRenderbuffer[Ie]=i.createRenderbuffer(),i.bindRenderbuffer(36161,q.__webglColorRenderbuffer[Ie]);const Ve=s.convert(De.format,De.encoding),Ne=s.convert(De.type),qe=x(De.internalFormat,Ve,Ne,De.encoding),lt=_e(T);i.renderbufferStorageMultisample(36161,lt,qe,T.width,T.height),i.framebufferRenderbuffer(36160,36064+Ie,36161,q.__webglColorRenderbuffer[Ie])}i.bindRenderbuffer(36161,null),T.depthBuffer&&(q.__webglDepthRenderbuffer=i.createRenderbuffer(),He(q.__webglDepthRenderbuffer,T,!0)),t.bindFramebuffer(36160,null)}}if(ue){t.bindTexture(34067,re.__webglTexture),se(34067,C,Re);for(let Q=0;Q<6;Q++)de(q.__webglFramebuffer[Q],T,C,36064,34069+Q);S(C,Re)&&A(34067),t.unbindTexture()}else if(ve){const Q=T.texture;for(let Ie=0,De=Q.length;Ie<De;Ie++){const Ve=Q[Ie],Ne=r.get(Ve);t.bindTexture(3553,Ne.__webglTexture),se(3553,Ve,Re),de(q.__webglFramebuffer,T,Ve,36064+Ie,3553),S(Ve,Re)&&A(3553)}t.unbindTexture()}else{let Q=3553;(T.isWebGL3DRenderTarget||T.isWebGLArrayRenderTarget)&&(a?Q=T.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(Q,re.__webglTexture),se(Q,C,Re),de(q.__webglFramebuffer,T,C,36064,Q),S(C,Re)&&A(Q),t.unbindTexture()}T.depthBuffer&&L(T)}function le(T){const C=_(T)||a,q=T.isWebGLMultipleRenderTargets===!0?T.texture:[T.texture];for(let re=0,ue=q.length;re<ue;re++){const ve=q[re];if(S(ve,C)){const Re=T.isWebGLCubeRenderTarget?34067:3553,Q=r.get(ve).__webglTexture;t.bindTexture(Re,Q),A(Re),t.unbindTexture()}}}function oe(T){if(a&&T.samples>0&&we(T)===!1){const C=T.isWebGLMultipleRenderTargets?T.texture:[T.texture],q=T.width,re=T.height;let ue=16384;const ve=[],Re=T.stencilBuffer?33306:36096,Q=r.get(T),Ie=T.isWebGLMultipleRenderTargets===!0;if(Ie)for(let De=0;De<C.length;De++)t.bindFramebuffer(36160,Q.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(36160,36064+De,36161,null),t.bindFramebuffer(36160,Q.__webglFramebuffer),i.framebufferTexture2D(36009,36064+De,3553,null,0);t.bindFramebuffer(36008,Q.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,Q.__webglFramebuffer);for(let De=0;De<C.length;De++){ve.push(36064+De),T.depthBuffer&&ve.push(Re);const Ve=Q.__ignoreDepthValues!==void 0?Q.__ignoreDepthValues:!1;if(Ve===!1&&(T.depthBuffer&&(ue|=256),T.stencilBuffer&&(ue|=1024)),Ie&&i.framebufferRenderbuffer(36008,36064,36161,Q.__webglColorRenderbuffer[De]),Ve===!0&&(i.invalidateFramebuffer(36008,[Re]),i.invalidateFramebuffer(36009,[Re])),Ie){const Ne=r.get(C[De]).__webglTexture;i.framebufferTexture2D(36009,36064,3553,Ne,0)}i.blitFramebuffer(0,0,q,re,0,0,q,re,ue,9728),p&&i.invalidateFramebuffer(36008,ve)}if(t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,null),Ie)for(let De=0;De<C.length;De++){t.bindFramebuffer(36160,Q.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(36160,36064+De,36161,Q.__webglColorRenderbuffer[De]);const Ve=r.get(C[De]).__webglTexture;t.bindFramebuffer(36160,Q.__webglFramebuffer),i.framebufferTexture2D(36009,36064+De,3553,Ve,0)}t.bindFramebuffer(36009,Q.__webglMultisampledFramebuffer)}}function _e(T){return Math.min(u,T.samples)}function we(T){const C=r.get(T);return a&&T.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&C.__useRenderToTexture!==!1}function xe(T){const C=o.render.frame;g.get(T)!==C&&(g.set(T,C),T.update())}function Me(T,C){const q=T.encoding,re=T.format,ue=T.type;return T.isCompressedTexture===!0||T.isVideoTexture===!0||T.format===1035||q!==3e3&&(q===3001?a===!1?e.has("EXT_sRGB")===!0&&re===1023?(T.format=1035,T.minFilter=1006,T.generateMipmaps=!1):C=Gy.sRGBToLinear(C):(re!==1023||ue!==1009)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",q)),C}this.allocateTextureUnit=Y,this.resetTextureUnits=j,this.setTexture2D=ee,this.setTexture2DArray=me,this.setTexture3D=X,this.setTextureCube=ye,this.rebindTextures=$,this.setupRenderTarget=Z,this.updateRenderTargetMipmap=le,this.updateMultisampleRenderTarget=oe,this.setupDepthRenderbuffer=L,this.setupFrameBufferTexture=de,this.useMultisampledRTT=we}function h7(i,e,t){const r=t.isWebGL2;function n(s,o=null){let a;if(s===1009)return 5121;if(s===1017)return 32819;if(s===1018)return 32820;if(s===1010)return 5120;if(s===1011)return 5122;if(s===1012)return 5123;if(s===1013)return 5124;if(s===1014)return 5125;if(s===1015)return 5126;if(s===1016)return r?5131:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===1021)return 6406;if(s===1023)return 6408;if(s===1024)return 6409;if(s===1025)return 6410;if(s===1026)return 6402;if(s===1027)return 34041;if(s===1028)return 6403;if(s===1022)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(s===1035)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===1029)return 36244;if(s===1030)return 33319;if(s===1031)return 33320;if(s===1033)return 36249;if(s===33776||s===33777||s===33778||s===33779)if(o===3001)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===33776)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===33777)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===33778)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===33779)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===33776)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===33777)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===33778)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===33779)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===35840||s===35841||s===35842||s===35843)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===35840)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===35841)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===35842)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===35843)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===36196)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===37492||s===37496)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(s===37492)return o===3001?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===37496)return o===3001?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===37808||s===37809||s===37810||s===37811||s===37812||s===37813||s===37814||s===37815||s===37816||s===37817||s===37818||s===37819||s===37820||s===37821)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(s===37808)return o===3001?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===37809)return o===3001?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===37810)return o===3001?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===37811)return o===3001?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===37812)return o===3001?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===37813)return o===3001?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===37814)return o===3001?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===37815)return o===3001?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===37816)return o===3001?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===37817)return o===3001?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===37818)return o===3001?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===37819)return o===3001?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===37820)return o===3001?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===37821)return o===3001?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===36492)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(s===36492)return o===3001?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;return s===1020?r?34042:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):i[s]!==void 0?i[s]:null}return{convert:n}}class f7 extends fi{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Rl extends ei{constructor(){super(),this.isGroup=!0,this.type="Group"}}const p7={type:"move"};class wu{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Rl,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Rl,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new J,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new J),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Rl,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new J,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new J),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,r){let n=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(c&&e.hand){o=!0;for(const f of e.hand.values()){const m=t.getJointPose(f,r);if(c.joints[f.jointName]===void 0){const y=new Rl;y.matrixAutoUpdate=!1,y.visible=!1,c.joints[f.jointName]=y,c.add(y)}const b=c.joints[f.jointName];m!==null&&(b.matrix.fromArray(m.transform.matrix),b.matrix.decompose(b.position,b.rotation,b.scale),b.jointRadius=m.radius),b.visible=m!==null}const d=c.joints["index-finger-tip"],u=c.joints["thumb-tip"],h=d.position.distanceTo(u.position),p=.02,g=.005;c.inputState.pinching&&h>p+g?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&h<=p-g&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,r),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(n=t.getPose(e.targetRaySpace,r),n===null&&s!==null&&(n=s),n!==null&&(a.matrix.fromArray(n.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),n.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(n.linearVelocity)):a.hasLinearVelocity=!1,n.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(n.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(p7)))}return a!==null&&(a.visible=n!==null),l!==null&&(l.visible=s!==null),c!==null&&(c.visible=o!==null),this}}class m7 extends vi{constructor(e,t,r,n,s,o,a,l,c,d){if(d=d!==void 0?d:1026,d!==1026&&d!==1027)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&d===1026&&(r=1014),r===void 0&&d===1027&&(r=1020),super(null,n,s,o,a,l,d,r,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:1003,this.minFilter=l!==void 0?l:1003,this.flipY=!1,this.generateMipmaps=!1}}class g7 extends mo{constructor(e,t){super();const r=this;let n=null,s=1,o=null,a="local-floor",l=null,c=null,d=null,u=null,h=null,p=null;const g=t.getContextAttributes();let f=null,m=null;const b=[],y=[],w=new fi;w.layers.enable(1),w.viewport=new Ot;const _=new fi;_.layers.enable(2),_.viewport=new Ot;const M=[w,_],S=new f7;S.layers.enable(1),S.layers.enable(2);let A=null,x=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(W){let ee=b[W];return ee===void 0&&(ee=new wu,b[W]=ee),ee.getTargetRaySpace()},this.getControllerGrip=function(W){let ee=b[W];return ee===void 0&&(ee=new wu,b[W]=ee),ee.getGripSpace()},this.getHand=function(W){let ee=b[W];return ee===void 0&&(ee=new wu,b[W]=ee),ee.getHandSpace()};function E(W){const ee=y.indexOf(W.inputSource);if(ee===-1)return;const me=b[ee];me!==void 0&&me.dispatchEvent({type:W.type,data:W.inputSource})}function D(){n.removeEventListener("select",E),n.removeEventListener("selectstart",E),n.removeEventListener("selectend",E),n.removeEventListener("squeeze",E),n.removeEventListener("squeezestart",E),n.removeEventListener("squeezeend",E),n.removeEventListener("end",D),n.removeEventListener("inputsourceschange",F);for(let W=0;W<b.length;W++){const ee=y[W];ee!==null&&(y[W]=null,b[W].disconnect(ee))}A=null,x=null,e.setRenderTarget(f),h=null,u=null,d=null,n=null,m=null,Y.stop(),r.isPresenting=!1,r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(W){s=W,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(W){a=W,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||o},this.setReferenceSpace=function(W){l=W},this.getBaseLayer=function(){return u!==null?u:h},this.getBinding=function(){return d},this.getFrame=function(){return p},this.getSession=function(){return n},this.setSession=async function(W){if(n=W,n!==null){if(f=e.getRenderTarget(),n.addEventListener("select",E),n.addEventListener("selectstart",E),n.addEventListener("selectend",E),n.addEventListener("squeeze",E),n.addEventListener("squeezestart",E),n.addEventListener("squeezeend",E),n.addEventListener("end",D),n.addEventListener("inputsourceschange",F),g.xrCompatible!==!0&&await t.makeXRCompatible(),n.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const ee={antialias:n.renderState.layers===void 0?g.antialias:!0,alpha:g.alpha,depth:g.depth,stencil:g.stencil,framebufferScaleFactor:s};h=new XRWebGLLayer(n,t,ee),n.updateRenderState({baseLayer:h}),m=new ds(h.framebufferWidth,h.framebufferHeight,{format:1023,type:1009,encoding:e.outputEncoding})}else{let ee=null,me=null,X=null;g.depth&&(X=g.stencil?35056:33190,ee=g.stencil?1027:1026,me=g.stencil?1020:1014);const ye={colorFormat:32856,depthFormat:X,scaleFactor:s};d=new XRWebGLBinding(n,t),u=d.createProjectionLayer(ye),n.updateRenderState({layers:[u]}),m=new ds(u.textureWidth,u.textureHeight,{format:1023,type:1009,depthTexture:new m7(u.textureWidth,u.textureHeight,me,void 0,void 0,void 0,void 0,void 0,void 0,ee),stencilBuffer:g.stencil,encoding:e.outputEncoding,samples:g.antialias?4:0});const Ce=e.properties.get(m);Ce.__ignoreDepthValues=u.ignoreDepthValues}m.isXRRenderTarget=!0,this.setFoveation(1),l=null,o=await n.requestReferenceSpace(a),Y.setContext(n),Y.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}};function F(W){for(let ee=0;ee<W.removed.length;ee++){const me=W.removed[ee],X=y.indexOf(me);X>=0&&(y[X]=null,b[X].dispatchEvent({type:"disconnected",data:me}))}for(let ee=0;ee<W.added.length;ee++){const me=W.added[ee];let X=y.indexOf(me);if(X===-1){for(let Ce=0;Ce<b.length;Ce++)if(Ce>=y.length){y.push(me),X=Ce;break}else if(y[Ce]===null){y[Ce]=me,X=Ce;break}if(X===-1)break}const ye=b[X];ye&&ye.dispatchEvent({type:"connected",data:me})}}const R=new J,B=new J;function I(W,ee,me){R.setFromMatrixPosition(ee.matrixWorld),B.setFromMatrixPosition(me.matrixWorld);const X=R.distanceTo(B),ye=ee.projectionMatrix.elements,Ce=me.projectionMatrix.elements,We=ye[14]/(ye[10]-1),se=ye[14]/(ye[10]+1),te=(ye[9]+1)/ye[5],fe=(ye[9]-1)/ye[5],pe=(ye[8]-1)/ye[0],de=(Ce[8]+1)/Ce[0],He=We*pe,$e=We*de,L=X/(-pe+de),$=L*-pe;ee.matrixWorld.decompose(W.position,W.quaternion,W.scale),W.translateX($),W.translateZ(L),W.matrixWorld.compose(W.position,W.quaternion,W.scale),W.matrixWorldInverse.copy(W.matrixWorld).invert();const Z=We+L,le=se+L,oe=He-$,_e=$e+(X-$),we=te*se/le*Z,xe=fe*se/le*Z;W.projectionMatrix.makePerspective(oe,_e,we,xe,Z,le)}function V(W,ee){ee===null?W.matrixWorld.copy(W.matrix):W.matrixWorld.multiplyMatrices(ee.matrixWorld,W.matrix),W.matrixWorldInverse.copy(W.matrixWorld).invert()}this.updateCamera=function(W){if(n===null)return;S.near=_.near=w.near=W.near,S.far=_.far=w.far=W.far,(A!==S.near||x!==S.far)&&(n.updateRenderState({depthNear:S.near,depthFar:S.far}),A=S.near,x=S.far);const ee=W.parent,me=S.cameras;V(S,ee);for(let ye=0;ye<me.length;ye++)V(me[ye],ee);S.matrixWorld.decompose(S.position,S.quaternion,S.scale),W.position.copy(S.position),W.quaternion.copy(S.quaternion),W.scale.copy(S.scale),W.matrix.copy(S.matrix),W.matrixWorld.copy(S.matrixWorld);const X=W.children;for(let ye=0,Ce=X.length;ye<Ce;ye++)X[ye].updateMatrixWorld(!0);me.length===2?I(S,w,_):S.projectionMatrix.copy(w.projectionMatrix)},this.getCamera=function(){return S},this.getFoveation=function(){if(u!==null)return u.fixedFoveation;if(h!==null)return h.fixedFoveation},this.setFoveation=function(W){u!==null&&(u.fixedFoveation=W),h!==null&&h.fixedFoveation!==void 0&&(h.fixedFoveation=W)};let N=null;function j(W,ee){if(c=ee.getViewerPose(l||o),p=ee,c!==null){const me=c.views;h!==null&&(e.setRenderTargetFramebuffer(m,h.framebuffer),e.setRenderTarget(m));let X=!1;me.length!==S.cameras.length&&(S.cameras.length=0,X=!0);for(let ye=0;ye<me.length;ye++){const Ce=me[ye];let We=null;if(h!==null)We=h.getViewport(Ce);else{const te=d.getViewSubImage(u,Ce);We=te.viewport,ye===0&&(e.setRenderTargetTextures(m,te.colorTexture,u.ignoreDepthValues?void 0:te.depthStencilTexture),e.setRenderTarget(m))}let se=M[ye];se===void 0&&(se=new fi,se.layers.enable(ye),se.viewport=new Ot,M[ye]=se),se.matrix.fromArray(Ce.transform.matrix),se.projectionMatrix.fromArray(Ce.projectionMatrix),se.viewport.set(We.x,We.y,We.width,We.height),ye===0&&S.matrix.copy(se.matrix),X===!0&&S.cameras.push(se)}}for(let me=0;me<b.length;me++){const X=y[me],ye=b[me];X!==null&&ye!==void 0&&ye.update(X,ee,l||o)}N&&N(W,ee),p=null}const Y=new t_;Y.setAnimationLoop(j),this.setAnimationLoop=function(W){N=W},this.dispose=function(){}}}function v7(i,e){function t(f,m){f.fogColor.value.copy(m.color),m.isFog?(f.fogNear.value=m.near,f.fogFar.value=m.far):m.isFogExp2&&(f.fogDensity.value=m.density)}function r(f,m,b,y,w){m.isMeshBasicMaterial||m.isMeshLambertMaterial?n(f,m):m.isMeshToonMaterial?(n(f,m),d(f,m)):m.isMeshPhongMaterial?(n(f,m),c(f,m)):m.isMeshStandardMaterial?(n(f,m),u(f,m),m.isMeshPhysicalMaterial&&h(f,m,w)):m.isMeshMatcapMaterial?(n(f,m),p(f,m)):m.isMeshDepthMaterial?n(f,m):m.isMeshDistanceMaterial?(n(f,m),g(f,m)):m.isMeshNormalMaterial?n(f,m):m.isLineBasicMaterial?(s(f,m),m.isLineDashedMaterial&&o(f,m)):m.isPointsMaterial?a(f,m,b,y):m.isSpriteMaterial?l(f,m):m.isShadowMaterial?(f.color.value.copy(m.color),f.opacity.value=m.opacity):m.isShaderMaterial&&(m.uniformsNeedUpdate=!1)}function n(f,m){f.opacity.value=m.opacity,m.color&&f.diffuse.value.copy(m.color),m.emissive&&f.emissive.value.copy(m.emissive).multiplyScalar(m.emissiveIntensity),m.map&&(f.map.value=m.map),m.alphaMap&&(f.alphaMap.value=m.alphaMap),m.bumpMap&&(f.bumpMap.value=m.bumpMap,f.bumpScale.value=m.bumpScale,m.side===1&&(f.bumpScale.value*=-1)),m.displacementMap&&(f.displacementMap.value=m.displacementMap,f.displacementScale.value=m.displacementScale,f.displacementBias.value=m.displacementBias),m.emissiveMap&&(f.emissiveMap.value=m.emissiveMap),m.normalMap&&(f.normalMap.value=m.normalMap,f.normalScale.value.copy(m.normalScale),m.side===1&&f.normalScale.value.negate()),m.specularMap&&(f.specularMap.value=m.specularMap),m.alphaTest>0&&(f.alphaTest.value=m.alphaTest);const b=e.get(m).envMap;if(b&&(f.envMap.value=b,f.flipEnvMap.value=b.isCubeTexture&&b.isRenderTargetTexture===!1?-1:1,f.reflectivity.value=m.reflectivity,f.ior.value=m.ior,f.refractionRatio.value=m.refractionRatio),m.lightMap){f.lightMap.value=m.lightMap;const _=i.physicallyCorrectLights!==!0?Math.PI:1;f.lightMapIntensity.value=m.lightMapIntensity*_}m.aoMap&&(f.aoMap.value=m.aoMap,f.aoMapIntensity.value=m.aoMapIntensity);let y;m.map?y=m.map:m.specularMap?y=m.specularMap:m.displacementMap?y=m.displacementMap:m.normalMap?y=m.normalMap:m.bumpMap?y=m.bumpMap:m.roughnessMap?y=m.roughnessMap:m.metalnessMap?y=m.metalnessMap:m.alphaMap?y=m.alphaMap:m.emissiveMap?y=m.emissiveMap:m.clearcoatMap?y=m.clearcoatMap:m.clearcoatNormalMap?y=m.clearcoatNormalMap:m.clearcoatRoughnessMap?y=m.clearcoatRoughnessMap:m.iridescenceMap?y=m.iridescenceMap:m.iridescenceThicknessMap?y=m.iridescenceThicknessMap:m.specularIntensityMap?y=m.specularIntensityMap:m.specularColorMap?y=m.specularColorMap:m.transmissionMap?y=m.transmissionMap:m.thicknessMap?y=m.thicknessMap:m.sheenColorMap?y=m.sheenColorMap:m.sheenRoughnessMap&&(y=m.sheenRoughnessMap),y!==void 0&&(y.isWebGLRenderTarget&&(y=y.texture),y.matrixAutoUpdate===!0&&y.updateMatrix(),f.uvTransform.value.copy(y.matrix));let w;m.aoMap?w=m.aoMap:m.lightMap&&(w=m.lightMap),w!==void 0&&(w.isWebGLRenderTarget&&(w=w.texture),w.matrixAutoUpdate===!0&&w.updateMatrix(),f.uv2Transform.value.copy(w.matrix))}function s(f,m){f.diffuse.value.copy(m.color),f.opacity.value=m.opacity}function o(f,m){f.dashSize.value=m.dashSize,f.totalSize.value=m.dashSize+m.gapSize,f.scale.value=m.scale}function a(f,m,b,y){f.diffuse.value.copy(m.color),f.opacity.value=m.opacity,f.size.value=m.size*b,f.scale.value=y*.5,m.map&&(f.map.value=m.map),m.alphaMap&&(f.alphaMap.value=m.alphaMap),m.alphaTest>0&&(f.alphaTest.value=m.alphaTest);let w;m.map?w=m.map:m.alphaMap&&(w=m.alphaMap),w!==void 0&&(w.matrixAutoUpdate===!0&&w.updateMatrix(),f.uvTransform.value.copy(w.matrix))}function l(f,m){f.diffuse.value.copy(m.color),f.opacity.value=m.opacity,f.rotation.value=m.rotation,m.map&&(f.map.value=m.map),m.alphaMap&&(f.alphaMap.value=m.alphaMap),m.alphaTest>0&&(f.alphaTest.value=m.alphaTest);let b;m.map?b=m.map:m.alphaMap&&(b=m.alphaMap),b!==void 0&&(b.matrixAutoUpdate===!0&&b.updateMatrix(),f.uvTransform.value.copy(b.matrix))}function c(f,m){f.specular.value.copy(m.specular),f.shininess.value=Math.max(m.shininess,1e-4)}function d(f,m){m.gradientMap&&(f.gradientMap.value=m.gradientMap)}function u(f,m){f.roughness.value=m.roughness,f.metalness.value=m.metalness,m.roughnessMap&&(f.roughnessMap.value=m.roughnessMap),m.metalnessMap&&(f.metalnessMap.value=m.metalnessMap),e.get(m).envMap&&(f.envMapIntensity.value=m.envMapIntensity)}function h(f,m,b){f.ior.value=m.ior,m.sheen>0&&(f.sheenColor.value.copy(m.sheenColor).multiplyScalar(m.sheen),f.sheenRoughness.value=m.sheenRoughness,m.sheenColorMap&&(f.sheenColorMap.value=m.sheenColorMap),m.sheenRoughnessMap&&(f.sheenRoughnessMap.value=m.sheenRoughnessMap)),m.clearcoat>0&&(f.clearcoat.value=m.clearcoat,f.clearcoatRoughness.value=m.clearcoatRoughness,m.clearcoatMap&&(f.clearcoatMap.value=m.clearcoatMap),m.clearcoatRoughnessMap&&(f.clearcoatRoughnessMap.value=m.clearcoatRoughnessMap),m.clearcoatNormalMap&&(f.clearcoatNormalScale.value.copy(m.clearcoatNormalScale),f.clearcoatNormalMap.value=m.clearcoatNormalMap,m.side===1&&f.clearcoatNormalScale.value.negate())),m.iridescence>0&&(f.iridescence.value=m.iridescence,f.iridescenceIOR.value=m.iridescenceIOR,f.iridescenceThicknessMinimum.value=m.iridescenceThicknessRange[0],f.iridescenceThicknessMaximum.value=m.iridescenceThicknessRange[1],m.iridescenceMap&&(f.iridescenceMap.value=m.iridescenceMap),m.iridescenceThicknessMap&&(f.iridescenceThicknessMap.value=m.iridescenceThicknessMap)),m.transmission>0&&(f.transmission.value=m.transmission,f.transmissionSamplerMap.value=b.texture,f.transmissionSamplerSize.value.set(b.width,b.height),m.transmissionMap&&(f.transmissionMap.value=m.transmissionMap),f.thickness.value=m.thickness,m.thicknessMap&&(f.thicknessMap.value=m.thicknessMap),f.attenuationDistance.value=m.attenuationDistance,f.attenuationColor.value.copy(m.attenuationColor)),f.specularIntensity.value=m.specularIntensity,f.specularColor.value.copy(m.specularColor),m.specularIntensityMap&&(f.specularIntensityMap.value=m.specularIntensityMap),m.specularColorMap&&(f.specularColorMap.value=m.specularColorMap)}function p(f,m){m.matcap&&(f.matcap.value=m.matcap)}function g(f,m){f.referencePosition.value.copy(m.referencePosition),f.nearDistance.value=m.nearDistance,f.farDistance.value=m.farDistance}return{refreshFogUniforms:t,refreshMaterialUniforms:r}}function b7(i,e,t,r){let n={},s={},o=[];const a=t.isWebGL2?i.getParameter(35375):0;function l(y,w){const _=w.program;r.uniformBlockBinding(y,_)}function c(y,w){let _=n[y.id];_===void 0&&(g(y),_=d(y),n[y.id]=_,y.addEventListener("dispose",m));const M=w.program;r.updateUBOMapping(y,M);const S=e.render.frame;s[y.id]!==S&&(h(y),s[y.id]=S)}function d(y){const w=u();y.__bindingPointIndex=w;const _=i.createBuffer(),M=y.__size,S=y.usage;return i.bindBuffer(35345,_),i.bufferData(35345,M,S),i.bindBuffer(35345,null),i.bindBufferBase(35345,w,_),_}function u(){for(let y=0;y<a;y++)if(o.indexOf(y)===-1)return o.push(y),y;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function h(y){const w=n[y.id],_=y.uniforms,M=y.__cache;i.bindBuffer(35345,w);for(let S=0,A=_.length;S<A;S++){const x=_[S];if(p(x,S,M)===!0){const E=x.value,D=x.__offset;typeof E=="number"?(x.__data[0]=E,i.bufferSubData(35345,D,x.__data)):(x.value.isMatrix3?(x.__data[0]=x.value.elements[0],x.__data[1]=x.value.elements[1],x.__data[2]=x.value.elements[2],x.__data[3]=x.value.elements[0],x.__data[4]=x.value.elements[3],x.__data[5]=x.value.elements[4],x.__data[6]=x.value.elements[5],x.__data[7]=x.value.elements[0],x.__data[8]=x.value.elements[6],x.__data[9]=x.value.elements[7],x.__data[10]=x.value.elements[8],x.__data[11]=x.value.elements[0]):E.toArray(x.__data),i.bufferSubData(35345,D,x.__data))}}i.bindBuffer(35345,null)}function p(y,w,_){const M=y.value;if(_[w]===void 0)return typeof M=="number"?_[w]=M:_[w]=M.clone(),!0;if(typeof M=="number"){if(_[w]!==M)return _[w]=M,!0}else{const S=_[w];if(S.equals(M)===!1)return S.copy(M),!0}return!1}function g(y){const w=y.uniforms;let _=0;const M=16;let S=0;for(let A=0,x=w.length;A<x;A++){const E=w[A],D=f(E);if(E.__data=new Float32Array(D.storage/Float32Array.BYTES_PER_ELEMENT),E.__offset=_,A>0){S=_%M;const F=M-S;S!==0&&F-D.boundary<0&&(_+=M-S,E.__offset=_)}_+=D.storage}return S=_%M,S>0&&(_+=M-S),y.__size=_,y.__cache={},this}function f(y){const w=y.value,_={boundary:0,storage:0};return typeof w=="number"?(_.boundary=4,_.storage=4):w.isVector2?(_.boundary=8,_.storage=8):w.isVector3||w.isColor?(_.boundary=16,_.storage=12):w.isVector4?(_.boundary=16,_.storage=16):w.isMatrix3?(_.boundary=48,_.storage=48):w.isMatrix4?(_.boundary=64,_.storage=64):w.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",w),_}function m(y){const w=y.target;w.removeEventListener("dispose",m);const _=o.indexOf(w.__bindingPointIndex);o.splice(_,1),i.deleteBuffer(n[w.id]),delete n[w.id],delete s[w.id]}function b(){for(const y in n)i.deleteBuffer(n[y]);o=[],n={},s={}}return{bind:l,update:c,dispose:b}}function y7(){const i=Vc("canvas");return i.style.display="block",i}function a_(i={}){this.isWebGLRenderer=!0;const e=i.canvas!==void 0?i.canvas:y7(),t=i.context!==void 0?i.context:null,r=i.depth!==void 0?i.depth:!0,n=i.stencil!==void 0?i.stencil:!0,s=i.antialias!==void 0?i.antialias:!1,o=i.premultipliedAlpha!==void 0?i.premultipliedAlpha:!0,a=i.preserveDrawingBuffer!==void 0?i.preserveDrawingBuffer:!1,l=i.powerPreference!==void 0?i.powerPreference:"default",c=i.failIfMajorPerformanceCaveat!==void 0?i.failIfMajorPerformanceCaveat:!1;let d;t!==null?d=t.getContextAttributes().alpha:d=i.alpha!==void 0?i.alpha:!1;let u=null,h=null;const p=[],g=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=3e3,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1,Object.defineProperties(this,{gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}});const f=this;let m=!1,b=0,y=0,w=null,_=-1,M=null;const S=new Ot,A=new Ot;let x=null,E=e.width,D=e.height,F=1,R=null,B=null;const I=new Ot(0,0,E,D),V=new Ot(0,0,E,D);let N=!1;const j=new Nf;let Y=!1,W=!1,ee=null;const me=new Ft,X=new at,ye=new J,Ce={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function We(){return w===null?F:1}let se=t;function te(O,ie){for(let ae=0;ae<O.length;ae++){const ne=O[ae],ge=e.getContext(ne,ie);if(ge!==null)return ge}return null}try{const O={alpha:!0,depth:r,stencil:n,antialias:s,premultipliedAlpha:o,preserveDrawingBuffer:a,powerPreference:l,failIfMajorPerformanceCaveat:c};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${zf}`),e.addEventListener("webglcontextlost",qe,!1),e.addEventListener("webglcontextrestored",lt,!1),e.addEventListener("webglcontextcreationerror",tt,!1),se===null){const ie=["webgl2","webgl","experimental-webgl"];if(f.isWebGL1Renderer===!0&&ie.shift(),se=te(ie,O),se===null)throw te(ie)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}se.getShaderPrecisionFormat===void 0&&(se.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(O){throw console.error("THREE.WebGLRenderer: "+O.message),O}let fe,pe,de,He,$e,L,$,Z,le,oe,_e,we,xe,Me,T,C,q,re,ue,ve,Re,Q,Ie,De;function Ve(){fe=new AB(se),pe=new xB(se,fe,i),fe.init(pe),Q=new h7(se,fe,pe),de=new d7(se,fe,pe),He=new PB,$e=new K8,L=new u7(se,fe,de,$e,pe,Q,He),$=new MB(f),Z=new TB(f),le=new Uz(se,pe),Ie=new _B(se,fe,le,pe),oe=new LB(se,le,He,Ie),_e=new FB(se,oe,le,He),ue=new OB(se,pe,L),C=new SB($e),we=new X8(f,$,Z,fe,pe,Ie,C),xe=new v7(f,$e),Me=new Z8,T=new n7(fe,pe),re=new yB(f,$,de,_e,d,o),q=new c7(f,_e,pe),De=new b7(se,He,pe,de),ve=new wB(se,fe,He,pe),Re=new DB(se,fe,He,pe),He.programs=we.programs,f.capabilities=pe,f.extensions=fe,f.properties=$e,f.renderLists=Me,f.shadowMap=q,f.state=de,f.info=He}Ve();const Ne=new g7(f,se);this.xr=Ne,this.getContext=function(){return se},this.getContextAttributes=function(){return se.getContextAttributes()},this.forceContextLoss=function(){const O=fe.get("WEBGL_lose_context");O&&O.loseContext()},this.forceContextRestore=function(){const O=fe.get("WEBGL_lose_context");O&&O.restoreContext()},this.getPixelRatio=function(){return F},this.setPixelRatio=function(O){O!==void 0&&(F=O,this.setSize(E,D,!1))},this.getSize=function(O){return O.set(E,D)},this.setSize=function(O,ie,ae){if(Ne.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}E=O,D=ie,e.width=Math.floor(O*F),e.height=Math.floor(ie*F),ae!==!1&&(e.style.width=O+"px",e.style.height=ie+"px"),this.setViewport(0,0,O,ie)},this.getDrawingBufferSize=function(O){return O.set(E*F,D*F).floor()},this.setDrawingBufferSize=function(O,ie,ae){E=O,D=ie,F=ae,e.width=Math.floor(O*ae),e.height=Math.floor(ie*ae),this.setViewport(0,0,O,ie)},this.getCurrentViewport=function(O){return O.copy(S)},this.getViewport=function(O){return O.copy(I)},this.setViewport=function(O,ie,ae,ne){O.isVector4?I.set(O.x,O.y,O.z,O.w):I.set(O,ie,ae,ne),de.viewport(S.copy(I).multiplyScalar(F).floor())},this.getScissor=function(O){return O.copy(V)},this.setScissor=function(O,ie,ae,ne){O.isVector4?V.set(O.x,O.y,O.z,O.w):V.set(O,ie,ae,ne),de.scissor(A.copy(V).multiplyScalar(F).floor())},this.getScissorTest=function(){return N},this.setScissorTest=function(O){de.setScissorTest(N=O)},this.setOpaqueSort=function(O){R=O},this.setTransparentSort=function(O){B=O},this.getClearColor=function(O){return O.copy(re.getClearColor())},this.setClearColor=function(){re.setClearColor.apply(re,arguments)},this.getClearAlpha=function(){return re.getClearAlpha()},this.setClearAlpha=function(){re.setClearAlpha.apply(re,arguments)},this.clear=function(O=!0,ie=!0,ae=!0){let ne=0;O&&(ne|=16384),ie&&(ne|=256),ae&&(ne|=1024),se.clear(ne)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",qe,!1),e.removeEventListener("webglcontextrestored",lt,!1),e.removeEventListener("webglcontextcreationerror",tt,!1),Me.dispose(),T.dispose(),$e.dispose(),$.dispose(),Z.dispose(),_e.dispose(),Ie.dispose(),De.dispose(),we.dispose(),Ne.dispose(),Ne.removeEventListener("sessionstart",_t),Ne.removeEventListener("sessionend",zt),ee&&(ee.dispose(),ee=null),Ct.stop()};function qe(O){O.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),m=!0}function lt(){console.log("THREE.WebGLRenderer: Context Restored."),m=!1;const O=He.autoReset,ie=q.enabled,ae=q.autoUpdate,ne=q.needsUpdate,ge=q.type;Ve(),He.autoReset=O,q.enabled=ie,q.autoUpdate=ae,q.needsUpdate=ne,q.type=ge}function tt(O){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",O.statusMessage)}function G(O){const ie=O.target;ie.removeEventListener("dispose",G),Oe(ie)}function Oe(O){ce(O),$e.remove(O)}function ce(O){const ie=$e.get(O).programs;ie!==void 0&&(ie.forEach(function(ae){we.releaseProgram(ae)}),O.isShaderMaterial&&we.releaseShaderCache(O))}this.renderBufferDirect=function(O,ie,ae,ne,ge,je){ie===null&&(ie=Ce);const Ke=ge.isMesh&&ge.matrixWorld.determinant()<0,Je=__(O,ie,ae,ne,ge);de.setMaterial(ne,Ke);let it=ae.index;const Et=ae.attributes.position;if(it===null){if(Et===void 0||Et.count===0)return}else if(it.count===0)return;let rt=1;ne.wireframe===!0&&(it=oe.getWireframeAttribute(ae),rt=2),Ie.setup(ge,ne,Je,ae,it);let ct,Nt=ve;it!==null&&(ct=le.get(it),Nt=Re,Nt.setIndex(ct));const Tn=it!==null?it.count:Et.count,ys=ae.drawRange.start*rt,_s=ae.drawRange.count*rt,Wi=je!==null?je.start*rt:0,mt=je!==null?je.count*rt:1/0,ws=Math.max(ys,Wi),vo=Math.min(Tn,ys+_s,Wi+mt)-1,_i=Math.max(0,vo-ws+1);if(_i!==0){if(ge.isMesh)ne.wireframe===!0?(de.setLineWidth(ne.wireframeLinewidth*We()),Nt.setMode(1)):Nt.setMode(4);else if(ge.isLine){let Or=ne.linewidth;Or===void 0&&(Or=1),de.setLineWidth(Or*We()),ge.isLineSegments?Nt.setMode(1):ge.isLineLoop?Nt.setMode(2):Nt.setMode(3)}else ge.isPoints?Nt.setMode(0):ge.isSprite&&Nt.setMode(4);if(ge.isInstancedMesh)Nt.renderInstances(ws,_i,ge.count);else if(ae.isInstancedBufferGeometry){const Or=Math.min(ae.instanceCount,ae._maxInstanceCount);Nt.renderInstances(ws,_i,Or)}else Nt.render(ws,_i)}},this.compile=function(O,ie){h=T.get(O),h.init(),g.push(h),O.traverseVisible(function(ae){ae.isLight&&ae.layers.test(ie.layers)&&(h.pushLight(ae),ae.castShadow&&h.pushShadow(ae))}),h.setupLights(f.physicallyCorrectLights),O.traverse(function(ae){const ne=ae.material;if(ne)if(Array.isArray(ne))for(let ge=0;ge<ne.length;ge++){const je=ne[ge];gd(je,O,ae)}else gd(ne,O,ae)}),g.pop(),h=null};let Be=null;function Te(O){Be&&Be(O)}function _t(){Ct.stop()}function zt(){Ct.start()}const Ct=new t_;Ct.setAnimationLoop(Te),typeof self<"u"&&Ct.setContext(self),this.setAnimationLoop=function(O){Be=O,Ne.setAnimationLoop(O),O===null?Ct.stop():Ct.start()},Ne.addEventListener("sessionstart",_t),Ne.addEventListener("sessionend",zt),this.render=function(O,ie){if(ie!==void 0&&ie.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(m===!0)return;O.autoUpdate===!0&&O.updateMatrixWorld(),ie.parent===null&&ie.updateMatrixWorld(),Ne.enabled===!0&&Ne.isPresenting===!0&&(Ne.cameraAutoUpdate===!0&&Ne.updateCamera(ie),ie=Ne.getCamera()),O.isScene===!0&&O.onBeforeRender(f,O,ie,w),h=T.get(O,g.length),h.init(),g.push(h),me.multiplyMatrices(ie.projectionMatrix,ie.matrixWorldInverse),j.setFromProjectionMatrix(me),W=this.localClippingEnabled,Y=C.init(this.clippingPlanes,W,ie),u=Me.get(O,p.length),u.init(),p.push(u),Ir(O,ie,0,f.sortObjects),u.finish(),f.sortObjects===!0&&u.sort(R,B),Y===!0&&C.beginShadows();const ae=h.state.shadowsArray;if(q.render(ae,O,ie),Y===!0&&C.endShadows(),this.info.autoReset===!0&&this.info.reset(),re.render(u,O),h.setupLights(f.physicallyCorrectLights),ie.isArrayCamera){const ne=ie.cameras;for(let ge=0,je=ne.length;ge<je;ge++){const Ke=ne[ge];Mt(u,O,Ke,Ke.viewport)}}else Mt(u,O,ie);w!==null&&(L.updateMultisampleRenderTarget(w),L.updateRenderTargetMipmap(w)),O.isScene===!0&&O.onAfterRender(f,O,ie),Ie.resetDefaultState(),_=-1,M=null,g.pop(),g.length>0?h=g[g.length-1]:h=null,p.pop(),p.length>0?u=p[p.length-1]:u=null};function Ir(O,ie,ae,ne){if(O.visible===!1)return;if(O.layers.test(ie.layers)){if(O.isGroup)ae=O.renderOrder;else if(O.isLOD)O.autoUpdate===!0&&O.update(ie);else if(O.isLight)h.pushLight(O),O.castShadow&&h.pushShadow(O);else if(O.isSprite){if(!O.frustumCulled||j.intersectsSprite(O)){ne&&ye.setFromMatrixPosition(O.matrixWorld).applyMatrix4(me);const je=_e.update(O),Ke=O.material;Ke.visible&&u.push(O,je,Ke,ae,ye.z,null)}}else if((O.isMesh||O.isLine||O.isPoints)&&(O.isSkinnedMesh&&O.skeleton.frame!==He.render.frame&&(O.skeleton.update(),O.skeleton.frame=He.render.frame),!O.frustumCulled||j.intersectsObject(O))){ne&&ye.setFromMatrixPosition(O.matrixWorld).applyMatrix4(me);const je=_e.update(O),Ke=O.material;if(Array.isArray(Ke)){const Je=je.groups;for(let it=0,Et=Je.length;it<Et;it++){const rt=Je[it],ct=Ke[rt.materialIndex];ct&&ct.visible&&u.push(O,je,ct,ae,ye.z,rt)}}else Ke.visible&&u.push(O,je,Ke,ae,ye.z,null)}}const ge=O.children;for(let je=0,Ke=ge.length;je<Ke;je++)Ir(ge[je],ie,ae,ne)}function Mt(O,ie,ae,ne){const ge=O.opaque,je=O.transmissive,Ke=O.transparent;h.setupLightsView(ae),je.length>0&&cr(ge,ie,ae),ne&&de.viewport(S.copy(ne)),ge.length>0&&yi(ge,ie,ae),je.length>0&&yi(je,ie,ae),Ke.length>0&&yi(Ke,ie,ae),de.buffers.depth.setTest(!0),de.buffers.depth.setMask(!0),de.buffers.color.setMask(!0),de.setPolygonOffset(!1)}function cr(O,ie,ae){const ne=pe.isWebGL2;ee===null&&(ee=new ds(1,1,{generateMipmaps:!0,type:fe.has("EXT_color_buffer_half_float")?1016:1009,minFilter:1008,samples:ne&&s===!0?4:0})),f.getDrawingBufferSize(X),ne?ee.setSize(X.x,X.y):ee.setSize(fh(X.x),fh(X.y));const ge=f.getRenderTarget();f.setRenderTarget(ee),f.clear();const je=f.toneMapping;f.toneMapping=0,yi(O,ie,ae),f.toneMapping=je,L.updateMultisampleRenderTarget(ee),L.updateRenderTargetMipmap(ee),f.setRenderTarget(ge)}function yi(O,ie,ae){const ne=ie.isScene===!0?ie.overrideMaterial:null;for(let ge=0,je=O.length;ge<je;ge++){const Ke=O[ge],Je=Ke.object,it=Ke.geometry,Et=ne===null?Ke.material:ne,rt=Ke.group;Je.layers.test(ae.layers)&&y_(Je,ie,ae,it,Et,rt)}}function y_(O,ie,ae,ne,ge,je){O.onBeforeRender(f,ie,ae,ne,ge,je),O.modelViewMatrix.multiplyMatrices(ae.matrixWorldInverse,O.matrixWorld),O.normalMatrix.getNormalMatrix(O.modelViewMatrix),ge.onBeforeRender(f,ie,ae,ne,O,je),ge.transparent===!0&&ge.side===2?(ge.side=1,ge.needsUpdate=!0,f.renderBufferDirect(ae,ie,ne,ge,O,je),ge.side=0,ge.needsUpdate=!0,f.renderBufferDirect(ae,ie,ne,ge,O,je),ge.side=2):f.renderBufferDirect(ae,ie,ne,ge,O,je),O.onAfterRender(f,ie,ae,ne,ge,je)}function gd(O,ie,ae){ie.isScene!==!0&&(ie=Ce);const ne=$e.get(O),ge=h.state.lights,je=h.state.shadowsArray,Ke=ge.state.version,Je=we.getParameters(O,ge.state,je,ie,ae),it=we.getProgramCacheKey(Je);let Et=ne.programs;ne.environment=O.isMeshStandardMaterial?ie.environment:null,ne.fog=ie.fog,ne.envMap=(O.isMeshStandardMaterial?Z:$).get(O.envMap||ne.environment),Et===void 0&&(O.addEventListener("dispose",G),Et=new Map,ne.programs=Et);let rt=Et.get(it);if(rt!==void 0){if(ne.currentProgram===rt&&ne.lightsStateVersion===Ke)return Gf(O,Je),rt}else Je.uniforms=we.getUniforms(O),O.onBuild(ae,Je,f),O.onBeforeCompile(Je,f),rt=we.acquireProgram(Je,it),Et.set(it,rt),ne.uniforms=Je.uniforms;const ct=ne.uniforms;(!O.isShaderMaterial&&!O.isRawShaderMaterial||O.clipping===!0)&&(ct.clippingPlanes=C.uniform),Gf(O,Je),ne.needsLights=x_(O),ne.lightsStateVersion=Ke,ne.needsLights&&(ct.ambientLightColor.value=ge.state.ambient,ct.lightProbe.value=ge.state.probe,ct.directionalLights.value=ge.state.directional,ct.directionalLightShadows.value=ge.state.directionalShadow,ct.spotLights.value=ge.state.spot,ct.spotLightShadows.value=ge.state.spotShadow,ct.rectAreaLights.value=ge.state.rectArea,ct.ltc_1.value=ge.state.rectAreaLTC1,ct.ltc_2.value=ge.state.rectAreaLTC2,ct.pointLights.value=ge.state.point,ct.pointLightShadows.value=ge.state.pointShadow,ct.hemisphereLights.value=ge.state.hemi,ct.directionalShadowMap.value=ge.state.directionalShadowMap,ct.directionalShadowMatrix.value=ge.state.directionalShadowMatrix,ct.spotShadowMap.value=ge.state.spotShadowMap,ct.spotShadowMatrix.value=ge.state.spotShadowMatrix,ct.pointShadowMap.value=ge.state.pointShadowMap,ct.pointShadowMatrix.value=ge.state.pointShadowMatrix);const Nt=rt.getUniforms(),Tn=ec.seqWithValue(Nt.seq,ct);return ne.currentProgram=rt,ne.uniformsList=Tn,rt}function Gf(O,ie){const ae=$e.get(O);ae.outputEncoding=ie.outputEncoding,ae.instancing=ie.instancing,ae.skinning=ie.skinning,ae.morphTargets=ie.morphTargets,ae.morphNormals=ie.morphNormals,ae.morphColors=ie.morphColors,ae.morphTargetsCount=ie.morphTargetsCount,ae.numClippingPlanes=ie.numClippingPlanes,ae.numIntersection=ie.numClipIntersection,ae.vertexAlphas=ie.vertexAlphas,ae.vertexTangents=ie.vertexTangents,ae.toneMapping=ie.toneMapping}function __(O,ie,ae,ne,ge){ie.isScene!==!0&&(ie=Ce),L.resetTextureUnits();const je=ie.fog,Ke=ne.isMeshStandardMaterial?ie.environment:null,Je=w===null?f.outputEncoding:w.isXRRenderTarget===!0?w.texture.encoding:3e3,it=(ne.isMeshStandardMaterial?Z:$).get(ne.envMap||Ke),Et=ne.vertexColors===!0&&!!ae.attributes.color&&ae.attributes.color.itemSize===4,rt=!!ne.normalMap&&!!ae.attributes.tangent,ct=!!ae.morphAttributes.position,Nt=!!ae.morphAttributes.normal,Tn=!!ae.morphAttributes.color,ys=ne.toneMapped?f.toneMapping:0,_s=ae.morphAttributes.position||ae.morphAttributes.normal||ae.morphAttributes.color,Wi=_s!==void 0?_s.length:0,mt=$e.get(ne),ws=h.state.lights;if(Y===!0&&(W===!0||O!==M)){const li=O===M&&ne.id===_;C.setState(ne,O,li)}let vo=!1;ne.version===mt.__version?(mt.needsLights&&mt.lightsStateVersion!==ws.state.version||mt.outputEncoding!==Je||ge.isInstancedMesh&&mt.instancing===!1||!ge.isInstancedMesh&&mt.instancing===!0||ge.isSkinnedMesh&&mt.skinning===!1||!ge.isSkinnedMesh&&mt.skinning===!0||mt.envMap!==it||ne.fog===!0&&mt.fog!==je||mt.numClippingPlanes!==void 0&&(mt.numClippingPlanes!==C.numPlanes||mt.numIntersection!==C.numIntersection)||mt.vertexAlphas!==Et||mt.vertexTangents!==rt||mt.morphTargets!==ct||mt.morphNormals!==Nt||mt.morphColors!==Tn||mt.toneMapping!==ys||pe.isWebGL2===!0&&mt.morphTargetsCount!==Wi)&&(vo=!0):(vo=!0,mt.__version=ne.version);let _i=mt.currentProgram;vo===!0&&(_i=gd(ne,ie,ge));let Or=!1,bo=!1,vd=!1;const Kt=_i.getUniforms(),yo=mt.uniforms;if(de.useProgram(_i.program)&&(Or=!0,bo=!0,vd=!0),ne.id!==_&&(_=ne.id,bo=!0),Or||M!==O){if(Kt.setValue(se,"projectionMatrix",O.projectionMatrix),pe.logarithmicDepthBuffer&&Kt.setValue(se,"logDepthBufFC",2/(Math.log(O.far+1)/Math.LN2)),M!==O&&(M=O,bo=!0,vd=!0),ne.isShaderMaterial||ne.isMeshPhongMaterial||ne.isMeshToonMaterial||ne.isMeshStandardMaterial||ne.envMap){const li=Kt.map.cameraPosition;li!==void 0&&li.setValue(se,ye.setFromMatrixPosition(O.matrixWorld))}(ne.isMeshPhongMaterial||ne.isMeshToonMaterial||ne.isMeshLambertMaterial||ne.isMeshBasicMaterial||ne.isMeshStandardMaterial||ne.isShaderMaterial)&&Kt.setValue(se,"isOrthographic",O.isOrthographicCamera===!0),(ne.isMeshPhongMaterial||ne.isMeshToonMaterial||ne.isMeshLambertMaterial||ne.isMeshBasicMaterial||ne.isMeshStandardMaterial||ne.isShaderMaterial||ne.isShadowMaterial||ge.isSkinnedMesh)&&Kt.setValue(se,"viewMatrix",O.matrixWorldInverse)}if(ge.isSkinnedMesh){Kt.setOptional(se,ge,"bindMatrix"),Kt.setOptional(se,ge,"bindMatrixInverse");const li=ge.skeleton;li&&(pe.floatVertexTextures?(li.boneTexture===null&&li.computeBoneTexture(),Kt.setValue(se,"boneTexture",li.boneTexture,L),Kt.setValue(se,"boneTextureSize",li.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const bd=ae.morphAttributes;if((bd.position!==void 0||bd.normal!==void 0||bd.color!==void 0&&pe.isWebGL2===!0)&&ue.update(ge,ae,ne,_i),(bo||mt.receiveShadow!==ge.receiveShadow)&&(mt.receiveShadow=ge.receiveShadow,Kt.setValue(se,"receiveShadow",ge.receiveShadow)),bo&&(Kt.setValue(se,"toneMappingExposure",f.toneMappingExposure),mt.needsLights&&w_(yo,vd),je&&ne.fog===!0&&xe.refreshFogUniforms(yo,je),xe.refreshMaterialUniforms(yo,ne,F,D,ee),ec.upload(se,mt.uniformsList,yo,L)),ne.isShaderMaterial&&ne.uniformsNeedUpdate===!0&&(ec.upload(se,mt.uniformsList,yo,L),ne.uniformsNeedUpdate=!1),ne.isSpriteMaterial&&Kt.setValue(se,"center",ge.center),Kt.setValue(se,"modelViewMatrix",ge.modelViewMatrix),Kt.setValue(se,"normalMatrix",ge.normalMatrix),Kt.setValue(se,"modelMatrix",ge.matrixWorld),ne.isShaderMaterial||ne.isRawShaderMaterial){const li=ne.uniformsGroups;for(let yd=0,S_=li.length;yd<S_;yd++)if(pe.isWebGL2){const qf=li[yd];De.update(qf,_i),De.bind(qf,_i)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return _i}function w_(O,ie){O.ambientLightColor.needsUpdate=ie,O.lightProbe.needsUpdate=ie,O.directionalLights.needsUpdate=ie,O.directionalLightShadows.needsUpdate=ie,O.pointLights.needsUpdate=ie,O.pointLightShadows.needsUpdate=ie,O.spotLights.needsUpdate=ie,O.spotLightShadows.needsUpdate=ie,O.rectAreaLights.needsUpdate=ie,O.hemisphereLights.needsUpdate=ie}function x_(O){return O.isMeshLambertMaterial||O.isMeshToonMaterial||O.isMeshPhongMaterial||O.isMeshStandardMaterial||O.isShadowMaterial||O.isShaderMaterial&&O.lights===!0}this.getActiveCubeFace=function(){return b},this.getActiveMipmapLevel=function(){return y},this.getRenderTarget=function(){return w},this.setRenderTargetTextures=function(O,ie,ae){$e.get(O.texture).__webglTexture=ie,$e.get(O.depthTexture).__webglTexture=ae;const ne=$e.get(O);ne.__hasExternalTextures=!0,ne.__hasExternalTextures&&(ne.__autoAllocateDepthBuffer=ae===void 0,ne.__autoAllocateDepthBuffer||fe.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),ne.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(O,ie){const ae=$e.get(O);ae.__webglFramebuffer=ie,ae.__useDefaultFramebuffer=ie===void 0},this.setRenderTarget=function(O,ie=0,ae=0){w=O,b=ie,y=ae;let ne=!0;if(O){const Je=$e.get(O);Je.__useDefaultFramebuffer!==void 0?(de.bindFramebuffer(36160,null),ne=!1):Je.__webglFramebuffer===void 0?L.setupRenderTarget(O):Je.__hasExternalTextures&&L.rebindTextures(O,$e.get(O.texture).__webglTexture,$e.get(O.depthTexture).__webglTexture)}let ge=null,je=!1,Ke=!1;if(O){const Je=O.texture;(Je.isData3DTexture||Je.isDataArrayTexture)&&(Ke=!0);const it=$e.get(O).__webglFramebuffer;O.isWebGLCubeRenderTarget?(ge=it[ie],je=!0):pe.isWebGL2&&O.samples>0&&L.useMultisampledRTT(O)===!1?ge=$e.get(O).__webglMultisampledFramebuffer:ge=it,S.copy(O.viewport),A.copy(O.scissor),x=O.scissorTest}else S.copy(I).multiplyScalar(F).floor(),A.copy(V).multiplyScalar(F).floor(),x=N;if(de.bindFramebuffer(36160,ge)&&pe.drawBuffers&&ne&&de.drawBuffers(O,ge),de.viewport(S),de.scissor(A),de.setScissorTest(x),je){const Je=$e.get(O.texture);se.framebufferTexture2D(36160,36064,34069+ie,Je.__webglTexture,ae)}else if(Ke){const Je=$e.get(O.texture),it=ie||0;se.framebufferTextureLayer(36160,36064,Je.__webglTexture,ae||0,it)}_=-1},this.readRenderTargetPixels=function(O,ie,ae,ne,ge,je,Ke){if(!(O&&O.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Je=$e.get(O).__webglFramebuffer;if(O.isWebGLCubeRenderTarget&&Ke!==void 0&&(Je=Je[Ke]),Je){de.bindFramebuffer(36160,Je);try{const it=O.texture,Et=it.format,rt=it.type;if(Et!==1023&&Q.convert(Et)!==se.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const ct=rt===1016&&(fe.has("EXT_color_buffer_half_float")||pe.isWebGL2&&fe.has("EXT_color_buffer_float"));if(rt!==1009&&Q.convert(rt)!==se.getParameter(35738)&&!(rt===1015&&(pe.isWebGL2||fe.has("OES_texture_float")||fe.has("WEBGL_color_buffer_float")))&&!ct){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}ie>=0&&ie<=O.width-ne&&ae>=0&&ae<=O.height-ge&&se.readPixels(ie,ae,ne,ge,Q.convert(Et),Q.convert(rt),je)}finally{const it=w!==null?$e.get(w).__webglFramebuffer:null;de.bindFramebuffer(36160,it)}}},this.copyFramebufferToTexture=function(O,ie,ae=0){const ne=Math.pow(2,-ae),ge=Math.floor(ie.image.width*ne),je=Math.floor(ie.image.height*ne);L.setTexture2D(ie,0),se.copyTexSubImage2D(3553,ae,0,0,O.x,O.y,ge,je),de.unbindTexture()},this.copyTextureToTexture=function(O,ie,ae,ne=0){const ge=ie.image.width,je=ie.image.height,Ke=Q.convert(ae.format),Je=Q.convert(ae.type);L.setTexture2D(ae,0),se.pixelStorei(37440,ae.flipY),se.pixelStorei(37441,ae.premultiplyAlpha),se.pixelStorei(3317,ae.unpackAlignment),ie.isDataTexture?se.texSubImage2D(3553,ne,O.x,O.y,ge,je,Ke,Je,ie.image.data):ie.isCompressedTexture?se.compressedTexSubImage2D(3553,ne,O.x,O.y,ie.mipmaps[0].width,ie.mipmaps[0].height,Ke,ie.mipmaps[0].data):se.texSubImage2D(3553,ne,O.x,O.y,Ke,Je,ie.image),ne===0&&ae.generateMipmaps&&se.generateMipmap(3553),de.unbindTexture()},this.copyTextureToTexture3D=function(O,ie,ae,ne,ge=0){if(f.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const je=O.max.x-O.min.x+1,Ke=O.max.y-O.min.y+1,Je=O.max.z-O.min.z+1,it=Q.convert(ne.format),Et=Q.convert(ne.type);let rt;if(ne.isData3DTexture)L.setTexture3D(ne,0),rt=32879;else if(ne.isDataArrayTexture)L.setTexture2DArray(ne,0),rt=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}se.pixelStorei(37440,ne.flipY),se.pixelStorei(37441,ne.premultiplyAlpha),se.pixelStorei(3317,ne.unpackAlignment);const ct=se.getParameter(3314),Nt=se.getParameter(32878),Tn=se.getParameter(3316),ys=se.getParameter(3315),_s=se.getParameter(32877),Wi=ae.isCompressedTexture?ae.mipmaps[0]:ae.image;se.pixelStorei(3314,Wi.width),se.pixelStorei(32878,Wi.height),se.pixelStorei(3316,O.min.x),se.pixelStorei(3315,O.min.y),se.pixelStorei(32877,O.min.z),ae.isDataTexture||ae.isData3DTexture?se.texSubImage3D(rt,ge,ie.x,ie.y,ie.z,je,Ke,Je,it,Et,Wi.data):ae.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),se.compressedTexSubImage3D(rt,ge,ie.x,ie.y,ie.z,je,Ke,Je,it,Wi.data)):se.texSubImage3D(rt,ge,ie.x,ie.y,ie.z,je,Ke,Je,it,Et,Wi),se.pixelStorei(3314,ct),se.pixelStorei(32878,Nt),se.pixelStorei(3316,Tn),se.pixelStorei(3315,ys),se.pixelStorei(32877,_s),ge===0&&ne.generateMipmaps&&se.generateMipmap(rt),de.unbindTexture()},this.initTexture=function(O){O.isCubeTexture?L.setTextureCube(O,0):O.isData3DTexture?L.setTexture3D(O,0):O.isDataArrayTexture?L.setTexture2DArray(O,0):L.setTexture2D(O,0),de.unbindTexture()},this.resetState=function(){b=0,y=0,w=null,de.reset(),Ie.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class _7 extends a_{}_7.prototype.isWebGL1Renderer=!0;class w7 extends ei{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),t}}class s0 extends vi{constructor(e,t,r,n,s,o,a,l,c){super(e,t,r,n,s,o,a,l,c),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Bf extends lr{constructor(e=1,t=1,r=1,n=8,s=1,o=!1,a=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:n,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const c=this;n=Math.floor(n),s=Math.floor(s);const d=[],u=[],h=[],p=[];let g=0;const f=[],m=r/2;let b=0;y(),o===!1&&(e>0&&w(!0),t>0&&w(!1)),this.setIndex(d),this.setAttribute("position",new Yt(u,3)),this.setAttribute("normal",new Yt(h,3)),this.setAttribute("uv",new Yt(p,2));function y(){const _=new J,M=new J;let S=0;const A=(t-e)/r;for(let x=0;x<=s;x++){const E=[],D=x/s,F=D*(t-e)+e;for(let R=0;R<=n;R++){const B=R/n,I=B*l+a,V=Math.sin(I),N=Math.cos(I);M.x=F*V,M.y=-D*r+m,M.z=F*N,u.push(M.x,M.y,M.z),_.set(V,A,N).normalize(),h.push(_.x,_.y,_.z),p.push(B,1-D),E.push(g++)}f.push(E)}for(let x=0;x<n;x++)for(let E=0;E<s;E++){const D=f[E][x],F=f[E+1][x],R=f[E+1][x+1],B=f[E][x+1];d.push(D,F,B),d.push(F,R,B),S+=6}c.addGroup(b,S,0),b+=S}function w(_){const M=g,S=new at,A=new J;let x=0;const E=_===!0?e:t,D=_===!0?1:-1;for(let R=1;R<=n;R++)u.push(0,m*D,0),h.push(0,D,0),p.push(.5,.5),g++;const F=g;for(let R=0;R<=n;R++){const B=R/n*l+a,I=Math.cos(B),V=Math.sin(B);A.x=E*V,A.y=m*D,A.z=E*I,u.push(A.x,A.y,A.z),h.push(0,D,0),S.x=I*.5+.5,S.y=V*.5*D+.5,p.push(S.x,S.y),g++}for(let R=0;R<n;R++){const B=M+R,I=F+R;_===!0?d.push(I,I+1,B):d.push(I+1,I,B),x+=3}c.addGroup(b,x,_===!0?1:2),b+=x}}static fromJSON(e){return new Bf(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class x7 extends bs{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new ot(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class S7 extends bs{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new ot(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ot(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new at(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class M7 extends bs{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new ot(16777215),this.specular=new ot(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ot(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new at(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class l_ extends ei{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new ot(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}class E7 extends l_{constructor(e,t,r){super(e,r),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(ei.DefaultUp),this.updateMatrix(),this.groundColor=new ot(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const o0=new Ft,a0=new J,l0=new J;class k7{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new at(512,512),this.map=null,this.mapPass=null,this.matrix=new Ft,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Nf,this._frameExtents=new at(1,1),this._viewportCount=1,this._viewports=[new Ot(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,r=this.matrix;a0.setFromMatrixPosition(e.matrixWorld),t.position.copy(a0),l0.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(l0),t.updateMatrixWorld(),o0.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(o0),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(t.projectionMatrix),r.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class C7 extends k7{constructor(){super(new fi(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,r=hh*2*e.angle*this.focus,n=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(r!==t.fov||n!==t.aspect||s!==t.far)&&(t.fov=r,t.aspect=n,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class T7 extends l_{constructor(e,t,r=0,n=Math.PI/3,s=0,o=1){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(ei.DefaultUp),this.updateMatrix(),this.target=new ei,this.distance=r,this.angle=n,this.penumbra=s,this.decay=o,this.shadow=new C7}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:zf}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=zf);class Hi{constructor(e){e===void 0&&(e=[0,0,0,0,0,0,0,0,0]),this.elements=e}identity(){const e=this.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1}setZero(){const e=this.elements;e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e[8]=0}setTrace(e){const t=this.elements;t[0]=e.x,t[4]=e.y,t[8]=e.z}getTrace(e){e===void 0&&(e=new k);const t=this.elements;return e.x=t[0],e.y=t[4],e.z=t[8],e}vmult(e,t){t===void 0&&(t=new k);const r=this.elements,n=e.x,s=e.y,o=e.z;return t.x=r[0]*n+r[1]*s+r[2]*o,t.y=r[3]*n+r[4]*s+r[5]*o,t.z=r[6]*n+r[7]*s+r[8]*o,t}smult(e){for(let t=0;t<this.elements.length;t++)this.elements[t]*=e}mmult(e,t){t===void 0&&(t=new Hi);const r=this.elements,n=e.elements,s=t.elements,o=r[0],a=r[1],l=r[2],c=r[3],d=r[4],u=r[5],h=r[6],p=r[7],g=r[8],f=n[0],m=n[1],b=n[2],y=n[3],w=n[4],_=n[5],M=n[6],S=n[7],A=n[8];return s[0]=o*f+a*y+l*M,s[1]=o*m+a*w+l*S,s[2]=o*b+a*_+l*A,s[3]=c*f+d*y+u*M,s[4]=c*m+d*w+u*S,s[5]=c*b+d*_+u*A,s[6]=h*f+p*y+g*M,s[7]=h*m+p*w+g*S,s[8]=h*b+p*_+g*A,t}scale(e,t){t===void 0&&(t=new Hi);const r=this.elements,n=t.elements;for(let s=0;s!==3;s++)n[3*s+0]=e.x*r[3*s+0],n[3*s+1]=e.y*r[3*s+1],n[3*s+2]=e.z*r[3*s+2];return t}solve(e,t){t===void 0&&(t=new k);const r=3,n=4,s=[];let o,a;for(o=0;o<r*n;o++)s.push(0);for(o=0;o<3;o++)for(a=0;a<3;a++)s[o+n*a]=this.elements[o+3*a];s[3+4*0]=e.x,s[3+4*1]=e.y,s[3+4*2]=e.z;let l=3;const c=l;let d;const u=4;let h;do{if(o=c-l,s[o+n*o]===0){for(a=o+1;a<c;a++)if(s[o+n*a]!==0){d=u;do h=u-d,s[h+n*o]+=s[h+n*a];while(--d);break}}if(s[o+n*o]!==0)for(a=o+1;a<c;a++){const p=s[o+n*a]/s[o+n*o];d=u;do h=u-d,s[h+n*a]=h<=o?0:s[h+n*a]-s[h+n*o]*p;while(--d)}}while(--l);if(t.z=s[2*n+3]/s[2*n+2],t.y=(s[1*n+3]-s[1*n+2]*t.z)/s[1*n+1],t.x=(s[0*n+3]-s[0*n+2]*t.z-s[0*n+1]*t.y)/s[0*n+0],isNaN(t.x)||isNaN(t.y)||isNaN(t.z)||t.x===1/0||t.y===1/0||t.z===1/0)throw`Could not solve equation! Got x=[${t.toString()}], b=[${e.toString()}], A=[${this.toString()}]`;return t}e(e,t,r){if(r===void 0)return this.elements[t+3*e];this.elements[t+3*e]=r}copy(e){for(let t=0;t<e.elements.length;t++)this.elements[t]=e.elements[t];return this}toString(){let e="";const t=",";for(let r=0;r<9;r++)e+=this.elements[r]+t;return e}reverse(e){e===void 0&&(e=new Hi);const t=3,r=6,n=A7;let s,o;for(s=0;s<3;s++)for(o=0;o<3;o++)n[s+r*o]=this.elements[s+3*o];n[3+6*0]=1,n[3+6*1]=0,n[3+6*2]=0,n[4+6*0]=0,n[4+6*1]=1,n[4+6*2]=0,n[5+6*0]=0,n[5+6*1]=0,n[5+6*2]=1;let a=3;const l=a;let c;const d=r;let u;do{if(s=l-a,n[s+r*s]===0){for(o=s+1;o<l;o++)if(n[s+r*o]!==0){c=d;do u=d-c,n[u+r*s]+=n[u+r*o];while(--c);break}}if(n[s+r*s]!==0)for(o=s+1;o<l;o++){const h=n[s+r*o]/n[s+r*s];c=d;do u=d-c,n[u+r*o]=u<=s?0:n[u+r*o]-n[u+r*s]*h;while(--c)}}while(--a);s=2;do{o=s-1;do{const h=n[s+r*o]/n[s+r*s];c=r;do u=r-c,n[u+r*o]=n[u+r*o]-n[u+r*s]*h;while(--c)}while(o--)}while(--s);s=2;do{const h=1/n[s+r*s];c=r;do u=r-c,n[u+r*s]=n[u+r*s]*h;while(--c)}while(s--);s=2;do{o=2;do{if(u=n[t+o+r*s],isNaN(u)||u===1/0)throw`Could not reverse! A=[${this.toString()}]`;e.e(s,o,u)}while(o--)}while(s--);return e}setRotationFromQuaternion(e){const t=e.x,r=e.y,n=e.z,s=e.w,o=t+t,a=r+r,l=n+n,c=t*o,d=t*a,u=t*l,h=r*a,p=r*l,g=n*l,f=s*o,m=s*a,b=s*l,y=this.elements;return y[3*0+0]=1-(h+g),y[3*0+1]=d-b,y[3*0+2]=u+m,y[3*1+0]=d+b,y[3*1+1]=1-(c+g),y[3*1+2]=p-f,y[3*2+0]=u-m,y[3*2+1]=p+f,y[3*2+2]=1-(c+h),this}transpose(e){e===void 0&&(e=new Hi);const t=this.elements,r=e.elements;let n;return r[0]=t[0],r[4]=t[4],r[8]=t[8],n=t[1],r[1]=t[3],r[3]=n,n=t[2],r[2]=t[6],r[6]=n,n=t[5],r[5]=t[7],r[7]=n,e}}const A7=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];class k{constructor(e,t,r){e===void 0&&(e=0),t===void 0&&(t=0),r===void 0&&(r=0),this.x=e,this.y=t,this.z=r}cross(e,t){t===void 0&&(t=new k);const r=e.x,n=e.y,s=e.z,o=this.x,a=this.y,l=this.z;return t.x=a*s-l*n,t.y=l*r-o*s,t.z=o*n-a*r,t}set(e,t,r){return this.x=e,this.y=t,this.z=r,this}setZero(){this.x=this.y=this.z=0}vadd(e,t){if(t)t.x=e.x+this.x,t.y=e.y+this.y,t.z=e.z+this.z;else return new k(this.x+e.x,this.y+e.y,this.z+e.z)}vsub(e,t){if(t)t.x=this.x-e.x,t.y=this.y-e.y,t.z=this.z-e.z;else return new k(this.x-e.x,this.y-e.y,this.z-e.z)}crossmat(){return new Hi([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}normalize(){const e=this.x,t=this.y,r=this.z,n=Math.sqrt(e*e+t*t+r*r);if(n>0){const s=1/n;this.x*=s,this.y*=s,this.z*=s}else this.x=0,this.y=0,this.z=0;return n}unit(e){e===void 0&&(e=new k);const t=this.x,r=this.y,n=this.z;let s=Math.sqrt(t*t+r*r+n*n);return s>0?(s=1/s,e.x=t*s,e.y=r*s,e.z=n*s):(e.x=1,e.y=0,e.z=0),e}length(){const e=this.x,t=this.y,r=this.z;return Math.sqrt(e*e+t*t+r*r)}lengthSquared(){return this.dot(this)}distanceTo(e){const t=this.x,r=this.y,n=this.z,s=e.x,o=e.y,a=e.z;return Math.sqrt((s-t)*(s-t)+(o-r)*(o-r)+(a-n)*(a-n))}distanceSquared(e){const t=this.x,r=this.y,n=this.z,s=e.x,o=e.y,a=e.z;return(s-t)*(s-t)+(o-r)*(o-r)+(a-n)*(a-n)}scale(e,t){t===void 0&&(t=new k);const r=this.x,n=this.y,s=this.z;return t.x=e*r,t.y=e*n,t.z=e*s,t}vmul(e,t){return t===void 0&&(t=new k),t.x=e.x*this.x,t.y=e.y*this.y,t.z=e.z*this.z,t}addScaledVector(e,t,r){return r===void 0&&(r=new k),r.x=this.x+e*t.x,r.y=this.y+e*t.y,r.z=this.z+e*t.z,r}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}isZero(){return this.x===0&&this.y===0&&this.z===0}negate(e){return e===void 0&&(e=new k),e.x=-this.x,e.y=-this.y,e.z=-this.z,e}tangents(e,t){const r=this.length();if(r>0){const n=L7,s=1/r;n.set(this.x*s,this.y*s,this.z*s);const o=D7;Math.abs(n.x)<.9?(o.set(1,0,0),n.cross(o,e)):(o.set(0,1,0),n.cross(o,e)),n.cross(e,t)}else e.set(1,0,0),t.set(0,1,0)}toString(){return`${this.x},${this.y},${this.z}`}toArray(){return[this.x,this.y,this.z]}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}lerp(e,t,r){const n=this.x,s=this.y,o=this.z;r.x=n+(e.x-n)*t,r.y=s+(e.y-s)*t,r.z=o+(e.z-o)*t}almostEquals(e,t){return t===void 0&&(t=1e-6),!(Math.abs(this.x-e.x)>t||Math.abs(this.y-e.y)>t||Math.abs(this.z-e.z)>t)}almostZero(e){return e===void 0&&(e=1e-6),!(Math.abs(this.x)>e||Math.abs(this.y)>e||Math.abs(this.z)>e)}isAntiparallelTo(e,t){return this.negate(c0),c0.almostEquals(e,t)}clone(){return new k(this.x,this.y,this.z)}}k.ZERO=new k(0,0,0);k.UNIT_X=new k(1,0,0);k.UNIT_Y=new k(0,1,0);k.UNIT_Z=new k(0,0,1);const L7=new k,D7=new k,c0=new k;class bi{constructor(e){e===void 0&&(e={}),this.lowerBound=new k,this.upperBound=new k,e.lowerBound&&this.lowerBound.copy(e.lowerBound),e.upperBound&&this.upperBound.copy(e.upperBound)}setFromPoints(e,t,r,n){const s=this.lowerBound,o=this.upperBound,a=r;s.copy(e[0]),a&&a.vmult(s,s),o.copy(s);for(let l=1;l<e.length;l++){let c=e[l];a&&(a.vmult(c,d0),c=d0),c.x>o.x&&(o.x=c.x),c.x<s.x&&(s.x=c.x),c.y>o.y&&(o.y=c.y),c.y<s.y&&(s.y=c.y),c.z>o.z&&(o.z=c.z),c.z<s.z&&(s.z=c.z)}return t&&(t.vadd(s,s),t.vadd(o,o)),n&&(s.x-=n,s.y-=n,s.z-=n,o.x+=n,o.y+=n,o.z+=n),this}copy(e){return this.lowerBound.copy(e.lowerBound),this.upperBound.copy(e.upperBound),this}clone(){return new bi().copy(this)}extend(e){this.lowerBound.x=Math.min(this.lowerBound.x,e.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,e.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,e.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,e.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,e.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,e.upperBound.z)}overlaps(e){const t=this.lowerBound,r=this.upperBound,n=e.lowerBound,s=e.upperBound,o=n.x<=r.x&&r.x<=s.x||t.x<=s.x&&s.x<=r.x,a=n.y<=r.y&&r.y<=s.y||t.y<=s.y&&s.y<=r.y,l=n.z<=r.z&&r.z<=s.z||t.z<=s.z&&s.z<=r.z;return o&&a&&l}volume(){const e=this.lowerBound,t=this.upperBound;return(t.x-e.x)*(t.y-e.y)*(t.z-e.z)}contains(e){const t=this.lowerBound,r=this.upperBound,n=e.lowerBound,s=e.upperBound;return t.x<=n.x&&r.x>=s.x&&t.y<=n.y&&r.y>=s.y&&t.z<=n.z&&r.z>=s.z}getCorners(e,t,r,n,s,o,a,l){const c=this.lowerBound,d=this.upperBound;e.copy(c),t.set(d.x,c.y,c.z),r.set(d.x,d.y,c.z),n.set(c.x,d.y,d.z),s.set(d.x,c.y,d.z),o.set(c.x,d.y,c.z),a.set(c.x,c.y,d.z),l.copy(d)}toLocalFrame(e,t){const r=u0,n=r[0],s=r[1],o=r[2],a=r[3],l=r[4],c=r[5],d=r[6],u=r[7];this.getCorners(n,s,o,a,l,c,d,u);for(let h=0;h!==8;h++){const p=r[h];e.pointToLocal(p,p)}return t.setFromPoints(r)}toWorldFrame(e,t){const r=u0,n=r[0],s=r[1],o=r[2],a=r[3],l=r[4],c=r[5],d=r[6],u=r[7];this.getCorners(n,s,o,a,l,c,d,u);for(let h=0;h!==8;h++){const p=r[h];e.pointToWorld(p,p)}return t.setFromPoints(r)}overlapsRay(e){const{direction:t,from:r}=e,n=1/t.x,s=1/t.y,o=1/t.z,a=(this.lowerBound.x-r.x)*n,l=(this.upperBound.x-r.x)*n,c=(this.lowerBound.y-r.y)*s,d=(this.upperBound.y-r.y)*s,u=(this.lowerBound.z-r.z)*o,h=(this.upperBound.z-r.z)*o,p=Math.max(Math.max(Math.min(a,l),Math.min(c,d)),Math.min(u,h)),g=Math.min(Math.min(Math.max(a,l),Math.max(c,d)),Math.max(u,h));return!(g<0||p>g)}}const d0=new k,u0=[new k,new k,new k,new k,new k,new k,new k,new k];class h0{constructor(){this.matrix=[]}get(e,t){let{index:r}=e,{index:n}=t;if(n>r){const s=n;n=r,r=s}return this.matrix[(r*(r+1)>>1)+n-1]}set(e,t,r){let{index:n}=e,{index:s}=t;if(s>n){const o=s;s=n,n=o}this.matrix[(n*(n+1)>>1)+s-1]=r?1:0}reset(){for(let e=0,t=this.matrix.length;e!==t;e++)this.matrix[e]=0}setNumObjects(e){this.matrix.length=e*(e-1)>>1}}class c_{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const r=this._listeners;return r[e]===void 0&&(r[e]=[]),r[e].includes(t)||r[e].push(t),this}hasEventListener(e,t){if(this._listeners===void 0)return!1;const r=this._listeners;return!!(r[e]!==void 0&&r[e].includes(t))}hasAnyEventListener(e){return this._listeners===void 0?!1:this._listeners[e]!==void 0}removeEventListener(e,t){if(this._listeners===void 0)return this;const r=this._listeners;if(r[e]===void 0)return this;const n=r[e].indexOf(t);return n!==-1&&r[e].splice(n,1),this}dispatchEvent(e){if(this._listeners===void 0)return this;const t=this._listeners[e.type];if(t!==void 0){e.target=this;for(let r=0,n=t.length;r<n;r++)t[r].call(this,e)}return this}}class Dt{constructor(e,t,r,n){e===void 0&&(e=0),t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=1),this.x=e,this.y=t,this.z=r,this.w=n}set(e,t,r,n){return this.x=e,this.y=t,this.z=r,this.w=n,this}toString(){return`${this.x},${this.y},${this.z},${this.w}`}toArray(){return[this.x,this.y,this.z,this.w]}setFromAxisAngle(e,t){const r=Math.sin(t*.5);return this.x=e.x*r,this.y=e.y*r,this.z=e.z*r,this.w=Math.cos(t*.5),this}toAxisAngle(e){e===void 0&&(e=new k),this.normalize();const t=2*Math.acos(this.w),r=Math.sqrt(1-this.w*this.w);return r<.001?(e.x=this.x,e.y=this.y,e.z=this.z):(e.x=this.x/r,e.y=this.y/r,e.z=this.z/r),[e,t]}setFromVectors(e,t){if(e.isAntiparallelTo(t)){const r=P7,n=R7;e.tangents(r,n),this.setFromAxisAngle(r,Math.PI)}else{const r=e.cross(t);this.x=r.x,this.y=r.y,this.z=r.z,this.w=Math.sqrt(e.length()**2*t.length()**2)+e.dot(t),this.normalize()}return this}mult(e,t){t===void 0&&(t=new Dt);const r=this.x,n=this.y,s=this.z,o=this.w,a=e.x,l=e.y,c=e.z,d=e.w;return t.x=r*d+o*a+n*c-s*l,t.y=n*d+o*l+s*a-r*c,t.z=s*d+o*c+r*l-n*a,t.w=o*d-r*a-n*l-s*c,t}inverse(e){e===void 0&&(e=new Dt);const t=this.x,r=this.y,n=this.z,s=this.w;this.conjugate(e);const o=1/(t*t+r*r+n*n+s*s);return e.x*=o,e.y*=o,e.z*=o,e.w*=o,e}conjugate(e){return e===void 0&&(e=new Dt),e.x=-this.x,e.y=-this.y,e.z=-this.z,e.w=this.w,e}normalize(){let e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return e===0?(this.x=0,this.y=0,this.z=0,this.w=0):(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}normalizeFast(){const e=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return e===0?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}vmult(e,t){t===void 0&&(t=new k);const r=e.x,n=e.y,s=e.z,o=this.x,a=this.y,l=this.z,c=this.w,d=c*r+a*s-l*n,u=c*n+l*r-o*s,h=c*s+o*n-a*r,p=-o*r-a*n-l*s;return t.x=d*c+p*-o+u*-l-h*-a,t.y=u*c+p*-a+h*-o-d*-l,t.z=h*c+p*-l+d*-a-u*-o,t}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}toEuler(e,t){t===void 0&&(t="YZX");let r,n,s;const o=this.x,a=this.y,l=this.z,c=this.w;switch(t){case"YZX":const d=o*a+l*c;if(d>.499&&(r=2*Math.atan2(o,c),n=Math.PI/2,s=0),d<-.499&&(r=-2*Math.atan2(o,c),n=-Math.PI/2,s=0),r===void 0){const u=o*o,h=a*a,p=l*l;r=Math.atan2(2*a*c-2*o*l,1-2*h-2*p),n=Math.asin(2*d),s=Math.atan2(2*o*c-2*a*l,1-2*u-2*p)}break;default:throw new Error(`Euler order ${t} not supported yet.`)}e.y=r,e.z=n,e.x=s}setFromEuler(e,t,r,n){n===void 0&&(n="XYZ");const s=Math.cos(e/2),o=Math.cos(t/2),a=Math.cos(r/2),l=Math.sin(e/2),c=Math.sin(t/2),d=Math.sin(r/2);return n==="XYZ"?(this.x=l*o*a+s*c*d,this.y=s*c*a-l*o*d,this.z=s*o*d+l*c*a,this.w=s*o*a-l*c*d):n==="YXZ"?(this.x=l*o*a+s*c*d,this.y=s*c*a-l*o*d,this.z=s*o*d-l*c*a,this.w=s*o*a+l*c*d):n==="ZXY"?(this.x=l*o*a-s*c*d,this.y=s*c*a+l*o*d,this.z=s*o*d+l*c*a,this.w=s*o*a-l*c*d):n==="ZYX"?(this.x=l*o*a-s*c*d,this.y=s*c*a+l*o*d,this.z=s*o*d-l*c*a,this.w=s*o*a+l*c*d):n==="YZX"?(this.x=l*o*a+s*c*d,this.y=s*c*a+l*o*d,this.z=s*o*d-l*c*a,this.w=s*o*a-l*c*d):n==="XZY"&&(this.x=l*o*a-s*c*d,this.y=s*c*a-l*o*d,this.z=s*o*d+l*c*a,this.w=s*o*a+l*c*d),this}clone(){return new Dt(this.x,this.y,this.z,this.w)}slerp(e,t,r){r===void 0&&(r=new Dt);const n=this.x,s=this.y,o=this.z,a=this.w;let l=e.x,c=e.y,d=e.z,u=e.w,h,p,g,f,m;return p=n*l+s*c+o*d+a*u,p<0&&(p=-p,l=-l,c=-c,d=-d,u=-u),1-p>1e-6?(h=Math.acos(p),g=Math.sin(h),f=Math.sin((1-t)*h)/g,m=Math.sin(t*h)/g):(f=1-t,m=t),r.x=f*n+m*l,r.y=f*s+m*c,r.z=f*o+m*d,r.w=f*a+m*u,r}integrate(e,t,r,n){n===void 0&&(n=new Dt);const s=e.x*r.x,o=e.y*r.y,a=e.z*r.z,l=this.x,c=this.y,d=this.z,u=this.w,h=t*.5;return n.x+=h*(s*u+o*d-a*c),n.y+=h*(o*u+a*l-s*d),n.z+=h*(a*u+s*c-o*l),n.w+=h*(-s*l-o*c-a*d),n}}const P7=new k,R7=new k,I7={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};class ze{constructor(e){e===void 0&&(e={}),this.id=ze.idCounter++,this.type=e.type||0,this.boundingSphereRadius=0,this.collisionResponse=e.collisionResponse?e.collisionResponse:!0,this.collisionFilterGroup=e.collisionFilterGroup!==void 0?e.collisionFilterGroup:1,this.collisionFilterMask=e.collisionFilterMask!==void 0?e.collisionFilterMask:-1,this.material=e.material?e.material:null,this.body=null}updateBoundingSphereRadius(){throw`computeBoundingSphereRadius() not implemented for shape type ${this.type}`}volume(){throw`volume() not implemented for shape type ${this.type}`}calculateLocalInertia(e,t){throw`calculateLocalInertia() not implemented for shape type ${this.type}`}calculateWorldAABB(e,t,r,n){throw`calculateWorldAABB() not implemented for shape type ${this.type}`}}ze.idCounter=0;ze.types=I7;class pt{constructor(e){e===void 0&&(e={}),this.position=new k,this.quaternion=new Dt,e.position&&this.position.copy(e.position),e.quaternion&&this.quaternion.copy(e.quaternion)}pointToLocal(e,t){return pt.pointToLocalFrame(this.position,this.quaternion,e,t)}pointToWorld(e,t){return pt.pointToWorldFrame(this.position,this.quaternion,e,t)}vectorToWorldFrame(e,t){return t===void 0&&(t=new k),this.quaternion.vmult(e,t),t}static pointToLocalFrame(e,t,r,n){return n===void 0&&(n=new k),r.vsub(e,n),t.conjugate(f0),f0.vmult(n,n),n}static pointToWorldFrame(e,t,r,n){return n===void 0&&(n=new k),t.vmult(r,n),n.vadd(e,n),n}static vectorToWorldFrame(e,t,r){return r===void 0&&(r=new k),e.vmult(t,r),r}static vectorToLocalFrame(e,t,r,n){return n===void 0&&(n=new k),t.w*=-1,t.vmult(r,n),t.w*=-1,n}}const f0=new Dt;class is extends ze{constructor(e){e===void 0&&(e={});const{vertices:t=[],faces:r=[],normals:n=[],axes:s,boundingSphereRadius:o}=e;super({type:ze.types.CONVEXPOLYHEDRON}),this.vertices=t,this.faces=r,this.faceNormals=n,this.faceNormals.length===0&&this.computeNormals(),o?this.boundingSphereRadius=o:this.updateBoundingSphereRadius(),this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.worldFaceNormals=[],this.worldFaceNormalsNeedsUpdate=!0,this.uniqueAxes=s?s.slice():null,this.uniqueEdges=[],this.computeEdges()}computeEdges(){const e=this.faces,t=this.vertices,r=this.uniqueEdges;r.length=0;const n=new k;for(let s=0;s!==e.length;s++){const o=e[s],a=o.length;for(let l=0;l!==a;l++){const c=(l+1)%a;t[o[l]].vsub(t[o[c]],n),n.normalize();let d=!1;for(let u=0;u!==r.length;u++)if(r[u].almostEquals(n)||r[u].almostEquals(n)){d=!0;break}d||r.push(n.clone())}}}computeNormals(){this.faceNormals.length=this.faces.length;for(let e=0;e<this.faces.length;e++){for(let n=0;n<this.faces[e].length;n++)if(!this.vertices[this.faces[e][n]])throw new Error(`Vertex ${this.faces[e][n]} not found!`);const t=this.faceNormals[e]||new k;this.getFaceNormal(e,t),t.negate(t),this.faceNormals[e]=t;const r=this.vertices[this.faces[e][0]];if(t.dot(r)<0){console.error(`.faceNormals[${e}] = Vec3(${t.toString()}) looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.`);for(let n=0;n<this.faces[e].length;n++)console.warn(`.vertices[${this.faces[e][n]}] = Vec3(${this.vertices[this.faces[e][n]].toString()})`)}}}getFaceNormal(e,t){const r=this.faces[e],n=this.vertices[r[0]],s=this.vertices[r[1]],o=this.vertices[r[2]];is.computeNormal(n,s,o,t)}static computeNormal(e,t,r,n){const s=new k,o=new k;t.vsub(e,o),r.vsub(t,s),s.cross(o,n),n.isZero()||n.normalize()}clipAgainstHull(e,t,r,n,s,o,a,l,c){const d=new k;let u=-1,h=-Number.MAX_VALUE;for(let g=0;g<r.faces.length;g++){d.copy(r.faceNormals[g]),s.vmult(d,d);const f=d.dot(o);f>h&&(h=f,u=g)}const p=[];for(let g=0;g<r.faces[u].length;g++){const f=r.vertices[r.faces[u][g]],m=new k;m.copy(f),s.vmult(m,m),n.vadd(m,m),p.push(m)}u>=0&&this.clipFaceAgainstHull(o,e,t,p,a,l,c)}findSeparatingAxis(e,t,r,n,s,o,a,l){const c=new k,d=new k,u=new k,h=new k,p=new k,g=new k;let f=Number.MAX_VALUE;const m=this;if(m.uniqueAxes)for(let b=0;b!==m.uniqueAxes.length;b++){r.vmult(m.uniqueAxes[b],c);const y=m.testSepAxis(c,e,t,r,n,s);if(y===!1)return!1;y<f&&(f=y,o.copy(c))}else{const b=a?a.length:m.faces.length;for(let y=0;y<b;y++){const w=a?a[y]:y;c.copy(m.faceNormals[w]),r.vmult(c,c);const _=m.testSepAxis(c,e,t,r,n,s);if(_===!1)return!1;_<f&&(f=_,o.copy(c))}}if(e.uniqueAxes)for(let b=0;b!==e.uniqueAxes.length;b++){s.vmult(e.uniqueAxes[b],d);const y=m.testSepAxis(d,e,t,r,n,s);if(y===!1)return!1;y<f&&(f=y,o.copy(d))}else{const b=l?l.length:e.faces.length;for(let y=0;y<b;y++){const w=l?l[y]:y;d.copy(e.faceNormals[w]),s.vmult(d,d);const _=m.testSepAxis(d,e,t,r,n,s);if(_===!1)return!1;_<f&&(f=_,o.copy(d))}}for(let b=0;b!==m.uniqueEdges.length;b++){r.vmult(m.uniqueEdges[b],h);for(let y=0;y!==e.uniqueEdges.length;y++)if(s.vmult(e.uniqueEdges[y],p),h.cross(p,g),!g.almostZero()){g.normalize();const w=m.testSepAxis(g,e,t,r,n,s);if(w===!1)return!1;w<f&&(f=w,o.copy(g))}}return n.vsub(t,u),u.dot(o)>0&&o.negate(o),!0}testSepAxis(e,t,r,n,s,o){const a=this;is.project(a,e,r,n,xu),is.project(t,e,s,o,Su);const l=xu[0],c=xu[1],d=Su[0],u=Su[1];if(l<u||d<c)return!1;const h=l-u,p=d-c;return h<p?h:p}calculateLocalInertia(e,t){const r=new k,n=new k;this.computeLocalAABB(n,r);const s=r.x-n.x,o=r.y-n.y,a=r.z-n.z;t.x=1/12*e*(2*o*2*o+2*a*2*a),t.y=1/12*e*(2*s*2*s+2*a*2*a),t.z=1/12*e*(2*o*2*o+2*s*2*s)}getPlaneConstantOfFace(e){const t=this.faces[e],r=this.faceNormals[e],n=this.vertices[t[0]];return-r.dot(n)}clipFaceAgainstHull(e,t,r,n,s,o,a){const l=new k,c=new k,d=new k,u=new k,h=new k,p=new k,g=new k,f=new k,m=this,b=[],y=n,w=b;let _=-1,M=Number.MAX_VALUE;for(let D=0;D<m.faces.length;D++){l.copy(m.faceNormals[D]),r.vmult(l,l);const F=l.dot(e);F<M&&(M=F,_=D)}if(_<0)return;const S=m.faces[_];S.connectedFaces=[];for(let D=0;D<m.faces.length;D++)for(let F=0;F<m.faces[D].length;F++)S.indexOf(m.faces[D][F])!==-1&&D!==_&&S.connectedFaces.indexOf(D)===-1&&S.connectedFaces.push(D);const A=S.length;for(let D=0;D<A;D++){const F=m.vertices[S[D]],R=m.vertices[S[(D+1)%A]];F.vsub(R,c),d.copy(c),r.vmult(d,d),t.vadd(d,d),u.copy(this.faceNormals[_]),r.vmult(u,u),t.vadd(u,u),d.cross(u,h),h.negate(h),p.copy(F),r.vmult(p,p),t.vadd(p,p);const B=S.connectedFaces[D];g.copy(this.faceNormals[B]);const I=this.getPlaneConstantOfFace(B);f.copy(g),r.vmult(f,f);const V=I-f.dot(t);for(this.clipFaceAgainstPlane(y,w,f,V);y.length;)y.shift();for(;w.length;)y.push(w.shift())}g.copy(this.faceNormals[_]);const x=this.getPlaneConstantOfFace(_);f.copy(g),r.vmult(f,f);const E=x-f.dot(t);for(let D=0;D<y.length;D++){let F=f.dot(y[D])+E;if(F<=s&&(F=s),F<=o){const R=y[D];if(F<=1e-6){const B={point:R,normal:f,depth:F};a.push(B)}}}}clipFaceAgainstPlane(e,t,r,n){let s,o;const a=e.length;if(a<2)return t;let l=e[e.length-1],c=e[0];s=r.dot(l)+n;for(let d=0;d<a;d++){if(c=e[d],o=r.dot(c)+n,s<0)if(o<0){const u=new k;u.copy(c),t.push(u)}else{const u=new k;l.lerp(c,s/(s-o),u),t.push(u)}else if(o<0){const u=new k;l.lerp(c,s/(s-o),u),t.push(u),t.push(c)}l=c,s=o}return t}computeWorldVertices(e,t){for(;this.worldVertices.length<this.vertices.length;)this.worldVertices.push(new k);const r=this.vertices,n=this.worldVertices;for(let s=0;s!==this.vertices.length;s++)t.vmult(r[s],n[s]),e.vadd(n[s],n[s]);this.worldVerticesNeedsUpdate=!1}computeLocalAABB(e,t){const r=this.vertices;e.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),t.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let n=0;n<this.vertices.length;n++){const s=r[n];s.x<e.x?e.x=s.x:s.x>t.x&&(t.x=s.x),s.y<e.y?e.y=s.y:s.y>t.y&&(t.y=s.y),s.z<e.z?e.z=s.z:s.z>t.z&&(t.z=s.z)}}computeWorldFaceNormals(e){const t=this.faceNormals.length;for(;this.worldFaceNormals.length<t;)this.worldFaceNormals.push(new k);const r=this.faceNormals,n=this.worldFaceNormals;for(let s=0;s!==t;s++)e.vmult(r[s],n[s]);this.worldFaceNormalsNeedsUpdate=!1}updateBoundingSphereRadius(){let e=0;const t=this.vertices;for(let r=0;r!==t.length;r++){const n=t[r].lengthSquared();n>e&&(e=n)}this.boundingSphereRadius=Math.sqrt(e)}calculateWorldAABB(e,t,r,n){const s=this.vertices;let o,a,l,c,d,u,h=new k;for(let p=0;p<s.length;p++){h.copy(s[p]),t.vmult(h,h),e.vadd(h,h);const g=h;(o===void 0||g.x<o)&&(o=g.x),(c===void 0||g.x>c)&&(c=g.x),(a===void 0||g.y<a)&&(a=g.y),(d===void 0||g.y>d)&&(d=g.y),(l===void 0||g.z<l)&&(l=g.z),(u===void 0||g.z>u)&&(u=g.z)}r.set(o,a,l),n.set(c,d,u)}volume(){return 4*Math.PI*this.boundingSphereRadius/3}getAveragePointLocal(e){e===void 0&&(e=new k);const t=this.vertices;for(let r=0;r<t.length;r++)e.vadd(t[r],e);return e.scale(1/t.length,e),e}transformAllPoints(e,t){const r=this.vertices.length,n=this.vertices;if(t){for(let s=0;s<r;s++){const o=n[s];t.vmult(o,o)}for(let s=0;s<this.faceNormals.length;s++){const o=this.faceNormals[s];t.vmult(o,o)}}if(e)for(let s=0;s<r;s++){const o=n[s];o.vadd(e,o)}}pointIsInside(e){const t=this.vertices,r=this.faces,n=this.faceNormals,s=null,o=new k;this.getAveragePointLocal(o);for(let a=0;a<this.faces.length;a++){let l=n[a];const c=t[r[a][0]],d=new k;e.vsub(c,d);const u=l.dot(d),h=new k;o.vsub(c,h);const p=l.dot(h);if(u<0&&p>0||u>0&&p<0)return!1}return s?1:-1}static project(e,t,r,n,s){const o=e.vertices.length,a=O7;let l=0,c=0;const d=F7,u=e.vertices;d.setZero(),pt.vectorToLocalFrame(r,n,t,a),pt.pointToLocalFrame(r,n,d,d);const h=d.dot(a);c=l=u[0].dot(a);for(let p=1;p<o;p++){const g=u[p].dot(a);g>l&&(l=g),g<c&&(c=g)}if(c-=h,l-=h,c>l){const p=c;c=l,l=p}s[0]=l,s[1]=c}}const xu=[],Su=[];new k;const O7=new k,F7=new k;class Vf extends ze{constructor(e){super({type:ze.types.BOX}),this.halfExtents=e,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}updateConvexPolyhedronRepresentation(){const e=this.halfExtents.x,t=this.halfExtents.y,r=this.halfExtents.z,n=k,s=[new n(-e,-t,-r),new n(e,-t,-r),new n(e,t,-r),new n(-e,t,-r),new n(-e,-t,r),new n(e,-t,r),new n(e,t,r),new n(-e,t,r)],o=[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]],a=[new n(0,0,1),new n(0,1,0),new n(1,0,0)],l=new is({vertices:s,faces:o,axes:a});this.convexPolyhedronRepresentation=l,l.material=this.material}calculateLocalInertia(e,t){return t===void 0&&(t=new k),Vf.calculateInertia(this.halfExtents,e,t),t}static calculateInertia(e,t,r){const n=e;r.x=1/12*t*(2*n.y*2*n.y+2*n.z*2*n.z),r.y=1/12*t*(2*n.x*2*n.x+2*n.z*2*n.z),r.z=1/12*t*(2*n.y*2*n.y+2*n.x*2*n.x)}getSideNormals(e,t){const r=e,n=this.halfExtents;if(r[0].set(n.x,0,0),r[1].set(0,n.y,0),r[2].set(0,0,n.z),r[3].set(-n.x,0,0),r[4].set(0,-n.y,0),r[5].set(0,0,-n.z),t!==void 0)for(let s=0;s!==r.length;s++)t.vmult(r[s],r[s]);return r}volume(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z}updateBoundingSphereRadius(){this.boundingSphereRadius=this.halfExtents.length()}forEachWorldCorner(e,t,r){const n=this.halfExtents,s=[[n.x,n.y,n.z],[-n.x,n.y,n.z],[-n.x,-n.y,n.z],[-n.x,-n.y,-n.z],[n.x,-n.y,-n.z],[n.x,n.y,-n.z],[-n.x,n.y,-n.z],[n.x,-n.y,n.z]];for(let o=0;o<s.length;o++)Kr.set(s[o][0],s[o][1],s[o][2]),t.vmult(Kr,Kr),e.vadd(Kr,Kr),r(Kr.x,Kr.y,Kr.z)}calculateWorldAABB(e,t,r,n){const s=this.halfExtents;qi[0].set(s.x,s.y,s.z),qi[1].set(-s.x,s.y,s.z),qi[2].set(-s.x,-s.y,s.z),qi[3].set(-s.x,-s.y,-s.z),qi[4].set(s.x,-s.y,-s.z),qi[5].set(s.x,s.y,-s.z),qi[6].set(-s.x,s.y,-s.z),qi[7].set(s.x,-s.y,s.z);const o=qi[0];t.vmult(o,o),e.vadd(o,o),n.copy(o),r.copy(o);for(let a=1;a<8;a++){const l=qi[a];t.vmult(l,l),e.vadd(l,l);const c=l.x,d=l.y,u=l.z;c>n.x&&(n.x=c),d>n.y&&(n.y=d),u>n.z&&(n.z=u),c<r.x&&(r.x=c),d<r.y&&(r.y=d),u<r.z&&(r.z=u)}}}const Kr=new k,qi=[new k,new k,new k,new k,new k,new k,new k,new k],Hf={DYNAMIC:1,STATIC:2,KINEMATIC:4},Uf={AWAKE:0,SLEEPY:1,SLEEPING:2};class Ae extends c_{constructor(e){e===void 0&&(e={}),super(),this.id=Ae.idCounter++,this.index=-1,this.world=null,this.vlambda=new k,this.collisionFilterGroup=typeof e.collisionFilterGroup=="number"?e.collisionFilterGroup:1,this.collisionFilterMask=typeof e.collisionFilterMask=="number"?e.collisionFilterMask:-1,this.collisionResponse=typeof e.collisionResponse=="boolean"?e.collisionResponse:!0,this.position=new k,this.previousPosition=new k,this.interpolatedPosition=new k,this.initPosition=new k,e.position&&(this.position.copy(e.position),this.previousPosition.copy(e.position),this.interpolatedPosition.copy(e.position),this.initPosition.copy(e.position)),this.velocity=new k,e.velocity&&this.velocity.copy(e.velocity),this.initVelocity=new k,this.force=new k;const t=typeof e.mass=="number"?e.mass:0;this.mass=t,this.invMass=t>0?1/t:0,this.material=e.material||null,this.linearDamping=typeof e.linearDamping=="number"?e.linearDamping:.01,this.type=t<=0?Ae.STATIC:Ae.DYNAMIC,typeof e.type==typeof Ae.STATIC&&(this.type=e.type),this.allowSleep=typeof e.allowSleep<"u"?e.allowSleep:!0,this.sleepState=Ae.AWAKE,this.sleepSpeedLimit=typeof e.sleepSpeedLimit<"u"?e.sleepSpeedLimit:.1,this.sleepTimeLimit=typeof e.sleepTimeLimit<"u"?e.sleepTimeLimit:1,this.timeLastSleepy=0,this.wakeUpAfterNarrowphase=!1,this.torque=new k,this.quaternion=new Dt,this.initQuaternion=new Dt,this.previousQuaternion=new Dt,this.interpolatedQuaternion=new Dt,e.quaternion&&(this.quaternion.copy(e.quaternion),this.initQuaternion.copy(e.quaternion),this.previousQuaternion.copy(e.quaternion),this.interpolatedQuaternion.copy(e.quaternion)),this.angularVelocity=new k,e.angularVelocity&&this.angularVelocity.copy(e.angularVelocity),this.initAngularVelocity=new k,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new k,this.invInertia=new k,this.invInertiaWorld=new Hi,this.invMassSolve=0,this.invInertiaSolve=new k,this.invInertiaWorldSolve=new Hi,this.fixedRotation=typeof e.fixedRotation<"u"?e.fixedRotation:!1,this.angularDamping=typeof e.angularDamping<"u"?e.angularDamping:.01,this.linearFactor=new k(1,1,1),e.linearFactor&&this.linearFactor.copy(e.linearFactor),this.angularFactor=new k(1,1,1),e.angularFactor&&this.angularFactor.copy(e.angularFactor),this.aabb=new bi,this.aabbNeedsUpdate=!0,this.boundingRadius=0,this.wlambda=new k,this.isTrigger=!!e.isTrigger,e.shape&&this.addShape(e.shape),this.updateMassProperties()}wakeUp(){const e=this.sleepState;this.sleepState=Ae.AWAKE,this.wakeUpAfterNarrowphase=!1,e===Ae.SLEEPING&&this.dispatchEvent(Ae.wakeupEvent)}sleep(){this.sleepState=Ae.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.wakeUpAfterNarrowphase=!1}sleepTick(e){if(this.allowSleep){const t=this.sleepState,r=this.velocity.lengthSquared()+this.angularVelocity.lengthSquared(),n=this.sleepSpeedLimit**2;t===Ae.AWAKE&&r<n?(this.sleepState=Ae.SLEEPY,this.timeLastSleepy=e,this.dispatchEvent(Ae.sleepyEvent)):t===Ae.SLEEPY&&r>n?this.wakeUp():t===Ae.SLEEPY&&e-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(Ae.sleepEvent))}}updateSolveMassProperties(){this.sleepState===Ae.SLEEPING||this.type===Ae.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))}pointToLocalFrame(e,t){return t===void 0&&(t=new k),e.vsub(this.position,t),this.quaternion.conjugate().vmult(t,t),t}vectorToLocalFrame(e,t){return t===void 0&&(t=new k),this.quaternion.conjugate().vmult(e,t),t}pointToWorldFrame(e,t){return t===void 0&&(t=new k),this.quaternion.vmult(e,t),t.vadd(this.position,t),t}vectorToWorldFrame(e,t){return t===void 0&&(t=new k),this.quaternion.vmult(e,t),t}addShape(e,t,r){const n=new k,s=new Dt;return t&&n.copy(t),r&&s.copy(r),this.shapes.push(e),this.shapeOffsets.push(n),this.shapeOrientations.push(s),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=this,this}removeShape(e){const t=this.shapes.indexOf(e);return t===-1?(console.warn("Shape does not belong to the body"),this):(this.shapes.splice(t,1),this.shapeOffsets.splice(t,1),this.shapeOrientations.splice(t,1),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=null,this)}updateBoundingRadius(){const e=this.shapes,t=this.shapeOffsets,r=e.length;let n=0;for(let s=0;s!==r;s++){const o=e[s];o.updateBoundingSphereRadius();const a=t[s].length(),l=o.boundingSphereRadius;a+l>n&&(n=a+l)}this.boundingRadius=n}updateAABB(){const e=this.shapes,t=this.shapeOffsets,r=this.shapeOrientations,n=e.length,s=z7,o=N7,a=this.quaternion,l=this.aabb,c=$7;for(let d=0;d!==n;d++){const u=e[d];a.vmult(t[d],s),s.vadd(this.position,s),a.mult(r[d],o),u.calculateWorldAABB(s,o,c.lowerBound,c.upperBound),d===0?l.copy(c):l.extend(c)}this.aabbNeedsUpdate=!1}updateInertiaWorld(e){const t=this.invInertia;if(!(t.x===t.y&&t.y===t.z&&!e)){const r=B7,n=V7;r.setRotationFromQuaternion(this.quaternion),r.transpose(n),r.scale(t,r),r.mmult(n,this.invInertiaWorld)}}applyForce(e,t){if(t===void 0&&(t=new k),this.type!==Ae.DYNAMIC)return;this.sleepState===Ae.SLEEPING&&this.wakeUp();const r=H7;t.cross(e,r),this.force.vadd(e,this.force),this.torque.vadd(r,this.torque)}applyLocalForce(e,t){if(t===void 0&&(t=new k),this.type!==Ae.DYNAMIC)return;const r=U7,n=j7;this.vectorToWorldFrame(e,r),this.vectorToWorldFrame(t,n),this.applyForce(r,n)}applyTorque(e){this.type===Ae.DYNAMIC&&(this.sleepState===Ae.SLEEPING&&this.wakeUp(),this.torque.vadd(e,this.torque))}applyImpulse(e,t){if(t===void 0&&(t=new k),this.type!==Ae.DYNAMIC)return;this.sleepState===Ae.SLEEPING&&this.wakeUp();const r=t,n=W7;n.copy(e),n.scale(this.invMass,n),this.velocity.vadd(n,this.velocity);const s=G7;r.cross(e,s),this.invInertiaWorld.vmult(s,s),this.angularVelocity.vadd(s,this.angularVelocity)}applyLocalImpulse(e,t){if(t===void 0&&(t=new k),this.type!==Ae.DYNAMIC)return;const r=q7,n=Y7;this.vectorToWorldFrame(e,r),this.vectorToWorldFrame(t,n),this.applyImpulse(r,n)}updateMassProperties(){const e=X7;this.invMass=this.mass>0?1/this.mass:0;const t=this.inertia,r=this.fixedRotation;this.updateAABB(),e.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),Vf.calculateInertia(e,this.mass,t),this.invInertia.set(t.x>0&&!r?1/t.x:0,t.y>0&&!r?1/t.y:0,t.z>0&&!r?1/t.z:0),this.updateInertiaWorld(!0)}getVelocityAtWorldPoint(e,t){const r=new k;return e.vsub(this.position,r),this.angularVelocity.cross(r,t),this.velocity.vadd(t,t),t}integrate(e,t,r){if(this.previousPosition.copy(this.position),this.previousQuaternion.copy(this.quaternion),!(this.type===Ae.DYNAMIC||this.type===Ae.KINEMATIC)||this.sleepState===Ae.SLEEPING)return;const n=this.velocity,s=this.angularVelocity,o=this.position,a=this.force,l=this.torque,c=this.quaternion,d=this.invMass,u=this.invInertiaWorld,h=this.linearFactor,p=d*e;n.x+=a.x*p*h.x,n.y+=a.y*p*h.y,n.z+=a.z*p*h.z;const g=u.elements,f=this.angularFactor,m=l.x*f.x,b=l.y*f.y,y=l.z*f.z;s.x+=e*(g[0]*m+g[1]*b+g[2]*y),s.y+=e*(g[3]*m+g[4]*b+g[5]*y),s.z+=e*(g[6]*m+g[7]*b+g[8]*y),o.x+=n.x*e,o.y+=n.y*e,o.z+=n.z*e,c.integrate(this.angularVelocity,e,this.angularFactor,c),t&&(r?c.normalizeFast():c.normalize()),this.aabbNeedsUpdate=!0,this.updateInertiaWorld()}}Ae.idCounter=0;Ae.COLLIDE_EVENT_NAME="collide";Ae.DYNAMIC=Hf.DYNAMIC;Ae.STATIC=Hf.STATIC;Ae.KINEMATIC=Hf.KINEMATIC;Ae.AWAKE=Uf.AWAKE;Ae.SLEEPY=Uf.SLEEPY;Ae.SLEEPING=Uf.SLEEPING;Ae.wakeupEvent={type:"wakeup"};Ae.sleepyEvent={type:"sleepy"};Ae.sleepEvent={type:"sleep"};const z7=new k,N7=new Dt,$7=new bi,B7=new Hi,V7=new Hi;new Hi;const H7=new k,U7=new k,j7=new k,W7=new k,G7=new k,q7=new k,Y7=new k,X7=new k;class K7{constructor(){this.world=null,this.useBoundingBoxes=!1,this.dirty=!0}collisionPairs(e,t,r){throw new Error("collisionPairs not implemented for this BroadPhase class!")}needBroadphaseCollision(e,t){return!(!(e.collisionFilterGroup&t.collisionFilterMask)||!(t.collisionFilterGroup&e.collisionFilterMask)||(e.type&Ae.STATIC||e.sleepState===Ae.SLEEPING)&&(t.type&Ae.STATIC||t.sleepState===Ae.SLEEPING))}intersectionTest(e,t,r,n){this.useBoundingBoxes?this.doBoundingBoxBroadphase(e,t,r,n):this.doBoundingSphereBroadphase(e,t,r,n)}doBoundingSphereBroadphase(e,t,r,n){const s=J7;t.position.vsub(e.position,s);const o=(e.boundingRadius+t.boundingRadius)**2;s.lengthSquared()<o&&(r.push(e),n.push(t))}doBoundingBoxBroadphase(e,t,r,n){e.aabbNeedsUpdate&&e.updateAABB(),t.aabbNeedsUpdate&&t.updateAABB(),e.aabb.overlaps(t.aabb)&&(r.push(e),n.push(t))}makePairsUnique(e,t){const r=Z7,n=Q7,s=eV,o=e.length;for(let a=0;a!==o;a++)n[a]=e[a],s[a]=t[a];e.length=0,t.length=0;for(let a=0;a!==o;a++){const l=n[a].id,c=s[a].id,d=l<c?`${l},${c}`:`${c},${l}`;r[d]=a,r.keys.push(d)}for(let a=0;a!==r.keys.length;a++){const l=r.keys.pop(),c=r[l];e.push(n[c]),t.push(s[c]),delete r[l]}}setWorld(e){}static boundingSphereCheck(e,t){const r=new k;e.position.vsub(t.position,r);const n=e.shapes[0],s=t.shapes[0];return Math.pow(n.boundingSphereRadius+s.boundingSphereRadius,2)>r.lengthSquared()}aabbQuery(e,t,r){return console.warn(".aabbQuery is not implemented in this Broadphase subclass."),[]}}const J7=new k;new k;new Dt;new k;const Z7={keys:[]},Q7=[],eV=[];new k;new k;new k;class d_ extends K7{constructor(){super()}collisionPairs(e,t,r){const n=e.bodies,s=n.length;let o,a;for(let l=0;l!==s;l++)for(let c=0;c!==l;c++)o=n[l],a=n[c],this.needBroadphaseCollision(o,a)&&this.intersectionTest(o,a,t,r)}aabbQuery(e,t,r){r===void 0&&(r=[]);for(let n=0;n<e.bodies.length;n++){const s=e.bodies[n];s.aabbNeedsUpdate&&s.updateAABB(),s.aabb.overlaps(t)&&r.push(s)}return r}}class Hc{constructor(){this.rayFromWorld=new k,this.rayToWorld=new k,this.hitNormalWorld=new k,this.hitPointWorld=new k,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}reset(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}abort(){this.shouldStop=!0}set(e,t,r,n,s,o,a){this.rayFromWorld.copy(e),this.rayToWorld.copy(t),this.hitNormalWorld.copy(r),this.hitPointWorld.copy(n),this.shape=s,this.body=o,this.distance=a}}let u_,h_,f_,p_,m_,g_,v_;const jf={CLOSEST:1,ANY:2,ALL:4};u_=ze.types.SPHERE;h_=ze.types.PLANE;f_=ze.types.BOX;p_=ze.types.CYLINDER;m_=ze.types.CONVEXPOLYHEDRON;g_=ze.types.HEIGHTFIELD;v_=ze.types.TRIMESH;class Lt{get[u_](){return this._intersectSphere}get[h_](){return this._intersectPlane}get[f_](){return this._intersectBox}get[p_](){return this._intersectConvex}get[m_](){return this._intersectConvex}get[g_](){return this._intersectHeightfield}get[v_](){return this._intersectTrimesh}constructor(e,t){e===void 0&&(e=new k),t===void 0&&(t=new k),this.from=e.clone(),this.to=t.clone(),this.direction=new k,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=Lt.ANY,this.result=new Hc,this.hasHit=!1,this.callback=r=>{}}intersectWorld(e,t){return this.mode=t.mode||Lt.ANY,this.result=t.result||new Hc,this.skipBackfaces=!!t.skipBackfaces,this.collisionFilterMask=typeof t.collisionFilterMask<"u"?t.collisionFilterMask:-1,this.collisionFilterGroup=typeof t.collisionFilterGroup<"u"?t.collisionFilterGroup:-1,this.checkCollisionResponse=typeof t.checkCollisionResponse<"u"?t.checkCollisionResponse:!0,t.from&&this.from.copy(t.from),t.to&&this.to.copy(t.to),this.callback=t.callback||(()=>{}),this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB(p0),Mu.length=0,e.broadphase.aabbQuery(e,p0,Mu),this.intersectBodies(Mu),this.hasHit}intersectBody(e,t){t&&(this.result=t,this.updateDirection());const r=this.checkCollisionResponse;if(r&&!e.collisionResponse||!(this.collisionFilterGroup&e.collisionFilterMask)||!(e.collisionFilterGroup&this.collisionFilterMask))return;const n=tV,s=iV;for(let o=0,a=e.shapes.length;o<a;o++){const l=e.shapes[o];if(!(r&&!l.collisionResponse)&&(e.quaternion.mult(e.shapeOrientations[o],s),e.quaternion.vmult(e.shapeOffsets[o],n),n.vadd(e.position,n),this.intersectShape(l,s,n,e),this.result.shouldStop))break}}intersectBodies(e,t){t&&(this.result=t,this.updateDirection());for(let r=0,n=e.length;!this.result.shouldStop&&r<n;r++)this.intersectBody(e[r])}updateDirection(){this.to.vsub(this.from,this.direction),this.direction.normalize()}intersectShape(e,t,r,n){const s=this.from;if(gV(s,this.direction,r)>e.boundingSphereRadius)return;const o=this[e.type];o&&o.call(this,e,t,r,n,e)}_intersectBox(e,t,r,n,s){return this._intersectConvex(e.convexPolyhedronRepresentation,t,r,n,s)}_intersectPlane(e,t,r,n,s){const o=this.from,a=this.to,l=this.direction,c=new k(0,0,1);t.vmult(c,c);const d=new k;o.vsub(r,d);const u=d.dot(c);a.vsub(r,d);const h=d.dot(c);if(u*h>0||o.distanceTo(a)<u)return;const p=c.dot(l);if(Math.abs(p)<this.precision)return;const g=new k,f=new k,m=new k;o.vsub(r,g);const b=-c.dot(g)/p;l.scale(b,f),o.vadd(f,m),this.reportIntersection(c,m,s,n,-1)}getAABB(e){const{lowerBound:t,upperBound:r}=e,n=this.to,s=this.from;t.x=Math.min(n.x,s.x),t.y=Math.min(n.y,s.y),t.z=Math.min(n.z,s.z),r.x=Math.max(n.x,s.x),r.y=Math.max(n.y,s.y),r.z=Math.max(n.z,s.z)}_intersectHeightfield(e,t,r,n,s){e.data,e.elementSize;const o=rV;o.from.copy(this.from),o.to.copy(this.to),pt.pointToLocalFrame(r,t,o.from,o.from),pt.pointToLocalFrame(r,t,o.to,o.to),o.updateDirection();const a=nV;let l,c,d,u;l=c=0,d=u=e.data.length-1;const h=new bi;o.getAABB(h),e.getIndexOfPosition(h.lowerBound.x,h.lowerBound.y,a,!0),l=Math.max(l,a[0]),c=Math.max(c,a[1]),e.getIndexOfPosition(h.upperBound.x,h.upperBound.y,a,!0),d=Math.min(d,a[0]+1),u=Math.min(u,a[1]+1);for(let p=l;p<d;p++)for(let g=c;g<u;g++){if(this.result.shouldStop)return;if(e.getAabbAtIndex(p,g,h),!!h.overlapsRay(o)){if(e.getConvexTrianglePillar(p,g,!1),pt.pointToWorldFrame(r,t,e.pillarOffset,Il),this._intersectConvex(e.pillarConvex,t,Il,n,s,m0),this.result.shouldStop)return;e.getConvexTrianglePillar(p,g,!0),pt.pointToWorldFrame(r,t,e.pillarOffset,Il),this._intersectConvex(e.pillarConvex,t,Il,n,s,m0)}}}_intersectSphere(e,t,r,n,s){const o=this.from,a=this.to,l=e.radius,c=(a.x-o.x)**2+(a.y-o.y)**2+(a.z-o.z)**2,d=2*((a.x-o.x)*(o.x-r.x)+(a.y-o.y)*(o.y-r.y)+(a.z-o.z)*(o.z-r.z)),u=(o.x-r.x)**2+(o.y-r.y)**2+(o.z-r.z)**2-l**2,h=d**2-4*c*u,p=sV,g=oV;if(!(h<0))if(h===0)o.lerp(a,h,p),p.vsub(r,g),g.normalize(),this.reportIntersection(g,p,s,n,-1);else{const f=(-d-Math.sqrt(h))/(2*c),m=(-d+Math.sqrt(h))/(2*c);if(f>=0&&f<=1&&(o.lerp(a,f,p),p.vsub(r,g),g.normalize(),this.reportIntersection(g,p,s,n,-1)),this.result.shouldStop)return;m>=0&&m<=1&&(o.lerp(a,m,p),p.vsub(r,g),g.normalize(),this.reportIntersection(g,p,s,n,-1))}}_intersectConvex(e,t,r,n,s,o){const a=aV,l=g0,c=o&&o.faceList||null,d=e.faces,u=e.vertices,h=e.faceNormals,p=this.direction,g=this.from,f=this.to,m=g.distanceTo(f),b=c?c.length:d.length,y=this.result;for(let w=0;!y.shouldStop&&w<b;w++){const _=c?c[w]:w,M=d[_],S=h[_],A=t,x=r;l.copy(u[M[0]]),A.vmult(l,l),l.vadd(x,l),l.vsub(g,l),A.vmult(S,a);const E=p.dot(a);if(Math.abs(E)<this.precision)continue;const D=a.dot(l)/E;if(!(D<0)){p.scale(D,ri),ri.vadd(g,ri),Ni.copy(u[M[0]]),A.vmult(Ni,Ni),x.vadd(Ni,Ni);for(let F=1;!y.shouldStop&&F<M.length-1;F++){Yi.copy(u[M[F]]),Xi.copy(u[M[F+1]]),A.vmult(Yi,Yi),A.vmult(Xi,Xi),x.vadd(Yi,Yi),x.vadd(Xi,Xi);const R=ri.distanceTo(g);!(Lt.pointInTriangle(ri,Ni,Yi,Xi)||Lt.pointInTriangle(ri,Yi,Ni,Xi))||R>m||this.reportIntersection(a,ri,s,n,_)}}}}_intersectTrimesh(e,t,r,n,s,o){const a=lV,l=pV,c=mV,d=g0,u=cV,h=dV,p=uV,g=fV,f=hV,m=e.indices;e.vertices;const b=this.from,y=this.to,w=this.direction;c.position.copy(r),c.quaternion.copy(t),pt.vectorToLocalFrame(r,t,w,u),pt.pointToLocalFrame(r,t,b,h),pt.pointToLocalFrame(r,t,y,p),p.x*=e.scale.x,p.y*=e.scale.y,p.z*=e.scale.z,h.x*=e.scale.x,h.y*=e.scale.y,h.z*=e.scale.z,p.vsub(h,u),u.normalize();const _=h.distanceSquared(p);e.tree.rayQuery(this,c,l);for(let M=0,S=l.length;!this.result.shouldStop&&M!==S;M++){const A=l[M];e.getNormal(A,a),e.getVertex(m[A*3],Ni),Ni.vsub(h,d);const x=u.dot(a),E=a.dot(d)/x;if(E<0)continue;u.scale(E,ri),ri.vadd(h,ri),e.getVertex(m[A*3+1],Yi),e.getVertex(m[A*3+2],Xi);const D=ri.distanceSquared(h);!(Lt.pointInTriangle(ri,Yi,Ni,Xi)||Lt.pointInTriangle(ri,Ni,Yi,Xi))||D>_||(pt.vectorToWorldFrame(t,a,f),pt.pointToWorldFrame(r,t,ri,g),this.reportIntersection(f,g,s,n,A))}l.length=0}reportIntersection(e,t,r,n,s){const o=this.from,a=this.to,l=o.distanceTo(t),c=this.result;if(!(this.skipBackfaces&&e.dot(this.direction)>0))switch(c.hitFaceIndex=typeof s<"u"?s:-1,this.mode){case Lt.ALL:this.hasHit=!0,c.set(o,a,e,t,r,n,l),c.hasHit=!0,this.callback(c);break;case Lt.CLOSEST:(l<c.distance||!c.hasHit)&&(this.hasHit=!0,c.hasHit=!0,c.set(o,a,e,t,r,n,l));break;case Lt.ANY:this.hasHit=!0,c.hasHit=!0,c.set(o,a,e,t,r,n,l),c.shouldStop=!0;break}}static pointInTriangle(e,t,r,n){n.vsub(t,qn),r.vsub(t,Io),e.vsub(t,Eu);const s=qn.dot(qn),o=qn.dot(Io),a=qn.dot(Eu),l=Io.dot(Io),c=Io.dot(Eu);let d,u;return(d=l*a-o*c)>=0&&(u=s*c-o*a)>=0&&d+u<s*l-o*o}}Lt.CLOSEST=jf.CLOSEST;Lt.ANY=jf.ANY;Lt.ALL=jf.ALL;const p0=new bi,Mu=[],Io=new k,Eu=new k,tV=new k,iV=new Dt,ri=new k,Ni=new k,Yi=new k,Xi=new k;new k;new Hc;const m0={faceList:[0]},Il=new k,rV=new Lt,nV=[],sV=new k,oV=new k,aV=new k;new k;new k;const g0=new k,lV=new k,cV=new k,dV=new k,uV=new k,hV=new k,fV=new k;new bi;const pV=[],mV=new pt,qn=new k,Ol=new k;function gV(i,e,t){t.vsub(i,qn);const r=qn.dot(e);return e.scale(r,Ol),Ol.vadd(i,Ol),t.distanceTo(Ol)}class vV{static defaults(e,t){e===void 0&&(e={});for(let r in t)r in e||(e[r]=t[r]);return e}}class v0{constructor(){this.spatial=new k,this.rotational=new k}multiplyElement(e){return e.spatial.dot(this.spatial)+e.rotational.dot(this.rotational)}multiplyVectors(e,t){return e.dot(this.spatial)+t.dot(this.rotational)}}class Ga{constructor(e,t,r,n){r===void 0&&(r=-1e6),n===void 0&&(n=1e6),this.id=Ga.idCounter++,this.minForce=r,this.maxForce=n,this.bi=e,this.bj=t,this.a=0,this.b=0,this.eps=0,this.jacobianElementA=new v0,this.jacobianElementB=new v0,this.enabled=!0,this.multiplier=0,this.setSpookParams(1e7,4,1/60)}setSpookParams(e,t,r){const n=t,s=e,o=r;this.a=4/(o*(1+4*n)),this.b=4*n/(1+4*n),this.eps=4/(o*o*s*(1+4*n))}computeB(e,t,r){const n=this.computeGW(),s=this.computeGq(),o=this.computeGiMf();return-s*e-n*t-o*r}computeGq(){const e=this.jacobianElementA,t=this.jacobianElementB,r=this.bi,n=this.bj,s=r.position,o=n.position;return e.spatial.dot(s)+t.spatial.dot(o)}computeGW(){const e=this.jacobianElementA,t=this.jacobianElementB,r=this.bi,n=this.bj,s=r.velocity,o=n.velocity,a=r.angularVelocity,l=n.angularVelocity;return e.multiplyVectors(s,a)+t.multiplyVectors(o,l)}computeGWlambda(){const e=this.jacobianElementA,t=this.jacobianElementB,r=this.bi,n=this.bj,s=r.vlambda,o=n.vlambda,a=r.wlambda,l=n.wlambda;return e.multiplyVectors(s,a)+t.multiplyVectors(o,l)}computeGiMf(){const e=this.jacobianElementA,t=this.jacobianElementB,r=this.bi,n=this.bj,s=r.force,o=r.torque,a=n.force,l=n.torque,c=r.invMassSolve,d=n.invMassSolve;return s.scale(c,b0),a.scale(d,y0),r.invInertiaWorldSolve.vmult(o,_0),n.invInertiaWorldSolve.vmult(l,w0),e.multiplyVectors(b0,_0)+t.multiplyVectors(y0,w0)}computeGiMGt(){const e=this.jacobianElementA,t=this.jacobianElementB,r=this.bi,n=this.bj,s=r.invMassSolve,o=n.invMassSolve,a=r.invInertiaWorldSolve,l=n.invInertiaWorldSolve;let c=s+o;return a.vmult(e.rotational,Fl),c+=Fl.dot(e.rotational),l.vmult(t.rotational,Fl),c+=Fl.dot(t.rotational),c}addToWlambda(e){const t=this.jacobianElementA,r=this.jacobianElementB,n=this.bi,s=this.bj,o=bV;n.vlambda.addScaledVector(n.invMassSolve*e,t.spatial,n.vlambda),s.vlambda.addScaledVector(s.invMassSolve*e,r.spatial,s.vlambda),n.invInertiaWorldSolve.vmult(t.rotational,o),n.wlambda.addScaledVector(e,o,n.wlambda),s.invInertiaWorldSolve.vmult(r.rotational,o),s.wlambda.addScaledVector(e,o,s.wlambda)}computeC(){return this.computeGiMGt()+this.eps}}Ga.idCounter=0;const b0=new k,y0=new k,_0=new k,w0=new k,Fl=new k,bV=new k;class yV extends Ga{constructor(e,t,r){r===void 0&&(r=1e6),super(e,t,0,r),this.restitution=0,this.ri=new k,this.rj=new k,this.ni=new k}computeB(e){const t=this.a,r=this.b,n=this.bi,s=this.bj,o=this.ri,a=this.rj,l=_V,c=wV,d=n.velocity,u=n.angularVelocity;n.force,n.torque;const h=s.velocity,p=s.angularVelocity;s.force,s.torque;const g=xV,f=this.jacobianElementA,m=this.jacobianElementB,b=this.ni;o.cross(b,l),a.cross(b,c),b.negate(f.spatial),l.negate(f.rotational),m.spatial.copy(b),m.rotational.copy(c),g.copy(s.position),g.vadd(a,g),g.vsub(n.position,g),g.vsub(o,g);const y=b.dot(g),w=this.restitution+1,_=w*h.dot(b)-w*d.dot(b)+p.dot(c)-u.dot(l),M=this.computeGiMf();return-y*t-_*r-e*M}getImpactVelocityAlongNormal(){const e=SV,t=MV,r=EV,n=kV,s=CV;return this.bi.position.vadd(this.ri,r),this.bj.position.vadd(this.rj,n),this.bi.getVelocityAtWorldPoint(r,e),this.bj.getVelocityAtWorldPoint(n,t),e.vsub(t,s),this.ni.dot(s)}}const _V=new k,wV=new k,xV=new k,SV=new k,MV=new k,EV=new k,kV=new k,CV=new k;new k;new k;new k;new k;new k;new k;new k;new k;new k;new k;class x0 extends Ga{constructor(e,t,r){super(e,t,-r,r),this.ri=new k,this.rj=new k,this.t=new k}computeB(e){this.a;const t=this.b;this.bi,this.bj;const r=this.ri,n=this.rj,s=TV,o=AV,a=this.t;r.cross(a,s),n.cross(a,o);const l=this.jacobianElementA,c=this.jacobianElementB;a.negate(l.spatial),s.negate(l.rotational),c.spatial.copy(a),c.rotational.copy(o);const d=this.computeGW(),u=this.computeGiMf();return-d*t-e*u}}const TV=new k,AV=new k;class rs{constructor(e,t,r){r=vV.defaults(r,{friction:.3,restitution:.3,contactEquationStiffness:1e7,contactEquationRelaxation:3,frictionEquationStiffness:1e7,frictionEquationRelaxation:3}),this.id=rs.idCounter++,this.materials=[e,t],this.friction=r.friction,this.restitution=r.restitution,this.contactEquationStiffness=r.contactEquationStiffness,this.contactEquationRelaxation=r.contactEquationRelaxation,this.frictionEquationStiffness=r.frictionEquationStiffness,this.frictionEquationRelaxation=r.frictionEquationRelaxation}}rs.idCounter=0;class ns{constructor(e){e===void 0&&(e={});let t="";typeof e=="string"&&(t=e,e={}),this.name=t,this.id=ns.idCounter++,this.friction=typeof e.friction<"u"?e.friction:-1,this.restitution=typeof e.restitution<"u"?e.restitution:-1}}ns.idCounter=0;new k;new k;new k;new k;new k;new k;new k;new k;new k;new k;new k;new k;new k;new k;new k;new k;new k;new k;new k;new Lt;new k;new k;new k;new k(1,0,0),new k(0,1,0),new k(0,0,1);new k;new k;new k;new k;new k;new k;new k;new k;new k;new k;new k;new k;new k;new k;new k;new k;new k;new k;new k;new k;class LV extends is{constructor(e,t,r,n){if(e===void 0&&(e=1),t===void 0&&(t=1),r===void 0&&(r=1),n===void 0&&(n=8),e<0)throw new Error("The cylinder radiusTop cannot be negative.");if(t<0)throw new Error("The cylinder radiusBottom cannot be negative.");const s=n,o=[],a=[],l=[],c=[],d=[],u=Math.cos,h=Math.sin;o.push(new k(-t*h(0),-r*.5,t*u(0))),c.push(0),o.push(new k(-e*h(0),r*.5,e*u(0))),d.push(1);for(let g=0;g<s;g++){const f=2*Math.PI/s*(g+1),m=2*Math.PI/s*(g+.5);g<s-1?(o.push(new k(-t*h(f),-r*.5,t*u(f))),c.push(2*g+2),o.push(new k(-e*h(f),r*.5,e*u(f))),d.push(2*g+3),l.push([2*g,2*g+1,2*g+3,2*g+2])):l.push([2*g,2*g+1,1,0]),(s%2===1||g<s/2)&&a.push(new k(-h(m),0,u(m)))}l.push(c),a.push(new k(0,1,0));const p=[];for(let g=0;g<d.length;g++)p.push(d[d.length-g-1]);l.push(p),super({vertices:o,faces:l,axes:a}),this.type=ze.types.CYLINDER,this.radiusTop=e,this.radiusBottom=t,this.height=r,this.numSegments=n}}class Oo extends ze{constructor(){super({type:ze.types.PLANE}),this.worldNormal=new k,this.worldNormalNeedsUpdate=!0,this.boundingSphereRadius=Number.MAX_VALUE}computeWorldNormal(e){const t=this.worldNormal;t.set(0,0,1),e.vmult(t,t),this.worldNormalNeedsUpdate=!1}calculateLocalInertia(e,t){return t===void 0&&(t=new k),t}volume(){return Number.MAX_VALUE}calculateWorldAABB(e,t,r,n){br.set(0,0,1),t.vmult(br,br);const s=Number.MAX_VALUE;r.set(-s,-s,-s),n.set(s,s,s),br.x===1?n.x=e.x:br.x===-1&&(r.x=e.x),br.y===1?n.y=e.y:br.y===-1&&(r.y=e.y),br.z===1?n.z=e.z:br.z===-1&&(r.z=e.z)}updateBoundingSphereRadius(){this.boundingSphereRadius=Number.MAX_VALUE}}const br=new k;new k;new k;new k;new k;new k;new k;new k;new k;new k;new k;new bi;new k;new bi;new k;new k;new k;new k;new k;new k;new k;new bi;new k;new pt;new bi;class DV{constructor(){this.equations=[]}solve(e,t){return 0}addEquation(e){e.enabled&&!e.bi.isTrigger&&!e.bj.isTrigger&&this.equations.push(e)}removeEquation(e){const t=this.equations,r=t.indexOf(e);r!==-1&&t.splice(r,1)}removeAllEquations(){this.equations.length=0}}class PV extends DV{constructor(){super(),this.iterations=10,this.tolerance=1e-7}solve(e,t){let r=0;const n=this.iterations,s=this.tolerance*this.tolerance,o=this.equations,a=o.length,l=t.bodies,c=l.length,d=e;let u,h,p,g,f,m;if(a!==0)for(let _=0;_!==c;_++)l[_].updateSolveMassProperties();const b=IV,y=OV,w=RV;b.length=a,y.length=a,w.length=a;for(let _=0;_!==a;_++){const M=o[_];w[_]=0,y[_]=M.computeB(d),b[_]=1/M.computeC()}if(a!==0){for(let S=0;S!==c;S++){const A=l[S],x=A.vlambda,E=A.wlambda;x.set(0,0,0),E.set(0,0,0)}for(r=0;r!==n;r++){g=0;for(let S=0;S!==a;S++){const A=o[S];u=y[S],h=b[S],m=w[S],f=A.computeGWlambda(),p=h*(u-f-A.eps*m),m+p<A.minForce?p=A.minForce-m:m+p>A.maxForce&&(p=A.maxForce-m),w[S]+=p,g+=p>0?p:-p,A.addToWlambda(p)}if(g*g<s)break}for(let S=0;S!==c;S++){const A=l[S],x=A.velocity,E=A.angularVelocity;A.vlambda.vmul(A.linearFactor,A.vlambda),x.vadd(A.vlambda,x),A.wlambda.vmul(A.angularFactor,A.wlambda),E.vadd(A.wlambda,E)}let _=o.length;const M=1/d;for(;_--;)o[_].multiplier=w[_]*M}return r}}const RV=[],IV=[],OV=[];Ae.STATIC;class FV{constructor(){this.objects=[],this.type=Object}release(){const e=arguments.length;for(let t=0;t!==e;t++)this.objects.push(t<0||arguments.length<=t?void 0:arguments[t]);return this}get(){return this.objects.length===0?this.constructObject():this.objects.pop()}constructObject(){throw new Error("constructObject() not implemented in this Pool subclass yet!")}resize(e){const t=this.objects;for(;t.length>e;)t.pop();for(;t.length<e;)t.push(this.constructObject());return this}}class zV extends FV{constructor(){super(...arguments),this.type=k}constructObject(){return new k}}const xt={sphereSphere:ze.types.SPHERE,spherePlane:ze.types.SPHERE|ze.types.PLANE,boxBox:ze.types.BOX|ze.types.BOX,sphereBox:ze.types.SPHERE|ze.types.BOX,planeBox:ze.types.PLANE|ze.types.BOX,convexConvex:ze.types.CONVEXPOLYHEDRON,sphereConvex:ze.types.SPHERE|ze.types.CONVEXPOLYHEDRON,planeConvex:ze.types.PLANE|ze.types.CONVEXPOLYHEDRON,boxConvex:ze.types.BOX|ze.types.CONVEXPOLYHEDRON,sphereHeightfield:ze.types.SPHERE|ze.types.HEIGHTFIELD,boxHeightfield:ze.types.BOX|ze.types.HEIGHTFIELD,convexHeightfield:ze.types.CONVEXPOLYHEDRON|ze.types.HEIGHTFIELD,sphereParticle:ze.types.PARTICLE|ze.types.SPHERE,planeParticle:ze.types.PLANE|ze.types.PARTICLE,boxParticle:ze.types.BOX|ze.types.PARTICLE,convexParticle:ze.types.PARTICLE|ze.types.CONVEXPOLYHEDRON,cylinderCylinder:ze.types.CYLINDER,sphereCylinder:ze.types.SPHERE|ze.types.CYLINDER,planeCylinder:ze.types.PLANE|ze.types.CYLINDER,boxCylinder:ze.types.BOX|ze.types.CYLINDER,convexCylinder:ze.types.CONVEXPOLYHEDRON|ze.types.CYLINDER,heightfieldCylinder:ze.types.HEIGHTFIELD|ze.types.CYLINDER,particleCylinder:ze.types.PARTICLE|ze.types.CYLINDER,sphereTrimesh:ze.types.SPHERE|ze.types.TRIMESH,planeTrimesh:ze.types.PLANE|ze.types.TRIMESH};class NV{get[xt.sphereSphere](){return this.sphereSphere}get[xt.spherePlane](){return this.spherePlane}get[xt.boxBox](){return this.boxBox}get[xt.sphereBox](){return this.sphereBox}get[xt.planeBox](){return this.planeBox}get[xt.convexConvex](){return this.convexConvex}get[xt.sphereConvex](){return this.sphereConvex}get[xt.planeConvex](){return this.planeConvex}get[xt.boxConvex](){return this.boxConvex}get[xt.sphereHeightfield](){return this.sphereHeightfield}get[xt.boxHeightfield](){return this.boxHeightfield}get[xt.convexHeightfield](){return this.convexHeightfield}get[xt.sphereParticle](){return this.sphereParticle}get[xt.planeParticle](){return this.planeParticle}get[xt.boxParticle](){return this.boxParticle}get[xt.convexParticle](){return this.convexParticle}get[xt.cylinderCylinder](){return this.convexConvex}get[xt.sphereCylinder](){return this.sphereConvex}get[xt.planeCylinder](){return this.planeConvex}get[xt.boxCylinder](){return this.boxConvex}get[xt.convexCylinder](){return this.convexConvex}get[xt.heightfieldCylinder](){return this.heightfieldCylinder}get[xt.particleCylinder](){return this.particleCylinder}get[xt.sphereTrimesh](){return this.sphereTrimesh}get[xt.planeTrimesh](){return this.planeTrimesh}constructor(e){this.contactPointPool=[],this.frictionEquationPool=[],this.result=[],this.frictionResult=[],this.v3pool=new zV,this.world=e,this.currentContactMaterial=e.defaultContactMaterial,this.enableFrictionReduction=!1}createContactEquation(e,t,r,n,s,o){let a;this.contactPointPool.length?(a=this.contactPointPool.pop(),a.bi=e,a.bj=t):a=new yV(e,t),a.enabled=e.collisionResponse&&t.collisionResponse&&r.collisionResponse&&n.collisionResponse;const l=this.currentContactMaterial;a.restitution=l.restitution,a.setSpookParams(l.contactEquationStiffness,l.contactEquationRelaxation,this.world.dt);const c=r.material||e.material,d=n.material||t.material;return c&&d&&c.restitution>=0&&d.restitution>=0&&(a.restitution=c.restitution*d.restitution),a.si=s||r,a.sj=o||n,a}createFrictionEquationsFromContact(e,t){const r=e.bi,n=e.bj,s=e.si,o=e.sj,a=this.world,l=this.currentContactMaterial;let c=l.friction;const d=s.material||r.material,u=o.material||n.material;if(d&&u&&d.friction>=0&&u.friction>=0&&(c=d.friction*u.friction),c>0){const h=c*(a.frictionGravity||a.gravity).length();let p=r.invMass+n.invMass;p>0&&(p=1/p);const g=this.frictionEquationPool,f=g.length?g.pop():new x0(r,n,h*p),m=g.length?g.pop():new x0(r,n,h*p);return f.bi=m.bi=r,f.bj=m.bj=n,f.minForce=m.minForce=-h*p,f.maxForce=m.maxForce=h*p,f.ri.copy(e.ri),f.rj.copy(e.rj),m.ri.copy(e.ri),m.rj.copy(e.rj),e.ni.tangents(f.t,m.t),f.setSpookParams(l.frictionEquationStiffness,l.frictionEquationRelaxation,a.dt),m.setSpookParams(l.frictionEquationStiffness,l.frictionEquationRelaxation,a.dt),f.enabled=m.enabled=e.enabled,t.push(f,m),!0}return!1}createFrictionFromAverage(e){let t=this.result[this.result.length-1];if(!this.createFrictionEquationsFromContact(t,this.frictionResult)||e===1)return;const r=this.frictionResult[this.frictionResult.length-2],n=this.frictionResult[this.frictionResult.length-1];zn.setZero(),zs.setZero(),Ns.setZero();const s=t.bi;t.bj;for(let a=0;a!==e;a++)t=this.result[this.result.length-1-a],t.bi!==s?(zn.vadd(t.ni,zn),zs.vadd(t.ri,zs),Ns.vadd(t.rj,Ns)):(zn.vsub(t.ni,zn),zs.vadd(t.rj,zs),Ns.vadd(t.ri,Ns));const o=1/e;zs.scale(o,r.ri),Ns.scale(o,r.rj),n.ri.copy(r.ri),n.rj.copy(r.rj),zn.normalize(),zn.tangents(r.t,n.t)}getContacts(e,t,r,n,s,o,a){this.contactPointPool=s,this.frictionEquationPool=a,this.result=n,this.frictionResult=o;const l=VV,c=HV,d=$V,u=BV;for(let h=0,p=e.length;h!==p;h++){const g=e[h],f=t[h];let m=null;g.material&&f.material&&(m=r.getContactMaterial(g.material,f.material)||null);const b=g.type&Ae.KINEMATIC&&f.type&Ae.STATIC||g.type&Ae.STATIC&&f.type&Ae.KINEMATIC||g.type&Ae.KINEMATIC&&f.type&Ae.KINEMATIC;for(let y=0;y<g.shapes.length;y++){g.quaternion.mult(g.shapeOrientations[y],l),g.quaternion.vmult(g.shapeOffsets[y],d),d.vadd(g.position,d);const w=g.shapes[y];for(let _=0;_<f.shapes.length;_++){f.quaternion.mult(f.shapeOrientations[_],c),f.quaternion.vmult(f.shapeOffsets[_],u),u.vadd(f.position,u);const M=f.shapes[_];if(!(w.collisionFilterMask&M.collisionFilterGroup&&M.collisionFilterMask&w.collisionFilterGroup)||d.distanceTo(u)>w.boundingSphereRadius+M.boundingSphereRadius)continue;let S=null;w.material&&M.material&&(S=r.getContactMaterial(w.material,M.material)||null),this.currentContactMaterial=S||m||r.defaultContactMaterial;const A=w.type|M.type,x=this[A];if(x){let E=!1;w.type<M.type?E=x.call(this,w,M,d,u,l,c,g,f,w,M,b):E=x.call(this,M,w,u,d,c,l,f,g,w,M,b),E&&b&&(r.shapeOverlapKeeper.set(w.id,M.id),r.bodyOverlapKeeper.set(g.id,f.id))}}}}}sphereSphere(e,t,r,n,s,o,a,l,c,d,u){if(u)return r.distanceSquared(n)<(e.radius+t.radius)**2;const h=this.createContactEquation(a,l,e,t,c,d);n.vsub(r,h.ni),h.ni.normalize(),h.ri.copy(h.ni),h.rj.copy(h.ni),h.ri.scale(e.radius,h.ri),h.rj.scale(-t.radius,h.rj),h.ri.vadd(r,h.ri),h.ri.vsub(a.position,h.ri),h.rj.vadd(n,h.rj),h.rj.vsub(l.position,h.rj),this.result.push(h),this.createFrictionEquationsFromContact(h,this.frictionResult)}spherePlane(e,t,r,n,s,o,a,l,c,d,u){const h=this.createContactEquation(a,l,e,t,c,d);if(h.ni.set(0,0,1),o.vmult(h.ni,h.ni),h.ni.negate(h.ni),h.ni.normalize(),h.ni.scale(e.radius,h.ri),r.vsub(n,zl),h.ni.scale(h.ni.dot(zl),S0),zl.vsub(S0,h.rj),-zl.dot(h.ni)<=e.radius){if(u)return!0;const p=h.ri,g=h.rj;p.vadd(r,p),p.vsub(a.position,p),g.vadd(n,g),g.vsub(l.position,g),this.result.push(h),this.createFrictionEquationsFromContact(h,this.frictionResult)}}boxBox(e,t,r,n,s,o,a,l,c,d,u){return e.convexPolyhedronRepresentation.material=e.material,t.convexPolyhedronRepresentation.material=t.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,t.convexPolyhedronRepresentation.collisionResponse=t.collisionResponse,this.convexConvex(e.convexPolyhedronRepresentation,t.convexPolyhedronRepresentation,r,n,s,o,a,l,e,t,u)}sphereBox(e,t,r,n,s,o,a,l,c,d,u){const h=this.v3pool,p=pH;r.vsub(n,Nl),t.getSideNormals(p,o);const g=e.radius;let f=!1;const m=gH,b=vH,y=bH;let w=null,_=0,M=0,S=0,A=null;for(let N=0,j=p.length;N!==j&&f===!1;N++){const Y=uH;Y.copy(p[N]);const W=Y.length();Y.normalize();const ee=Nl.dot(Y);if(ee<W+g&&ee>0){const me=hH,X=fH;me.copy(p[(N+1)%3]),X.copy(p[(N+2)%3]);const ye=me.length(),Ce=X.length();me.normalize(),X.normalize();const We=Nl.dot(me),se=Nl.dot(X);if(We<ye&&We>-ye&&se<Ce&&se>-Ce){const te=Math.abs(ee-W-g);if((A===null||te<A)&&(A=te,M=We,S=se,w=W,m.copy(Y),b.copy(me),y.copy(X),_++,u))return!0}}}if(_){f=!0;const N=this.createContactEquation(a,l,e,t,c,d);m.scale(-g,N.ri),N.ni.copy(m),N.ni.negate(N.ni),m.scale(w,m),b.scale(M,b),m.vadd(b,m),y.scale(S,y),m.vadd(y,N.rj),N.ri.vadd(r,N.ri),N.ri.vsub(a.position,N.ri),N.rj.vadd(n,N.rj),N.rj.vsub(l.position,N.rj),this.result.push(N),this.createFrictionEquationsFromContact(N,this.frictionResult)}let x=h.get();const E=mH;for(let N=0;N!==2&&!f;N++)for(let j=0;j!==2&&!f;j++)for(let Y=0;Y!==2&&!f;Y++)if(x.set(0,0,0),N?x.vadd(p[0],x):x.vsub(p[0],x),j?x.vadd(p[1],x):x.vsub(p[1],x),Y?x.vadd(p[2],x):x.vsub(p[2],x),n.vadd(x,E),E.vsub(r,E),E.lengthSquared()<g*g){if(u)return!0;f=!0;const W=this.createContactEquation(a,l,e,t,c,d);W.ri.copy(E),W.ri.normalize(),W.ni.copy(W.ri),W.ri.scale(g,W.ri),W.rj.copy(x),W.ri.vadd(r,W.ri),W.ri.vsub(a.position,W.ri),W.rj.vadd(n,W.rj),W.rj.vsub(l.position,W.rj),this.result.push(W),this.createFrictionEquationsFromContact(W,this.frictionResult)}h.release(x),x=null;const D=h.get(),F=h.get(),R=h.get(),B=h.get(),I=h.get(),V=p.length;for(let N=0;N!==V&&!f;N++)for(let j=0;j!==V&&!f;j++)if(N%3!==j%3){p[j].cross(p[N],D),D.normalize(),p[N].vadd(p[j],F),R.copy(r),R.vsub(F,R),R.vsub(n,R);const Y=R.dot(D);D.scale(Y,B);let W=0;for(;W===N%3||W===j%3;)W++;I.copy(r),I.vsub(B,I),I.vsub(F,I),I.vsub(n,I);const ee=Math.abs(Y),me=I.length();if(ee<p[W].length()&&me<g){if(u)return!0;f=!0;const X=this.createContactEquation(a,l,e,t,c,d);F.vadd(B,X.rj),X.rj.copy(X.rj),I.negate(X.ni),X.ni.normalize(),X.ri.copy(X.rj),X.ri.vadd(n,X.ri),X.ri.vsub(r,X.ri),X.ri.normalize(),X.ri.scale(g,X.ri),X.ri.vadd(r,X.ri),X.ri.vsub(a.position,X.ri),X.rj.vadd(n,X.rj),X.rj.vsub(l.position,X.rj),this.result.push(X),this.createFrictionEquationsFromContact(X,this.frictionResult)}}h.release(D,F,R,B,I)}planeBox(e,t,r,n,s,o,a,l,c,d,u){return t.convexPolyhedronRepresentation.material=t.material,t.convexPolyhedronRepresentation.collisionResponse=t.collisionResponse,t.convexPolyhedronRepresentation.id=t.id,this.planeConvex(e,t.convexPolyhedronRepresentation,r,n,s,o,a,l,e,t,u)}convexConvex(e,t,r,n,s,o,a,l,c,d,u,h,p){const g=RH;if(!(r.distanceTo(n)>e.boundingSphereRadius+t.boundingSphereRadius)&&e.findSeparatingAxis(t,r,s,n,o,g,h,p)){const f=[],m=IH;e.clipAgainstHull(r,s,t,n,o,g,-100,100,f);let b=0;for(let y=0;y!==f.length;y++){if(u)return!0;const w=this.createContactEquation(a,l,e,t,c,d),_=w.ri,M=w.rj;g.negate(w.ni),f[y].normal.negate(m),m.scale(f[y].depth,m),f[y].point.vadd(m,_),M.copy(f[y].point),_.vsub(r,_),M.vsub(n,M),_.vadd(r,_),_.vsub(a.position,_),M.vadd(n,M),M.vsub(l.position,M),this.result.push(w),b++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(w,this.frictionResult)}this.enableFrictionReduction&&b&&this.createFrictionFromAverage(b)}}sphereConvex(e,t,r,n,s,o,a,l,c,d,u){const h=this.v3pool;r.vsub(n,yH);const p=t.faceNormals,g=t.faces,f=t.vertices,m=e.radius;let b=!1;for(let y=0;y!==f.length;y++){const w=f[y],_=SH;o.vmult(w,_),n.vadd(_,_);const M=xH;if(_.vsub(r,M),M.lengthSquared()<m*m){if(u)return!0;b=!0;const S=this.createContactEquation(a,l,e,t,c,d);S.ri.copy(M),S.ri.normalize(),S.ni.copy(S.ri),S.ri.scale(m,S.ri),_.vsub(n,S.rj),S.ri.vadd(r,S.ri),S.ri.vsub(a.position,S.ri),S.rj.vadd(n,S.rj),S.rj.vsub(l.position,S.rj),this.result.push(S),this.createFrictionEquationsFromContact(S,this.frictionResult);return}}for(let y=0,w=g.length;y!==w&&b===!1;y++){const _=p[y],M=g[y],S=MH;o.vmult(_,S);const A=EH;o.vmult(f[M[0]],A),A.vadd(n,A);const x=kH;S.scale(-m,x),r.vadd(x,x);const E=CH;x.vsub(A,E);const D=E.dot(S),F=TH;if(r.vsub(A,F),D<0&&F.dot(S)>0){const R=[];for(let B=0,I=M.length;B!==I;B++){const V=h.get();o.vmult(f[M[B]],V),n.vadd(V,V),R.push(V)}if(dH(R,S,r)){if(u)return!0;b=!0;const B=this.createContactEquation(a,l,e,t,c,d);S.scale(-m,B.ri),S.negate(B.ni);const I=h.get();S.scale(-D,I);const V=h.get();S.scale(-m,V),r.vsub(n,B.rj),B.rj.vadd(V,B.rj),B.rj.vadd(I,B.rj),B.rj.vadd(n,B.rj),B.rj.vsub(l.position,B.rj),B.ri.vadd(r,B.ri),B.ri.vsub(a.position,B.ri),h.release(I),h.release(V),this.result.push(B),this.createFrictionEquationsFromContact(B,this.frictionResult);for(let N=0,j=R.length;N!==j;N++)h.release(R[N]);return}else for(let B=0;B!==M.length;B++){const I=h.get(),V=h.get();o.vmult(f[M[(B+1)%M.length]],I),o.vmult(f[M[(B+2)%M.length]],V),n.vadd(I,I),n.vadd(V,V);const N=_H;V.vsub(I,N);const j=wH;N.unit(j);const Y=h.get(),W=h.get();r.vsub(I,W);const ee=W.dot(j);j.scale(ee,Y),Y.vadd(I,Y);const me=h.get();if(Y.vsub(r,me),ee>0&&ee*ee<N.lengthSquared()&&me.lengthSquared()<m*m){if(u)return!0;const X=this.createContactEquation(a,l,e,t,c,d);Y.vsub(n,X.rj),Y.vsub(r,X.ni),X.ni.normalize(),X.ni.scale(m,X.ri),X.rj.vadd(n,X.rj),X.rj.vsub(l.position,X.rj),X.ri.vadd(r,X.ri),X.ri.vsub(a.position,X.ri),this.result.push(X),this.createFrictionEquationsFromContact(X,this.frictionResult);for(let ye=0,Ce=R.length;ye!==Ce;ye++)h.release(R[ye]);h.release(I),h.release(V),h.release(Y),h.release(me),h.release(W);return}h.release(I),h.release(V),h.release(Y),h.release(me),h.release(W)}for(let B=0,I=R.length;B!==I;B++)h.release(R[B])}}}planeConvex(e,t,r,n,s,o,a,l,c,d,u){const h=AH,p=LH;p.set(0,0,1),s.vmult(p,p);let g=0;const f=DH;for(let m=0;m!==t.vertices.length;m++)if(h.copy(t.vertices[m]),o.vmult(h,h),n.vadd(h,h),h.vsub(r,f),p.dot(f)<=0){if(u)return!0;const b=this.createContactEquation(a,l,e,t,c,d),y=PH;p.scale(p.dot(f),y),h.vsub(y,y),y.vsub(r,b.ri),b.ni.copy(p),h.vsub(n,b.rj),b.ri.vadd(r,b.ri),b.ri.vsub(a.position,b.ri),b.rj.vadd(n,b.rj),b.rj.vsub(l.position,b.rj),this.result.push(b),g++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(b,this.frictionResult)}this.enableFrictionReduction&&g&&this.createFrictionFromAverage(g)}boxConvex(e,t,r,n,s,o,a,l,c,d,u){return e.convexPolyhedronRepresentation.material=e.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,this.convexConvex(e.convexPolyhedronRepresentation,t,r,n,s,o,a,l,e,t,u)}sphereHeightfield(e,t,r,n,s,o,a,l,c,d,u){const h=t.data,p=e.radius,g=t.elementSize,f=GH,m=WH;pt.pointToLocalFrame(n,o,r,m);let b=Math.floor((m.x-p)/g)-1,y=Math.ceil((m.x+p)/g)+1,w=Math.floor((m.y-p)/g)-1,_=Math.ceil((m.y+p)/g)+1;if(y<0||_<0||b>h.length||w>h[0].length)return;b<0&&(b=0),y<0&&(y=0),w<0&&(w=0),_<0&&(_=0),b>=h.length&&(b=h.length-1),y>=h.length&&(y=h.length-1),_>=h[0].length&&(_=h[0].length-1),w>=h[0].length&&(w=h[0].length-1);const M=[];t.getRectMinMax(b,w,y,_,M);const S=M[0],A=M[1];if(m.z-p>A||m.z+p<S)return;const x=this.result;for(let E=b;E<y;E++)for(let D=w;D<_;D++){const F=x.length;let R=!1;if(t.getConvexTrianglePillar(E,D,!1),pt.pointToWorldFrame(n,o,t.pillarOffset,f),r.distanceTo(f)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&(R=this.sphereConvex(e,t.pillarConvex,r,f,s,o,a,l,e,t,u)),u&&R||(t.getConvexTrianglePillar(E,D,!0),pt.pointToWorldFrame(n,o,t.pillarOffset,f),r.distanceTo(f)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&(R=this.sphereConvex(e,t.pillarConvex,r,f,s,o,a,l,e,t,u)),u&&R))return!0;if(x.length-F>2)return}}boxHeightfield(e,t,r,n,s,o,a,l,c,d,u){return e.convexPolyhedronRepresentation.material=e.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,this.convexHeightfield(e.convexPolyhedronRepresentation,t,r,n,s,o,a,l,e,t,u)}convexHeightfield(e,t,r,n,s,o,a,l,c,d,u){const h=t.data,p=t.elementSize,g=e.boundingSphereRadius,f=UH,m=jH,b=HH;pt.pointToLocalFrame(n,o,r,b);let y=Math.floor((b.x-g)/p)-1,w=Math.ceil((b.x+g)/p)+1,_=Math.floor((b.y-g)/p)-1,M=Math.ceil((b.y+g)/p)+1;if(w<0||M<0||y>h.length||_>h[0].length)return;y<0&&(y=0),w<0&&(w=0),_<0&&(_=0),M<0&&(M=0),y>=h.length&&(y=h.length-1),w>=h.length&&(w=h.length-1),M>=h[0].length&&(M=h[0].length-1),_>=h[0].length&&(_=h[0].length-1);const S=[];t.getRectMinMax(y,_,w,M,S);const A=S[0],x=S[1];if(!(b.z-g>x||b.z+g<A))for(let E=y;E<w;E++)for(let D=_;D<M;D++){let F=!1;if(t.getConvexTrianglePillar(E,D,!1),pt.pointToWorldFrame(n,o,t.pillarOffset,f),r.distanceTo(f)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&(F=this.convexConvex(e,t.pillarConvex,r,f,s,o,a,l,null,null,u,m,null)),u&&F||(t.getConvexTrianglePillar(E,D,!0),pt.pointToWorldFrame(n,o,t.pillarOffset,f),r.distanceTo(f)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&(F=this.convexConvex(e,t.pillarConvex,r,f,s,o,a,l,null,null,u,m,null)),u&&F))return!0}}sphereParticle(e,t,r,n,s,o,a,l,c,d,u){const h=NH;if(h.set(0,0,1),n.vsub(r,h),h.lengthSquared()<=e.radius*e.radius){if(u)return!0;const p=this.createContactEquation(l,a,t,e,c,d);h.normalize(),p.rj.copy(h),p.rj.scale(e.radius,p.rj),p.ni.copy(h),p.ni.negate(p.ni),p.ri.set(0,0,0),this.result.push(p),this.createFrictionEquationsFromContact(p,this.frictionResult)}}planeParticle(e,t,r,n,s,o,a,l,c,d,u){const h=OH;h.set(0,0,1),a.quaternion.vmult(h,h);const p=FH;if(n.vsub(a.position,p),h.dot(p)<=0){if(u)return!0;const g=this.createContactEquation(l,a,t,e,c,d);g.ni.copy(h),g.ni.negate(g.ni),g.ri.set(0,0,0);const f=zH;h.scale(h.dot(n),f),n.vsub(f,f),g.rj.copy(f),this.result.push(g),this.createFrictionEquationsFromContact(g,this.frictionResult)}}boxParticle(e,t,r,n,s,o,a,l,c,d,u){return e.convexPolyhedronRepresentation.material=e.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,this.convexParticle(e.convexPolyhedronRepresentation,t,r,n,s,o,a,l,e,t,u)}convexParticle(e,t,r,n,s,o,a,l,c,d,u){let h=-1;const p=BH,g=VH;let f=null;const m=$H;if(m.copy(n),m.vsub(r,m),s.conjugate(M0),M0.vmult(m,m),e.pointIsInside(m)){e.worldVerticesNeedsUpdate&&e.computeWorldVertices(r,s),e.worldFaceNormalsNeedsUpdate&&e.computeWorldFaceNormals(s);for(let b=0,y=e.faces.length;b!==y;b++){const w=[e.worldVertices[e.faces[b][0]]],_=e.worldFaceNormals[b];n.vsub(w[0],E0);const M=-_.dot(E0);if(f===null||Math.abs(M)<Math.abs(f)){if(u)return!0;f=M,h=b,p.copy(_)}}if(h!==-1){const b=this.createContactEquation(l,a,t,e,c,d);p.scale(f,g),g.vadd(n,g),g.vsub(r,g),b.rj.copy(g),p.negate(b.ni),b.ri.set(0,0,0);const y=b.ri,w=b.rj;y.vadd(n,y),y.vsub(l.position,y),w.vadd(r,w),w.vsub(a.position,w),this.result.push(b),this.createFrictionEquationsFromContact(b,this.frictionResult)}else console.warn("Point found inside convex, but did not find penetrating face!")}}heightfieldCylinder(e,t,r,n,s,o,a,l,c,d,u){return this.convexHeightfield(t,e,n,r,o,s,l,a,c,d,u)}particleCylinder(e,t,r,n,s,o,a,l,c,d,u){return this.convexParticle(t,e,n,r,o,s,l,a,c,d,u)}sphereTrimesh(e,t,r,n,s,o,a,l,c,d,u){const h=KV,p=JV,g=ZV,f=QV,m=eH,b=tH,y=sH,w=XV,_=qV,M=oH;pt.pointToLocalFrame(n,o,r,m);const S=e.radius;y.lowerBound.set(m.x-S,m.y-S,m.z-S),y.upperBound.set(m.x+S,m.y+S,m.z+S),t.getTrianglesInAABB(y,M);const A=YV,x=e.radius*e.radius;for(let B=0;B<M.length;B++)for(let I=0;I<3;I++)if(t.getVertex(t.indices[M[B]*3+I],A),A.vsub(m,_),_.lengthSquared()<=x){if(w.copy(A),pt.pointToWorldFrame(n,o,w,A),A.vsub(r,_),u)return!0;let V=this.createContactEquation(a,l,e,t,c,d);V.ni.copy(_),V.ni.normalize(),V.ri.copy(V.ni),V.ri.scale(e.radius,V.ri),V.ri.vadd(r,V.ri),V.ri.vsub(a.position,V.ri),V.rj.copy(A),V.rj.vsub(l.position,V.rj),this.result.push(V),this.createFrictionEquationsFromContact(V,this.frictionResult)}for(let B=0;B<M.length;B++)for(let I=0;I<3;I++){t.getVertex(t.indices[M[B]*3+I],h),t.getVertex(t.indices[M[B]*3+(I+1)%3],p),p.vsub(h,g),m.vsub(p,b);const V=b.dot(g);m.vsub(h,b);let N=b.dot(g);if(N>0&&V<0&&(m.vsub(h,b),f.copy(g),f.normalize(),N=b.dot(f),f.scale(N,b),b.vadd(h,b),b.distanceTo(m)<e.radius)){if(u)return!0;const j=this.createContactEquation(a,l,e,t,c,d);b.vsub(m,j.ni),j.ni.normalize(),j.ni.scale(e.radius,j.ri),j.ri.vadd(r,j.ri),j.ri.vsub(a.position,j.ri),pt.pointToWorldFrame(n,o,b,b),b.vsub(l.position,j.rj),pt.vectorToWorldFrame(o,j.ni,j.ni),pt.vectorToWorldFrame(o,j.ri,j.ri),this.result.push(j),this.createFrictionEquationsFromContact(j,this.frictionResult)}}const E=iH,D=rH,F=nH,R=GV;for(let B=0,I=M.length;B!==I;B++){t.getTriangleVertices(M[B],E,D,F),t.getNormal(M[B],R),m.vsub(E,b);let V=b.dot(R);if(R.scale(V,b),m.vsub(b,b),V=b.distanceTo(m),Lt.pointInTriangle(b,E,D,F)&&V<e.radius){if(u)return!0;let N=this.createContactEquation(a,l,e,t,c,d);b.vsub(m,N.ni),N.ni.normalize(),N.ni.scale(e.radius,N.ri),N.ri.vadd(r,N.ri),N.ri.vsub(a.position,N.ri),pt.pointToWorldFrame(n,o,b,b),b.vsub(l.position,N.rj),pt.vectorToWorldFrame(o,N.ni,N.ni),pt.vectorToWorldFrame(o,N.ri,N.ri),this.result.push(N),this.createFrictionEquationsFromContact(N,this.frictionResult)}}M.length=0}planeTrimesh(e,t,r,n,s,o,a,l,c,d,u){const h=new k,p=UV;p.set(0,0,1),s.vmult(p,p);for(let g=0;g<t.vertices.length/3;g++){t.getVertex(g,h);const f=new k;f.copy(h),pt.pointToWorldFrame(n,o,f,h);const m=jV;if(h.vsub(r,m),p.dot(m)<=0){if(u)return!0;const b=this.createContactEquation(a,l,e,t,c,d);b.ni.copy(p);const y=WV;p.scale(m.dot(p),y),h.vsub(y,y),b.ri.copy(y),b.ri.vsub(a.position,b.ri),b.rj.copy(h),b.rj.vsub(l.position,b.rj),this.result.push(b),this.createFrictionEquationsFromContact(b,this.frictionResult)}}}}const zn=new k,zs=new k,Ns=new k,$V=new k,BV=new k,VV=new Dt,HV=new Dt,UV=new k,jV=new k,WV=new k,GV=new k,qV=new k;new k;const YV=new k,XV=new k,KV=new k,JV=new k,ZV=new k,QV=new k,eH=new k,tH=new k,iH=new k,rH=new k,nH=new k,sH=new bi,oH=[],zl=new k,S0=new k,aH=new k,lH=new k,cH=new k;function dH(i,e,t){let r=null;const n=i.length;for(let s=0;s!==n;s++){const o=i[s],a=aH;i[(s+1)%n].vsub(o,a);const l=lH;a.cross(e,l);const c=cH;t.vsub(o,c);const d=l.dot(c);if(r===null||d>0&&r===!0||d<=0&&r===!1){r===null&&(r=d>0);continue}else return!1}return!0}const Nl=new k,uH=new k,hH=new k,fH=new k,pH=[new k,new k,new k,new k,new k,new k],mH=new k,gH=new k,vH=new k,bH=new k,yH=new k,_H=new k,wH=new k,xH=new k,SH=new k,MH=new k,EH=new k,kH=new k,CH=new k,TH=new k;new k;new k;const AH=new k,LH=new k,DH=new k,PH=new k,RH=new k,IH=new k,OH=new k,FH=new k,zH=new k,NH=new k,M0=new Dt,$H=new k;new k;const BH=new k,E0=new k,VH=new k,HH=new k,UH=new k,jH=[0],WH=new k,GH=new k;class k0{constructor(){this.current=[],this.previous=[]}getKey(e,t){if(t<e){const r=t;t=e,e=r}return e<<16|t}set(e,t){const r=this.getKey(e,t),n=this.current;let s=0;for(;r>n[s];)s++;if(r!==n[s]){for(let o=n.length-1;o>=s;o--)n[o+1]=n[o];n[s]=r}}tick(){const e=this.current;this.current=this.previous,this.previous=e,this.current.length=0}getDiff(e,t){const r=this.current,n=this.previous,s=r.length,o=n.length;let a=0;for(let l=0;l<s;l++){let c=!1;const d=r[l];for(;d>n[a];)a++;c=d===n[a],c||C0(e,d)}a=0;for(let l=0;l<o;l++){let c=!1;const d=n[l];for(;d>r[a];)a++;c=r[a]===d,c||C0(t,d)}}}function C0(i,e){i.push((e&4294901760)>>16,e&65535)}const ku=(i,e)=>i<e?`${i}-${e}`:`${e}-${i}`;class qH{constructor(){this.data={keys:[]}}get(e,t){const r=ku(e,t);return this.data[r]}set(e,t,r){const n=ku(e,t);this.get(e,t)||this.data.keys.push(n),this.data[n]=r}delete(e,t){const r=ku(e,t),n=this.data.keys.indexOf(r);n!==-1&&this.data.keys.splice(n,1),delete this.data[r]}reset(){const e=this.data,t=e.keys;for(;t.length>0;){const r=t.pop();delete e[r]}}}class YH extends c_{constructor(e){e===void 0&&(e={}),super(),this.dt=-1,this.allowSleep=!!e.allowSleep,this.contacts=[],this.frictionEquations=[],this.quatNormalizeSkip=e.quatNormalizeSkip!==void 0?e.quatNormalizeSkip:0,this.quatNormalizeFast=e.quatNormalizeFast!==void 0?e.quatNormalizeFast:!1,this.time=0,this.stepnumber=0,this.default_dt=1/60,this.nextId=0,this.gravity=new k,e.gravity&&this.gravity.copy(e.gravity),e.frictionGravity&&(this.frictionGravity=new k,this.frictionGravity.copy(e.frictionGravity)),this.broadphase=e.broadphase!==void 0?e.broadphase:new d_,this.bodies=[],this.hasActiveBodies=!1,this.solver=e.solver!==void 0?e.solver:new PV,this.constraints=[],this.narrowphase=new NV(this),this.collisionMatrix=new h0,this.collisionMatrixPrevious=new h0,this.bodyOverlapKeeper=new k0,this.shapeOverlapKeeper=new k0,this.contactmaterials=[],this.contactMaterialTable=new qH,this.defaultMaterial=new ns("default"),this.defaultContactMaterial=new rs(this.defaultMaterial,this.defaultMaterial,{friction:.3,restitution:0}),this.doProfiling=!1,this.profile={solve:0,makeContactConstraints:0,broadphase:0,integrate:0,narrowphase:0},this.accumulator=0,this.subsystems=[],this.addBodyEvent={type:"addBody",body:null},this.removeBodyEvent={type:"removeBody",body:null},this.idToBodyMap={},this.broadphase.setWorld(this)}getContactMaterial(e,t){return this.contactMaterialTable.get(e.id,t.id)}collisionMatrixTick(){const e=this.collisionMatrixPrevious;this.collisionMatrixPrevious=this.collisionMatrix,this.collisionMatrix=e,this.collisionMatrix.reset(),this.bodyOverlapKeeper.tick(),this.shapeOverlapKeeper.tick()}addConstraint(e){this.constraints.push(e)}removeConstraint(e){const t=this.constraints.indexOf(e);t!==-1&&this.constraints.splice(t,1)}rayTest(e,t,r){r instanceof Hc?this.raycastClosest(e,t,{skipBackfaces:!0},r):this.raycastAll(e,t,{skipBackfaces:!0},r)}raycastAll(e,t,r,n){return r===void 0&&(r={}),r.mode=Lt.ALL,r.from=e,r.to=t,r.callback=n,Cu.intersectWorld(this,r)}raycastAny(e,t,r,n){return r===void 0&&(r={}),r.mode=Lt.ANY,r.from=e,r.to=t,r.result=n,Cu.intersectWorld(this,r)}raycastClosest(e,t,r,n){return r===void 0&&(r={}),r.mode=Lt.CLOSEST,r.from=e,r.to=t,r.result=n,Cu.intersectWorld(this,r)}addBody(e){this.bodies.includes(e)||(e.index=this.bodies.length,this.bodies.push(e),e.world=this,e.initPosition.copy(e.position),e.initVelocity.copy(e.velocity),e.timeLastSleepy=this.time,e instanceof Ae&&(e.initAngularVelocity.copy(e.angularVelocity),e.initQuaternion.copy(e.quaternion)),this.collisionMatrix.setNumObjects(this.bodies.length),this.addBodyEvent.body=e,this.idToBodyMap[e.id]=e,this.dispatchEvent(this.addBodyEvent))}removeBody(e){e.world=null;const t=this.bodies.length-1,r=this.bodies,n=r.indexOf(e);if(n!==-1){r.splice(n,1);for(let s=0;s!==r.length;s++)r[s].index=s;this.collisionMatrix.setNumObjects(t),this.removeBodyEvent.body=e,delete this.idToBodyMap[e.id],this.dispatchEvent(this.removeBodyEvent)}}getBodyById(e){return this.idToBodyMap[e]}getShapeById(e){const t=this.bodies;for(let r=0;r<t.length;r++){const n=t[r].shapes;for(let s=0;s<n.length;s++){const o=n[s];if(o.id===e)return o}}return null}addContactMaterial(e){this.contactmaterials.push(e),this.contactMaterialTable.set(e.materials[0].id,e.materials[1].id,e)}removeContactMaterial(e){const t=this.contactmaterials.indexOf(e);t!==-1&&(this.contactmaterials.splice(t,1),this.contactMaterialTable.delete(e.materials[0].id,e.materials[1].id))}fixedStep(e,t){e===void 0&&(e=1/60),t===void 0&&(t=10);const r=It.now()/1e3;if(!this.lastCallTime)this.step(e,void 0,t);else{const n=r-this.lastCallTime;this.step(e,n,t)}this.lastCallTime=r}step(e,t,r){if(r===void 0&&(r=10),t===void 0)this.internalStep(e),this.time+=e;else{this.accumulator+=t;const n=It.now();let s=0;for(;this.accumulator>=e&&s<r&&(this.internalStep(e),this.accumulator-=e,s++,!(It.now()-n>e*1e3)););this.accumulator=this.accumulator%e;const o=this.accumulator/e;for(let a=0;a!==this.bodies.length;a++){const l=this.bodies[a];l.previousPosition.lerp(l.position,o,l.interpolatedPosition),l.previousQuaternion.slerp(l.quaternion,o,l.interpolatedQuaternion),l.previousQuaternion.normalize()}this.time+=t}}internalStep(e){this.dt=e;const t=this.contacts,r=QH,n=e9,s=this.bodies.length,o=this.bodies,a=this.solver,l=this.gravity,c=this.doProfiling,d=this.profile,u=Ae.DYNAMIC;let h=-1/0;const p=this.constraints,g=ZH;l.length();const f=l.x,m=l.y,b=l.z;let y=0;for(c&&(h=It.now()),y=0;y!==s;y++){const R=o[y];if(R.type===u){const B=R.force,I=R.mass;B.x+=I*f,B.y+=I*m,B.z+=I*b}}for(let R=0,B=this.subsystems.length;R!==B;R++)this.subsystems[R].update();c&&(h=It.now()),r.length=0,n.length=0,this.broadphase.collisionPairs(this,r,n),c&&(d.broadphase=It.now()-h);let w=p.length;for(y=0;y!==w;y++){const R=p[y];if(!R.collideConnected)for(let B=r.length-1;B>=0;B-=1)(R.bodyA===r[B]&&R.bodyB===n[B]||R.bodyB===r[B]&&R.bodyA===n[B])&&(r.splice(B,1),n.splice(B,1))}this.collisionMatrixTick(),c&&(h=It.now());const _=JH,M=t.length;for(y=0;y!==M;y++)_.push(t[y]);t.length=0;const S=this.frictionEquations.length;for(y=0;y!==S;y++)g.push(this.frictionEquations[y]);for(this.frictionEquations.length=0,this.narrowphase.getContacts(r,n,this,t,_,this.frictionEquations,g),c&&(d.narrowphase=It.now()-h),c&&(h=It.now()),y=0;y<this.frictionEquations.length;y++)a.addEquation(this.frictionEquations[y]);const A=t.length;for(let R=0;R!==A;R++){const B=t[R],I=B.bi,V=B.bj,N=B.si,j=B.sj;let Y;if(I.material&&V.material?Y=this.getContactMaterial(I.material,V.material)||this.defaultContactMaterial:Y=this.defaultContactMaterial,Y.friction,I.material&&V.material&&(I.material.friction>=0&&V.material.friction>=0&&I.material.friction*V.material.friction,I.material.restitution>=0&&V.material.restitution>=0&&(B.restitution=I.material.restitution*V.material.restitution)),a.addEquation(B),I.allowSleep&&I.type===Ae.DYNAMIC&&I.sleepState===Ae.SLEEPING&&V.sleepState===Ae.AWAKE&&V.type!==Ae.STATIC){const W=V.velocity.lengthSquared()+V.angularVelocity.lengthSquared(),ee=V.sleepSpeedLimit**2;W>=ee*2&&(I.wakeUpAfterNarrowphase=!0)}if(V.allowSleep&&V.type===Ae.DYNAMIC&&V.sleepState===Ae.SLEEPING&&I.sleepState===Ae.AWAKE&&I.type!==Ae.STATIC){const W=I.velocity.lengthSquared()+I.angularVelocity.lengthSquared(),ee=I.sleepSpeedLimit**2;W>=ee*2&&(V.wakeUpAfterNarrowphase=!0)}this.collisionMatrix.set(I,V,!0),this.collisionMatrixPrevious.get(I,V)||(Fo.body=V,Fo.contact=B,I.dispatchEvent(Fo),Fo.body=I,V.dispatchEvent(Fo)),this.bodyOverlapKeeper.set(I.id,V.id),this.shapeOverlapKeeper.set(N.id,j.id)}for(this.emitContactEvents(),c&&(d.makeContactConstraints=It.now()-h,h=It.now()),y=0;y!==s;y++){const R=o[y];R.wakeUpAfterNarrowphase&&(R.wakeUp(),R.wakeUpAfterNarrowphase=!1)}for(w=p.length,y=0;y!==w;y++){const R=p[y];R.update();for(let B=0,I=R.equations.length;B!==I;B++){const V=R.equations[B];a.addEquation(V)}}a.solve(e,this),c&&(d.solve=It.now()-h),a.removeAllEquations();const x=Math.pow;for(y=0;y!==s;y++){const R=o[y];if(R.type&u){const B=x(1-R.linearDamping,e),I=R.velocity;I.scale(B,I);const V=R.angularVelocity;if(V){const N=x(1-R.angularDamping,e);V.scale(N,V)}}}this.dispatchEvent(KH),c&&(h=It.now());const E=this.stepnumber%(this.quatNormalizeSkip+1)===0,D=this.quatNormalizeFast;for(y=0;y!==s;y++)o[y].integrate(e,E,D);this.clearForces(),this.broadphase.dirty=!0,c&&(d.integrate=It.now()-h),this.stepnumber+=1,this.dispatchEvent(XH);let F=!0;if(this.allowSleep)for(F=!1,y=0;y!==s;y++){const R=o[y];R.sleepTick(this.time),R.sleepState!==Ae.SLEEPING&&(F=!0)}this.hasActiveBodies=F}emitContactEvents(){const e=this.hasAnyEventListener("beginContact"),t=this.hasAnyEventListener("endContact");if((e||t)&&this.bodyOverlapKeeper.getDiff(yr,_r),e){for(let s=0,o=yr.length;s<o;s+=2)zo.bodyA=this.getBodyById(yr[s]),zo.bodyB=this.getBodyById(yr[s+1]),this.dispatchEvent(zo);zo.bodyA=zo.bodyB=null}if(t){for(let s=0,o=_r.length;s<o;s+=2)No.bodyA=this.getBodyById(_r[s]),No.bodyB=this.getBodyById(_r[s+1]),this.dispatchEvent(No);No.bodyA=No.bodyB=null}yr.length=_r.length=0;const r=this.hasAnyEventListener("beginShapeContact"),n=this.hasAnyEventListener("endShapeContact");if((r||n)&&this.shapeOverlapKeeper.getDiff(yr,_r),r){for(let s=0,o=yr.length;s<o;s+=2){const a=this.getShapeById(yr[s]),l=this.getShapeById(yr[s+1]);wr.shapeA=a,wr.shapeB=l,a&&(wr.bodyA=a.body),l&&(wr.bodyB=l.body),this.dispatchEvent(wr)}wr.bodyA=wr.bodyB=wr.shapeA=wr.shapeB=null}if(n){for(let s=0,o=_r.length;s<o;s+=2){const a=this.getShapeById(_r[s]),l=this.getShapeById(_r[s+1]);xr.shapeA=a,xr.shapeB=l,a&&(xr.bodyA=a.body),l&&(xr.bodyB=l.body),this.dispatchEvent(xr)}xr.bodyA=xr.bodyB=xr.shapeA=xr.shapeB=null}}clearForces(){const e=this.bodies,t=e.length;for(let r=0;r!==t;r++){const n=e[r];n.force,n.torque,n.force.set(0,0,0),n.torque.set(0,0,0)}}}new bi;const Cu=new Lt,It=globalThis.performance||{};if(!It.now){let i=Date.now();It.timing&&It.timing.navigationStart&&(i=It.timing.navigationStart),It.now=()=>Date.now()-i}new k;const XH={type:"postStep"},KH={type:"preStep"},Fo={type:Ae.COLLIDE_EVENT_NAME,body:null,contact:null},JH=[],ZH=[],QH=[],e9=[],yr=[],_r=[],zo={type:"beginContact",bodyA:null,bodyB:null},No={type:"endContact",bodyA:null,bodyB:null},wr={type:"beginShapeContact",bodyA:null,bodyB:null,shapeA:null,shapeB:null},xr={type:"endShapeContact",bodyA:null,bodyB:null,shapeA:null,shapeB:null};class T0{constructor(e){typeof e=="object"&&(e=e.notation),this.set=[],this.setkeys=[],this.setid=0,this.groups=[],this.totalDice=0,this.op="",this.constant=null,this.result=[],this.error=!1,this.boost=1,this.notation="",this.vectors=[],(!e||e=="0")&&(this.error=!0),this.parseNotation(e)}parseNotation(e){if(e){let h=e.split("!").length-1||0;h>0&&(this.boost=Math.min(Math.max(h,0),3)*4),e=e.split("!").join(""),e=e.split(" ").join("");let p=e.split("(").length-1,g=e.split(")").length-1;p!=g&&(this.error=!0)}const t=this.notation.length>0?"+":"";this.notation+=t+e;let r=e.split("@"),n=r[0],s=new RegExp(/(\+|\-|\*|\/|\%|\^|){0,1}()(\d*)([a-z]+\d+|[a-z]+|)(?:\{([a-z]+)(.*?|)\}|)()/,"i"),o=new RegExp(/(\b)*(\-\d+|\d+)(\b)*/,"gi"),a,l=0,c=30,d=0,u=0;for(;!this.error&&n.length>0&&(a=s.exec(n))!==null&&l<c;){l++,n=n.substring(a[0].length);let h=a[1],p=a[2]&&a[2].length>0,g=a[3],f=a[4],m=a[5]||"",b=a[6]||"",y=a[7]&&a[7].length>0,w=!0;p&&(d+=a[2].length),b=b.split(","),(!b||b.length<1)&&(b=""),b.shift(),l==1&&n.length==0&&!f&&h&&g?(f="d20",this.op=h,this.constant=parseInt(g),g=1):l>1&&n.length==0&&!f&&(this.op=h,this.constant=parseInt(g),w=!1),w&&this.addSet(g,f,u,d,m,b,h),y&&(d-=a[7].length,u+=a[7].length)}!this.error&&r[1]&&(a=r[1].match(o))!==null&&this.result.push(...a)}stringify(e=!0){let t="";if(this.set.length<1)return t;for(let r=0;r<this.set.length;r++){let n=this.set[r];t+=r>0&&n.op?n.op:"",t+=n.num+n.type,n.func&&(t+="{",t+=n.func?n.func:"",t+=n.args?","+(Array.isArray(n.args)?n.args.join(","):n.args):"",t+="}")}return t+=this.constant?this.op+""+Math.abs(this.constant):"",e&&this.result&&this.result.length>0&&(t+="@"+this.result.join(",")),this.boost>1&&(t+="!".repeat(this.boost/4)),t}addSet(e,t,r=0,n=0,s="",o="",a="+"){e=Math.abs(parseInt(e||1));let l=a+""+t+r+n+s+o,c=this.setkeys[l]!=null,d={};c&&(d=this.set[this.setkeys[l]-1]),e>0&&(d.num=c?e+d.num:e,d.type=t,d.sid=this.setid,d.gid=r,d.glvl=n,s&&(d.func=s),o&&(d.args=o),a&&(d.op=a),c?this.set[this.setkeys[l]-1]=d:this.setkeys[l]=this.set.push(d)),c||++this.setid}static mergeNotation(e,t){return{...e,constant:e.constant+t.constant,notation:e.notation+"+"+t.notation,set:[...e.set,...t.set],totalDice:e.vectors.length+t.vectors.length,vectors:[...e.vectors,...t.vectors]}}}const Tu={d2:{name:"d2",labels:["1","2"],values:[1,2],inertia:8,mass:400,scale:.9,system:"dweird"},dc:{type:"d2",name:"Coin",labels:["textures/silvercoin/tail.png","textures/silvercoin/heads.png"],setBumpMaps:["textures/silvercoin/tail_bump.png","textures/silvercoin/heads_bump.png"],values:[0,1],inertia:8,mass:400,scale:.9,colorset:"coin_silver"},d1:{name:"One-sided Dice",type:"d6",labels:["1"],values:[1,1],scale:.9,system:"dweird"},d3:{name:"Three-Sided Dice",type:"d6",labels:["1","2","3"],values:[1,3],scale:.9,system:"dweird"},df:{name:"Fudge Dice",type:"d6",labels:["-","0","+"],values:[-1,1],scale:.9,system:"dweird"},d4:{name:"Four-Sided Dice",labels:["1","2","3","4"],values:[1,4],inertia:5,scale:1.2},d6:{name:"Six-Sided Dice (Numbers)",labels:["1","2","3","4","5","6"],values:[1,6],scale:.9},dpip:{name:"Six-Sided Dice (Pips)",type:"d6",labels:[`   
 ⬤ 
   `,`⬤  
   
  ⬤`,`⬤  
 ⬤ 
  ⬤`,`⬤ ⬤
   
⬤ ⬤`,`⬤ ⬤
 ⬤ 
⬤ ⬤`,`⬤ ⬤
⬤ ⬤
⬤ ⬤`],values:[1,6],scale:.9,font:"monospace"},dsex:{name:"Sex-Sided Emoji Dice",type:"d6",labels:["🍆","🍑","👌","💦","🙏","💥"],values:[1,6],scale:.9,display:"labels",system:"dweird"},dpoker:{name:"Poker Dice (9-Ace)",type:"d6",labels:["A","9","10","J","Q","K"],values:[1,6],scale:.9,display:"labels",system:"dweird",font:"Times New Roman"},dspanpoker:{name:"Spanish Poker Dice (7-Ace)",type:"d8",labels:["A","7","8","9","10","J","Q","K"],values:[1,8],display:"labels",system:"dweird",font:"Times New Roman"},disotope:{name:"Radioactive Twelve-Sided Dice",type:"d12",labels:["","","","","","","","","","","","☢️"],values:[0,0,0,0,0,0,0,0,0,0,0,1],mass:350,inertia:8,scale:.9,system:"dweird"},dsuit:{name:"Four-Suited Dice",type:"d4",labels:["♠️","♥️","♦️","♣️"],values:[1,4],inertia:5,scale:1.2,display:"labels",system:"dweird"},d8:{name:"Eight-Sided Dice",labels:["1","2","3","4","5","6","7","8"],values:[1,8]},d10:{name:"Ten-Sided Dice (Single Digit)",labels:["1","2","3","4","5","6","7","8","9","0"],values:[1,10],mass:350,inertia:9,scale:.9},d100:{name:"Ten-Sided Dice (Tens Digit)",type:"d10",labels:["10","20","30","40","50","60","70","80","90","00"],values:[10,100,10],mass:350,inertia:9,scale:.9},d12:{name:"Twelve-Sided Dice",labels:["1","2","3","4","5","6","7","8","9","10","11","12"],values:[1,12],mass:350,inertia:8,scale:.9},d20:{name:"Twenty-Sided Dice",labels:["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20"],values:[1,20],mass:400,inertia:6},dabi:{name:"Star Wars RPG: Ability Dice",type:"d8",labels:["s","a",`s
a`,`s
s`,"a","s",`a
a`,""],values:[1,8],font:"SWRPG-Symbol-Regular",color:"#00FF00",colorset:"swrpg_abi",display:"labels",system:"swrpg"},ddif:{name:"Star Wars RPG: Difficulty Dice",type:"d8",labels:["t","f",`f
t`,"t","",`t
t`,`f
f`,"t"],values:[1,8],font:"SWRPG-Symbol-Regular",color:"#8000FC",colorset:"swrpg_dif",display:"labels",system:"swrpg"},dpro:{name:"Star Wars RPG: Proficiency Dice",type:"d12",labels:[`a
a`,"a",`a
a`,"x","s",`s
a`,"s",`s
a`,`s
s`,`s
a`,`s
s`,""],values:[1,12],mass:350,inertia:8,scale:.9,font:"SWRPG-Symbol-Regular",color:"#FFFF00",colorset:"swrpg_pro",display:"labels",system:"swrpg"},dcha:{name:"Star Wars RPG: Challenge Dice",type:"d12",labels:[`t
t`,"t",`t
t`,"t",`t
f`,"f",`t
f`,"f",`f
f`,"y",`f
f`,""],values:[1,12],mass:350,inertia:8,scale:.9,font:"SWRPG-Symbol-Regular",color:"#FF0000",colorset:"swrpg_cha",display:"labels",system:"swrpg"},dfor:{name:"Star Wars RPG: Force Dice",type:"d12",labels:["z",`Z
Z`,"z",`Z
Z`,"z",`Z
Z`,"z","Z","z","Z","z",`z
z`],values:[1,12],mass:350,inertia:8,scale:.9,font:"SWRPG-Symbol-Regular",color:"#FFFFFF",colorset:"swrpg_for",display:"labels",system:"swrpg"},dboo:{name:"Star Wars RPG: Boost Dice",type:"d6",labels:[`s  
  a`,`a  
  a`,"s","a","",""],values:[1,6],scale:.9,font:"SWRPG-Symbol-Regular",color:"#00FFFF",colorset:"swrpg_boo",display:"labels",system:"swrpg"},dset:{name:"Star Wars RPG: Setback Dice",type:"d6",labels:["","t","f"],values:[1,3],scale:.9,font:"SWRPG-Symbol-Regular",color:"#111111",colorset:"swrpg_set",display:"labels",system:"swrpg"},swar:{name:"Star Wars Armada: Red Attack Dice",type:"d8",labels:["F","F",`F
F`,"E","E","G","",""],values:[1,8],font:"Armada-Symbol-Regular",color:"#FF0000",colorset:"swa_red",display:"labels",system:"swarmada"},swab:{name:"Star Wars Armada: Blue Attack Dice",type:"d8",labels:["F","F","F","F","E","E","G","G"],values:[1,8],font:"Armada-Symbol-Regular",color:"#0000FF",colorset:"swa_blue",display:"labels",system:"swarmada"},swak:{name:"Star Wars Armada: Black Attack Dice",type:"d8",labels:["F","F","F","F",`F
E`,`F
E`,"",""],values:[1,8],font:"Armada-Symbol-Regular",color:"#111111",colorset:"swa_black",display:"labels",system:"swarmada"},xwatk:{name:"Star Wars X-Wing: Red Attack Dice",type:"d8",labels:["c","d","d","d","f","f","",""],values:[1,8],font:"XWing-Symbol-Regular",color:"#FF0000",colorset:"xwing_red",display:"labels",system:"xwing"},xwdef:{name:"Star Wars X-Wing: Green Defense Dice",type:"d8",labels:["e","e","e","f","f","","",""],values:[1,8],font:"XWing-Symbol-Regular",color:"#00FF00",colorset:"xwing_green",display:"labels",system:"xwing"},swlar:{name:"Star Wars Legion: Red Attack Dice",type:"d8",labels:["h","h","h","h","h","c","o",""],values:[1,8],font:"Legion-Symbol-Regular",color:"#FF0000",colorset:"swl_atkred",display:"labels",system:"legion"},swlab:{name:"Star Wars Legion: Black Attack Dice",type:"d8",labels:["h","h","h","","","c","o",""],values:[1,8],font:"Legion-Symbol-Regular",color:"#111111",colorset:"swl_atkblack",display:"labels",system:"legion"},swlaw:{name:"Star Wars Legion: White Attack Dice",type:"d8",labels:["h","","","","","c","o",""],values:[1,8],font:"Legion-Symbol-Regular",color:"#FFFFFF",colorset:"swl_atkwhite",display:"labels",system:"legion"},swldr:{name:"Star Wars Legion: Red Defense Dice",type:"d6",labels:["s","s","s","d","",""],values:[1,6],scale:.9,font:"Legion-Symbol-Regular",color:"#FF0000",colorset:"swl_defred",display:"labels",system:"legion"},swldw:{name:"Star Wars Legion: White Defense Dice",type:"d6",labels:["s","","","d","",""],values:[1,6],scale:.9,font:"Legion-Symbol-Regular",color:"#FFFFFF",colorset:"swl_defwhite",display:"labels",system:"legion"}},Si={d4:{vertices:[[1,1,1],[-1,-1,1],[-1,1,-1],[1,-1,-1]],faces:[[1,0,2,1],[0,1,3,2],[0,3,2,3],[1,2,3,4]]},d6:{vertices:[[-1,-1,-1],[1,-1,-1],[1,1,-1],[-1,1,-1],[-1,-1,1],[1,-1,1],[1,1,1],[-1,1,1]],faces:[[0,3,2,1,1],[1,2,6,5,2],[0,1,5,4,3],[3,7,6,2,4],[0,4,7,3,5],[4,5,6,7,6]]},d8:{vertices:[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],faces:[[0,2,4,1],[0,4,3,2],[0,3,5,3],[0,5,2,4],[1,3,4,5],[1,4,2,6],[1,2,5,7],[1,5,3,8]]},d10:{vertices:[[1,0,-.105],[.809,.5877,.105],[.309,.951,-.105],[-.309,.951,.105],[-.809,.5877,-.105],[-1,0,.105],[-.809,-.587,-.105],[-.309,-.951,.105],[.309,-.951,-.105],[.809,-.5877,.105],[0,0,-1],[0,0,1]],faces:[[5,6,7,11,0],[4,3,2,10,1],[1,2,3,11,2],[0,9,8,10,3],[7,8,9,11,4],[8,7,6,10,5],[9,0,1,11,6],[2,1,0,10,7],[3,4,5,11,8],[6,5,4,10,9]]},d12:{vertices:[[0,.618,1.618],[0,.618,-1.618],[0,-.618,1.618],[0,-.618,-1.618],[1.618,0,.618],[1.618,0,-.618],[-1.618,0,.618],[-1.618,0,-.618],[.618,1.618,0],[.618,-1.618,0],[-.618,1.618,0],[-.618,-1.618,0],[1,1,1],[1,1,-1],[1,-1,1],[1,-1,-1],[-1,1,1],[-1,1,-1],[-1,-1,1],[-1,-1,-1]],faces:[[2,14,4,12,0,1],[15,9,11,19,3,2],[16,10,17,7,6,3],[6,7,19,11,18,4],[6,18,2,0,16,5],[18,11,9,14,2,6],[1,17,10,8,13,7],[1,13,5,15,3,8],[13,8,12,4,5,9],[5,4,14,9,15,10],[0,12,8,10,16,11],[3,19,7,17,1,12]]},d20:{vertices:[[-1,1.618,0],[1,1.618,0],[-1,-1.618,0],[1,-1.618,0],[0,-1,1.618],[0,1,1.618],[0,-1,-1.618],[0,1,-1.618],[1.618,0,-1],[1.618,0,1],[-1.618,0,-1],[-1.618,0,1]],faces:[[0,11,5,1],[0,5,1,2],[0,1,7,3],[0,7,10,4],[0,10,11,5],[1,5,9,6],[5,11,4,7],[11,10,2,8],[10,7,6,9],[7,1,8,10],[3,9,4,11],[3,4,2,12],[3,2,6,13],[3,6,8,14],[3,8,9,15],[4,9,5,16],[2,4,11,17],[6,2,10,18],[8,6,7,19],[9,8,1,20]]}},t9={name:"",scale:1,font:"Arial",color:"",labels:[],valueMap:[],values:[],normals:[],mass:300,inertia:13,geometry:null,display:"values",system:"d20"};class i9{constructor(e){if(!Tu.hasOwnProperty(e))return console.error("dice type unavailable");Object.assign(this,t9,Tu[e]),this.shape=Tu[e].type||e,this.type=e,this.setLabels(this.labels),this.setValues(this.values[0],this.values[1],this.values[2]),this.setValueMap(this.valueMap),this.bumpMaps&&this.setBumpMaps(this.bumpMaps)}setValues(e=1,t=20,r=1){this.values=this.range(e,t,r)}setValueMap(e){for(let t=0;t<this.values.length;t++){let r=this.values[t];e[r]!=null&&(this.valueMap[r]=e[r])}}registerFaces(e,t="labels"){let r;if(t=="labels"?r=this.labels:r=this.normals,r.unshift(""),["d2","d10"].includes(this.shape)||r.unshift(""),this.shape=="d4"){let n=e[0],s=e[1],o=e[2],a=e[3];this.labels=[[[],[0,0,0],[s,a,o],[n,o,a],[s,n,a],[n,s,o]],[[],[0,0,0],[s,o,a],[o,n,a],[s,a,n],[o,s,n]],[[],[0,0,0],[a,o,s],[o,a,n],[a,s,n],[o,n,s]],[[],[0,0,0],[a,s,o],[n,a,o],[a,n,s],[n,o,s]]]}else Array.prototype.push.apply(r,e)}setLabels(e){this.loadTextures(e,this.registerFaces.bind(this),"labels")}setBumpMaps(e){this.loadTextures(e,this.registerFaces.bind(this),"bump")}loadTextures(e,t,r){let n=0,s=e.length,o=/\.(PNG|JPG|GIF|WEBP)$/i,a=Array(e.length),l=!1;for(let c=0;c<s;c++){if(e[c]==""||!e[c].match(o)){a[c]=e[c],++n;continue}l=!0,a[c]=new Image,a[c].onload=function(){++n>=s&&t(a,r)},a[c].src=e[c]}l||t(a,r)}range(e,t,r=1){for(var n=[e],s=e;s<t;)n.push(s+=r||1);return n}}const r9={none:{name:"Plastic"},perfectmetal:{name:"Perfect Metal",color:14540253,roughness:0,metalness:1,envMapIntensity:1},metal:{name:"Metal",color:14540253,roughness:.5,metalness:.6,envMapIntensity:1},wood:{name:"Wood",color:14540253,roughness:.9,metalness:0,envMapIntensity:1},glass:{name:"Glass",color:14540253,roughness:.1,metalness:0,envMapIntensity:1}},n9={baseScale:100,bumpMapping:!0},Uo=class{constructor(i){this.geometries={},this.materials_cache={},this.cache_hits=0,this.cache_misses=0,this.label_color="",this.dice_color="",this.edge_color="",this.label_outline="",this.dice_texture="",this.dice_material="",this.material_options={specular:16777215,color:11908533,shininess:5,flatShading:!0},Object.assign(this,n9,i)}updateConfig(i={}){Object.assign(this,i),i.scale&&this.scaleGeometry()}setBumpMapping(i){this.bumpMapping=i,this.materials_cache={}}create(i){let e=this.get(i);if(!e)return null;let t=this.geometries[i];if(t||(t=this.createGeometry(e.shape,e.scale*this.baseScale),this.geometries[i]=t),!t)return null;this.setMaterialInfo();let r=new Qi(t,this.createMaterials(e,this.baseScale/2,1));switch(r.result=[],r.shape=e.shape,r.rerolls=0,r.resultReason="natural",r.mass=e.mass,r.getFaceValue=function(){let n=this.resultReason,s=new J(0,0,this.shape=="d4"?-1:1),o,a=Math.PI*2,l=this.geometry.getAttribute("normal").array;for(let g=0,f=this.geometry.groups.length;g<f;++g){let m=this.geometry.groups[g];if(m.materialIndex==0)continue;let b=g*9,y=new J(l[b],l[b+1],l[b+2]).clone().applyQuaternion(this.body.quaternion).angleTo(s);y<a&&(a=y,o=m)}let c=o.materialIndex-1,d=2;const u=Uo.dice[this.notation.type];if(this.shape=="d4"){let g=c-1==0?5:c;return{value:c,label:u.labels[c-1][g][0],reason:n}}["d10","d2"].includes(this.shape)&&(c+=1,d-=1);let h=u.values[(c-1)%u.values.length],p=u.labels[(c-1)%(u.labels.length-2)+d];return{value:h,label:p,reason:n}},r.storeRolledValue=function(n){this.resultReason=n||this.resultReason,this.result.push(this.getFaceValue())},r.getLastValue=function(){return!this.result||this.result.length<1?{value:void 0,label:"",reason:""}:this.result[this.result.length-1]},r.ignoreLastValue=function(n){let s=this.getLastValue();s.value!==void 0&&(s.ignore=n,this.setLastValue(s))},r.setLastValue=function(n){if(!(!this.result||this.result.length<1)&&!(!n||n.length<1))return this.result[this.result.length-1]=n},e.color&&(r.material[0].color=new ot(e.color),r.material[0].emissive=new ot(e.color),r.material[0].emissiveIntensity=1,r.material[0].needsUpdate=!0),e.values.length){case 1:return this.fixmaterials(r,1);case 2:return this.fixmaterials(r,2);case 3:return this.fixmaterials(r,3);default:return r}}get(i){let e;return Uo.dice.hasOwnProperty(i)?e=Uo.dice[i]:(e=new i9(i),Uo.dice[i]=e),e}getGeometry(i){return this.geometries[i]}scaleGeometry(){}createMaterials(i,e,t,r=!0,n=0){let s=[],o=i.labels;i.shape=="d4"&&(o=i.labels[n],e=this.baseScale/2,t=this.baseScale*2);for(var a=0;a<o.length;++a){var l;this.dice_material!="none"?(l=new S7(r9[this.dice_material]),l.envMapIntensity=0):l=new M7(this.material_options);let c;if(a==0){let d={name:"none"};this.dice_texture_rand.composite!="source-over"&&(d=this.dice_texture_rand),c=this.createTextMaterial(i,o,a,e,t,d,this.label_color_rand,this.label_outline_rand,this.edge_color_rand,r),l.map=c.composite}else if(c=this.createTextMaterial(i,o,a,e,t,this.dice_texture_rand,this.label_color_rand,this.label_outline_rand,this.dice_color_rand,r),l.map=c.composite,this.bumpMapping){{let d=.75;e>35&&(d=1),e>40&&(d=2.5),e>45&&(d=4),l.bumpScale=d}c.bump&&(l.bumpMap=c.bump),i.shape!="d4"&&i.normals[a]&&(l.bumpMap=new vi(i.normals[a]),l.bumpScale=4,l.bumpMap.needsUpdate=!0)}l.opacity=1,l.transparent=!0,l.depthTest=!1,l.needUpdate=!0,s.push(l)}return s}createTextMaterial(i,e,t,r,n,s,o,a,l,c){if(e[t]===void 0)return null;s=s||this.dice_texture_rand,o=o||this.label_color_rand,a=a||this.label_outline_rand,l=l||this.dice_color_rand,c=c??!0;let d=e[t],u=!1,h=d;d instanceof HTMLImageElement?h=d.src:d instanceof Array&&d.forEach(A=>{h+=A.src});let p=i.type+h+t+s.name+o+a+l;if(i.shape=="d4"&&(p=i.type+h+s.name+o+a+l),c&&this.materials_cache[p]!=null)return this.cache_hits++,this.materials_cache[p];let g=document.createElement("canvas"),f=g.getContext("2d",{alpha:!0});f.globalAlpha=0,f.clearRect(0,0,g.width,g.height);let m=document.createElement("canvas"),b=m.getContext("2d",{alpha:!0});b.globalAlpha=0,b.clearRect(0,0,m.width,m.height);let y;if(i.shape=="d4"?y=this.calc_texture_size(r+n)*4:y=this.calc_texture_size(r+r*2*n)*4,g.width=g.height=y,m.width=m.height=y,f.fillStyle=l,f.fillRect(0,0,g.width,g.height),b.fillStyle="#FFFFFF",b.fillRect(0,0,m.width,m.height),s.texture&&s.name!=""&&s.name!="none"?(f.globalCompositeOperation=s.composite||"source-over",f.drawImage(s.texture,0,0,g.width,g.height),f.globalCompositeOperation="source-over",s.bump&&(b.globalCompositeOperation="source-over",b.drawImage(s.bump,0,0,g.width,g.height))):f.globalCompositeOperation="source-over",f.globalCompositeOperation="source-over",f.textAlign="center",f.textBaseline="middle",b.textAlign="center",b.textBaseline="middle",i.shape!="d4"){let A={d8:{even:-7.5,odd:-127.5},d10:{all:-6},d12:{all:5},d20:{all:-7.5}}[i.shape];if(A){let x;if(A.hasOwnProperty("all")?x=A.all:t>0&&t%2!=0?x=A.odd:x=A.even,x&&x!=0){var w=g.width/2,_=g.height/2;f.translate(w,_),f.rotate(x*(Math.PI/180)),f.translate(-w,-_),b.translate(w,_),b.rotate(x*(Math.PI/180)),b.translate(-w,-_)}}if(d instanceof HTMLImageElement)u=!0,f.drawImage(d,0,0,d.width,d.height,0,0,g.width,g.height);else{let x=y/(1+2*n),E=g.height/2+10,D=g.width/2;i.shape=="d10"?(x=x*.75,E=E*1.15-10):i.shape=="d20"&&(D=D*.98),f.font=x+"pt "+i.font,b.font=x+"pt "+i.font;let F=f.measureText("M").width*1.4,R=d.split(`
`);R.length>1&&(x=x/R.length,f.font=x+"pt "+i.font,b.font=x+"pt "+i.font,F=f.measureText("M").width*1.2,E-=F*R.length/2);for(let B=0,I=R.length;B<I;B++){let V=R[B].trim();a!="none"&&a!=l&&(f.strokeStyle=a,f.lineWidth=5,f.strokeText(R[B],D,E),b.strokeStyle="#000000",b.lineWidth=5,b.strokeText(R[B],D,E),(V=="6"||V=="9")&&(f.strokeText("  .",D,E),b.strokeText("  .",D,E))),f.fillStyle=o,f.fillText(R[B],D,E),b.fillStyle="#000000",b.fillText(R[B],D,E),(V=="6"||V=="9")&&(f.fillText("  .",D,E),b.fillText("  .",D,E)),E+=F*1.5}}}else{var w=g.width/2,_=g.height/2;f.font=y/128*24+"pt "+i.font,b.font=y/128*24+"pt "+i.font;for(let E=0;E<d.length;E++){if(d[E]instanceof HTMLImageElement){let D=d[E].width/g.width;f.drawImage(d[E],0,0,d[E].width,d[E].height,100/D,25/D,60/D,60/D)}else a!="none"&&a!=l&&(f.strokeStyle=a,f.lineWidth=5,f.strokeText(d[E],w,_-y*.3),b.strokeStyle="#000000",b.lineWidth=5,b.strokeText(d[E],w,_-y*.3)),f.fillStyle=o,f.fillText(d[E],w,_-y*.3),b.fillStyle="#000000",b.fillText(d[E],w,_-y*.3);f.translate(w,_),f.rotate(Math.PI*2/3),f.translate(-w,-_),b.translate(w,_),b.rotate(Math.PI*2/3),b.translate(-w,-_)}}var M=new s0(g),S;return u?S=null:S=new s0(m),c&&(this.cache_misses++,this.materials_cache[p]={composite:M,bump:S}),{composite:M,bump:S}}applyColorSet(i){var e;this.colordata=i,this.label_color=i.foreground,this.dice_color=i.background,this.label_outline=i.outline,this.dice_texture=i.texture,this.dice_material=((e=i==null?void 0:i.texture)==null?void 0:e.material)||"none",this.edge_color=i.hasOwnProperty("edge")?i.edge:i.background}setMaterialInfo(i=""){let e=this.colordata,t=this.dice_texture,r=this.dice_material;if(this.dice_color_rand="",this.label_color_rand="",this.label_outline_rand="",this.dice_texture_rand="",this.dice_material_rand="",this.edge_color_rand="",Array.isArray(this.dice_color)){var n=Math.floor(Math.random()*this.dice_color.length);Array.isArray(this.label_color)&&this.label_color.length==this.dice_color.length&&(this.label_color_rand=this.label_color[n],Array.isArray(this.label_outline)&&this.label_outline.length==this.label_color.length&&(this.label_outline_rand=this.label_outline[n])),Array.isArray(this.dice_texture)&&this.dice_texture.length==this.dice_color.length&&(this.dice_texture_rand=this.dice_texture[n],this.dice_material_rand=this.dice_texture_rand.material),Array.isArray(this.edge_color)&&this.edge_color.length==this.dice_color.length&&(this.edge_color_rand=this.edge_color[n]),this.dice_color_rand=this.dice_color[n]}else this.dice_color_rand=this.dice_color;if(this.edge_color_rand=="")if(Array.isArray(this.edge_color)){var n=Math.floor(Math.random()*this.edge_color.length);this.edge_color_rand=this.edge_color[n]}else this.edge_color_rand=this.edge_color;if(this.label_color_rand==""&&Array.isArray(this.label_color)){var n=this.label_color[Math.floor(Math.random()*this.label_color.length)];Array.isArray(this.label_outline)&&this.label_outline.length==this.label_color.length&&(this.label_outline_rand=this.label_outline[n]),this.label_color_rand=this.label_color[n]}else this.label_color_rand==""&&(this.label_color_rand=this.label_color);if(this.label_outline_rand==""&&Array.isArray(this.label_outline)){var n=this.label_outline[Math.floor(Math.random()*this.label_outline.length)];this.label_outline_rand=this.label_outline[n]}else this.label_outline_rand==""&&(this.label_outline_rand=this.label_outline);this.dice_texture_rand==""&&Array.isArray(this.dice_texture)?(this.dice_texture_rand=this.dice_texture[Math.floor(Math.random()*this.dice_texture.length)],this.dice_material_rand=this.dice_texture_rand.material||this.dice_material):this.dice_texture_rand==""&&(this.dice_texture_rand=this.dice_texture,this.dice_material_rand=this.dice_texture_rand.material||this.dice_material),this.dice_material_rand==""&&Array.isArray(this.dice_material)?this.dice_material_rand=this.dice_material[Math.floor(Math.random()*this.dice_material.length)]:this.dice_material_rand==""&&(this.dice_material_rand=this.dice_material),this.colordata&&this.colordata.id!=e.id&&this.applyColorSet(e,t,r)}calc_texture_size(i){return Math.pow(2,Math.floor(Math.log(i)/Math.log(2)))}createGeometry(i,e,t=!1){const r=t?"create_shape":"create_geom";switch(i){case"d2":var n=new Bf(1*e,1*e,.1*e,32);return n.cannon_shape=new LV(1*e,1*e,.1*e,8),n;case"d4":return this[r](Si.d4.vertices,Si.d4.faces,e,-.1,Math.PI*7/6,.96);case"d6":return this[r](Si.d6.vertices,Si.d6.faces,e,.1,Math.PI/4,.96);case"d8":return this[r](Si.d8.vertices,Si.d8.faces,e,0,-Math.PI/4/2,.965);case"d10":return this[r](Si.d10.vertices,Si.d10.faces,e,.3,Math.PI,.945);case"d12":return this[r](Si.d12.vertices,Si.d12.faces,e,.2,-Math.PI/4/2,.968);case"d20":return this[r](Si.d20.vertices,Si.d20.faces,e,-.2,-Math.PI/4/2,.955);default:return console.error(`Geometry for ${i} is not available`),null}}fixmaterials(i,e){for(let r=0,n=i.geometry.groups.length;r<n;++r){var t=i.geometry.groups[r].materialIndex-2;if(t<e)continue;let s=t%e;i.geometry.groups[r].materialIndex=s+2}return i.geometry.elementsNeedUpdate=!0,i}create_shape(i,e,t){for(var r=new Array(i.length),n=0;n<i.length;++n)r[n]=new J().fromArray(i[n]).normalize();for(var s=new Array(i.length),o=new Array(e.length),n=0;n<r.length;++n){var a=r[n];s[n]=new k(a.x*t,a.y*t,a.z*t)}for(var n=0;n<e.length;++n)o[n]=e[n].slice(0,e[n].length-1);return new is({vertices:s,faces:o})}make_geom(i,e,t,r,n){let s=new lr;for(let p=0;p<i.length;++p)i[p]=i[p].multiplyScalar(t);let o=[];const a=[],l=[],c=new J,d=new J;let u,h=0;for(let p=0;p<e.length;++p){let g=e[p],f=g.length-1,m=Math.PI*2/f;u=g[f]+1;for(let y=0;y<f-2;++y)o.push(...i[g[0]].toArray()),o.push(...i[g[y+1]].toArray()),o.push(...i[g[y+2]].toArray()),c.subVectors(i[g[y+2]],i[g[y+1]]),d.subVectors(i[g[0]],i[g[y+1]]),c.cross(d),c.normalize(),a.push(...c.toArray()),a.push(...c.toArray()),a.push(...c.toArray()),l.push((Math.cos(n)+1+r)/2/(1+r),(Math.sin(n)+1+r)/2/(1+r)),l.push((Math.cos(m*(y+1)+n)+1+r)/2/(1+r),(Math.sin(m*(y+1)+n)+1+r)/2/(1+r)),l.push((Math.cos(m*(y+2)+n)+1+r)/2/(1+r),(Math.sin(m*(y+2)+n)+1+r)/2/(1+r));let b=(f-2)*3;for(let y=0;y<b/3;y++)s.addGroup(h,3,u),h+=3}return s.setAttribute("position",new Yt(o,3)),s.setAttribute("normal",new Yt(a,3)),s.setAttribute("uv",new Yt(l,2)),s.boundingSphere=new La(new J,t),s}make_d10_geom(i,e,t,r,n){let s=new lr;for(let y=0;y<i.length;++y)i[y]=i[y].multiplyScalar(t);let o=[];const a=[],l=[],c=new J,d=new J;let u,h=0;for(let y=0;y<e.length;++y){let w=e[y],_=w.length-1,M=Math.PI*2/_;u=w[_]+1;var p=.65,g=.85,f=1-1*g,m=1-.895/1.105*g,b=1;for(let A=0;A<_-2;++A)o.push(...i[w[0]].toArray()),o.push(...i[w[A+1]].toArray()),o.push(...i[w[A+2]].toArray()),c.subVectors(i[w[A+2]],i[w[A+1]]),d.subVectors(i[w[0]],i[w[A+1]]),c.cross(d),c.normalize(),a.push(...c.toArray()),a.push(...c.toArray()),a.push(...c.toArray()),e[y][e[y].length-1]==-1||A>=2?(l.push((Math.cos(n)+1+r)/2/(1+r),(Math.sin(n)+1+r)/2/(1+r)),l.push((Math.cos(M*(A+1)+n)+1+r)/2/(1+r),(Math.sin(M*(A+1)+n)+1+r)/2/(1+r)),l.push((Math.cos(M*(A+2)+n)+1+r)/2/(1+r),(Math.sin(M*(A+2)+n)+1+r)/2/(1+r))):A==0?(l.push(.5-p/2,m),l.push(.5,f),l.push(.5+p/2,m)):A==1&&(l.push(.5-p/2,m),l.push(.5+p/2,m),l.push(.5,b));let S=(_-2)*3;for(let A=0;A<S/3;A++)s.addGroup(h,3,u),h+=3}return s.setAttribute("position",new Yt(o,3)),s.setAttribute("normal",new Yt(a,3)),s.setAttribute("uv",new Yt(l,2)),s.boundingSphere=new La(new J,t),s}chamfer_geom(i,e,t){for(var r=[],n=[],s=new Array(i.length),o=0;o<i.length;++o)s[o]=[];for(var o=0;o<e.length;++o){for(var a=e[o],l=a.length-1,c=new J,d=new Array(l),u=0;u<l;++u){var h=i[a[u]].clone();c.add(h),s[a[u]].push(d[u]=r.push(h)-1)}c.divideScalar(l);for(var u=0;u<l;++u){var h=r[d[u]];h.subVectors(h,c).multiplyScalar(t).addVectors(h,c)}d.push(a[l]),n.push(d)}for(var o=0;o<e.length-1;++o)for(var u=o+1;u<e.length;++u){for(var p=[],g=-1,f=0;f<e[o].length-1;++f){var m=e[u].indexOf(e[o][f]);m>=0&&m<e[u].length-1&&(g>=0&&f!=g+1?p.unshift([o,f],[u,m]):p.push([o,f],[u,m]),g=f)}p.length==4&&n.push([n[p[0][0]][p[0][1]],n[p[1][0]][p[1][1]],n[p[3][0]][p[3][1]],n[p[2][0]][p[2][1]],-1])}for(var o=0;o<s.length;++o){for(var b=s[o],d=[b[0]],y=b.length-1;y;){for(var f=e.length;f<n.length;++f){var w=n[f].indexOf(d[d.length-1]);if(w>=0&&w<4){--w==-1&&(w=3);var _=n[f][w];if(b.indexOf(_)>=0){d.push(_);break}}}--y}d.push(-1),n.push(d)}return{vectors:r,faces:n}}create_geom(i,e,t,r,n,s){for(var o=new Array(i.length),a=0;a<i.length;++a)o[a]=new J().fromArray(i[a]).normalize();var l=this.chamfer_geom(o,e,s);if(e.length!=10)var c=this.make_geom(l.vectors,l.faces,t,r,n);else var c=this.make_d10_geom(l.vectors,l.faces,t,r,n);return c.cannon_shape=this.create_shape(i,e,t),c.name="d"+e.length,c}};let b_=Uo;_z(b_,"dice",{});const Au={cloudy:{name:"Clouds (Transparent)",composite:"destination-in",source:"textures/cloudy.webp",source_bump:"textures/cloudy.alt.webp"},cloudy_2:{name:"Clouds",composite:"multiply",source:"textures/cloudy.alt.webp",source_bump:"textures/cloudy.alt.webp"},fire:{name:"Fire",composite:"multiply",source:"textures/fire.webp",source_bump:"textures/fire.webp",material:"metal"},marble:{name:"Marble",composite:"multiply",source:"textures/marble.webp",source_bump:"",material:"glass"},water:{name:"Water",composite:"destination-in",source:"textures/water.webp",source_bump:"textures/water.webp",material:"glass"},ice:{name:"Ice",composite:"destination-in",source:"textures/ice.webp",source_bump:"textures/ice.webp",material:"glass"},paper:{name:"Paper",composite:"multiply",source:"textures/paper.webp",source_bump:"textures/paper-bump.webp",material:"wood"},speckles:{name:"Speckles",composite:"multiply",source:"textures/speckles.webp",source_bump:"textures/speckles.webp",material:"none"},glitter:{name:"Glitter",composite:"multiply",source:"textures/glitter.webp",source_bump:"textures/glitter-bump.webp",material:"none"},glitter_2:{name:"Glitter (Transparent)",composite:"destination-in",source:"textures/glitter-alpha.webp",source_bump:"",material:"none"},stars:{name:"Stars",composite:"multiply",source:"textures/stars.webp",source_bump:"textures/stars.webp",material:"none"},stainedglass:{name:"Stained Glass",composite:"multiply",source:"textures/stainedglass.webp",source_bump:"textures/stainedglass-bump.webp",material:"glass"},wood:{name:"Wood",composite:"multiply",source:"textures/wood.webp",source_bump:"textures/wood.webp",material:"wood"},metal:{name:"Stainless Steel",composite:"multiply",source:"textures/metal.webp",source_bump:"textures/metal-bump.webp",material:"metal"},skulls:{name:"Skulls",composite:"multiply",source:"textures/skulls.webp",source_bump:"textures/skulls.webp"},leopard:{name:"Leopard",composite:"multiply",source:"textures/leopard.webp",source_bump:"textures/leopard.webp",material:"wood"},tiger:{name:"Tiger",composite:"multiply",source:"textures/tiger.webp",source_bump:"textures/tiger.webp",material:"wood"},cheetah:{name:"Cheetah",composite:"multiply",source:"textures/cheetah.webp",source_bump:"textures/cheetah.webp",material:"wood"},dragon:{name:"Dragon",composite:"multiply",source:"textures/dragon.webp",source_bump:"textures/dragon-bump.webp",material:"none"},lizard:{name:"Lizard",composite:"multiply",source:"textures/lizard.webp",source_bump:"textures/lizard.webp",material:"none"},bird:{name:"Bird",composite:"multiply",source:"textures/feather.webp",source_bump:"textures/feather-bump.webp",material:"wood"},astral:{name:"Astral Sea",composite:"multiply",source:"textures/astral.webp",source_bump:"textures/stars.webp",material:"none"},acleaf:{name:"AC Leaf",composite:"multiply",source:"textures/acleaf.webp",source_bump:"textures/acleaf.webp",material:"none"},thecage:{name:"Nicholas Cage",composite:"multiply",source:"textures/thecage.webp",source_bump:"",material:"metal"},isabelle:{name:"Isabelle",composite:"source-over",source:"textures/isabelle.webp",source_bump:"",material:"none"},bronze01:{name:"bronze01",composite:"difference",source:"textures/bronze01.webp",source_bump:"",material:"metal"},bronze02:{name:"bronze02",composite:"difference",source:"textures/bronze02.webp",source_bump:"",material:"metal"},bronze03:{name:"bronze03",composite:"difference",source:"textures/bronze03.webp",source_bump:"",material:"metal"},bronze03a:{name:"bronze03a",composite:"difference",source:"textures/bronze03a.webp",source_bump:"",material:"metal"},bronze03b:{name:"bronze03b",composite:"difference",source:"textures/bronze03b.webp",source_bump:"",material:"metal"},bronze04:{name:"bronze04",composite:"difference",source:"textures/bronze04.webp",source_bump:"",material:"metal"},none:{name:"none",composite:"source-over",source:"",source_bump:"",material:""},"":{name:"~ Preset ~",composite:"source-over",source:"",source_bump:"",material:""}},A0={coin_default:{name:"Gold Coin",description:"Gold Dragonhead Coin",category:"Other",foreground:"#f6c928",background:"#f6c928",outline:"none",texture:"metal"},coin_silver:{name:"Silver Coin",description:"Gold Dragonhead Coin",category:"Other",foreground:"#f6c928",background:"#f6c928",outline:"none",texture:"metal"},radiant:{name:"Radiant",category:"Damage Types",foreground:"#F9B333",background:"#FFFFFF",outline:"",texture:"paper",description:"Radiant"},fire:{name:"Fire",category:"Damage Types",foreground:"#f8d84f",background:["#f8d84f","#f9b02d","#f43c04","#910200","#4c1009"],outline:"black",texture:"fire",description:"Fire"},ice:{name:"Ice",category:"Damage Types",foreground:"#60E9FF",background:["#214fa3","#3c6ac1","#253f70","#0b56e2","#09317a"],outline:"black",texture:"ice",description:"Ice"},poison:{name:"Poison",category:"Damage Types",foreground:"#D6A8FF",background:["#313866","#504099","#66409e","#934fc3","#c949fc"],outline:"black",texture:"cloudy",description:"Poison"},acid:{name:"Acid",category:"Damage Types",foreground:"#A9FF70",background:["#a6ff00","#83b625","#5ace04","#69f006","#b0f006","#93bc25"],outline:"black",texture:"marble",description:"Acid"},thunder:{name:"Thunder",category:"Damage Types",foreground:"#FFC500",background:"#7D7D7D",outline:"black",texture:"cloudy",description:"Thunder"},lightning:{name:"Lightning",category:"Damage Types",foreground:"#FFC500",background:["#f17105","#f3ca40","#eddea4","#df9a57","#dea54b"],outline:"#7D7D7D",texture:"ice",description:"Lightning"},air:{name:"Air",category:"Damage Types",foreground:"#ffffff",background:["#d0e5ea","#c3dee5","#a4ccd6","#8dafb7","#80a4ad"],outline:"black",texture:"cloudy",description:"Air"},water:{name:"Water",category:"Damage Types",foreground:"#60E9FF",background:["#87b8c4","#77a6b2","#6b98a3","#5b8691","#4b757f"],outline:"black",texture:"water",description:"Water"},earth:{name:"Earth",category:"Damage Types",foreground:"#6C9943",background:["#346804","#184200","#527f22","#3a1d04","#56341a","#331c17","#5a352a","#302210"],outline:"black",texture:"speckles",description:"Earth"},force:{name:"Force",category:"Damage Types",foreground:"white",background:["#FF97FF","#FF68FF","#C651C6"],outline:"#570000",texture:"stars",description:"Force"},psychic:{name:"Psychic",category:"Damage Types",foreground:"#D6A8FF",background:["#313866","#504099","#66409E","#934FC3","#C949FC","#313866"],outline:"black",texture:"speckles",description:"Psychic"},necrotic:{name:"Necrotic",category:"Damage Types",foreground:"#ffffff",background:"#6F0000",outline:"black",texture:"skulls",description:"Necrotic"},breebaby:{name:"Pastel Sunset",category:"Custom Sets",foreground:["#5E175E","#564A5E","#45455E","#3D5A5E","#1E595E","#5E3F3D","#5E1E29","#283C5E","#25295E"],background:["#FE89CF","#DFD4F2","#C2C2E8","#CCE7FA","#A1D9FC","#F3C3C2","#EB8993","#8EA1D2","#7477AD"],outline:"white",texture:"marble",description:"Pastel Sunset, for Breyanna"},pinkdreams:{name:"Pink Dreams",category:"Custom Sets",foreground:"white",background:["#ff007c","#df73ff","#f400a1","#df00ff","#ff33cc"],outline:"#570000",texture:"skulls",description:"Pink Dreams, for Ethan"},inspired:{name:"Inspired",category:"Custom Sets",foreground:"#FFD800",background:"#C4C4B6",outline:"#8E8E86",texture:"none",description:"Inspired, for Austin"},bloodmoon:{name:"Blood Moon",category:"Custom Sets",foreground:"#CDB800",background:"#6F0000",outline:"black",texture:"marble",description:"Blood Moon, for Jared"},starynight:{name:"Stary Night",category:"Custom Sets",foreground:"#4F708F",background:["#091636","#233660","#4F708F","#8597AD","#E2E2E2"],outline:"white",texture:"speckles",description:"Stary Night, for Mai"},glitterparty:{name:"Glitter Party",category:"Custom Sets",foreground:"white",background:["#FFB5F5","#7FC9FF","#A17FFF"],outline:"none",texture:"glitter",description:"Glitter Party, for Austin"},astralsea:{name:"Astral Sea",category:"Custom Sets",foreground:"#565656",background:"white",outline:"none",texture:"astral",description:"The Astral Sea, for Austin"},bronze:{name:"Thylean Bronze",description:"Thylean Bronze by @SpencerThayer",category:"Custom Sets",foreground:["#FF9159","#FFB066","#FFBF59","#FFD059"],background:["#705206","#7A4E06","#643100","#7A2D06"],outline:["#3D2D03","#472D04","#301700","#471A04"],edge:["#FF5D0D","#FF7B00","#FFA20D","#FFBA0D"],texture:["bronze01","bronze02","bronze03","bronze03a","bronze03b","bronze04"]},dragons:{name:"Here be Dragons",category:"Custom Sets",foreground:"#FFFFFF",background:["#B80000","#4D5A5A","#5BB8FF","#7E934E","#FFFFFF","#F6ED7C","#7797A3","#A78437","#862C1A","#FFDF8A"],outline:"black",texture:["dragon","lizard"],description:"Here be Dragons"},birdup:{name:"Bird Up",category:"Custom Sets",foreground:"#FFFFFF",background:["#F11602","#FFC000","#6EC832","#0094BC","#05608D","#FEABB3","#F75680","#F3F0DF","#C7A57F"],outline:"black",texture:"bird",description:"Bird Up!"},tigerking:{name:"Tiger King",category:"Other",foreground:"#ffffff",background:"#FFCC40",outline:"black",texture:["leopard","tiger","cheetah"],description:"Leopard Print"},covid:{name:"COViD",category:"Other",foreground:"#A9FF70",background:["#a6ff00","#83b625","#5ace04","#69f006","#b0f006","#93bc25"],outline:"black",texture:"fire",description:"Covid-19"},acleaf:{name:"Animal Crossing",category:"Other",foreground:"#00FF00",background:"#07540A",outline:"black",texture:"acleaf",description:"Animal Crossing Leaf"},isabelle:{name:"Isabelle",category:"Other",foreground:"white",background:"#FEE5CC",outline:"black",texture:"isabelle",description:"Isabelle"},thecage:{name:"Nicholas Cage",category:"Other",foreground:"#ffffff",background:"#ffffff",outline:"black",texture:"thecage",description:"Nicholas Cage"},test:{name:"Test",category:"Colors",foreground:["#00FF00","#0000FF","#FF0000"],background:["#FF0000","#00FF00","#0000FF"],outline:"black",texture:"none",description:"Test"},rainbow:{name:"Rainblow",category:"Colors",foreground:["#FF5959","#FFA74F","#FFFF56","#59FF59","#2374FF","#00FFFF","#FF59FF"],background:["#900000","#CE3900","#BCBC00","#00B500","#00008E","#008282","#A500A5"],outline:"black",texture:"none",description:"Rainblow"},black:{name:"Black",category:"Colors",foreground:"#ffffff",background:"#000000",outline:"black",texture:"none",description:"Black"},white:{name:"White",category:"Colors",foreground:"#000000",background:"#FFFFFF",outline:"#FFFFFF",texture:"none",description:"White"},swrpg_abi:{name:"Star Wars RPG - Ability",category:"Star Wars™ RPG",foreground:"#00FF00",background:["#3D9238","#52B848","#5EAC56","#9ECB9A"],outline:"#000000",texture:"cloudy_2",description:"Star Wars™ RPG Ability Dice"},swrpg_pro:{name:"Star Wars RPG - Proficiency",category:"Star Wars™ RPG",foreground:"#FFFF00",background:["#CABB1C","#F9E33B","#FFE900","#F0E49D"],outline:"#000000",texture:"paper",description:"Star Wars™ RPG Proficiency Dice"},swrpg_dif:{name:"Star Wars RPG - Difficulty",category:"Star Wars™ RPG",foreground:"#8000FC",background:["#39165F","#664B84","#50247E","#745F88"],outline:"#000000",texture:"cloudy_2",description:"Star Wars™ RPG Difficulty Dice"},swrpg_cha:{name:"Star Wars RPG - Challenge",category:"Star Wars™ RPG",foreground:"#FF0000",background:["#A91F32","#EB4254","#E51836","#BA3645"],outline:"#000000",texture:"paper",description:"Star Wars™ RPG Challenge Dice"},swrpg_boo:{name:"Star Wars RPG - Boost",category:"Star Wars™ RPG",foreground:"#00FFFF",background:["#4B9DC6","#689FC4","#85CFF2","#8FC0D8"],outline:"#000000",texture:"glitter",description:"Star Wars™ RPG Boost Dice"},swrpg_set:{name:"Star Wars RPG - Setback",category:"Star Wars™ RPG",foreground:"#111111",background:["#252223","#241F21","#282828","#111111"],outline:"#ffffff",texture:"glitter",description:"Star Wars™ RPG Setback Dice"},swrpg_for:{name:"Star Wars RPG - Force",category:"Star Wars™ RPG",foreground:"#000000",background:["#F3F3F3","#D3D3D3","#BABABA","#FFFFFF"],outline:"#FFFFFF",texture:"stars",description:"Star Wars™ RPG Force Dice"},swa_red:{name:"Armada Attack - Red",category:"Star Wars™ Armada",foreground:"#ffffff",background:["#440D19","#8A1425","#C72336","#C04551"],outline:"none",texture:"stainedglass",description:"Star Wars™ Armada Red Attack Dice"},swa_blue:{name:"Armada Attack - Blue",category:"Star Wars™ Armada",foreground:"#ffffff",background:["#212642","#28286E","#2B348C","#3D4BB5","#5D64AB"],outline:"none",texture:"stainedglass",description:"Star Wars™ Armada Blue Attack Dice"},swa_black:{name:"Armada Attack - Black",category:"Star Wars™ Armada",foreground:"#ffffff",background:["#252223","#241F21","#282828","#111111"],outline:"none",texture:"stainedglass",description:"Star Wars™ Armada Black Attack Dice"},xwing_red:{name:"X-Wing Attack - Red",category:"Star Wars™ X-Wing",foreground:"#ffffff",background:["#440D19","#8A1425","#C72336","#C04551"],outline:"none",texture:"stars",description:"Star Wars™ X-Wing Red Attack Dice"},xwing_green:{name:"X-Wing Attack - Green",category:"Star Wars™ X-Wing",foreground:"#ffffff",background:["#3D9238","#52B848","#5EAC56","#9ECB9A"],outline:"none",texture:"stars",description:"Star Wars™ X-Wing Green Attack Dice"},swl_atkred:{name:"Legion Attack - Red",category:"Star Wars™ Legion",foreground:"#ffffff",background:["#440D19","#8A1425","#C72336","#C04551"],outline:"none",texture:"fire",description:"Star Wars™ Legion Red Attack Dice"},swl_atkblack:{name:"Legion Attack - Black",category:"Star Wars™ Legion",foreground:"#ffffff",background:["#252223","#241F21","#282828","#111111"],outline:"none",texture:"fire",description:"Star Wars™ Legion Black Attack Dice"},swl_atkwhite:{name:"Legion Attack - White",category:"Star Wars™ Legion",foreground:"#000000",background:["#ffffff","#DFF4FA","#BCBCBC","#F1EDE2","#F2ECE0"],outline:"none",texture:"fire",description:"Star Wars™ Legion White Attack Dice"},swl_defred:{name:"Legion Defense - Red",category:"Star Wars™ Legion",foreground:"#ffffff",background:["#440D19","#8A1425","#C72336","#C04551"],outline:"none",texture:"fire",description:"Star Wars™ Legion Red Defense Dice"},swl_defwhite:{name:"Legion Defense - White",category:"Star Wars™ Legion",foreground:"#000000",background:["#ffffff","#DFF4FA","#BCBCBC","#F1EDE2","#F2ECE0"],outline:"none",texture:"fire",description:"Star Wars™ Legion White Defense Dice"}};class s9{constructor(e={}){this.colorsets=[],this.assetPath=e.assetPath}async ImageLoader(e){if(Array.isArray(e)){for(let t=0,r=e.length;t<r;t++)e[t]=await this.ImageLoader(e[t]);return e}return e.source&&e.source!=""&&(e.texture=await this.loadImage(e.source)),e.source_bump&&e.source_bump!=""&&(e.bump=await this.loadImage(e.source_bump)),e}loadImage(e){return new Promise((t,r)=>{let n=new Image;n.onload=()=>t(n),n.crossOrigin="anonymous",n.src=this.assetPath+e,n.onerror=s=>r(s)}).catch(t=>{console.error("Unable to load image texture")})}async getColorSet(e){let t,r;if(typeof e=="string"&&(t=e),typeof e=="object"&&(t=e.colorset),this.colorsets.hasOwnProperty(t))return this.colorsets[t];let n=A0[t];return r=e.texture||n.texture,n.texture=this.getTexture(r),n.texture=await this.ImageLoader(n.texture),e.material&&(n.texture.material=e.material),this.colorsets[t]=n,n}async makeColorSet(e={}){if(this.colorsets.hasOwnProperty(e.name))return this.colorsets[e.name];let t=A0.white,r=Object.assign({},t,e),n=this.getTexture(r.texture);return r.texture=await this.ImageLoader(n),e.material&&(r.texture.material=e.material),r.name.toLowerCase()==="white"&&(r.name=`${Date.now()}`),this.colorsets[r.name]=r,r}getTexture(e){if(Array.isArray(e)){let t=[];for(let r=0,n=e.length;r<n;r++)t.push(this.getTexture(e[r]));return t}return Au.hasOwnProperty(e)?Au[e]:Au.none}}const o9={default:{name:"Solid Color",author:"MajorVictory",showColorPicker:!0,surface:"wood_tray",colors:{fg:"#9794ff",bg:"#0b1a3e"},cubeMap:["envmap.jpg","envmap.jpg","envmap.jpg","envmap.jpg","envmap.jpg","envmap.jpg"]},"blue-felt":{name:"Blue Felt",author:"MajorVictory",showColorPicker:!0,surface:"felt",colors:{fg:"#9794ff",bg:"#0b1a3e"},cubeMap:["envmap.jpg","envmap.jpg","envmap.jpg","envmap.jpg","envmap.jpg","envmap.jpg"]},"red-felt":{name:"Red Felt",author:"MajorVictory",showColorPicker:!0,surface:"felt",colors:{fg:"#ff9494",bg:"#4d1e1e"},cubeMap:["envmap.jpg","envmap.jpg","envmap.jpg","envmap.jpg","envmap.jpg","envmap.jpg"]},"green-felt":{name:"Green Felt",author:"MajorVictory",showColorPicker:!0,surface:"felt",colors:{fg:"#97ff94",bg:"#244d1e"},cubeMap:["envmap.jpg","envmap.jpg","envmap.jpg","envmap.jpg","envmap.jpg","envmap.jpg"]},taverntable:{name:"Old Tavern Table",author:"MajorVictory",showColorPicker:!0,surface:"wood_table",colors:{fg:"#9794ff",bg:"#0b1a3e"},cubeMap:["px.png","nx.png","py.png","ny.png","pz.png","nz.png"]},mahogany:{name:"(Mah-Hog-Any)",author:"MajorVictory",showColorPicker:!0,surface:"wood_table",colors:{fg:"#9794ff",bg:"#0b1a3e"},cubeMap:["px.png","nx.png","py.png","ny.png","pz.png","nz.png"]},stainless:{name:"Stainless Steel",author:"MajorVictory",showColorPicker:!0,surface:"metal",colors:{fg:"#9794ff",bg:"#0b1a3e"},cubeMap:["px.png","nx.png","py.png","ny.png","pz.png","nz.png"]},cyberpunk:{name:"Neo-New-Future-City",author:"MajorVictory",showColorPicker:!0,surface:"metal",colors:{fg:"#3494A6",bg:"#440B28"},cubeMap:["px.png","nx.png","py.png","ny.png","pz.png","nz.png"]},cagetown:{name:"Cage Town",author:"MajorVictory",showColorPicker:!0,surface:"wood_table",colors:{fg:"#D7A866",bg:"#282811"},cubeMap:["px.png","nx.png","py.png","ny.png","pz.png","nz.png"]}},a9=i=>{let e;return function(){let t=this,r=arguments;e&&window.cancelAnimationFrame(e),e=window.requestAnimationFrame(function(){i.apply(t,r)})}},l9={assetPath:"./",framerate:1/60,sounds:!1,volume:100,color_spotlight:15720405,shadows:!0,theme_surface:"green-felt",sound_dieMaterial:"plastic",theme_customColorset:null,theme_colorset:"white",theme_texture:"",theme_material:"glass",gravity_multiplier:400,light_intensity:.7,baseScale:100,strength:1,iterationLimit:1e3,onRollComplete:()=>{},onRerollComplete:()=>{},onAddDiceComplete:()=>{},onRemoveDiceComplete:()=>{}};class c9{constructor(e,t={}){this.initialized=!1,this.container=document.querySelector(e),this.dimensions=new at(this.container.clientWidth,this.container.clientHeight),this.adaptive_timestep=!1,this.last_time=0,this.running=!1,this.rolling=!1,this.threadid,this.display={currentWidth:null,currentHeight:null,containerWidth:null,containerHeight:null,aspect:null,scale:null},this.cameraHeight={max:null,close:null,medium:null,far:null},this.scene=new w7,this.world=new YH,this.dice_body_material=new ns,this.sounds_table={},this.sounds_dice=[],this.lastSoundType="",this.lastSoundStep=0,this.lastSound=0,this.iteration,this.renderer,this.barrier,this.camera,this.light,this.light_amb,this.desk,this.box_body={},this.bodies=[],this.meshes=[],this.diceList=[],this.notationVectors=null,this.dieIndex=0,this.soundDelay=10,this.animstate="",this.selector={animate:!0,rotate:!0,intersected:null,dice:[]},Object.assign(this,l9,t),this.DiceColors=new s9({assetPath:this.assetPath}),this.DiceFactory=new b_({baseScale:this.baseScale}),this.DiceFactory.setBumpMapping(!0),this.surface=o9[this.theme_surface].surface}enableShadows(){this.shadows=!0,this.renderer&&(this.renderer.shadowMap.enabled=this.shadows),this.light&&(this.light.castShadow=this.shadows),this.desk&&(this.desk.receiveShadow=this.shadows)}disableShadows(){this.shadows=!1,this.renderer&&(this.renderer.shadowMap.enabled=this.shadows),this.light&&(this.light.castShadow=this.shadows),this.desk&&(this.desk.receiveShadow=this.shadows)}async initialize(){this.renderer=new a_({antialias:!0,alpha:!0}),this.container.appendChild(this.renderer.domElement),this.renderer.shadowMap.enabled=this.shadows,this.renderer.shadowMap.type=2,this.renderer.setClearColor(0,0),this.setDimensions(this.dimensions),this.world.gravity.set(0,0,-9.8*this.gravity_multiplier),this.world.broadphase=new d_,this.world.solver.iterations=14,this.world.allowSleep=!0,this.makeWorldBox(),this.resizeWorld(),await this.loadTheme({colorset:this.theme_colorset,texture:this.theme_texture,material:this.theme_material}).catch(e=>{throw new Error("Unable to load theme")}),this.sounds&&await this.loadSounds().catch(e=>{throw new Error("Unable to load sounds")}),this.initialized=!0,this.renderer.render(this.scene,this.camera)}makeWorldBox(){Object.keys(this.box_body).length&&(this.world.removeBody(this.box_body.desk),this.world.removeBody(this.box_body.topWall),this.world.removeBody(this.box_body.bottomWall),this.world.removeBody(this.box_body.leftWall),this.world.removeBody(this.box_body.rightWall));const e=new ns,t=new ns;this.world.addContactMaterial(new rs(e,this.dice_body_material,{mass:0,friction:.6,restitution:.5})),this.world.addContactMaterial(new rs(t,this.dice_body_material,{mass:0,friction:.6,restitution:1})),this.world.addContactMaterial(new rs(this.dice_body_material,this.dice_body_material,{mass:0,friction:.6,restitution:.5})),this.box_body.desk=new Ae({allowSleep:!1,mass:0,shape:new Oo,material:e}),this.world.addBody(this.box_body.desk),this.box_body.topWall=new Ae({allowSleep:!1,mass:0,shape:new Oo,material:t}),this.box_body.topWall.quaternion.setFromAxisAngle(new k(1,0,0),Math.PI/2),this.box_body.topWall.position.set(0,this.display.containerHeight*.93,0),this.world.addBody(this.box_body.topWall),this.box_body.bottomWall=new Ae({allowSleep:!1,mass:0,shape:new Oo,material:t}),this.box_body.bottomWall.quaternion.setFromAxisAngle(new k(1,0,0),-Math.PI/2),this.box_body.bottomWall.position.set(0,-this.display.containerHeight*.93,0),this.world.addBody(this.box_body.bottomWall),this.box_body.leftWall=new Ae({allowSleep:!1,mass:0,shape:new Oo,material:t}),this.box_body.leftWall.quaternion.setFromAxisAngle(new k(0,1,0),-Math.PI/2),this.box_body.leftWall.position.set(this.display.containerWidth*.93,0,0),this.world.addBody(this.box_body.leftWall),this.box_body.rightWall=new Ae({allowSleep:!1,mass:0,shape:new Oo,material:t}),this.box_body.rightWall.quaternion.setFromAxisAngle(new k(0,1,0),Math.PI/2),this.box_body.rightWall.position.set(-this.display.containerWidth*.93,0,0),this.world.addBody(this.box_body.rightWall)}async loadTheme(e){let t;this.theme_customColorset?t=await this.DiceColors.makeColorSet(this.theme_customColorset):t=await this.DiceColors.getColorSet(e),this.DiceFactory.applyColorSet(t),this.colorData=t}async loadSounds(){let e={felt:7,wood_table:7,wood_tray:7,metal:9},t={coin:6,metal:12,plastic:15,wood:12};const r=this.colorData.texture.material.match(/wood|metal/g);if(this.sound_dieMaterial=r?this.colorData.texture.material:"plastic",!this.sounds_table.hasOwnProperty(this.surface)){this.sounds_table[this.surface]=[];let n=e[this.surface];for(let s=1;s<=n;++s){const o=await this.loadAudio(this.assetPath+"sounds/surfaces/surface_"+this.surface+s+".mp3");this.sounds_table[this.surface].push(o)}}if(!this.sounds_dice.hasOwnProperty("coin")){this.sounds_dice.coin=[];let n=t.coin;for(let s=1;s<=n;++s){const o=await this.loadAudio(this.assetPath+"sounds/dicehit/dicehit_coin"+s+".mp3");this.sounds_dice.coin.push(o)}}if(!this.sounds_dice.hasOwnProperty(this.sound_dieMaterial)){this.sounds_dice[this.sound_dieMaterial]=[];let n=t[this.sound_dieMaterial];for(let s=1;s<=n;++s){const o=await this.loadAudio(this.assetPath+"sounds/dicehit/dicehit_"+this.sound_dieMaterial+s+".mp3");this.sounds_dice[this.sound_dieMaterial].push(o)}}}loadAudio(e){return new Promise((t,r)=>{let n=new Audio;n.oncanplaythrough=()=>t(n),n.crossOrigin="anonymous",n.src=e,n.onerror=s=>r(s)}).catch(t=>{console.error("Unable to load audio")})}async updateConfig(e={}){Object.apply(this,e),this.theme_customColorset=e.theme_customColorset?e.theme_customColorset:null,e.theme_colorset&&(this.theme_colorset=e.theme_colorset),e.theme_texture&&(this.theme_texture=e.theme_texture),e.theme_material&&(this.theme_material=e.theme_material),(e.theme_colorset||e.theme_texture||e.theme_material||e.theme_customColorset)&&await this.loadTheme({colorset:this.theme_colorset,texture:this.theme_texture,material:this.theme_material})}setDimensions(e){switch(this.display.currentWidth=this.container.clientWidth/2,this.display.currentHeight=this.container.clientHeight/2,e?(this.display.containerWidth=e.x,this.display.containerHeight=e.y):(this.display.containerWidth=this.display.currentWidth,this.display.containerHeight=this.display.currentHeight),this.display.aspect=Math.min(this.display.currentWidth/this.display.containerWidth,this.display.currentHeight/this.display.containerHeight),this.display.scale=Math.sqrt(this.display.containerWidth*this.display.containerWidth+this.display.containerHeight*this.display.containerHeight)/13,this.makeWorldBox(),this.renderer.setSize(this.display.currentWidth*2,this.display.currentHeight*2),this.cameraHeight.max=this.display.currentHeight/this.display.aspect/Math.tan(10*Math.PI/180),this.cameraHeight.medium=this.cameraHeight.max/1.5,this.cameraHeight.far=this.cameraHeight.max,this.cameraHeight.close=this.cameraHeight.max/2,this.camera&&this.scene.remove(this.camera),this.camera=new fi(20,this.display.currentWidth/this.display.currentHeight,1,this.cameraHeight.max*1.3),this.animstate){case"selector":this.camera.position.z=this.selector.dice.length>9?this.cameraHeight.far:this.selector.dice.length<6?this.cameraHeight.close:this.cameraHeight.medium;break;case"throw":case"afterthrow":default:this.camera.position.z=this.cameraHeight.far}this.camera.lookAt(new J(0,0,0));const t=Math.max(this.display.containerWidth,this.display.containerHeight);this.light&&this.scene.remove(this.light),this.light_amb&&this.scene.remove(this.light_amb),this.light=new T7(this.color_spotlight,this.light_intensity),this.light.position.set(-t/2,t/2,t*3),this.light.target.position.set(0,0,0),this.light.distance=t*5,this.light.angle=Math.PI/4,this.light.castShadow=this.shadows,this.light.shadow.camera.near=t/10,this.light.shadow.camera.far=t*5,this.light.shadow.camera.fov=50,this.light.shadow.bias=.001,this.light.shadow.mapSize.width=1024,this.light.shadow.mapSize.height=1024,this.scene.add(this.light),this.light_amb=new E7(16777147,6776689,this.light_intensity),this.scene.add(this.light_amb),this.desk&&this.scene.remove(this.desk);let r=new x7;r.opacity=.5,this.desk=new Qi(new pd(this.display.containerWidth*6,this.display.containerHeight*6,1,1),r),this.desk.receiveShadow=this.shadows,this.scene.add(this.desk),this.renderer.render(this.scene,this.camera)}resizeWorld(){const e=a9(()=>{const t=this.renderer.domElement,r=this.container.clientWidth,n=this.container.clientHeight,s=t.width!==r||t.height!==n;return s&&this.setDimensions(new at(this.container.clientWidth,this.container.clientHeight)),s});window.addEventListener("resize",e)}vectorRand({x:e,y:t}){let r=Math.random()*Math.PI/5-Math.PI/5/2,n={x:e*Math.cos(r)-t*Math.sin(r),y:e*Math.sin(r)+t*Math.cos(r)};return n.x==0&&(n.x=.01),n.y==0&&(n.y=.01),n}getNotationVectors(e,t,r,n){let s=new T0(e);for(let o in s.set){const a=this.DiceFactory.get(s.set[o].type);let l=s.set[o].num,c=s.set[o].op,d=s.set[o].sid,u=s.set[o].gid,h=s.set[o].glvl,p=s.set[o].func,g=s.set[o].args;for(let f=0;f<l;f++){let m=this.vectorRand(t);m.x/=n,m.y/=n;let b={x:this.display.containerWidth*(m.x>0?-1:1)*.9,y:this.display.containerHeight*(m.y>0?-1:1)*.9,z:Math.random()*200+200},y=Math.abs(m.x/m.y);y>1?b.y/=y:b.x*=y;let w=this.vectorRand(t);w.x/=n,w.y/=n;let _,M,S;a.shape!="d2"?(_={x:w.x*r,y:w.y*r,z:-10},M={x:-(Math.random()*m.y*5+a.inertia*m.y),y:Math.random()*m.x*5+a.inertia*m.x,z:0},S={x:Math.random(),y:Math.random(),z:Math.random(),a:Math.random()}):(_={x:w.x*r/10,y:w.y*r/10,z:3e3},M={x:12*a.inertia,y:1*a.inertia,z:0},S={x:1,y:1,z:Math.random(),a:Math.random()}),s.vectors.push({index:this.dieIndex++,type:a.type,op:c,sid:d,gid:u,glvl:h,func:p,args:g,pos:b,velocity:_,angle:M,axis:S})}}return s}swapDiceFace(e,t){const r=this.DiceFactory.get(e.notation.type);if(e.resultReason="forced",r.shape=="d4"){this.swapDiceFace_D4(e,t);return}r.values;let n=parseInt(e.getLastValue().value);t=parseInt(t),e.notation.type=="d10"&&n==0&&(n=10),e.notation.type=="d100"&&n==0&&(n=100),e.notation.type=="d100"&&n>0&&n<10&&(n*=10),e.notation.type=="d10"&&t==0&&(t=10),e.notation.type=="d100"&&t==0&&(t=100),e.notation.type=="d100"&&t>0&&t<10&&(t*=10);let s=r.values.indexOf(n),o=r.values.indexOf(t);if(s<0||o<0||s==o)return;let a=e.geometry.clone(),l=[],c=[],d=2;r.shape=="d10"&&(d=1);let u,h=o+d;r.shape!="d2"?(u=s+d,h=o+d):(u=s+1,h=o+1);for(var p=0,g=a.groups.length;p<g;++p){const f=a.groups[p].materialIndex;if(f==u){l.push(p);continue}if(f==h){c.push(p);continue}}if(!(l.length<=0||c.length<=0)){for(let f=0,m=c.length;f<m;f++)a.groups[c[f]].materialIndex=u;for(let f=0,m=l.length;f<m;f++)a.groups[l[f]].materialIndex=h;e.geometry=a,e.result=[]}}swapDiceFace_D4(e,t){const r=this.DiceFactory.get(e.notation.type);let n=parseInt(e.getLastValue().value);if(t=parseInt(t),!(n>=1&&n<=4))return;let s=t-n,o=e.geometry.clone();for(let a=0,l=o.groups.length;a<l;++a){const c=o.groups[a];let d=c.materialIndex;if(d!=0){for(d+=s-1;d>4;)d-=4;for(;d<1;)d+=4;c.materialIndex=d+1}}s!=0&&(s<0&&(s+=4),e.material=this.DiceFactory.createMaterials(r,0,0,!1,s)),e.geometry=o}spawnDice(e,t=!1){const{pos:r,axis:n,angle:s,velocity:o}=e;let a;if(t)a=t,a.stopped=0,this.world.removeBody(a.body);else{if(a=this.DiceFactory.create(e.type,this.colorData),!a)return;a.notation=e,a.result=[],a.stopped=0,a.castShadow=this.shadows,this.scene.add(a),this.diceList.push(a)}a.body=new Ae({allowSleep:!0,sleepSpeedLimit:75,sleepTimeLimit:.9,mass:a.mass,shape:a.geometry.cannon_shape,material:this.dice_body_material}),a.body.type=Ae.DYNAMIC,a.body.position.set(r.x,r.y,r.z),a.body.quaternion.setFromAxisAngle(new k(n.x,n.y,n.z),n.a*Math.PI*2),a.body.angularVelocity.set(s.x,s.y,s.z),a.body.velocity.set(o.x,o.y,o.z),a.body.linearDamping=.1,a.body.angularDamping=.1,a.body.diceShape=a.shape,a.body.sleepState=0,a.body.addEventListener("collide",this.eventCollide.bind(this)),this.world.addBody(a.body)}eventCollide({body:e,target:t}){if(this.animstate=="simulate"||!this.sounds||!e||this.volume<=0)return;let r=Date.now(),n=e.mass>0?"dice":"table";if(!((this.lastSoundStep==e.world.stepnumber||this.lastSound>r)&&n!="dice")&&!((this.lastSoundStep==e.world.stepnumber||this.lastSound>r)&&n=="dice"&&this.lastSoundType=="dice")){if(e.mass>0){let s=e.velocity.length();if(s<250)return;let o;e.diceShape==="d2"?o=this.sounds_dice.coin[Math.floor(Math.random()*this.sounds_dice.coin.length)]:o=this.sounds_dice[this.sound_dieMaterial][Math.floor(Math.random()*this.sounds_dice[this.sound_dieMaterial].length)],o&&(o.volume=Math.min(s/8e3,this.volume/100),o.play().catch(a=>{})),this.lastSoundType="dice"}else{let s=t.velocity.length();if(s<250)return;let o=this.surface,a=this.sounds_table[o],l=a[Math.floor(Math.random()*a.length)];l&&(l.volume=Math.min(s/8e3,this.volume/100),l.play().catch(c=>{})),this.lastSoundType="table"}this.lastSoundStep=e.world.stepnumber,this.lastSound=r+this.soundDelay}}checkForRethrow(e){let t=e.notation.func?e.notation.func.toLowerCase():"",r,n=!1;if(t!=""&&r&&r.method){t=e.notation.func.toLowerCase();let s=e.notation.args||"";n=r.method(e,s)}return n}throwFinished(){const e=this.iteration>this.iterationLimit;for(let t=0,r=this.diceList.length;t<r;++t){const n=this.diceList[t],s=Ae.SLEEPING;if(n.body.sleepState<s&&!e)return!1;if(n.body.sleepState==s||e){if(n.body.type===Ae.KINEMATIC)continue;let o=!1;if(n.result.length==0?(n.storeRolledValue(n.resultReason),o=this.checkForRethrow(n)):n.result.length>0&&n.rerolling&&(n.rerolling=!1,n.storeRolledValue("reroll"),o=this.checkForRethrow(n)),o)return n.rerolls+=1,n.rerolling=!0,n.body.wakeUp(),n.body.type=Ae.DYNAMIC,n.body.angularVelocity=new k(25,25,25),n.body.velocity=new k(0,0,3e3),!1;n.rerolling=!1,n.body.type=Ae.KINEMATIC}}return!0}simulateThrow(){for(this.animstate="simulate",this.iteration=0,this.rolling=!0;!this.throwFinished(!0);)++this.iteration,this.world.step(this.framerate)}animateThrow(e,t){this.animstate="throw";let r=Date.now();this.last_time=this.last_time||r-this.framerate*1e3;let n=(r-this.last_time)/1e3;++this.iteration;let s=Math.floor(n/this.framerate);for(let o=0;o<s;o++)this.world.step(this.framerate),++this.steps;for(let o in this.scene.children){let a=this.scene.children[o];a.body!=null&&(a.position.copy(a.body.position),a.quaternion.copy(a.body.quaternion))}if(this.renderer.render(this.scene,this.camera),this.last_time=this.last_time+s*this.framerate*1e3,this.running==e&&this.throwFinished()){this.running=!1,this.rolling=!1,t&&t.call(this,this.notationVectors),this.running=Date.now(),this.animateAfterThrow(this.running);return}this.running==e&&((o,a,l,c,d)=>{!l&&n<this.framerate?setTimeout(()=>{requestAnimationFrame(()=>{o.call(this,a,c,d)})},(this.framerate-n)*1e3):requestAnimationFrame(()=>{o.call(this,a,c,d)})}).bind(this)(this.animateThrow,e,this.adaptive_timestep,t)}animateAfterThrow(e){this.animstate="afterthrow";let t=Date.now(),r=(t-this.last_time)/1e3;r>3&&(r=this.framerate),this.running=!1,this.last_time=t,this.renderer.render(this.scene,this.camera),this.running==e&&((n,s,o)=>{!o&&r<this.framerate?setTimeout(()=>{requestAnimationFrame(()=>{n.call(this,s)})},(this.framerate-r)*1e3):requestAnimationFrame(()=>{n.call(this,s)})}).bind(this)(this.animateAfterThrow,e,this.adaptive_timestep)}startClickThrow(e){this.rolling&&(this.clearDice(),this.rolling=!1);let t={x:(Math.random()*2-.5)*this.display.currentWidth,y:-(Math.random()*2-.5)*this.display.currentHeight},r=Math.sqrt(t.x*t.x+t.y*t.y)+100,n=(Math.random()+3)*r*this.strength;return this.getNotationVectors(e,t,n,r)}clearDice(){this.running=!1;let e;for(;e=this.diceList.pop();)this.scene.remove(e),e.body&&this.world.removeBody(e.body);this.renderer.render(this.scene,this.camera),setTimeout(()=>{this.renderer.render(this.scene,this.camera)},100)}getDiceResults(e){if(e!==void 0)return{type:this.diceList[e].shape,sides:parseInt(this.diceList[e].shape.substring(1)),id:e,...this.diceList[e].result.at(-1)};let t=0;const r=this.notationVectors.constant?parseInt(`${this.notationVectors.op}${this.notationVectors.constant}`):0;let n=r;return{notation:this.notationVectors.notation,sets:this.notationVectors.set.map(s=>{const o=t+s.num-1;let a=0;const l=[];for(let d=t;d<=o;d++){if(this.diceList[t].result.at(-1).reason==="remove"){t++;continue}l.push({type:s.type,sides:parseInt(s.type.substring(1)),id:t,...this.diceList[t].result.at(-1)}),a+=this.diceList[t].result.at(-1).value,t++}const c={num:s.num,type:s.type,sides:parseInt(s.type.substring(1)),rolls:l,total:a};return n+=a,c}),modifier:r,total:n}}async roll(e){if(this.notationVectors=this.startClickThrow(e),this.notationVectors)return new Promise((t,r)=>{this.rollDice(()=>{const n=this.getDiceResults();this.onRollComplete(n);const s=new CustomEvent("rollComplete",{detail:n});document.dispatchEvent(s),t(n)})})}async reroll(e){return this.rolling=!0,this.running=Date.now(),this.iteration=0,new Promise((t,r)=>{e.forEach(n=>{const s=this.diceList[n];s.rerolls+=1,s.rerolling=!0,s.body.wakeUp(),s.body.type=Ae.DYNAMIC,s.body.angularVelocity=new k(25,25,25),s.body.velocity=new k(0,0,3e3)}),this.animateThrow(this.running,()=>{const n=e.map(o=>this.getDiceResults(o));this.onRerollComplete(n);const s=new CustomEvent("rerollComplete",{detail:n});document.dispatchEvent(s),t(n)})})}async add(e){let t=this.diceList.length;if(!t)return this.roll(e);let r=this.startClickThrow(e),n=[];for(let s=0,o=r.vectors.length;s<o;++s)this.spawnDice(r.vectors[s]);this.simulateThrow(),this.steps=0,this.iteration=0;for(let s=0,o=r.vectors.length;s<o;++s){const a=t+s;!this.diceList[a]||(this.spawnDice(r.vectors[s],this.diceList[a]),n.push(a))}if(r.result&&r.result.length>0)for(let s=0;s<r.result.length;s++){const o=t+s;let a=this.diceList[o];!a||a.getLastValue().value!=r.result[s]&&this.swapDiceFace(a,r.result[s])}return this.notationVectors=T0.mergeNotation(this.notationVectors,r),new Promise((s,o)=>{const a=()=>{const l=n.map(d=>this.getDiceResults(d));this.onAddDiceComplete(l);const c=new CustomEvent("addDiceComplete",{detail:l});document.dispatchEvent(c),s(l)};this.rolling=!0,this.running=Date.now(),this.last_time=0,this.animateThrow(this.running,a)})}async remove(e){return new Promise((t,r)=>{const n=[];e.forEach(o=>{const a=this.diceList[o];a.body&&this.world.removeBody(a.body),this.scene.remove(a),a.storeRolledValue("remove"),n.push(this.getDiceResults(o))}),this.renderer.render(this.scene,this.camera),this.onRemoveDiceComplete(n);const s=new CustomEvent("removeDiceComplete",{detail:n});document.dispatchEvent(s),t(n)})}rollDice(e){if(this.notationVectors.error){e.call(this);return}this.clearDice();for(let t=0,r=this.notationVectors.vectors.length;t<r;++t)this.spawnDice(this.notationVectors.vectors[t]);this.simulateThrow(),this.steps=0,this.iteration=0;for(let t=0,r=this.diceList.length;t<r;++t)!this.diceList[t]||this.spawnDice(this.notationVectors.vectors[t],this.diceList[t]);if(this.notationVectors.result&&this.notationVectors.result.length>0)for(let t=0;t<this.notationVectors.result.length;t++){let r=this.diceList[t];!r||r.getLastValue().value!=this.notationVectors.result[t]&&this.swapDiceFace(r,this.notationVectors.result[t])}this.rolling=!0,this.running=Date.now(),this.last_time=0,this.animateThrow(this.running,e)}}const ut=Kw(H3);ut.use(nR);ut.config.globalProperties.$expandText=i=>{for(;i.match(/:\w+/g)!=null;)i=i.replace(/:\w+/,"<ic-$&></ic-$&>").replace("<ic-:","<ic-").replace("</ic-:","</ic-");return i.includes(`
`)||(i=`
`+i),i=i.replace(`
`,"<p det>"),i=i+"</p>",i};ut.config.globalProperties.$randomInt=(i,e)=>Math.floor(i+Math.random()*(1+e-i));ut.config.globalProperties.$updateChars=i=>{localStorage.setItem("CHARS",JSON.stringify(i))};ut.config.globalProperties.$attrToChecks=i=>{let e=["attack","order","impact","defence","chaos","research"],t={},r=Object.values(i),n=r.length;return Object.entries(i).forEach(([s,o],a)=>{let l=r[(a+1)%n],c=r[(a+n-1)%n],d=r[(a+3)%n];console.log(`${e[a]}: ${l}, ${c}, ${d}`),t[e[a]]=Math.max(o+Math.floor((l+c)/2),Math.floor(d/2))}),t};let Wf=new c9("#dice-canvas",{theme_customColorset:{background:"#ffff00",foreground:"#ffffff",texture:"marble",material:"metal"},light_intensity:2,gravity_multiplier:300,baseScale:150,strength:25,onRollComplete:i=>{}}),hn=document.getElementById("dice-canvas");Wf.initialize().then(()=>{hn.classList.remove("top-[50%]"),hn.classList.add("top-[150%]"),hn.classList.remove("-z-50"),hn.classList.add("z-50")}).catch(i=>console.error(i));Wf.updateConfig({theme_customColorset:{background:"#ff0000",foreground:"#ffffff",texture:"ice",material:"metal"}});ut.config.globalProperties.$initiateRoll=async i=>{let e=i.expr??"1d12";return hn.classList.remove("top-[150%]"),hn.classList.add("top-[50%]"),await Wf.roll(e).then(r=>(hn.classList.remove("top-[50%]"),hn.classList.add("top-[150%]"),r))},ut.config.globalProperties.$CHARS=Qt({});ut.component("Icon",lI);ut.component("fwb-dropdown",D6);ut.component("fwb-list-group",I6);ut.component("fwb-list-group-item",U6);ut.component("fwb-toggle",mz);ut.component("fwb-tab",_O);ut.component("fwb-tabs",AO);ut.component("fwb-modal",Y6);ut.component("fwb-button",fy);ut.component("fwb-range",VF);ut.component("fwb-input",RF);ut.component("fwb-tooltip",_F);ut.component("fwb-a",vz);ut.component("fwb-table",J6);ut.component("fwb-table-body",eO);ut.component("fwb-table-cell",nO);ut.component("fwb-table-head",lO);ut.component("fwb-table-head-cell",hO);ut.component("fwb-table-row",vO);ut.component("fwb-accordion",uI);ut.component("fwb-accordion-content",WI);ut.component("fwb-accordion-header",QI);ut.component("fwb-accordion-panel",t5);ut.component("fwb-select",ez);ut.component("fwb-textarea",az);ut.mount("#app");export{H as a,v as b,z as c,he as d,P as o,st as r,K as w};
